(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[17],{ALtN:function(t,e,n){var o,i=e,r=n("oAGj"),a=n("cZuM"),s=n("lbYW"),l=n("c9Jm"),u=n("6Rk9"),c=n("sIWg");i.AlignTest=(o=function(){this.actionSequence_AlignRightAndBottom=[function(){return new s.AlignFormaeAction(a.AlignmentType.Right)},function(){return new s.AlignFormaeAction(a.AlignmentType.Bottom)}],this.formaeToAlign_=[],this.initialBounds_=c.TheoRect.Zero,this.postAlignBounds_=c.TheoRect.Zero,this.epsilon=1e-8,l.ActionTestBase.call(this)},r.defineClass({name:"AlignTest",ctor:o,superName:"ActionTestBase",props:{setUpActionSequence:function(t,e,n){var o=u.GeometryFacade.getFormaeBounds([n.firstPage.root],!0);this.formaeToAlign_=r.clone(this.allSelectableFormae(n,(function(t){return 1==t.controller.floating&&o.contains(u.GeometryFacade.getFormaeBounds([t],!0))}))),XCTAssertNotNil(r.clone(this.formaeToAlign_)),this.formaeToAlign_.length>0&&(n.controller.selection.replaceSelectionWithFormae(r.clone(this.formaeToAlign_)),this.initialBounds_=u.GeometryFacade.getFormaeBounds(r.clone(this.formaeToAlign_),!0))},validateAfterActionSequence:function(t,e){this.postAlignBounds_=u.GeometryFacade.getFormaeBounds(r.clone(this.formaeToAlign_),!0),this.validatePostAlignmentRightAndBottom()},validateAfterUndo:function(t,e){var n=u.GeometryFacade.getFormaeBounds(r.clone(this.formaeToAlign_),!0);XCTAssertTrue(this.initialBounds_.equal(n))},validateAfterRedo:function(t,e){this.postAlignBounds_=u.GeometryFacade.getFormaeBounds(r.clone(this.formaeToAlign_),!0),this.validatePostAlignmentRightAndBottom()},validatePostAlignmentRightAndBottom:function(){for(var t=r.iter(this.formaeToAlign_);!t.done;t.next()){var e=t.value,n=this.postAlignBounds_.evalXY(1,1),o=u.GeometryFacade.getFormaeBounds([e],!0).evalXY(1,1);XCTAssertTrue(n.equalWithAccuracy(o,this.epsilon))}},tearDown:function(){this.formaeToAlign_=[],l.ActionTestBase.prototype.tearDown.call(this)}}}),o)},QO3H:function(t,e,n){var o,i,r,a,s,l,u,c,A,h,d,_,m,f,p,T,g,C,S,E,F=e,v=n("oAGj"),R=n("Tq01"),D=n("KgU+"),L=n("KSe6"),y=n("VQVe"),k=n("c9Jm"),N=n("yGNn");F.AnimateTest=(o=function(){this.actionSequence_Animation=[],this.testDoc_=null,this.testPage_=null,this.initialAnimationStyle_=null,this.initialAnimationVariant_=null,this.appliedAnimationStyle_=null,k.ActionTestBase.call(this)},v.defineClass({name:"AnimateTest",ctor:o,superName:"ActionTestBase",props:{shuffledAnimationStyle_:{get:function(){return v.opt(v.as(this.getActionResult(0),R.AnimationStyleActionResult),(function(t){return t.style}))}},tearDown:function(){this.initialAnimationStyle_=null,this.appliedAnimationStyle_=null,k.ActionTestBase.prototype.tearDown.call(this)},populateActionSequence:function(t,e,n){var o=this;if(this.testDoc_=n,this.testPage_=n.firstPage,this.initialAnimationStyle_=n.firstPage.animationController.animationStyle,this.initialAnimationVariant_=v.opt(this.initialAnimationStyle_,(function(t){return t.variant})),null!=this.initialAnimationStyle_)return N.CorePromise.resolve(t.concat([function(){return new D.ShuffleAnimationStyleAction(o.initialAnimationStyle_,o.testPage_)},function(){return new D.ApplyAnimationStyleAction(o.shuffledAnimationStyle_,o.testPage_)}]));var i=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(this.testPage_.root));return i.length>1?(this.appliedAnimationStyle_=v.last(i),null==this.appliedAnimationStyle_&&XCTAssertNotEqual(this.appliedAnimationStyle_,null),N.CorePromise.resolve(t.concat([function(){return new D.ApplyAnimationStyleAction(o.appliedAnimationStyle_,o.testPage_)}]))):(XCTFail("Could not get style for AnimateTest"),N.CorePromise.resolve([]))},validateAfterActionSequence:function(t,e){if(null!=this.initialAnimationStyle_){var n=(r=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle}))).variant,o=r.variantCount,i=this.testPage_.animationLibrary.getNextAnimationStyleOfSameType(this.initialAnimationStyle_);XCTAssertEqual(i.name,this.initialAnimationStyle_.name),XCTAssertEqual(r.name,this.initialAnimationStyle_.name),XCTAssertEqual(n,this.initialAnimationVariant_+1%o)}else if(null!=this.appliedAnimationStyle_){var r;n=(r=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle}))).variant,XCTAssertEqual(r.name,this.appliedAnimationStyle_.name),XCTAssertEqual(n,0)}},validateAfterUndo:function(t,e){if(null!=this.initialAnimationStyle_){var n=(o=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle}))).variant;XCTAssertEqual(o.name,this.initialAnimationStyle_.name),XCTAssertEqual(n,this.initialAnimationVariant_)}else if(null!=this.appliedAnimationStyle_){var o=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle}));XCTAssertEqual(o,null)}},validateAfterRedo:function(t,e){if(null!=this.initialAnimationStyle_){var n=(r=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle}))).variant,o=r.variantCount,i=this.testPage_.animationLibrary.getNextAnimationStyleOfSameType(this.initialAnimationStyle_);XCTAssertEqual(i.name,this.initialAnimationStyle_.name),XCTAssertEqual(r.name,this.initialAnimationStyle_.name),XCTAssertEqual(n,this.initialAnimationVariant_+1%o)}else if(null!=this.appliedAnimationStyle_){var r;n=(r=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle}))).variant,XCTAssertEqual(r.name,this.appliedAnimationStyle_.name),XCTAssertEqual(n,0)}}}}),o),F.AnimationTestBase=(i=function(){this.testDoc_=null,this.testPage_=null,this.initialAnimationStyle_=null,this.initialAnimationVariant_=null,this.appliedAnimationStyle_=null,this.appliedAnimationVariant_=0,k.ActionTestBase.call(this)},v.defineClass({name:"AnimationTestBase",ctor:i,superName:"ActionTestBase",props:{shuffledAnimationStyle_:{get:function(){return v.opt(v.as(this.getActionResult(0),R.AnimationStyleActionResult),(function(t){return t.style}))}},tearDown:function(){this.initialAnimationStyle_=null,this.appliedAnimationStyle_=null,k.ActionTestBase.prototype.tearDown.call(this)},setAnimation:function(){},populateActionSequence:function(t,e,n){var o=this;return this.testDoc_=n,this.testPage_=n.firstPage,this.initialAnimationStyle_=n.firstPage.animationController.animationStyle,this.initialAnimationVariant_=v.opt(this.initialAnimationStyle_,(function(t){return t.variant})),this.setAnimation(),null==this.appliedAnimationStyle_&&XCTAssertNotEqual(this.appliedAnimationStyle_,null),N.CorePromise.resolve([function(){return new D.ApplyAndPrepareAnimationAction(o.appliedAnimationStyle_,o.testPage_)}])},validateAfterActionSequence:function(t,e){if(null!=this.appliedAnimationStyle_){var n=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle})),o=n.variant;XCTAssertEqual(n.name,this.appliedAnimationStyle_.name),XCTAssertEqual(o,this.appliedAnimationVariant_)}},validateAfterUndo:function(t,e){if(null!=this.initialAnimationStyle_){var n=(o=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle}))).variant;XCTAssertEqual(o.name,this.initialAnimationStyle_.name),XCTAssertEqual(n,this.initialAnimationVariant_)}else if(null!=this.appliedAnimationStyle_){var o=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle}));XCTAssertEqual(o,null)}},validateAfterRedo:function(t,e){if(null!=this.appliedAnimationStyle_){var n=v.opt(this.testPage_,(function(t){return t.animationController.animationStyle})),o=n.variant;XCTAssertEqual(n.name,this.appliedAnimationStyle_.name),XCTAssertEqual(o,this.appliedAnimationVariant_)}}}}),i),F.AnimationLetterTest=(r=function(){this.actionSequence_AnimationLetter=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationLetterTest",ctor:r,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_TYPE)return this.appliedAnimationStyle_=r,!0}return!1}}}),r),F.AnimationLetterRandomTest=(a=function(){this.actionSequence_AnimationLetterRandom=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationLetterRandomTest",ctor:a,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=this,i=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),r=v.iter(i);!r.done;r.next()){var a=r.value;if(a.name==y.AnimationStyle.NAME_TYPE)return this.appliedAnimationStyle_=a,this.appliedAnimationVariant_=1,v.opt(this.appliedAnimationStyle_,(function(t){return t.variant=o.appliedAnimationVariant_})),!0}return!1}}}),a),F.AnimationLetterFlickerTest=(s=function(){this.actionSequence_AnimationLetterFlicker=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationLetterFlickerTest",ctor:s,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=this,i=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),r=v.iter(i);!r.done;r.next()){var a=r.value;if(a.name==y.AnimationStyle.NAME_FLICKER)return this.appliedAnimationStyle_=a,this.appliedAnimationVariant_=1,v.opt(this.appliedAnimationStyle_,(function(t){return t.variant=o.appliedAnimationVariant_})),!0}return!1}}}),s),F.AnimationFlickerTest=(l=function(){this.actionSequence_AnimationFlicker=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationFlickerTest",ctor:l,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_FLICKER)return this.appliedAnimationStyle_=r,!0}return!1}}}),l),F.AnimationGrowTest=(u=function(){this.actionSequence_AnimationGrow=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationGrowTest",ctor:u,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_GROW)return this.appliedAnimationStyle_=r,!0}return!1}}}),u),F.AnimationFadeTest=(c=function(){this.actionSequence_AnimationFade=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationFadeTest",ctor:c,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_FADE)return this.appliedAnimationStyle_=r,!0}return!1}}}),c),F.AnimationDynamicZoomTest=(A=function(){this.actionSequence_AnimationDynamicZoom=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationDynamicZoomTest",ctor:A,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_DYNAMIC)return this.appliedAnimationStyle_=r,!0}return!1}}}),A),F.AnimationDynamicCenterTest=(h=function(){this.actionSequence_AnimationDynamicCenter=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationDynamicCenterTest",ctor:h,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=this,i=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),r=v.iter(i);!r.done;r.next()){var a=r.value;if(a.name==y.AnimationStyle.NAME_DYNAMIC)return this.appliedAnimationStyle_=a,this.appliedAnimationVariant_=1,v.opt(this.appliedAnimationStyle_,(function(t){return t.variant=o.appliedAnimationVariant_})),!0}return!1}}}),h),F.AnimationDynamicTwoTest=(d=function(){this.actionSequence_AnimationDynamicTwo=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationDynamicTwoTest",ctor:d,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=this,i=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),r=v.iter(i);!r.done;r.next()){var a=r.value;if(a.name==y.AnimationStyle.NAME_DYNAMIC)return this.appliedAnimationStyle_=a,this.appliedAnimationVariant_=2,v.opt(this.appliedAnimationStyle_,(function(t){return t.variant=o.appliedAnimationVariant_})),!0}return!1}}}),d),F.AnimationDynamicThreeTest=(_=function(){this.actionSequence_AnimationDynamicThree=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationDynamicThreeTest",ctor:_,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=this,i=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),r=v.iter(i);!r.done;r.next()){var a=r.value;if(a.name==y.AnimationStyle.NAME_DYNAMIC)return this.appliedAnimationStyle_=a,this.appliedAnimationVariant_=3,v.opt(this.appliedAnimationStyle_,(function(t){return t.variant=o.appliedAnimationVariant_})),!0}return!1}}}),_),F.AnimationColorSwapOneTest=(m=function(){this.actionSequence_AnimationColorSwapOne=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationColorSwapOneTest",ctor:m,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_COLORSWAP)return this.appliedAnimationStyle_=r,!0}return!1}}}),m),F.AnimationSlideTest=(f=function(){this.actionSequence_AnimationSlide=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationSlideTest",ctor:f,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_SLIDE)return this.appliedAnimationStyle_=r,!0}return!1}}}),f),F.AnimationZoomTest=(p=function(){this.actionSequence_AnimationZoom=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationZoomTest",ctor:p,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_ZOOM)return this.appliedAnimationStyle_=r,!0}return!1}}}),p),F.AnimationPanTest=(T=function(){this.actionSequence_AnimationPan=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationPanTest",ctor:T,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_PAN)return this.appliedAnimationStyle_=r,!0}return!1}}}),T),F.AnimationGrayscaleTest=(g=function(){this.actionSequence_AnimationGrayscale=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationGrayscaleTest",ctor:g,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_GRAYSCALE)return this.appliedAnimationStyle_=r,!0}return!1}}}),g),F.AnimationPhotoBlurTest=(C=function(){this.actionSequence_AnimationPhotoBlur=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationPhotoBlurTest",ctor:C,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_BLUR)return this.appliedAnimationStyle_=r,!0}return!1}}}),C),F.AnimationColorizeTest=(S=function(){this.actionSequence_AnimationColorize=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationColorizeTest",ctor:S,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_COLOR)return this.appliedAnimationStyle_=r,!0}return!1}}}),S),F.AnimationFillTest=(E=function(){this.actionSequence_AnimationFill=[],F.AnimationTestBase.call(this)},v.defineClass({name:"AnimationFillTest",ctor:E,superName:"AnimationTestBase",props:{canRunActionSequence:function(t,e,n){for(var o=v.clone(L.AnimationLibrary.getDisplayableAnimationStyles(n.firstPage.root)),i=v.iter(o);!i.done;i.next()){var r=i.value;if(r.name==y.AnimationStyle.NAME_FILL)return this.appliedAnimationStyle_=r,!0}return!1}}}),E)},c9Jm:function(t,e,n){var o,i,r,a,s,l=e,u=n("oAGj"),c=n("Tq01"),A=n("kYI4"),h=n("yvDn"),d=n("yGNn"),_=n("C42b"),m=n("iCxV"),f=n("3lr5"),p=n("sRQj"),T=n("jcfx"),g=n("umUn"),C=n("VJ9E");l.ActionTestBase=(o=function(){this.canRun_=!0,this.runningSequenceName_="",this.qualifiedSequenceName_="",this.completePath_="",this.path_="",this.undoToIndex_=0,this.performanceFilename="performance.json",this.validationState_=new l.ValidationState,this.prepResults_=[],this.actionResults_=[],this.synchronizer=null,this.FAKE_COLOR_ELEMENT_PRIMARY_ID="themeColor0",this.FAKE_COLOR_ELEMENT_SECONDARY_ID1="themeColor1",this.FAKE_COLOR_ELEMENT_SECONDARY_ID2="themeColor2",this.FAKE_COLOR_ELEMENT_SHADE_ID0="themeColor3",this.FAKE_COLOR_ELEMENT_SHADE_ID1="themeColor4",this.FAKE_COLOR_ELEMENT_SHADE_ID2="themeColor5",this.FAKE_COLOR_ELEMENT_SHADE_ID3="themeColor6",this.FAKE_COLOR_ELEMENT_SHADE_ID4="themeColor7",this.FAKE_COLOR_ELEMENT_SHADE_ID5="themeColor8",this.FAKE_COLOR_ELEMENT_SHADE_ID6="themeColor9",this.FAKE_LOGO_ELEMENT_PRIMARY_ID="logo-001",this.FAKE_LOGO_ELEMENT_STAMP_ID="logo-002",this.FAKE_FONT_ELEMENT_HEADLINE_ID="fnt-001",this.FAKE_FONT_ELEMENT_BODY_ID="fnt-002",this.FAKE_COLOR_ELEMENT_PRIMARY_ID_2="themeColor0-2",this.FAKE_COLOR_ELEMENT_SECONDARY_ID1_2="themeColor1-2",this.FAKE_COLOR_ELEMENT_SECONDARY_ID2_2="themeColor2-2",this.FAKE_COLOR_ELEMENT_SHADE_ID0_2="themeColor3-2",this.FAKE_COLOR_ELEMENT_SHADE_ID1_2="themeColor4-2",this.FAKE_COLOR_ELEMENT_SHADE_ID2_2="themeColor5-2",this.FAKE_COLOR_ELEMENT_SHADE_ID3_2="themeColor6-2",this.FAKE_COLOR_ELEMENT_SHADE_ID4_2="themeColor7-2",this.FAKE_COLOR_ELEMENT_SHADE_ID5_2="themeColor8-2",this.FAKE_COLOR_ELEMENT_SHADE_ID6_2="themeColor9-2",this.FAKE_LOGO_ELEMENT_PRIMARY_ID_2="logo-001-2",this.FAKE_LOGO_ELEMENT_STAMP_ID_2="logo-002-2",this.FAKE_FONT_ELEMENT_HEADLINE_ID_2="fnt-001-2",this.FAKE_FONT_ELEMENT_BODY_ID_2="fnt-002-2"},u.defineClass({name:"ActionTestBase",ctor:o,statics:{renderPerformanceData:{},actionPerformanceData:{},undoPerformanceData:{},redoPerformanceData:{}},props:{lastActionResult:{get:function(){return u.last(this.actionResults_)}},appendActionResult:function(t){this.actionResults_.push(t)},getActionResult:function(t){return t>=0&&t<this.actionResults_.length?this.actionResults_[t]:null},getPrepActionResult:function(t){return t>=0&&t<this.prepResults_.length?this.prepResults_[t]:null},testName:{get:function(){return"ActionTest:"+this.path_+"::"+this.runningSequenceName_}},initializeDocPath:function(t){this.completePath_=t,this.path_=u.toString(u.last(t.split("/")))},initializeTestParameters:function(t,e,n){this.runningSequence_=u.clone(t),this.runningSequenceName_=e,this.qualifiedSequenceName_=n},setUp:function(){var t=this;this.doc_=u.opt(m.Host.actionTesting,(function(e){return e.openDocument(t.completePath_)}))},tearDown:function(){var t=this;this.prepareSequence_=null,this.runningSequence_=null,this.prepResults_=[],this.actionResults_=[],u.opt(m.Host.actionTesting,(function(e){return e.closeDocument(t.completePath_)}))},validateActionSequence:function(){var t=this,e=this.nextValidationState();u.opt(m.Host.actionTesting,(function(n){return n.awaitResult(e,t.synchronizer)}))},nextValidationState:function(){var t,e,n,i=this;switch(this.validationState_.next()){case 0:return new d.CorePromise((function(t,e){var n;(n=i.doc_)?(_.CoreRandom.seedRandom(5489),i.canRun_=i.canRunActionSequence(u.clone(i.runningSequence_),i.runningSequenceName_,n),i.canRun_||i.validationState_.finish()):i.validationState_.fail(),t(null)})).then((function(t){return i.nextValidationState()}));case 1:return this.prepareDocument(this.doc_,this.runningSequenceName_).then((function(e){return i.prepareSequence_=u.clone((t=u.as(e,["Array","Function"]))||null!=t?t:[]),i.runActions(u.clone(i.prepareSequence_))})).then((function(t){return i.nextValidationState()}));case 2:return this.populateActionSequence(u.clone(this.runningSequence_),this.runningSequenceName_,this.doc_).then((function(t){return i.runningSequence_=u.clone(u.as(t,["Array","Function"])),null})).then((function(t){return i.nextValidationState()}));case 3:return new d.CorePromise((function(t,e){i.setUpActionSequence(u.clone(i.runningSequence_),i.runningSequenceName_,i.doc_),t(null)})).then((function(t){return i.nextValidationState()}));case 4:return new d.CorePromise((function(t,e){i.renderBeforeRunning(u.clone(i.runningSequence_),i.runningSequenceName_),t(null)})).then((function(t){return i.nextValidationState()}));case 5:var r=0;return d.CorePromise.resolve(null).then((function(t){return r=m.Host.async.getSystemUptimeInSeconds(),d.CorePromise.resolve(null)})).then((function(t){return i.runActionSequence(u.clone(i.runningSequence_),i.runningSequenceName_)})).then((function(t){var e=m.Host.async.getSystemUptimeInSeconds()-r,n=m.Host.locale.formatNumber(e,3),a=i.qualifiedSequenceName_+"/"+i.path_;return o.actionPerformanceData[a]={time:n,buffer:"99.99"},i.nextValidationState()}));case 6:return new d.CorePromise((function(t,e){i.validateAfterActionSequence(u.clone(i.runningSequence_),i.runningSequenceName_),t(null)})).then((function(t){return i.nextValidationState()}));case 7:return d.CorePromise.resolve(null).then((function(t){return d.CorePromise.resolve(null)})).then((function(t){return i.renderAfterRunning(u.clone(i.runningSequence_),i.runningSequenceName_)})).then((function(t){if(((e=u.opt(m.Host.actionTesting,(function(t){return t.allActionsEnabled})))||null!=e)&&!e){var r=i.path_,a=u.clone((n=u.as(t,["Dictionary","String","String"]))||null!=n?n:{time:"0.00",format:"image",buffer:"99.99"});o.renderPerformanceData[r]={time:a.time,buffer:a.buffer,format:a.format};var s={render:o.renderPerformanceData};u.opt(m.Host.actionTesting,(function(t){return t.writeJsonToFile(u.clone(s),i.performanceFilename)}))}return i.nextValidationState()}));case 8:return r=0,d.CorePromise.resolve(null).then((function(t){return r=m.Host.async.getSystemUptimeInSeconds(),d.CorePromise.resolve(null)})).then((function(t){return i.undoActionSequence(u.clone(i.runningSequence_),i.runningSequenceName_)})).then((function(t){var e=m.Host.async.getSystemUptimeInSeconds()-r,n=m.Host.locale.formatNumber(e,3),a=i.qualifiedSequenceName_+"/"+i.path_;return o.undoPerformanceData[a]={time:n,buffer:"99.99"},i.nextValidationState()}));case 9:return new d.CorePromise((function(t,e){i.validateAfterUndo(u.clone(i.runningSequence_),i.runningSequenceName_),t(null)})).then((function(t){return i.nextValidationState()}));case 10:return new d.CorePromise((function(t,e){i.renderAfterUndo(u.clone(i.runningSequence_),i.runningSequenceName_),t(null)})).then((function(t){return i.nextValidationState()}));case 11:return r=0,d.CorePromise.resolve(null).then((function(t){return r=m.Host.async.getSystemUptimeInSeconds(),d.CorePromise.resolve(null)})).then((function(t){return i.redoActionSequence(u.clone(i.runningSequence_),i.runningSequenceName_)})).then((function(t){var e=m.Host.async.getSystemUptimeInSeconds()-r,n=m.Host.locale.formatNumber(e,3),a=i.qualifiedSequenceName_+"/"+i.path_;return o.redoPerformanceData[a]={time:n,buffer:"99.99"},i.nextValidationState()}));case 12:return new d.CorePromise((function(t,e){i.validateAfterRedo(u.clone(i.runningSequence_),i.runningSequenceName_),t(null)})).then((function(t){return i.nextValidationState()}));case 13:return new d.CorePromise((function(t,e){i.renderAfterRedo(u.clone(i.runningSequence_),i.runningSequenceName_),t(null)})).then((function(t){return i.nextValidationState()}));case 14:return new d.CorePromise((function(t,e){i.shutdown(u.clone(i.runningSequence_),i.runningSequenceName_,i.doc_),t(null)})).then((function(t){return i.nextValidationState()}));default:return d.CorePromise.resolve(null)}},canRunActionSequence:function(t,e,n){return!0},populateActionSequence:function(t,e,n){return d.CorePromise.resolve(u.clone(t))},prepareDocument:function(t,e){return d.CorePromise.resolve([])},setUpActionSequence:function(t,e,n){},renderBeforeRunning:function(t,e){this.render(this.doc_,"before/"+this.qualifiedSequenceName_)},runActions:function(t){var e=this,n=new l.TestActionHandler(this.doc_.controller),o=u.clone(t);if(0==o.length)return d.CorePromise.resolve(null);var i=n.doAction(o.shift()()).then((function(t){return e.appendActionResult(c.ActionResult.fromPromiseAny(t))}));if(0==!o.length)for(var r=u.iter(o);!r.done;r.next()){var a=r.value;i=i.then((function(t){var e=a();return n.doAction(e)})).then((function(t){return e.appendActionResult(c.ActionResult.fromPromiseAny(t))}))}return i},clearResultsBeforeRunning:function(){this.prepResults_=u.clone(this.actionResults_),this.actionResults_=[]},runActionSequence:function(t,e){var n,o=this;return this.clearResultsBeforeRunning(),XCTAssertTrue(t.length>0,"should not run a test with no actions. Implement CanRun for this test to skip if the test can't be run on it"),(n=u.opt(u.opt(this.doc_,(function(t){return t.controller})),(function(t){return t.undoRedoMgr})))&&(this.undoToIndex_=n.getCurrentTimelineIndex()),this.runActions(u.clone(t)).then((function(e){return XCTAssertTrue(o.actionResults_.length==t.length)})).fail((function(t){var e;return(e=u.as(t,h.CoreStringError))?XCTFail(u.toString(e.message)):XCTFail("Failed with error: "+u.toString(t)),d.CorePromise.reject(t)}))},validateAfterActionSequence:function(t,e){},renderAfterRunning:function(t,e){var n,i,r,a=this,s=!(n=u.opt(m.Host.actionTesting,(function(t){return t.allActionsEnabled})))&&null==n||n?"after_actions/":"",l=!(i=u.opt(m.Host.actionTesting,(function(t){return t.allActionsEnabled})))&&null==i||i?this.qualifiedSequenceName_:"",c=u.clone(this.render(this.doc_,s+l));if(!(r=u.opt(m.Host.actionTesting,(function(t){return t.allActionsEnabled})))&&null==r||r){var A={action:o.actionPerformanceData};u.opt(m.Host.actionTesting,(function(t){return t.writeJsonToFile(u.clone(A),s+a.performanceFilename)}))}return c},undoActionSequence:function(t,e){var n,o=d.CorePromise.resolve(null);if(0==!t.length&&(n=u.opt(u.opt(this.doc_,(function(t){return t.controller})),(function(t){return t.undoRedoMgr})))){o=o.then((function(t){return XCTAssertTrue(null!=n.getUndoDescription(),"Undo not found before undoing tested actions"),XCTAssertTrue(null==n.getRedoDescription(),"Redo found before undoing tested actions"),null}));for(var i=this.undoToIndex_,r=u.iter(u.range(0,t.length,!1));!r.done;r.next())o=o.then((function(t){return new d.CorePromise((function(t,e){n.getCurrentTimelineIndex()>i?n.undo((function(){return t(null)})):t(null)}))}));o=o.then((function(t){return XCTAssertTrue(null!=n.getRedoDescription(),"No redo found after undoing tested actions"),null}))}return o},validateAfterUndo:function(t,e){},renderAfterUndo:function(t,e){var n=this;this.render(this.doc_,"after_undo/"+this.qualifiedSequenceName_);var i={undo:o.undoPerformanceData};u.opt(m.Host.actionTesting,(function(t){return t.writeJsonToFile(u.clone(i),"after_undo/"+n.performanceFilename)}))},redoActionSequence:function(t,e){var n,o=d.CorePromise.resolve(null);if(0==!t.length&&(n=u.opt(u.opt(this.doc_,(function(t){return t.controller})),(function(t){return t.undoRedoMgr})))){o=o.then((function(t){return XCTAssertTrue(null!=n.getRedoDescription(),"Redo not found before redoing tested actions"),null}));for(var i=u.iter(u.range(0,t.length,!1));!i.done;i.next())o=o.then((function(t){return new d.CorePromise((function(t,e){return n.redo((function(){return t(null)}))}))}));o=o.then((function(t){return XCTAssertTrue(null==n.getRedoDescription(),"Extra redo found after redoing tested actions"),XCTAssertTrue(null!=n.getUndoDescription(),"No undo found after redoing tested actions"),null}))}return o},validateAfterRedo:function(t,e){},renderAfterRedo:function(t,e){var n=this;this.render(this.doc_,"after_redo/"+this.qualifiedSequenceName_);var i={redo:o.redoPerformanceData};u.opt(m.Host.actionTesting,(function(t){return t.writeJsonToFile(u.clone(i),"after_redo/"+n.performanceFilename)}))},shutdown:function(t,e,n){},allSelectableFormae:function(t,e){var n;return void 0===e&&(e=null),t.firstPage.root.filterWithCallback((function(t){return null!=t.controller&&t.controller.selectable&&(!(n=u.opt(e,(function(e){return e(t)})))&&null==n||n)}))},findLargestForma:function(t){return t.reduce(this.chooseLargerForma,[null,0])[0]},chooseLargerForma:function(t,e){var n,o=(n=u.opt(e.bounds,(function(t){return t.area})))||null!=n?n:0;return o>t[1]?[e,o]:t},test_ValidateActionSequence:function(t,e){},installBrandkit:function(t){(new T.ProfilingColorMap).reset();var e=[],n=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_PRIMARY_ID,[g.TheoColor.SPARK_COLOR_ROLE_PRIMARY],25.5,127.5,255,1),o=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SECONDARY_ID1,[g.TheoColor.SPARK_COLOR_ROLE_SECONDARY],125,128,255,1),i=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SECONDARY_ID2,[g.TheoColor.SPARK_COLOR_ROLE_SECONDARY],25,228,155,1),r=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID0,[g.TheoColor.SPARK_COLOR_ROLE_SHADE0],30,20,40,1),a=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID1,[g.TheoColor.SPARK_COLOR_ROLE_SHADE1],60,40,80,1),s=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID2,[g.TheoColor.SPARK_COLOR_ROLE_SHADE2],100,50,255,1),l=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID3,[g.TheoColor.SPARK_COLOR_ROLE_SHADE3],140,60,120,1),c=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID4,[g.TheoColor.SPARK_COLOR_ROLE_SHADE4],190,80,160,1),h=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID5,[g.TheoColor.SPARK_COLOR_ROLE_SHADE5],230,100,200,1),d=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID6,[g.TheoColor.SPARK_COLOR_ROLE_SHADE6],255,255,255,1),_=g.TheoColor.init_bb45(n);e.push(_),e.push(g.TheoColor.init_bb45(o)),e.push(g.TheoColor.init_bb45(i)),e.push(g.TheoColor.init_bb45(r)),e.push(g.TheoColor.init_bb45(a)),e.push(g.TheoColor.init_bb45(s)),e.push(g.TheoColor.init_bb45(l)),e.push(g.TheoColor.init_bb45(c)),e.push(g.TheoColor.init_bb45(h)),e.push(g.TheoColor.init_bb45(d)),m.Host.fontProvider.getSuggestableFonts(f.ANY_DOCUMENT);var S=u.opt(m.Host.fontProvider,(function(t){return t.descriptorForPostScriptName("Yellowtail",f.ANY_DOCUMENT)})),E=u.opt(m.Host.fontProvider,(function(t){return t.descriptorForPostScriptName("WanderlustShine-Regular ",f.ANY_DOCUMENT)})),F=[],v=new p.MockAuthoringContextFont(this.FAKE_FONT_ELEMENT_HEADLINE_ID,C.TheoFont.SPARK_FONT_ROLE_HEADLINE,S),R=new p.MockAuthoringContextFont(this.FAKE_FONT_ELEMENT_BODY_ID,C.TheoFont.SPARK_FONT_ROLE_BODY,E);F.push(v),F.push(R);var D=new p.MockAuthoringContextLogo(this.FAKE_LOGO_ELEMENT_PRIMARY_ID,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNg/sXzHwAEFgIJ5hSCsQAAAABJRU5ErkJggg==",A.SPARK_LOGO_ROLE_PRIMARY,1,1),L=new p.MockAuthoringContextLogo(this.FAKE_LOGO_ELEMENT_STAMP_ID,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAADCAIAAADZSiLoAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAABZJREFUCJlj+P//PwMDA4REpf7//w8A4D0O8mtAqaUAAAAASUVORK5CYII=",A.SPARK_LOGO_ROLE_POST_STAMP,3,3),y=[];y.push(D),y.push(L);var k=p.MockAuthoringContext.init_44fd("Fake Brandkit","brandkit-for-actions",[n,o,i,r,a,s,l,c,h,d],u.clone(F),u.clone(y));m.Host.brandkitManager.fakeBrandkitForElementsForTesting=k},installSecondBrandkit:function(t){(new T.ProfilingColorMap).reset();var e=[],n=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_PRIMARY_ID_2,[g.TheoColor.SPARK_COLOR_ROLE_PRIMARY],65.5,167.5,222,1),o=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SECONDARY_ID1_2,[g.TheoColor.SPARK_COLOR_ROLE_SECONDARY],25,108,201,1),i=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SECONDARY_ID2_2,[g.TheoColor.SPARK_COLOR_ROLE_SECONDARY],75,208,105,1),r=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID0_2,[g.TheoColor.SPARK_COLOR_ROLE_SHADE0],245,245,245,1),a=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID1_2,[g.TheoColor.SPARK_COLOR_ROLE_SHADE1],230,100,200,1),s=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID2_2,[g.TheoColor.SPARK_COLOR_ROLE_SHADE2],190,80,160,1),l=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID3_2,[g.TheoColor.SPARK_COLOR_ROLE_SHADE3],140,60,120,1),c=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID4_2,[g.TheoColor.SPARK_COLOR_ROLE_SHADE4],100,50,255,1),h=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID5_2,[g.TheoColor.SPARK_COLOR_ROLE_SHADE5],60,40,80,1),d=new p.MockAuthoringContextColor(this.FAKE_COLOR_ELEMENT_SHADE_ID6_2,[g.TheoColor.SPARK_COLOR_ROLE_SHADE6],30,20,40,1),_=g.TheoColor.init_bb45(n);e.push(_),e.push(g.TheoColor.init_bb45(o)),e.push(g.TheoColor.init_bb45(i)),e.push(g.TheoColor.init_bb45(r)),e.push(g.TheoColor.init_bb45(a)),e.push(g.TheoColor.init_bb45(s)),e.push(g.TheoColor.init_bb45(l)),e.push(g.TheoColor.init_bb45(c)),e.push(g.TheoColor.init_bb45(h)),e.push(g.TheoColor.init_bb45(d)),m.Host.fontProvider.getSuggestableFonts(f.ANY_DOCUMENT);var S=u.opt(m.Host.fontProvider,(function(t){return t.descriptorForPostScriptName("Yellowtail",f.ANY_DOCUMENT)})),E=u.opt(m.Host.fontProvider,(function(t){return t.descriptorForPostScriptName("WanderlustShine-Regular ",f.ANY_DOCUMENT)})),F=[],v=new p.MockAuthoringContextFont(this.FAKE_FONT_ELEMENT_HEADLINE_ID_2,C.TheoFont.SPARK_FONT_ROLE_HEADLINE,S),R=new p.MockAuthoringContextFont(this.FAKE_FONT_ELEMENT_BODY_ID_2,C.TheoFont.SPARK_FONT_ROLE_BODY,E);F.push(v),F.push(R);var D=new p.MockAuthoringContextLogo(this.FAKE_LOGO_ELEMENT_PRIMARY_ID_2,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNg/sXzHwAEFgIJ5hSCsQAAAABJRU5ErkJggg==",A.SPARK_LOGO_ROLE_PRIMARY,1,1),L=new p.MockAuthoringContextLogo(this.FAKE_LOGO_ELEMENT_STAMP_ID_2,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAADCAIAAADZSiLoAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAABZJREFUCJlj+P//PwMDA4REpf7//w8A4D0O8mtAqaUAAAAASUVORK5CYII=",A.SPARK_LOGO_ROLE_POST_STAMP,3,3),y=[];y.push(D),y.push(L);var k=p.MockAuthoringContext.init_44fd("Fake Brandkit 2","brandkit-for-actions-2",[n,o,i,r,a,s,l,c,h,d],u.clone(F),u.clone(y));m.Host.brandkitManager.fakeBrandkitForElementsForTesting=k},removeBrandkit:function(t){m.Host.brandkitManager.fakeBrandkitForElementsForTesting=null,(new T.ProfilingColorMap).reset()},urlForAsset:function(t){return u.opt(m.Host.actionTesting,(function(e){return e.urlForAsset(t)}))},imageDataForAsset:function(t){return null!=m.Host.actionTesting?m.Host.actionTesting.imageDataForAsset(t):d.CorePromise.resolve(null)},render:function(t,e,n){void 0===n&&(n="");var o,i=this,r=((o=u.opt(m.Host.actionTesting,(function(t){return t.outputFolder})))||null!=o?o:"")+e+"/";return u.opt(m.Host.actionTesting,(function(e){return e.render(t,r,i.path_+n)}))}}}),o),l.TestActionHandler=(i=function(t){this.actionQueue=[],this.executingAction=null,this.dc=t},u.defineClass({name:"TestActionHandler",ctor:i,statics:{_implements:function(t){return"IActionHandler"==t}},props:{canDoAction:function(t){return XCTAssertTrue(t.canDo(this.dc)),t.canDo(this.dc)},finishAction:function(){this.executingAction=null;var t=u.first(this.actionQueue);null!=t&&(this.actionQueue.shift(),this.doActionWithCallback(t[0],t[1]))},doActionWithCallback:function(t,e){var n,o=this;if(null!=this.executingAction)this.actionQueue.push([t,e]);else if(n=this.dc){var i=null;n.undoRedoMgr.beginUserActionAsync(t.getUserAction(n)).then((function(e){return t.execute(n)})).then((function(t){return i=t,n.undoRedoMgr.endUserActionAsync()})).then((function(e){return t.updateSelection(n)})).then((function(t){return e(c.ActionResult.fromPromiseAny(i),null)})).fail((function(t){return e(null,t)})).then((function(t){return o.finishAction()}))}else XCTFail("Document controller destroyed")},doAction:function(t){var e=this;return new d.CorePromise((function(n,o){return e.doActionWithCallback(t,(function(t,e){var i;null!=(i=e)?o(i):n(t)}))}))}}}),i),l.TestState=u.defineEnum("TestState",{kFailed:-1,kCanRun:0,kPrepDoc:1,kPopulate:2,kSetUp:3,kRenderBeforeRunning:4,kRun:5,kValidateAfterRunning:6,kRenderAfterRunning:7,kUndo:8,kValidateAfterUndo:9,kRenderAfterUndo:10,kRedo:11,kValidateAfterRedo:12,kRenderAfterRedo:13,kShutdown:14,kFinished:15}),l.EnabledTestStates=(r=function(){},a={},u.defineClass({name:"EnabledTestStates",ctor:r,statics:{kRunStates:{get:function(){return void 0===a.kRunStates&&(a.kRunStates=r.init_34d9([l.TestState.kCanRun,l.TestState.kPrepDoc,l.TestState.kPopulate,l.TestState.kSetUp,l.TestState.kRun,l.TestState.kValidateAfterRunning,l.TestState.kRenderAfterRunning,l.TestState.kShutdown])),a.kRunStates}},kActionTestSpecificStates:{get:function(){return void 0===a.kActionTestSpecificStates&&(a.kActionTestSpecificStates=r.init_34d9([l.TestState.kRenderBeforeRunning])),a.kActionTestSpecificStates}},kUndoStates:{get:function(){return void 0===a.kUndoStates&&(a.kUndoStates=r.init_34d9([l.TestState.kUndo,l.TestState.kValidateAfterUndo,l.TestState.kRenderAfterUndo])),a.kUndoStates}},kRedoStates:{get:function(){return void 0===a.kRedoStates&&(a.kRedoStates=r.init_34d9([l.TestState.kRedo,l.TestState.kValidateAfterRedo,l.TestState.kRenderAfterRedo])),a.kRedoStates}},kRenderingStates:{get:function(){return void 0===a.kRenderingStates&&(a.kRenderingStates=r.init_34d9([l.TestState.kRenderBeforeRunning,l.TestState.kRenderAfterRunning,l.TestState.kRenderAfterUndo,l.TestState.kRenderAfterRedo])),a.kRenderingStates}},kValidationStates:{get:function(){return void 0===a.kValidationStates&&(a.kValidationStates=r.init_34d9([l.TestState.kValidateAfterRunning,l.TestState.kValidateAfterUndo,l.TestState.kValidateAfterRedo])),a.kValidationStates}},kAllStates:{get:function(){return void 0===a.kAllStates&&(a.kAllStates=r.init_34d9([l.TestState.kCanRun,l.TestState.kPrepDoc,l.TestState.kPopulate,l.TestState.kSetUp,l.TestState.kRenderBeforeRunning,l.TestState.kRun,l.TestState.kValidateAfterRunning,l.TestState.kRenderAfterRunning,l.TestState.kUndo,l.TestState.kValidateAfterUndo,l.TestState.kRenderAfterUndo,l.TestState.kRedo,l.TestState.kValidateAfterRedo,l.TestState.kRenderAfterRedo,l.TestState.kShutdown])),a.kAllStates}}},props:{init_5d5e:function(t){this.rawValue=t},init_b14a:function(t){this.rawValue=1<<t},init_34d9:function(t){this.rawValue=t.reduce((function(t,e){return t|1<<e}),0)},enabled:function(t){return this.rawValue&1<<t!=0},enable:function(t){return r.init_5d5e(this.rawValue|1<<t)},disable:function(t){return r.init_5d5e(this.rawValue&(r.kAllStates.rawValue^1<<t))},subtracting:function(t){return r.init_5d5e(this.rawValue&(r.kAllStates.rawValue^t.rawValue))}}}),r),l.ValidationState=(s=function(){var t,e,n,o;this.state_=l.TestState.kCanRun,this.enabledStates_=l.EnabledTestStates.kAllStates,!(t=u.opt(m.Host.actionTesting,(function(t){return t.allActionsEnabled})))&&null==t||t||(this.enabledStates_=this.enabledStates_.subtracting(l.EnabledTestStates.kActionTestSpecificStates)),((e=u.opt(m.Host.actionTesting,(function(t){return t.renderingEnabled})))||null!=e)&&e||(this.enabledStates_=this.enabledStates_.subtracting(l.EnabledTestStates.kRenderingStates)),((n=u.opt(m.Host.actionTesting,(function(t){return t.undoEnabled})))||null!=n)&&n||(this.enabledStates_=this.enabledStates_.subtracting(l.EnabledTestStates.kUndoStates),this.enabledStates_=this.enabledStates_.subtracting(l.EnabledTestStates.kRedoStates)),((o=u.opt(m.Host.actionTesting,(function(t){return t.validationEnabled})))||null!=o)&&o||(this.enabledStates_=this.enabledStates_.subtracting(l.EnabledTestStates.kValidationStates))},u.defineClass({name:"ValidationState",ctor:s,props:{next:function(){var t,e,n=this.state_;for(this.state_=(t=l.TestState.toCaseValue(this.state_+1))||null!=t?t:l.TestState.kFailed;!this.enabledStates_.enabled(this.state_)&&this.hasNext;)this.state_=(e=l.TestState.toCaseValue(this.state_+1))||null!=e?e:l.TestState.kFailed;return n},hasNext:{get:function(){return this.state_!=l.TestState.kFailed&&this.state_!=l.TestState.kFinished}},fail:function(){this.state_=l.TestState.kFailed},finish:function(){this.hasNext&&(this.state_=l.TestState.kFinished)}}}),s)},eLhV:function(t,e,n){var o,i,r,a,s=e,l=n("oAGj"),u=n("Tq01"),c=n("4mEG"),A=n("c9Jm"),h=n("yGNn"),d=n("FNB+"),_=n("iCxV"),m=n("3lr5"),f=n("cRpU"),p=n("enh0"),T=n("Vm85"),g=n("VJ9E"),C=n("8t9B"),S=n("uUew");s.SetHighlightMethodTest=(o=function t(){this.actionSequence_SetHighlightMethod=[function(){return new c.AddTextContentAction(t.initialText_)}],this.testDoc_=null,this.testPage_=null,this.testFormaID_=null,this.lockupFont_=null,A.ActionTestBase.call(this)},l.defineClass({name:"SetHighlightMethodTest",ctor:o,superName:"ActionTestBase",statics:{initialText_:"Some text that is long enough to span lines",testFont_:"Bellfort",getTheoFont:function(t){var e=g.TheoFont.init_9e5c(_.Host.fontProvider.getIncludedFonts(m.ANY_DOCUMENT).find((function(e){return e.postScriptName==t})));return XCTAssertEqual(e.fontData.postScriptName,t),e}},props:{textForma:{get:function(){return l.first(l.opt(l.as(this.getActionResult(0),u.FormaActionResult),(function(t){return t.formae})))}},populateActionSequence:function(t,e,n){var i=this;return h.CorePromise.resolve(t.concat([function(){return i.lockupFont_=l.opt(l.opt(l.opt(l.as(l.opt(i.textForma,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.lockupStyle})),(function(t){return t.font})),(function(t){return t.fontData.postScriptName})),l.opt(l.opt(i.testDoc_,(function(t){return t.controller})),(function(t){return t.selection.replaceSelection(i.textForma)})),new f.EnterCharStyleModeAction(i.textForma)},function(){return new f.SetHighlightMethodAction(C.HighlightMethod.EvenRows,!0)},function(){return new f.SetFontAction(o.getTheoFont(o.testFont_))},function(){return new f.ExitCharStyleModeAction(i.textForma)}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.testPage_=n.firstPage},validateAfterActionSequence:function(t,e){var n=this;this.testFormaID_=l.opt(this.textForma,(function(t){return t.formaID})),XCTAssertNotNil(this.testDoc_),XCTAssertNotNil(this.testPage_),XCTAssertNotNil(this.testFormaID_);var i=l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)}));XCTAssertTrue(i===this.textForma),XCTAssertEqual(l.opt(l.opt(i,(function(t){return t.controller})),(function(t){return t.kind})),C.TypeLockupController.KIND),XCTAssertEqual(l.opt(l.opt(l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.lockupStyle})),(function(t){return t.font})),(function(t){return t.fontData.postScriptName})),this.lockupFont_),i.visit(d.FormaTraversal.PreOrder,(function(t,e,n){var i;return(i=l.as(t,p.TextForma))&&i.rowIndex%2==0&&XCTAssertEqual(i.fontDescriptor.postScriptName,o.testFont_),!1}))},validateAfterUndo:function(t,e){var n=this;XCTAssertEqual(l.opt(l.opt(l.opt(l.as(l.opt(this.textForma,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.lockupStyle})),(function(t){return t.font})),(function(t){return t.fontData.postScriptName})),this.lockupFont_),XCTAssertNil(l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)})))},validateAfterRedo:function(t,e){var n=this,i=l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)}));XCTAssertNotNil(i),XCTAssertEqual(l.opt(l.opt(i,(function(t){return t.controller})),(function(t){return t.kind})),C.TypeLockupController.KIND),XCTAssertEqual(l.opt(l.opt(l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.lockupStyle})),(function(t){return t.font})),(function(t){return t.fontData.postScriptName})),this.lockupFont_),i.visit(d.FormaTraversal.PreOrder,(function(t,e,n){var i;return(i=l.as(t,p.TextForma))&&i.rowIndex%2==0&&XCTAssertEqual(i.fontDescriptor.postScriptName,o.testFont_),!1}))}}}),o),s.ApplyCharStyleTest=(i=function t(){this.actionSequence_ApplyCharStyle=[function(){return new c.AddTextContentAction(t.initialText_)}],this.testDoc_=null,this.testPage_=null,this.testFormaID_=null,this.oldRanges_=null,this.lastChildForma_=null,A.ActionTestBase.call(this)},l.defineClass({name:"ApplyCharStyleTest",ctor:i,superName:"ActionTestBase",statics:{initialText_:"0 1 2 3 4"},props:{textForma:{get:function(){return l.first(l.opt(l.as(this.getActionResult(0),u.FormaActionResult),(function(t){return t.formae})))}},tearDown:function(){this.lastChildForma_=null,A.ActionTestBase.prototype.tearDown.call(this)},populateActionSequence:function(t,e,n){var o=this;return h.CorePromise.resolve(t.concat([function(){return o.oldRanges_=l.clone(l.opt(l.as(l.opt(o.textForma,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges}))||[]),l.opt(l.opt(o.testDoc_,(function(t){return t.controller})),(function(t){return t.selection.replaceSelection(o.textForma)})),o.textForma.visit(d.FormaTraversal.PreOrder,(function(t,e,n){var i;return(i=l.as(t,p.TextForma))&&(o.lastChildForma_=i),!1})),new f.EnterCharStyleModeAction(o.textForma)},function(){return new f.ApplyCharStyleAction(o.lastChildForma_,C.TypeLockupController.HIGHLIGHT_STYLE,C.CharStyleApplyMode.Apply,new S.TextRange(0,0))},function(){return new f.ExitCharStyleModeAction(o.textForma)}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.testPage_=n.firstPage},validateAfterActionSequence:function(t,e){var n=this;this.testFormaID_=l.opt(this.textForma,(function(t){return t.formaID})),XCTAssertNotNil(this.testDoc_),XCTAssertNotNil(this.testPage_),XCTAssertNotNil(this.testFormaID_);var o,i=l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)}));XCTAssertTrue(i===this.textForma),XCTAssertEqual(l.opt(l.opt(i,(function(t){return t.controller})),(function(t){return t.kind})),C.TypeLockupController.KIND),XCTAssertNotNil(l.clone(l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges})))),(o=l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges})))&&(XCTAssertEqual(l.last(o).start,this.lastChildForma_.rangeInLockup.start),XCTAssertEqual(l.last(o).end,this.lastChildForma_.rangeInLockup.end))},validateAfterUndo:function(t,e){var n=this;XCTAssertEqual(l.clone(l.opt(l.as(l.opt(this.textForma,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges}))),l.clone(this.oldRanges_)),XCTAssertNil(l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)})))},validateAfterRedo:function(t,e){var n,o=this,i=l.opt(this.testPage_,(function(t){return t.formaByID(o.testFormaID_)}));XCTAssertNotNil(i),XCTAssertEqual(l.opt(l.opt(i,(function(t){return t.controller})),(function(t){return t.kind})),C.TypeLockupController.KIND),XCTAssertNotNil(l.clone(l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges})))),(n=l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges})))&&(XCTAssertEqual(l.last(n).start,this.lastChildForma_.rangeInLockup.start),XCTAssertEqual(l.last(n).end,this.lastChildForma_.rangeInLockup.end))}}}),i),s.ApplyCharStyleWithoutUITest=(r=function t(){this.actionSequence_ApplyCharStyle=[function(){return new c.AddTextContentAction(t.initialText_)}],this.testDoc_=null,this.testPage_=null,this.testFormaID_=null,this.oldRanges_=null,this.lastChildForma_=null,A.ActionTestBase.call(this)},l.defineClass({name:"ApplyCharStyleWithoutUITest",ctor:r,superName:"ActionTestBase",statics:{initialText_:"0 1 2 3 4"},props:{textForma:{get:function(){return l.first(l.opt(l.as(this.getActionResult(0),u.FormaActionResult),(function(t){return t.formae})))}},tearDown:function(){this.lastChildForma_=null,A.ActionTestBase.prototype.tearDown.call(this)},populateActionSequence:function(t,e,n){var o=this;return h.CorePromise.resolve(t.concat([function(){return o.oldRanges_=l.clone(l.opt(l.as(l.opt(o.textForma,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges}))||[]),l.opt(l.opt(o.testDoc_,(function(t){return t.controller})),(function(t){return t.selection.replaceSelection(o.textForma)})),o.textForma.visit(d.FormaTraversal.PreOrder,(function(t,e,n){var i;return(i=l.as(t,p.TextForma))&&(o.lastChildForma_=i),!1})),new f.ApplyCharStyleWithoutUIAction(o.lastChildForma_,C.TypeLockupController.HIGHLIGHT_STYLE,C.CharStyleApplyMode.Apply,new S.TextRange(0,0))}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.testPage_=n.firstPage},validateAfterActionSequence:function(t,e){var n=this;this.testFormaID_=l.opt(this.textForma,(function(t){return t.formaID})),XCTAssertNotNil(this.testDoc_),XCTAssertNotNil(this.testPage_),XCTAssertNotNil(this.testFormaID_);var o,i=l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)}));XCTAssertTrue(i===this.textForma),XCTAssertEqual(l.opt(l.opt(i,(function(t){return t.controller})),(function(t){return t.kind})),C.TypeLockupController.KIND),XCTAssertNotNil(l.clone(l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges})))),(o=l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges})))&&(XCTAssertEqual(l.last(o).start,this.lastChildForma_.rangeInLockup.start),XCTAssertEqual(l.last(o).end,this.lastChildForma_.rangeInLockup.end))},validateAfterUndo:function(t,e){var n=this;XCTAssertEqual(l.clone(l.opt(l.as(l.opt(this.textForma,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges}))),l.clone(this.oldRanges_)),XCTAssertNil(l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)})))},validateAfterRedo:function(t,e){var n,o=this,i=l.opt(this.testPage_,(function(t){return t.formaByID(o.testFormaID_)}));XCTAssertNotNil(i),XCTAssertEqual(l.opt(l.opt(i,(function(t){return t.controller})),(function(t){return t.kind})),C.TypeLockupController.KIND),XCTAssertNotNil(l.clone(l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges})))),(n=l.opt(l.as(l.opt(i,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.charStyleRanges})))&&(XCTAssertEqual(l.last(n).start,this.lastChildForma_.rangeInLockup.start),XCTAssertEqual(l.last(n).end,this.lastChildForma_.rangeInLockup.end))}}}),r),s.UpdateCharStyleRangeTest=(a=function t(){this.actionSequence_UpdateCharStyleRange=[function(){return new c.AddTextContentAction(t.initialText_)}],this.testDoc_=null,this.testPage_=null,this.testFormaID_=null,this.lockupFont_=null,A.ActionTestBase.call(this)},l.defineClass({name:"UpdateCharStyleRangeTest",ctor:a,superName:"ActionTestBase",statics:{initialText_:"1 2 3 4 5",newText_:"one two three four five",testFont_:"Bellfort",getTheoFont:function(t){var e=g.TheoFont.init_9e5c(_.Host.fontProvider.getIncludedFonts(m.ANY_DOCUMENT).find((function(e){return e.postScriptName==t})));return XCTAssertEqual(e.fontData.postScriptName,t),e}},props:{textForma:{get:function(){return l.first(l.opt(l.as(this.getActionResult(0),u.FormaActionResult),(function(t){return t.formae})))}},populateActionSequence:function(t,e,n){var o=this;return h.CorePromise.resolve(t.concat([function(){return o.lockupFont_=l.opt(l.opt(l.opt(l.as(l.opt(o.textForma,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.lockupStyle})),(function(t){return t.font})),(function(t){return t.fontData.postScriptName})),l.opt(l.opt(o.testDoc_,(function(t){return t.controller})),(function(t){return t.selection.replaceSelection(o.textForma)})),new f.EnterCharStyleModeAction(o.textForma)},function(){return new f.SetTextAction(a.newText_,o.textForma,[new S.TextRange(0,4)],T.ReplaceTextStrategy.PreventOverlap)},function(){return new f.SetFontAction(a.getTheoFont(a.testFont_))},function(){return new f.ExitCharStyleModeAction(o.textForma)}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.testPage_=n.firstPage},validateAfterActionSequence:function(t,e){var n=this;this.testFormaID_=l.opt(this.textForma,(function(t){return t.formaID})),XCTAssertNotNil(this.testDoc_),XCTAssertNotNil(this.testPage_),XCTAssertNotNil(this.testFormaID_);var o=l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)}));XCTAssertTrue(o===this.textForma),XCTAssertEqual(l.opt(l.opt(o,(function(t){return t.controller})),(function(t){return t.kind})),C.TypeLockupController.KIND),XCTAssertEqual(l.opt(l.opt(l.opt(l.as(l.opt(o,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.lockupStyle})),(function(t){return t.font})),(function(t){return t.fontData.postScriptName})),this.lockupFont_),o.visit(d.FormaTraversal.PreOrder,(function(t,e,o){var i;return(i=l.as(t,p.TextForma))&&(0==i.rangeInLockup.start?XCTAssertEqual(i.fontDescriptor.postScriptName,a.testFont_):XCTAssertEqual(i.fontDescriptor.postScriptName,n.lockupFont_)),!1}))},validateAfterUndo:function(t,e){var n=this;XCTAssertEqual(l.opt(l.opt(l.opt(l.as(l.opt(this.textForma,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.lockupStyle})),(function(t){return t.font})),(function(t){return t.fontData.postScriptName})),this.lockupFont_),XCTAssertNil(l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)})))},validateAfterRedo:function(t,e){var n=this,o=l.opt(this.testPage_,(function(t){return t.formaByID(n.testFormaID_)}));XCTAssertNotNil(o),XCTAssertEqual(l.opt(l.opt(o,(function(t){return t.controller})),(function(t){return t.kind})),C.TypeLockupController.KIND),XCTAssertEqual(l.opt(l.opt(l.opt(l.as(l.opt(o,(function(t){return t.controller})),C.TypeLockupController),(function(t){return t.lockupStyle})),(function(t){return t.font})),(function(t){return t.fontData.postScriptName})),this.lockupFont_),o.visit(d.FormaTraversal.PreOrder,(function(t,e,o){var i;return(i=l.as(t,p.TextForma))&&(0==i.rangeInLockup.start?XCTAssertEqual(i.fontDescriptor.postScriptName,a.testFont_):XCTAssertEqual(i.fontDescriptor.postScriptName,n.lockupFont_)),!1}))}}}),a)},wYGt:function(t,e,n){var o,i,r,a,s,l,u,c,A,h,d,_,m=e,f=n("oAGj"),p=n("Tq01"),T=n("wpCo"),g=n("4mEG"),C=n("c9Jm"),S=n("CWW7"),E=n("yGNn"),F=n("jo4Y"),v=n("FNB+"),R=n("pnSN"),D=n("iCxV"),L=n("xWmh"),y=n("bqbo"),k=n("fdtz"),N=n("lmwz"),I=n("c+uM"),B=n("VkKB"),P=n("djAF"),O=n("cRpU"),q=n("Vm85"),x=n("8t9B"),M=n("RkYL"),X=n("LGJg"),U=n("zjod");m.AddTextTest=(o=function(){this.actionSequence_AddText=[function(){return new g.AddTextContentAction("Dog")}],this.text_="Dog",this.rootForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"AddTextTest",ctor:o,superName:"ActionTestBase",props:{hasText:function(){var t=this,e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,R.GroupForma))&&(i=f.as(o.controller,x.TypeLockupController))&&i.text==t.text_&&(e=!0)}))})),e},setUpActionSequence:function(t,e,n){this.rootForma_=n.firstPage.root},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasText())},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasText())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasText())}}}),o),m.AddTextOverImageBackgroundTest=(i=function(){this.text_="Lorem ipsum dolor set",this.actionSequence_AddText=[function(){return new g.AddTextContentAction("Lorem ipsum dolor set")}],this.rootForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"AddTextOverImageBackgroundTest",ctor:i,superName:"ActionTestBase",props:{canRunActionSequence:function(t,e,n){return f.clone(n.firstPage.root.filterWithCallback((function(t){return N.ImageFacade.isPotentialBackgroundImage(t)}))).length>0},hasText:function(){var t=this,e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,R.GroupForma))&&(i=f.as(o.controller,x.TypeLockupController))&&i.text==t.text_&&(e=!0)}))})),e},prepareDocument:function(t,e){this.rootForma_=t.firstPage.root;var n=f.clone(t.firstPage.root.filterWithCallback((function(t){return N.ImageFacade.isPotentialBackgroundImage(t)})));XCTAssertTrue(n.length>0);var o=function(){var e=f.clone(t.firstPage.root.filterWithCallback((function(t){return null!=t.controller&&t.controller.floating})));return new F.DeleteAction(f.clone(e),!0)};if(n.length>0){var i=n.shift(),r=function(){return f.opt(t.controller,(function(t){return t.selection.replaceSelection(i)})),new y.SetImageAsBackgroundAction};return n.length>0?E.CorePromise.resolve([function(){return new F.DeleteAction(f.clone(n),!0)},r,o]):E.CorePromise.resolve([r,o])}return E.CorePromise.resolve([o])},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasText())},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasText())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasText())}}}),i),m.ReplaceTextTest=(r=function(){this.actionSequence_ReplaceText=[],this.initialText_="Initial...",this.finalText_="Final!",this.rootForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"ReplaceTextTest",ctor:r,superName:"ActionTestBase",props:{textForma:{get:function(){return f.first(f.opt(f.as(this.getActionResult(0),p.FormaActionResult),(function(t){return t.formae})))}},hasInitialText:function(){var t=this,e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,R.GroupForma))&&(i=f.as(o.controller,x.TypeLockupController))&&i.text==t.initialText_&&(e=!0)}))})),e},hasFinalText:function(){var t=this,e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,R.GroupForma))&&(i=f.as(o.controller,x.TypeLockupController))&&i.text==t.finalText_&&(e=!0)}))})),e},populateActionSequence:function(t,e,n){var o=this;return E.CorePromise.resolve(t.concat([function(){return new g.AddTextContentAction(o.initialText_)},function(){return new O.SetTextAction(o.finalText_,o.textForma)}]))},setUpActionSequence:function(t,e,n){this.rootForma_=n.firstPage.root},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasFinalText()),XCTAssertFalse(this.hasInitialText())},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasFinalText()),XCTAssertFalse(this.hasInitialText())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasFinalText()),XCTAssertFalse(this.hasInitialText())}}}),r),m.ReplaceTextTestStrategies=(a=function(){this.actionSequence_ReplaceAuto=[],this.actionSequence_ReplacePreventOverlap=[],this.actionSequence_ReplacePreserveWidth=[],this.actionSequence_ReplaceBalanced=[],C.ActionTestBase.call(this)},f.defineClass({name:"ReplaceTextTestStrategies",ctor:a,superName:"ActionTestBase",statics:{suffixText_:" more words.\n And then some."},props:{tearDown:function(){this.lockupForma_=null,C.ActionTestBase.prototype.tearDown.call(this)},canRunActionSequence:function(t,e,n){var o;return this.lockupForma_=this.findLargestForma(f.clone(this.allSelectableFormae(n,(function(t){return f.opt(t.controller,(function(t){return t.kind==x.TypeLockupController.KIND}))})))),null!=this.lockupForma_&&!("actionSequence_ReplaceBalanced"==e&&((o=f.opt(f.opt(this.lockupForma_,(function(t){return t.controller})),(function(t){return t.userGroupChild})))||null!=o)&&o)},prepareDocument:function(t,e){var n=this,o=[];return"actionSequence_ReplaceBalanced"==e&&q.TextFacade.getLayoutForForma(this.lockupForma_)!=I.LockupLayout.Standard&&o.push((function(){return f.opt(t.controller,(function(t){return t.selection.replaceSelection(n.lockupForma_)})),new O.ChangeTextLayoutAndAlignmentAction(I.LockupLayout.Standard,I.LockupAlignment.Center)})),E.CorePromise.resolve(f.clone(o))},populateActionSequence:function(t,e,n){var o=this;return E.CorePromise.resolve(t.concat([function(){var t,i=o.lockupForma_.controller.text+a.suffixText_;switch(e){case"actionSequence_ReplaceAuto":t=q.ReplaceTextStrategy.Auto;break;case"actionSequence_ReplacePreventOverlap":t=q.ReplaceTextStrategy.PreventOverlap;break;case"actionSequence_ReplacePreserveWidth":t=q.ReplaceTextStrategy.PreserveWidth;break;case"actionSequence_ReplaceBalanced":t=q.ReplaceTextStrategy.Balanced;break;default:t=q.ReplaceTextStrategy.Auto}return f.opt(n.controller,(function(t){return t.selection.replaceSelection(o.lockupForma_)})),new O.SetTextAction(i,o.lockupForma_,void 0,t)}]))}}}),a),m.AddImageTest=(s=function(){this.actionSequence_AddImage=[],this.imageURL_="",this.imageMimeType_="",this.imageWidth_=0,this.imageHeight_=0,this.rootForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"AddImageTest",ctor:s,superName:"ActionTestBase",props:{hasImage:function(){var t=this,e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,k.ImageForma))&&(i=o.contentNode)&&i.url==t.imageURL_&&i.mimeType==t.imageMimeType_&&i.pixelWidth==t.imageWidth_&&i.pixelHeight==t.imageHeight_&&(e=!0)}))})),e},populateActionSequence:function(t,e,n){var o=this,i=n.firstPage;return this.imageDataForAsset("dog1.jpeg").then((function(t){var e;if(e=f.as(t,L.ActionTestImageData)){var n=new S.AddFormaParams(p.ControllerSettingsBehaviorEnum.SetControllerSettings);return o.imageURL_=e.url,o.imageMimeType_="image/jpeg",o.imageWidth_=e.width,o.imageHeight_=e.height,E.CorePromise.resolve([function(){return new g.AddImageContentAction(i,o.imageURL_,o.imageMimeType_,o.imageWidth_,o.imageHeight_,!1,B.MediaMetadata.init_5f01(),null,null,n)}])}return XCTFail("Could not get image data for AddImageTest"),E.CorePromise.resolve([])}))},setUpActionSequence:function(t,e,n){this.rootForma_=n.firstPage.root},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasImage())},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasImage())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasImage())}}}),s),m.ReplaceImageTest=(l=function(){this.originalImageURL_="",this.originalImageMimeType_="",this.originalImageWidth_=0,this.originalImageHeight_=0,this.replacementImageURL_="",this.replacementImageMimeType_="",this.replacementImageWidth_=0,this.replacementImageHeight_=0,this.rootForma_=null,this.testPage_=null,this.actionSequence_ReplaceImage=[],C.ActionTestBase.call(this)},f.defineClass({name:"ReplaceImageTest",ctor:l,superName:"ActionTestBase",props:{imageForma:{get:function(){return f.first(f.opt(f.as(this.getActionResult(0),p.FormaActionResult),(function(t){return t.formae})))}},hasImage:function(){var t=this,e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,k.ImageForma))&&(i=o.contentNode)&&(XCTAssertNotEqual(t.originalImageURL_,i.url),i.url==t.replacementImageURL_&&i.mimeType==t.replacementImageMimeType_&&i.pixelWidth==t.replacementImageWidth_&&i.pixelHeight==t.replacementImageHeight_&&(e=!0))}))})),e},populateActionSequence:function(t,e,n){var o,i=this,r=n.firstPage;return this.imageDataForAsset("dog1.jpeg").then((function(e){var n;return(n=f.as(e,L.ActionTestImageData))?(i.originalImageURL_=n.url,i.originalImageMimeType_="image/jpeg",i.originalImageWidth_=n.width,i.originalImageHeight_=n.height,i.imageDataForAsset("bird_in_snow.jpg").then((function(e){var n;return(n=f.as(e,L.ActionTestImageData))?(i.replacementImageURL_=n.url,i.replacementImageMimeType_="image/jpeg",i.replacementImageWidth_=n.width,i.replacementImageHeight_=n.height,E.CorePromise.resolve(t.concat([function(){var t=new S.AddFormaParams(p.ControllerSettingsBehaviorEnum.SetControllerSettings);return new g.AddImageContentAction(r,i.originalImageURL_,i.originalImageMimeType_,i.originalImageWidth_,i.originalImageHeight_,!1,B.MediaMetadata.init_5f01(),null,null,t)},function(){XCTAssertTrue(!(!(o=f.opt(f.opt(i.imageForma,(function(t){return t.controller})),(function(t){return t.replaceable})))&&null==o)&&o);var t=new S.AddFormaParams(p.ControllerSettingsBehaviorEnum.SetControllerSettings,!1,i.imageForma);return new g.AddImageContentAction(r,i.replacementImageURL_,i.replacementImageMimeType_,i.replacementImageWidth_,i.replacementImageHeight_,!1,B.MediaMetadata.init_5f01(),null,null,t)}]))):(XCTFail("Could not get image data for second image in ReplaceImageTest"),E.CorePromise.resolve([]))}))):(XCTFail("Could not get image data for first image in ReplaceImageTest"),E.CorePromise.resolve([]))}))},setUpActionSequence:function(t,e,n){this.rootForma_=n.firstPage.root,this.testPage_=n.firstPage},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasImage())},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasImage())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasImage())}}}),l),m.AddIconTest=(u=function(){this.actionSequence_AddIcon=[],this.iconURL_="",this.rootForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"AddIconTest",ctor:u,superName:"ActionTestBase",props:{hasIcon:function(){var t=this,e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,P.ShapeForma))&&(i=f.as(o.contentNode,X.VectorContentNode))&&i.url==t.iconURL_&&(e=!0)}))})),e},populateActionSequence:function(t,e,n){var o,i=this;return null!=(o=this.urlForAsset("dog1.svg"))?(this.iconURL_=o,E.CorePromise.resolve([function(){return new g.AddIconContentAction(i.iconURL_,B.MediaMetadata.init_5f01(),null)}])):(XCTFail("Could not get Icon URL for AddIconTest"),E.CorePromise.resolve([]))},setUpActionSequence:function(t,e,n){this.rootForma_=n.firstPage.root},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasIcon())},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasIcon())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasIcon())}}}),u),m.ReplaceIconTest=(c=function(){this.actionSequence_ReplaceIcon=[],this.rootForma_=null,this.iconForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"ReplaceIconTest",ctor:c,superName:"ActionTestBase",statics:{originalIconURL_:"",replacementIconURL_:""},props:{hasIcon:function(){var t=!1;return f.opt(this.rootForma_,(function(e){return e.visitAll(v.FormaTraversal.PreOrder,(function(e){var n,o;(n=f.as(e,P.ShapeForma))&&(o=f.as(n.contentNode,X.VectorContentNode))&&o.url==c.replacementIconURL_&&(t=!0)}))})),t},populateActionSequence:function(t,e,n){var o,i=this;return E.CorePromise.resolve(t.concat([function(){return XCTAssertTrue(!(!(o=f.opt(f.opt(i.iconForma_,(function(t){return t.controller})),(function(t){return t.replaceable})))&&null==o)&&o),new g.AddIconContentAction(c.replacementIconURL_,B.MediaMetadata.init_5f01(),i.iconForma_)}]))},prepareDocument:function(t,e){var n,o;return this.rootForma_=t.firstPage.root,null!=(n=this.urlForAsset("dog1.svg"))&&null!=(o=this.urlForAsset("fork_and_spoon.svg"))&&(c.originalIconURL_=n,c.replacementIconURL_=o,XCTAssertNotEqual(c.originalIconURL_,c.replacementIconURL_)),E.CorePromise.resolve([function(){return new g.AddIconContentAction(c.originalIconURL_,B.MediaMetadata.init_5f01(),null)}])},setUpActionSequence:function(t,e,n){this.iconForma_=f.first(f.opt(f.as(this.lastActionResult,p.FormaActionResult),(function(t){return t.formae})))},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasIcon())},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasIcon())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasIcon())}}}),c),m.AddVideoTest=(A=function(){this.actionSequence_AddVideo=[],this.videoURL_="",this.trackWidth_=0,this.trackHeight_=0,this.duration_=M.TheoTime.Zero,this.times_=[],this.posterURL_=null,this.posterWidth_=0,this.posterHeight_=0,this.posterParams_=null,this.rootForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"AddVideoTest",ctor:A,superName:"ActionTestBase",props:{hasVideo:function(){var t=this,e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,U.VideoForma))&&(i=o.videoContentNode)&&i.url==t.videoURL_&&(e=!0)}))})),e},populateActionSequence:function(t,e,n){var o,i=this,r=n.firstPage;if(null!=(o=this.urlForAsset("spokes.gif"))){this.videoURL_=o,this.posterURL_=o;var a=this.posterURL_.split(".");a.length>0&&(a.pop(),this.posterURL_=a.join(".")+".png"),this.trackWidth_=480,this.trackHeight_=480,this.posterWidth_=480,this.posterHeight_=480;for(var s,l=7,u=f.iter(f.range(1,34,!0));!u.done;u.next())this.times_.push(new M.TheoTime(l,100)),l+=7;return this.duration_=new M.TheoTime(l,100),null!=(s=this.posterURL_)&&(this.posterParams_=new g.VideoPosterParams(s,"image/jpeg",this.posterWidth_,this.posterHeight_)),E.CorePromise.resolve([function(){return new g.AddVideoContentAction(r,i.videoURL_,"image/gif",i.trackWidth_,i.trackHeight_,i.duration_,f.clone(i.times_),i.posterParams_,!1,B.MediaMetadata.init_5f01(),null,null,null,S.AddFormaParams.DEFAULTS)}])}return XCTFail("Could not get Video URL for AddVideoTest"),E.CorePromise.resolve([])},setUpActionSequence:function(t,e,n){this.rootForma_=n.firstPage.root},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasVideo())},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasVideo())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasVideo())}}}),A),m.AddLogoTest=(h=function(){this.actionSequence_AddLogo=[],this.primaryLogoID_="",this.rootForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"AddLogoTest",ctor:h,superName:"ActionTestBase",props:{hasLogo:function(){var t=!1;return f.opt(this.rootForma_,(function(e){return e.visitAll(v.FormaTraversal.PreOrder,(function(e){var n;(n=f.as(e,k.ImageForma))&&n.contentNode&&n.isLogo()&&(t=!0)}))})),t},hasLogoWithID:function(t){var e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,k.ImageForma))&&(i=o.contentNode)&&i.sparkElementID==t&&o.isLogo()&&(e=!0)}))})),e},populateActionSequence:function(t,e,n){var o=this;return this.installBrandkit(n),E.CorePromise.resolve(t.concat([function(){var t=D.Host.brandkitManager.fakeBrandkitForElementsForTesting.logos[0];return o.primaryLogoID_=t.id,new g.AddLogoContentAction(n.firstPage,t,null,null)}]))},setUpActionSequence:function(t,e,n){this.rootForma_=n.firstPage.root},validateAfterActionSequence:function(t,e){XCTAssertTrue(this.hasLogoWithID(this.primaryLogoID_))},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasLogo())},validateAfterRedo:function(t,e){XCTAssertTrue(this.hasLogoWithID(this.primaryLogoID_))},shutdown:function(t,e,n){C.ActionTestBase.prototype.shutdown.call(this,f.clone(t),e,n),this.removeBrandkit(n)}}}),h),m.ReplaceLogoTest=(d=function(){this.actionSequence_ReplaceLogo=[],this.primaryLogoID_="",this.secondaryLogoID_="",this.rootForma_=null,C.ActionTestBase.call(this)},f.defineClass({name:"ReplaceLogoTest",ctor:d,superName:"ActionTestBase",props:{logoForma:{get:function(){return f.first(f.opt(f.as(this.getActionResult(0),p.FormaActionResult),(function(t){return t.formae})))}},hasLogo:function(){var t=!1;return f.opt(this.rootForma_,(function(e){return e.visitAll(v.FormaTraversal.PreOrder,(function(e){var n;(n=f.as(e,k.ImageForma))&&n.contentNode&&n.isLogo()&&(t=!0)}))})),t},hasLogoWithID:function(t){var e=!1;return f.opt(this.rootForma_,(function(n){return n.visitAll(v.FormaTraversal.PreOrder,(function(n){var o,i;(o=f.as(n,k.ImageForma))&&(i=o.contentNode)&&i.sparkElementID==t&&o.isLogo()&&(e=!0)}))})),e},populateActionSequence:function(t,e,n){var o=this;return this.installBrandkit(n),E.CorePromise.resolve(t.concat([function(){var t=D.Host.brandkitManager.fakeBrandkitForElementsForTesting.logos[0];o.primaryLogoID_=t.id;var e=D.Host.brandkitManager.fakeBrandkitForElementsForTesting.logos[1];return o.secondaryLogoID_=e.id,new g.AddLogoContentAction(n.firstPage,t,null,null)},function(){var t=D.Host.brandkitManager.fakeBrandkitForElementsForTesting.logos[1];return new g.AddLogoContentAction(n.firstPage,t,o.logoForma,null)}]))},setUpActionSequence:function(t,e,n){this.rootForma_=n.firstPage.root},validateAfterActionSequence:function(t,e){XCTAssertFalse(this.hasLogoWithID(this.primaryLogoID_)),XCTAssertTrue(this.hasLogoWithID(this.secondaryLogoID_))},validateAfterUndo:function(t,e){XCTAssertFalse(this.hasLogo())},validateAfterRedo:function(t,e){XCTAssertFalse(this.hasLogoWithID(this.primaryLogoID_)),XCTAssertTrue(this.hasLogoWithID(this.secondaryLogoID_))},shutdown:function(t,e,n){C.ActionTestBase.prototype.shutdown.call(this,f.clone(t),e,n),this.removeBrandkit(n)}}}),d),m.AddBadgeTest=(_=function(){this.actionSequence_AddAtomicBadgeTest=[],this.actionSequence_AddGroupedBadgeTest=[],this.atomicBadgeDocPromise_=null,this.groupedBadgeDocPromise_=null,this.numLockups_=0,this.numGroups_=0,this.doc_=null,C.ActionTestBase.call(this)},f.defineClass({name:"AddBadgeTest",ctor:_,superName:"ActionTestBase",props:{canRunActionSequence:function(t,e,n){return"actionSequence_AddAtomicBadgeTest"==e?(this.atomicBadgeDocPromise_=D.Host.actionTesting.badgeDocument(!1),null!=this.atomicBadgeDocPromise_):(this.groupedBadgeDocPromise_=D.Host.actionTesting.badgeDocument(!0),null!=this.groupedBadgeDocPromise_)},populateActionSequence:function(t,e,n){return("actionSequence_AddAtomicBadgeTest"==e?this.atomicBadgeDocPromise_:this.groupedBadgeDocPromise_).then((function(t){return[function(){return new T.AddBadgeAction(t,"automation")}]}))},countLockupsAndGroups:function(t){var e=0,n=0;return t.firstPage.root.visitAll(v.FormaTraversal.PreOrder,(function(t){t.isTypeLockup()?e+=1:f.opt(t.controller,(function(t){return 1==t.userGroup}))&&(n+=1)})),[e,n]},setUpActionSequence:function(t,e,n){var o=this.countLockupsAndGroups(n);this.numLockups_=o[0],this.numGroups_=o[1],this.doc_=n},validateAfterActionSequence:function(t,e){var n=this.countLockupsAndGroups(this.doc_);"actionSequence_AddAtomicBadgeTest"==e?XCTAssertEqual(n[0],this.numLockups_+1):XCTAssertEqual(n[1],this.numGroups_+1)},validateAfterUndo:function(t,e){var n=this.countLockupsAndGroups(this.doc_);XCTAssertEqual(n[0],this.numLockups_),XCTAssertEqual(n[1],this.numGroups_)},validateAfterRedo:function(t,e){var n=this.countLockupsAndGroups(this.doc_);"actionSequence_AddAtomicBadgeTest"==e?XCTAssertEqual(n[0],this.numLockups_+1):XCTAssertEqual(n[1],this.numGroups_+1)}}}),_)},zIaq:function(t,e,n){var o,i,r,a,s,l,u=e,c=n("oAGj"),A=n("c9Jm"),h=n("hJqd"),d=n("kYI4"),_=n("yGNn"),m=n("ascj"),f=n("iCxV"),p=n("DP9v"),T=n("Vm85");u.BrandifyTest=(o=function(){this.actionSequence_Brandify=[],this.testDoc_=null,this.page_=null,this.initialRootColor_=null,this.docHasText_=!1,A.ActionTestBase.call(this)},c.defineClass({name:"BrandifyTest",ctor:o,superName:"ActionTestBase",props:{hasText:function(t){for(var e=!1,n=c.iter(t.firstPage.root.filterWithCallback((function(t){return t.isTypeLockup()})));!n.done;n.next()){e=!0;break}return e},allTextBranded:function(t){for(var e,n=!0,o=c.iter(t.firstPage.root.filterWithCallback((function(t){return t.isTypeLockup()})));!o.done;o.next()){var i=o.value,r=T.TextFacade.getFontForForma(i);if(!(e=c.isEmpty(c.opt(r,(function(t){return t.getSparkFontRole()}))))&&null==e||e){n=!1;break}}return n},verifyColors:function(){var t=this.page_.root.style.colors.color(m.ColorRole.FieldPrimary);XCTAssertTrue(null!=t);for(var e=0,n=0,o=0,i=c.clone(this.page_.colorLibraryController.getTheoColorsUsedInDocument()),r=c.iter(i);!r.done;r.next()){var a=r.value;a.isBrandkitPrimaryColor()&&(e+=1),a.isBrandkitSecondaryColor()&&(n+=1),a.isBrandkitShade()&&(o+=1)}XCTAssertEqual(e,0),XCTAssertEqual(n,0),XCTAssertTrue(i.length>0),XCTAssertTrue(o>0);var s=c.clone(d.BrandingFacade.getDocumentBrandedElementsUsage(this.testDoc_,!1,!0));XCTAssertTrue(s.includes("color"))},populateActionSequence:function(t,e,n){var o=this;return this.docHasText_=this.hasText(n),this.installBrandkit(n),_.CorePromise.resolve(t.concat([function(){return new h.BrandifyAction(f.Host.brandkitManager.fakeBrandkitForElementsForTesting,o.docHasText_,!0,!0)}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.page_=n.firstPage,this.initialRootColor_=this.page_.root.style.colors.color(m.ColorRole.FieldPrimary)},validateAfterActionSequence:function(t,e){XCTAssertTrue(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_STAMP_ID])),XCTAssertFalse(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID])),this.docHasText_?(XCTAssertTrue(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID])),XCTAssertTrue(this.allTextBranded(this.testDoc_))):XCTAssertFalse(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID])),this.verifyColors()},validateAfterUndo:function(t,e){XCTAssertFalse(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID,this.FAKE_LOGO_ELEMENT_STAMP_ID])),XCTAssertFalse(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID,this.FAKE_FONT_ELEMENT_BODY_ID]))},validateAfterRedo:function(t,e){XCTAssertTrue(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_STAMP_ID])),XCTAssertFalse(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID])),this.docHasText_?(XCTAssertTrue(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID])),XCTAssertTrue(this.allTextBranded(this.testDoc_))):XCTAssertFalse(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID])),this.verifyColors()},shutdown:function(t,e,n){A.ActionTestBase.prototype.shutdown.call(this,c.clone(t),e,n),this.removeBrandkit(n)}}}),o),u.AddBrandTest=(i=function(){this.actionSequence_AddBrand=[],this.testDoc_=null,this.page_=null,this.initialRootColor_=null,this.docHasText_=!1,this.addedBrandName="",this.addedBrandURN="",A.ActionTestBase.call(this)},c.defineClass({name:"AddBrandTest",ctor:i,superName:"ActionTestBase",props:{hasText:function(t){for(var e=!1,n=c.iter(t.firstPage.root.filterWithCallback((function(t){return t.isTypeLockup()})));!n.done;n.next()){e=!0;break}return e},allTextBranded:function(t){for(var e,n=!0,o=c.iter(t.firstPage.root.filterWithCallback((function(t){return t.isTypeLockup()})));!o.done;o.next()){var i=o.value,r=T.TextFacade.getFontForForma(i);if(!(e=c.isEmpty(c.opt(r,(function(t){return t.getSparkFontRole()}))))&&null==e||e){n=!1;break}}return n},verifyColors:function(){var t=this.page_.root.style.colors.color(m.ColorRole.FieldPrimary);XCTAssertTrue(null!=t),XCTAssertFalse(t.isEqual(this.initialRootColor_));for(var e=0,n=0,o=0,i=c.clone(this.page_.colorLibraryController.getTheoColorsUsedInDocument()),r=c.iter(i);!r.done;r.next()){var a=r.value;a.isBrandkitPrimaryColor()&&(e+=1),a.isBrandkitSecondaryColor()&&(n+=1),a.isBrandkitShade()&&(o+=1)}XCTAssertEqual(e,0),XCTAssertEqual(n,0),XCTAssertTrue(i.length>0),XCTAssertTrue(o>0);var s=c.clone(d.BrandingFacade.getDocumentBrandedElementsUsage(this.testDoc_,!1,!0));XCTAssertTrue(s.includes("color"))},populateActionSequence:function(t,e,n){var o=this;return this.docHasText_=this.hasText(n),this.installBrandkit(n),_.CorePromise.resolve(t.concat([function(){return new h.BrandifyAction(f.Host.brandkitManager.fakeBrandkitForElementsForTesting,o.docHasText_,!0,!0)},function(){return o.installSecondBrandkit(o.testDoc_),o.addedBrandName=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.name,o.addedBrandURN=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.urn,new h.AddBrandingAction(f.Host.brandkitManager.fakeBrandkitForElementsForTesting)}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.page_=n.firstPage,this.initialRootColor_=this.page_.root.style.colors.color(m.ColorRole.FieldPrimary)},validateAfterActionSequence:function(t,e){XCTAssertTrue(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID_2])),this.docHasText_?(XCTAssertTrue(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID_2])),XCTAssertTrue(this.allTextBranded(this.testDoc_))):XCTAssertFalse(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID_2])),XCTAssertTrue(this.testDoc_.authoringContextName==this.addedBrandName),XCTAssertTrue(this.testDoc_.authoringContextURN==this.addedBrandURN),this.verifyColors()},validateAfterUndo:function(t,e){XCTAssertFalse(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID,this.FAKE_LOGO_ELEMENT_STAMP_ID])),XCTAssertFalse(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID,this.FAKE_FONT_ELEMENT_BODY_ID])),XCTAssertTrue(""==this.testDoc_.authoringContextName),XCTAssertTrue(""==this.testDoc_.authoringContextURN)},validateAfterRedo:function(t,e){XCTAssertTrue(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID_2])),this.docHasText_?(XCTAssertTrue(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID_2])),XCTAssertTrue(this.allTextBranded(this.testDoc_))):XCTAssertFalse(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID_2])),XCTAssertTrue(this.testDoc_.authoringContextName==this.addedBrandName),XCTAssertTrue(this.testDoc_.authoringContextURN==this.addedBrandURN),this.verifyColors()},shutdown:function(t,e,n){A.ActionTestBase.prototype.shutdown.call(this,c.clone(t),e,n),this.removeBrandkit(n)}}}),i),u.RemoveBrandingTest=(r=function(){this.actionSequence_RemoveBranding=[],this.testDoc_=null,this.page_=null,A.ActionTestBase.call(this)},c.defineClass({name:"RemoveBrandingTest",ctor:r,superName:"ActionTestBase",props:{verifyColors:function(t){for(var e=0,n=0,o=0,i=c.clone(this.page_.colorLibraryController.getTheoColorsUsedInDocument()),r=c.iter(i);!r.done;r.next()){var a=r.value;a.isBrandkitPrimaryColor()&&(e+=1),a.isBrandkitSecondaryColor()&&(n+=1),a.isBrandkitShade()&&(o+=1)}if(XCTAssertEqual(e,0),XCTAssertEqual(n,0),t){var s=c.clone(d.BrandingFacade.getDocumentBrandedElementsUsage(this.testDoc_,!1,!0));XCTAssertTrue(s.includes("color"))}else XCTAssertEqual(o,0);XCTAssertTrue(i.length>0)},populateActionSequence:function(t,e,n){return this.installBrandkit(n),_.CorePromise.resolve(t.concat([function(){return new h.BrandifyAction(f.Host.brandkitManager.fakeBrandkitForElementsForTesting,!0,!0,!0)},function(){return new h.RemoveBrandingAction}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.page_=n.firstPage},validateAfterActionSequence:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(0==n),this.verifyColors(!0)},validateAfterUndo:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(0==n),this.verifyColors(!1)},validateAfterRedo:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(0==n),this.verifyColors(!0)},shutdown:function(t,e,n){A.ActionTestBase.prototype.shutdown.call(this,c.clone(t),e,n),this.removeBrandkit(n)}}}),r),u.RemoveExistingBrandingTest=(a=function(){this.actionSequence_RemoveBranding=[],this.testDoc_=null,this.page_=null,this.initialBrandName="",this.initialBrandURN="",A.ActionTestBase.call(this)},c.defineClass({name:"RemoveExistingBrandingTest",ctor:a,superName:"ActionTestBase",props:{prepareDocument:function(t,e){var n=this;return this.installBrandkit(t),_.CorePromise.resolve([function(){return n.initialBrandName=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.name,n.initialBrandURN=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.urn,new h.BrandifyAction(f.Host.brandkitManager.fakeBrandkitForElementsForTesting,!0,!0,!0)}])},populateActionSequence:function(t,e,n){return _.CorePromise.resolve(t.concat([function(){return new h.RemoveBrandingAction}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.page_=n.firstPage},validateAfterActionSequence:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(0==n),XCTAssertTrue(""==this.testDoc_.authoringContextName),XCTAssertTrue(""==this.testDoc_.authoringContextURN)},validateAfterUndo:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(1==n),XCTAssertTrue(this.testDoc_.authoringContextName==this.initialBrandName),XCTAssertTrue(this.testDoc_.authoringContextURN==this.initialBrandURN)},validateAfterRedo:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(0==n),XCTAssertTrue(""==this.testDoc_.authoringContextName),XCTAssertTrue(""==this.testDoc_.authoringContextURN)},shutdown:function(t,e,n){A.ActionTestBase.prototype.shutdown.call(this,c.clone(t),e,n),this.removeBrandkit(n)}}}),a),u.ChangeBrandingTestToNone=(s=function(){this.actionSequence_ChangeBrandingToNone=[],this.testDoc_=null,this.page_=null,A.ActionTestBase.call(this)},c.defineClass({name:"ChangeBrandingTestToNone",ctor:s,superName:"ActionTestBase",props:{verifyColors:function(t){for(var e=0,n=0,o=0,i=c.clone(this.page_.colorLibraryController.getTheoColorsUsedInDocument()),r=c.iter(i);!r.done;r.next()){var a=r.value;a.isBrandkitPrimaryColor()&&(e+=1),a.isBrandkitSecondaryColor()&&(n+=1),a.isBrandkitShade()&&(o+=1)}if(XCTAssertEqual(e,0),XCTAssertEqual(n,0),t){var s=c.clone(d.BrandingFacade.getDocumentBrandedElementsUsage(this.testDoc_,!1,!0));XCTAssertTrue(s.includes("color"))}else XCTAssertEqual(o,0);XCTAssertTrue(i.length>0)},populateActionSequence:function(t,e,n){return this.installBrandkit(n),_.CorePromise.resolve(t.concat([function(){return new h.BrandifyAction(f.Host.brandkitManager.fakeBrandkitForElementsForTesting,!0,!0,!0)},function(){return new h.ChangeBrandingAction(null,f.Host.brandkitManager.fakeBrandkitForElementsForTesting.id,p.MultiBrandFacade.activeBrandkitID)}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.page_=n.firstPage},validateAfterActionSequence:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(0==n),this.verifyColors(!0),XCTAssertTrue(null==p.MultiBrandFacade.getBrand(this.testDoc_))},validateAfterUndo:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(0==n),this.verifyColors(!1)},validateAfterRedo:function(t,e){var n=d.BrandingFacade.isDocumentBranded(this.testDoc_,!0);XCTAssertTrue(0==n),this.verifyColors(!0),XCTAssertTrue(null==p.MultiBrandFacade.getBrand(this.testDoc_))},shutdown:function(t,e,n){A.ActionTestBase.prototype.shutdown.call(this,c.clone(t),e,n),this.removeBrandkit(n)}}}),s),u.ChangeBrandingTest=(l=function(){this.actionSequence_AddBrand=[],this.testDoc_=null,this.page_=null,this.initialRootColor_=null,this.docHasText_=!1,this.initialBrandName="",this.initialBrandURN="",this.finalBrandName="",this.finalBrandURN="",A.ActionTestBase.call(this)},c.defineClass({name:"ChangeBrandingTest",ctor:l,superName:"ActionTestBase",props:{hasText:function(t){for(var e=!1,n=c.iter(t.firstPage.root.filterWithCallback((function(t){return t.isTypeLockup()})));!n.done;n.next()){e=!0;break}return e},allTextBranded:function(t){for(var e,n=!0,o=c.iter(t.firstPage.root.filterWithCallback((function(t){return t.isTypeLockup()})));!o.done;o.next()){var i=o.value,r=T.TextFacade.getFontForForma(i);if(!(e=c.isEmpty(c.opt(r,(function(t){return t.getSparkFontRole()}))))&&null==e||e){n=!1;break}}return n},verifyColors:function(){var t=this.page_.root.style.colors.color(m.ColorRole.FieldPrimary);XCTAssertTrue(null!=t),XCTAssertFalse(t.isEqual(this.initialRootColor_));for(var e=0,n=0,o=0,i=c.clone(this.page_.colorLibraryController.getTheoColorsUsedInDocument()),r=c.iter(i);!r.done;r.next()){var a=r.value;a.isBrandkitPrimaryColor()&&(e+=1),a.isBrandkitSecondaryColor()&&(n+=1),a.isBrandkitShade()&&(o+=1)}XCTAssertEqual(e,0),XCTAssertEqual(n,0),XCTAssertTrue(i.length>0),XCTAssertTrue(o>0);var s=c.clone(d.BrandingFacade.getDocumentBrandedElementsUsage(this.testDoc_,!1,!0));XCTAssertTrue(s.includes("color"))},prepareDocument:function(t,e){var n=this;return this.installBrandkit(t),_.CorePromise.resolve([function(){return n.initialBrandName=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.name,n.initialBrandURN=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.urn,new h.BrandifyAction(f.Host.brandkitManager.fakeBrandkitForElementsForTesting,!0,!0,!0)}])},populateActionSequence:function(t,e,n){var o=this;return this.docHasText_=this.hasText(n),_.CorePromise.resolve(t.concat([function(){var t=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.id;return o.installSecondBrandkit(o.testDoc_),o.finalBrandName=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.name,o.finalBrandURN=f.Host.brandkitManager.fakeBrandkitForElementsForTesting.urn,new h.ChangeBrandingAction(f.Host.brandkitManager.fakeBrandkitForElementsForTesting,t,p.MultiBrandFacade.activeBrandkitID)}]))},setUpActionSequence:function(t,e,n){this.testDoc_=n,this.page_=n.firstPage,this.initialRootColor_=this.page_.root.style.colors.color(m.ColorRole.FieldPrimary)},validateAfterActionSequence:function(t,e){XCTAssertTrue(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID_2])),this.docHasText_?XCTAssertTrue(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID_2])):XCTAssertFalse(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID_2])),XCTAssertTrue(this.testDoc_.authoringContextName==this.finalBrandName),XCTAssertTrue(this.testDoc_.authoringContextURN==this.finalBrandURN),this.verifyColors()},validateAfterUndo:function(t,e){XCTAssertTrue(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID,this.FAKE_LOGO_ELEMENT_STAMP_ID])),XCTAssertTrue(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID,this.FAKE_FONT_ELEMENT_BODY_ID])),XCTAssertTrue(this.testDoc_.authoringContextName==this.initialBrandName),XCTAssertTrue(this.testDoc_.authoringContextURN==this.initialBrandURN)},validateAfterRedo:function(t,e){XCTAssertTrue(d.BrandingFacade.areSparkLogosInUse(this.testDoc_,[this.FAKE_LOGO_ELEMENT_PRIMARY_ID_2])),this.docHasText_?XCTAssertTrue(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID_2])):XCTAssertFalse(d.BrandingFacade.areSparkFontsInUse(this.testDoc_,[this.FAKE_FONT_ELEMENT_HEADLINE_ID_2])),XCTAssertTrue(this.testDoc_.authoringContextName==this.finalBrandName),XCTAssertTrue(this.testDoc_.authoringContextURN==this.finalBrandURN),this.verifyColors()},shutdown:function(t,e,n){A.ActionTestBase.prototype.shutdown.call(this,c.clone(t),e,n),this.removeBrandkit(n)}}}),l)}}]);
//# sourceMappingURL=vendors_npm_spark_4679d780-fedf5fe7.js.map