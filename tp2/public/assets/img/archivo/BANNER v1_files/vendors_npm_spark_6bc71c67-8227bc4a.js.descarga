(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[25],{"3HaQ":function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("6ZWm"),l=n("7Pku"),u=n("w/+j"),c=n("9Lk3"),p=n("iCxV"),f=n("fNpk"),d=n("tGKA"),h=n("Ird5"),m=n("jLWG"),P=n("jfma"),M=n("yjxF"),g=n("euLT"),T=n("Aj79"),F=n("Ucb9"),A=n("g6aL"),G=n("Zifs"),y=n("djAF"),v=n("byfQ"),R=n("hgLm"),_=n("oKlP");i.ShapeFormaToPGMMapper=(r=function e(){l.FormaToPGMMapper.call(this,e.FORMA_KIND)},o={},a.defineClass({name:"ShapeFormaToPGMMapper",ctor:r,superName:"FormaToPGMMapper",statics:{FORMA_KIND:{get:function(){return void 0===o.FORMA_KIND&&(o.FORMA_KIND=y.ShapeForma.KIND),o.FORMA_KIND}},instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}},createMapper:function(e){return r.instance},applyAnimations:function(e,t,n,r,o){var i,s=n;if(e.asDynamic&&(i=t.animation)){var l=a.clone(u.FormaToPGMUtils.convertAnimation(n,i,r,o));if(l.length>0){var c=h.PGMAnimationList.fromArray(l);s=n.withAnimations(n.animations.merge(c))}}return s},DUMMY_REF:{get:function(){return void 0===o.DUMMY_REF&&(o.DUMMY_REF=new T.PGMReference(new g.PGMNullNode("dummy"))),o.DUMMY_REF}},makePGMRefForArtwork:function(e,t,n,o,i,s){var l,u,c,p,d=h.PGMAnimationList.EMPTY;if(u=o.bounds)if(c=a.as(o,v.TheoArtworkShape))l=new T.PGMReference(new F.PGMShape(n,new M.PGMNodeMetadata(n,"shape"),d,u,a.clone(c.paths),s),i);else if(p=a.as(o,v.TheoArtworkGroup)){var g,G=[],y=1;p.forEachChild((function(o){var i;if(i=r.makePGMRefForArtwork(e,t,n+"-"+y,o,P.PGMCompositingParams.DEFAULT,s)){var a=r.applyAnimations(e,t,i,!1,!0);G.push(a)}y+=1})),l=(g=a.as(p,v.TheoArtworkClipGroup))?new T.PGMReference(new m.PGMClip(n,new M.PGMNodeMetadata(n,"clip"),h.PGMAnimationList.EMPTY,a.clone(G),[g.path]),i):1==G.length?G[0].withCompositing(i):new T.PGMReference(new A.PGMSimpleGroup(n,new M.PGMNodeMetadata(n,"group"),h.PGMAnimationList.EMPTY,a.clone(G)),i)}else f.LegacyCoreAssert.fail("unable to create PGM for artwork: not a shape or a group",void 0,"ShapeFormaToPGMMapper.makePGMRefForArtwork","ShapeFormaToPGMMapper.swift",156),l=null;else f.LegacyCoreAssert.fail("unable to create PGM for artwork: no bounds",void 0,"ShapeFormaToPGMMapper.makePGMRefForArtwork","ShapeFormaToPGMMapper.swift",160),l=null;return l},makePGMRefForShape:function(e,t,n){var o=r.DUMMY_REF,i=t.style.colors.fieldPrimary;null==i&&a.opt(p.Host.logging,(function(e){return e.warning("shape forma has no primary color; will not render")}));var l,u,m=i||G.SolidColor.ZERO,F=c.GridController.isBackgroundColoredCell(t)?e.backgroundOpacityOverride:1,y=m.withAlphaOf(m.alpha*F);if(null==t.sliceBox)if((l=t.canonicalArtwork.bounds)&&(u=t.bounds)){var v,R=d.Matrix2D.calculateResizeTransform(l,u,_.TheoPoint.ZERO,s.FitType.Stretch);if(v=r.makePGMRefForArtwork(e,t,n,t.canonicalArtwork,new P.PGMCompositingParams(R,t.style.opacity),y)){var C=r.applyAnimations(e,t,v,!1,!0);o=new T.PGMReference(new A.PGMSimpleGroup(n+"-shape-container",new M.PGMNodeMetadata(n,"shape-container"),h.PGMAnimationList.EMPTY,[C]),new P.PGMCompositingParams(t.placement))}else f.LegacyCoreAssert.fail("unexpected artwork configuration",void 0,"ShapeFormaToPGMMapper.makePGMRefForShape","ShapeFormaToPGMMapper.swift",225),o=new T.PGMReference(new g.PGMNullNode(n+"-shape-error-1"))}else f.LegacyCoreAssert.fail("couldn't get artwork or forma bounds for shape",void 0,"ShapeFormaToPGMMapper.makePGMRefForShape","ShapeFormaToPGMMapper.swift",229),o=new T.PGMReference(new g.PGMNullNode(n+"-shape-error-2"));else(v=r.makePGMRefForArtwork(e,t,n,t.sizedArtwork,new P.PGMCompositingParams(t.placement,t.style.opacity),y))?o=v:(f.LegacyCoreAssert.fail("unexpected artwork configuration",void 0,"ShapeFormaToPGMMapper.makePGMRefForShape","ShapeFormaToPGMMapper.swift",244),o=new T.PGMReference(new g.PGMNullNode(n+"-shape-error-3")));return o},applyPathAsClip:function(e,t,n,o,i){var l,u,c,p,F=r.DUMMY_REF,G=h.PGMAnimationList.EMPTY,y=a.clone(o);if(null==t.sliceBox)(l=t.canonicalArtwork.bounds)&&(p=n.bounds)?((b=(D=d.Matrix2D.calculateResizeTransform(l,p,_.TheoPoint.ZERO,s.FitType.Stretch).concat(t.placement)).inverse)&&(y=[new T.PGMReference(new A.PGMSimpleGroup(i,new M.PGMNodeMetadata(i,"clipped-node-wrapper"),G,a.clone(y)),new P.PGMCompositingParams(b))]),(c=a.as(t.canonicalArtwork,v.TheoArtworkShape))?F=new T.PGMReference(new m.PGMClip(i+"-clip",new M.PGMNodeMetadata(i,"shape-clip"),G,a.clone(y),a.clone(c.paths)),new P.PGMCompositingParams(D)):(u=a.as(t.canonicalArtwork,v.TheoArtworkClipGroup))&&(c=a.as(u.childAt(0),v.TheoArtworkShape))?F=new T.PGMReference(new m.PGMClip(i+"-clip",new M.PGMNodeMetadata(i,"outer-shape-clip"),h.PGMAnimationList.EMPTY,[new T.PGMReference(new m.PGMClip(i+"-inner-clip",new M.PGMNodeMetadata(i,"inner-shape-clip"),G,a.clone(y),a.clone(c.paths)))],[u.path]),new P.PGMCompositingParams(D)):(f.LegacyCoreAssert.fail("unexpected artwork configuration",void 0,"ShapeFormaToPGMMapper.applyPathAsClip","ShapeFormaToPGMMapper.swift",324),F=new T.PGMReference(new g.PGMNullNode(i)))):(f.LegacyCoreAssert.fail("no shape and/or primary color?",void 0,"ShapeFormaToPGMMapper.applyPathAsClip","ShapeFormaToPGMMapper.swift",328),F=new T.PGMReference(new g.PGMNullNode(i)));else if((c=a.as(t.sizedArtwork,v.TheoArtworkShape))&&(p=n.bounds)){for(var C=(E=a.clone(c.paths))[0].bounds,w=a.iter(a.range(1,E.length,!1));!w.done;w.next()){var S=w.value;C=C.unionWith(E[S].bounds)}(b=(D=d.Matrix2D.calculateResizeTransform(C,p,_.TheoPoint.ZERO,s.FitType.Stretch).concat(t.placement)).inverse)&&(F=new T.PGMReference(new m.PGMClip(i,new M.PGMNodeMetadata(i,"shape"),G,[new T.PGMReference(new A.PGMSimpleGroup(i+"-clip-wrapper",new M.PGMNodeMetadata(i,"clipped-node-wrapper"),G,a.clone(y)),new P.PGMCompositingParams(b))],a.clone(E)),new P.PGMCompositingParams(D)))}else if((u=a.as(t.sizedArtwork,v.TheoArtworkClipGroup))&&(c=a.as(u.childAt(0),v.TheoArtworkShape))&&(p=n.bounds)){C=(E=a.clone(c.paths))[0].bounds;for(var E,N=a.iter(a.range(1,E.length,!1));!N.done;N.next())S=N.value,C=C.unionWith(E[S].bounds);var D,b;if(b=(D=d.Matrix2D.calculateResizeTransform(C,p,_.TheoPoint.ZERO,s.FitType.Stretch).concat(t.placement)).inverse){var x,O=!0;u.path instanceof R.TheoEmptyPath?O=!1:(x=a.as(u.path,R.TheoRectanglePath))&&(O=x.rect.contains(C));var k=new T.PGMReference(new m.PGMClip(i,new M.PGMNodeMetadata(i,"shape"),G,[new T.PGMReference(new A.PGMSimpleGroup(i+"-clip-wrapper",new M.PGMNodeMetadata(i,"clipped-node-wrapper"),G,a.clone(y)),new P.PGMCompositingParams(b))],a.clone(E)),new P.PGMCompositingParams(O?d.Matrix2D.Identity:D));F=O?new T.PGMReference(new m.PGMClip(i+"-clip",new M.PGMNodeMetadata(i,"clip"),h.PGMAnimationList.EMPTY,[k],[u.path]),new P.PGMCompositingParams(D)):k}}else f.LegacyCoreAssert.fail("unexpected artwork configuration",void 0,"ShapeFormaToPGMMapper.applyPathAsClip","ShapeFormaToPGMMapper.swift",438),F=new T.PGMReference(new g.PGMNullNode(i));return F}},props:{makePGMRef:function(e,t,n,o){var i;return(i=a.as(e,y.ShapeForma))?0==t.backgroundOpacityOverride&&c.GridController.isBackgroundColoredCell(e)?new T.PGMReference(new g.PGMNullNode(i.formaID)):u.FormaToPGMUtils.applyAnimations(t,e,r.makePGMRefForShape(t,i,i.formaID)):(f.LegacyCoreAssert.fail("ShapeFormaToPGMMapper: not a shape forma",void 0,"ShapeFormaToPGMMapper.makePGMRef","ShapeFormaToPGMMapper.swift",50),null)}}}),r)},"44Iz":function(e,t,n){var r,o,i,a=t,s=n("oAGj");a.PGMExportSettings=(r=function(e,t){void 0===t&&(t=1),this.asDynamic=e,this.backgroundOpacityOverride=t},o={},s.defineClass({name:"PGMExportSettings",ctor:r,superName:"CoreObject",statics:{STATIC:{get:function(){return void 0===o.STATIC&&(o.STATIC=new r(!1)),o.STATIC}},DYNAMIC:{get:function(){return void 0===o.DYNAMIC&&(o.DYNAMIC=new r(!0)),o.DYNAMIC}}},props:{asString:{get:function(){return(this.asDynamic?"dynamic":"static")+(1==this.backgroundOpacityOverride?"":"bgop="+this.backgroundOpacityOverride)}}}}),r),a.PGMSource=(i=function(){},s.defineClass({name:"PGMSource",ctor:i,props:{getGraph:function(e){return null},getGraphForForma:function(e,t){return null}}}),i)},"5ex8":function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("6ZWm"),l=n("cmoc"),u=n("7Pku"),c=n("w/+j"),p=n("fdtz"),f=n("lmwz"),d=n("fNpk"),h=n("tGKA"),m=n("Ird5"),P=n("jLWG"),M=n("jfma"),g=n("dmHI"),T=n("vTQu"),F=n("yjxF"),A=n("Aj79"),G=n("Ucb9"),y=n("g6aL"),v=n("Zifs"),R=n("djAF"),_=n("3HaQ"),C=n("hgLm"),w=n("oKlP");i.FrameFormaToPGMMapper=(r=function e(){u.FormaToPGMMapper.call(this,e.FORMA_KIND)},o={},a.defineClass({name:"FrameFormaToPGMMapper",ctor:r,superName:"FormaToPGMMapper",statics:{FORMA_KIND:{get:function(){return void 0===o.FORMA_KIND&&(o.FORMA_KIND=l.FrameForma.KIND),o.FORMA_KIND}},instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}},createMapper:function(e){return r.instance}},props:{frameHasFillColor:function(e){var t,n;return!(!(t=a.as(e,l.FrameForma))||!(n=a.as(t.controller,s.FrameController)))&&n.hasCutout},makePGMRef:function(e,t,n,r){var o,i,u;if((o=a.as(e,l.FrameForma))&&(i=n.childReferences(o))&&(u=o.bounds)){var S,E,N=null,D=o.formaID,b=new F.PGMNodeMetadata(o.formaID,"frame"),x=m.PGMAnimationList.EMPTY,O=this.frameHasFillColor(e),k=o.style.opacity;if(O){var I,L=o.style.colors.fieldPrimary||v.SolidColor.ZERO,Y=new C.TheoRectanglePath(u);(I=f.ImageFacade.getImageFormaForForma(o))&&(k=I.style.opacity),N=new A.PGMReference(new G.PGMShape(o.formaID+"-background",new F.PGMNodeMetadata(o.formaID,"background"),m.PGMAnimationList.EMPTY,u,[Y],L)),i.splice(0,0,N)}if(E=f.ImageFacade.getMaskFormaForForma(o)){var B,U;if(B=a.as(E,R.ShapeForma))S=new y.PGMSimpleGroup(D,b,x,[_.ShapeFormaToPGMMapper.applyPathAsClip(t,B,e,a.clone(i),B.formaID)]);else{if(!(U=a.as(E,p.ImageForma)))return d.LegacyCoreAssert.fail("child reference generation failed for frame: unknown mask type",void 0,"FrameFormaToPGMMapper.makePGMRef","FrameFormaToPGMMapper.swift",147),null;var K,W;if(!(K=n.referenceForForma(U)))return d.LegacyCoreAssert.fail("child reference generation failed for frame: no image?",void 0,"FrameFormaToPGMMapper.makePGMRef","FrameFormaToPGMMapper.swift",142),null;W=1==i.length?i[0]:new A.PGMReference(new y.PGMSimpleGroup(D+"-children-group",b,x,a.clone(i)));var j,V=h.Matrix2D.calculateResizeTransform(U.bounds,o.bounds,w.TheoPoint.ZERO,s.FitType.Stretch),H=K.withPlacement(V);S=new g.PGMFilter(D,b,x,[W,H],new T.PGMMaskFilterSpec),(j=N)&&(S=new y.PGMSimpleGroup(D,b,x,[j,new A.PGMReference(S)]))}}else{var q,z=!1,Z=new C.TheoRectanglePath(o.bounds);(q=a.as(o.controller,s.FrameController))&&(z=q.clip),S=z?new P.PGMClip(D,b,x,a.clone(i),[Z]):new y.PGMSimpleGroup(D,b,x,a.clone(i))}return c.FormaToPGMUtils.applyAnimations(t,e,new A.PGMReference(S,new M.PGMCompositingParams(o.placement,k)))}return d.LegacyCoreAssert.fail("frame forma child reference generation failed",void 0,"FrameFormaToPGMMapper.makePGMRef","FrameFormaToPGMMapper.swift",182),null}}}),r)},"7Pku":function(e,t,n){var r,o=t,i=n("oAGj"),a=n("fNpk");o.FormaToPGMFactory=i.defineProtocol("FormaToPGMFactory",{childReferences:"(GroupForma) -> Array<PGMReference>",referenceForForma:"(Forma) -> PGMReference"}),o.FormaToPGMMapper=(r=function(e){this.formaKind=e},i.defineClass({name:"FormaToPGMMapper",ctor:r,props:{makePGMRef:function(e,t,n,r){return a.LegacyCoreAssert.fail("PGMMapperForForma isn't overriding makePGMRef",{kind:this.formaKind},"FormaToPGMMapper.makePGMRef","FormaToPGMMapper.swift",52),null},canDoSimpleTransformUpdate:function(e){return!0}}}),r)},"8Quq":function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("7Pku"),l=n("w/+j"),u=n("fNpk"),c=n("c+uM"),p=n("Ird5"),f=n("jfma"),d=n("djwB"),h=n("yjxF"),m=n("Aj79"),P=n("W6ub"),M=n("bAjp"),g=n("bJhu"),T=n("enh0"),F=n("sIWg");i.TextFormaToPGMMapper=(r=function e(){s.FormaToPGMMapper.call(this,e.FORMA_KIND)},o={},a.defineClass({name:"TextFormaToPGMMapper",ctor:r,superName:"FormaToPGMMapper",statics:{FORMA_KIND:{get:function(){return void 0===o.FORMA_KIND&&(o.FORMA_KIND=T.TextForma.KIND),o.FORMA_KIND}},instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}},createMapper:function(e){return r.instance},getPGMNodeForTextForma:function(e,t,n,r){var o;void 0===r&&(r=null);var i=p.PGMAnimationList.EMPTY,s=t.fontColor,l=t.fontDescriptor,f=t.textLook,m=t.fontStrokeColor,T=t.fontStrokeWidth,A=t.tracking,G=t.fontSize,y=r||s;null==r&&T>0&&(f==c.LockupTextLook.KnockoutAndOutline||f==c.LockupTextLook.OutlineOnly||f==c.LockupTextLook.KnockoutAndShadow)&&(y=null),u.LegacyCoreAssert.isFalse(null==t.bounds,"nil text forma bounds encountered when getting PGM node",void 0,"TextFormaToPGMMapper.getPGMNodeForTextForma","TextFormaToPGMMapper.swift",89);var v=((o=a.opt(t.bounds,(function(e){return e.width})))||null!=o?o:a.toDouble(t.text.length)*G)-T,R=F.TheoRect.fromXYWH(0,G*(l.capRatio-l.ascentRatio),v,G*(l.ascentRatio+l.descentRatio));return new M.PGMText(n,new h.PGMNodeMetadata(t.formaID,"text"),i,R,t.text,g.PGMTextStyle.createCacheable(d.PGMFont.fromDescriptor(l),y,m,T,A),P.PGMRenderRuns.init_378c(t.renderRuns))}},props:{makePGMRef:function(e,t,n,o){var i;return(i=a.as(e,T.TextForma))?l.FormaToPGMUtils.applyAnimations(t,i,new m.PGMReference(r.getPGMNodeForTextForma(t,i,i.formaID,null),new f.PGMCompositingParams(i.placement,i.style.opacity))):(u.LegacyCoreAssert.fail("TextFormaToPGMMapper: not a text forma",void 0,"TextFormaToPGMMapper.makePGMRef","TextFormaToPGMMapper.swift",52),null)}}}),r)},Bcdx:function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("5ex8"),l=n("Bqrn"),u=n("dX/e"),c=n("pR+7"),p=n("3HaQ"),f=n("8Quq"),d=n("zW/s"),h=n("s3ad");i.FormaToPGMMapperFactory=(r=function(){},o={},a.defineClass({name:"FormaToPGMMapperFactory",ctor:r,statics:{instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}},FORMA_KIND_TO_FN:{get:function(){return void 0===o.FORMA_KIND_TO_FN&&(o.FORMA_KIND_TO_FN={Root:function(e){return c.RootFormaToPGMMapper.createMapper(e)},Frame:function(e){return s.FrameFormaToPGMMapper.createMapper(e)},Text:function(e){return f.TextFormaToPGMMapper.createMapper(e)},Shape:function(e){return p.ShapeFormaToPGMMapper.createMapper(e)},Image:function(e){return u.ImageFormaToPGMMapper.createMapper(e)},Video:function(e){return h.VideoFormaToPGMMapper.createMapper(e)},Vector:function(e){return d.VectorFormaToPGMMapper.createMapper(e)},group:function(e){return l.GroupFormaToPGMMapper.createMapper(e)},"smart-group":function(e){return l.GroupFormaToPGMMapper.createMapper(e)}}),o.FORMA_KIND_TO_FN}}},props:{getMapper:function(e){return a.opt(r.FORMA_KIND_TO_FN[e.kind],(function(t){return t(e)}))}}}),r)},BgH2:function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("iCxV"),l=n("fNpk"),u=n("oKlP"),c=n("sIWg");i.TextPathSegment=(r=function(e,t,n,r){this._cachedTolerance=0,this._p0=e,this._p1=t,this._p2=n,this._p3=r},a.defineClass({name:"TextPathSegment",ctor:r,superName:"CoreObject",statics:{decodeFromJson:function(e){var t;if(t=e){var n=r.decodePoint(t[r.PROPERTY_P0]),o=r.decodePoint(t[r.PROPERTY_P1]),i=r.decodePoint(t[r.PROPERTY_P2]),a=r.decodePoint(t[r.PROPERTY_P3]);if(null!=n&&null!=o&&null!=i&&null!=a)return new r(n,o,i,a)}return null},encodePoint:function(e){return[e.x,e.y]},decodePoint:function(e){return u.TheoPoint.decodeJson(a.as(e,"AnyObject"))},PROPERTY_P0:"p0",PROPERTY_P1:"p1",PROPERTY_P2:"p2",PROPERTY_P3:"p3"},props:{p0:{get:function(){return this._p0}},p1:{get:function(){return this._p1}},p2:{get:function(){return this._p2}},p3:{get:function(){return this._p3}},clone:function(){return new r(this.p0,this.p1,this.p2,this.p3)},pointAt:function(e){if(!this.checkT(e))return u.TheoPoint.INVALID;var t=1-e,n=t*t*t*this.p0.x+3*e*t*t*this.p1.x+3*e*e*t*this.p2.x+e*e*e*this.p3.x,r=t*t*t*this.p0.y+3*e*t*t*this.p1.y+3*e*e*t*this.p2.y+e*e*e*this.p3.y;return new u.TheoPoint(n,r)},tangentUnitVectorAt:function(e){if(!this.checkT(e))return u.TheoPoint.INVALID;var t=e;t<.01?t=.01:t>.99&&(t=.99);var n=a.clone(this.calculateMidpoints(t)),r=u._minus_TheoPoint_TheoPoint(n[4],n[3]);return r.divide(r.length())},getBounds:function(){var e=this.getBoundsOneDim(this.p0.x,this.p1.x,this.p2.x,this.p3.x,(function(e){return e.x})),t=e.min,n=e.max,r=this.getBoundsOneDim(this.p0.y,this.p1.y,this.p2.y,this.p3.y,(function(e){return e.y})),o=r.min,i=r.max,a=new c.TheoRect(t,o,n,i),s=c.TheoRect.boundsOfPoints([this.p0,this.p1,this.p2,this.p3]);return s.equal(a)||s.contains(a)||l.LegacyCoreAssert.fail("Text path segment bounds incorrect",void 0,"TextPathSegment.getBounds","TextPath.swift",99),a},getBoundsOneDim:function(e,t,n,r,o){var i,a,s=3*r-9*n+9*t-3*e,l=6*e-12*t+6*n,u=3*(-e+t);if(Math.abs(s)<1e-6)a=i=-u/l;else{var c=Math.sqrt(l*l-4*s*u);i=(-l+c)/(2*s),a=(-l-c)/(2*s)}var p=this.checkT(i)?o(this.pointAt(i)):e,f=this.checkT(a)?o(this.pointAt(a)):r;return{min:Math.min(p,f,e,r),max:Math.max(p,f,e,r)}},multiply:function(e){return new r(this._p0.multiplyPoint(e),this._p1.multiplyPoint(e),this._p2.multiplyPoint(e),this._p3.multiplyPoint(e))},offset:function(e){return new r(u._plus_TheoPoint_TheoPoint(this._p0,e),u._plus_TheoPoint_TheoPoint(this._p1,e),u._plus_TheoPoint_TheoPoint(this._p2,e),u._plus_TheoPoint_TheoPoint(this._p3,e))},truncate:function(e){var t=a.clone(this.calculateMidpoints(e)),n=t[3].interpolate(t[4],e);return{prefix:new r(this.p0,t[0],t[3],n),suffix:new r(n,t[4],t[2],this._p3)}},getLength:function(e){if(null!=this._cachedLen&&this._cachedTolerance<=e)return this._cachedLen;for(var t=0,n=0,r=e,o=this.clone();!(o.getPolylineLength()-(t=o.getChordLength())<=e);){r/=2;var i=o.truncate(.5),a=i.prefix,s=i.suffix;n+=a.getLength(r),o=s}return this._cachedLen=n+t,this._cachedTolerance=r,this._cachedLen},getCorrectedLength:function(e,t,n){var r=this.getLength(n),o=u._minus_TheoPoint_TheoPoint(this.p3,this.p2),i=Math.atan2(o.y,o.x);return o=u._minus_TheoPoint_TheoPoint(this.p1,this.p0),(i-=Math.atan2(o.y,o.x))<-Math.PI&&(i+=2*Math.PI),i>Math.PI&&(i-=2*Math.PI),r+(i*=i>0?e:t)},findTValueByCorrectedPrefixLength:function(e,t,n,r){for(var o=r/2,i=0,l=1,u=0,c=0;c<1e3;){u=(i+l)/2;var p=this.truncate(u).prefix.getCorrectedLength(e,t,o);if(Math.abs(n-p)<=o)return u;n<p?l=u:i=u,c+=1}return a.opt(s.Host.logging,(function(e){return e.warning("findTValueByCorrectedPrefixLength did not converge")})),u},encodeJson:function(){var e={};return e[r.PROPERTY_P0]=r.encodePoint(this.p0),e[r.PROPERTY_P1]=r.encodePoint(this.p1),e[r.PROPERTY_P2]=r.encodePoint(this.p2),e[r.PROPERTY_P3]=r.encodePoint(this.p3),e},isEqual:function(e){return this.isEqualWithAccuracy(e,1e-6)},isEqualWithAccuracy:function(e,t){var n;return!!(n=a.as(e,r))&&this.p0.equalWithAccuracy(n.p0,t)&&this.p1.equalWithAccuracy(n.p1,t)&&this.p2.equalWithAccuracy(n.p2,t)&&this.p3.equalWithAccuracy(n.p3,t)},getPolylineLength:function(){return this.p0.distanceTo(this.p1)+this.p1.distanceTo(this.p2)+this.p2.distanceTo(this.p3)},getChordLength:function(){return this.p0.distanceTo(this.p3)},calculateMidpoints:function(e){var t=this.p0.interpolate(this.p1,e),n=this.p1.interpolate(this.p2,e),r=this.p2.interpolate(this.p3,e),o=t.interpolate(n,e),i=n.interpolate(r,e);return[t,n,r,o,i]},checkT:function(e){return e>=0&&e<=1}}}),r),i.TextPath=(o=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=1),this._segments=a.clone(e),this._flex=t},a.defineClass({name:"TextPath",ctor:o,superName:"CoreObject",statics:{decodeFromJson:function(e){var t,n;if(n=e){var r,s=(t=a.as(n[o.PROPERTY_FLEX],"Double"))||null!=t?t:1,l=[];if(r=a.as(n[o.PROPERTY_SEGMENTS],["Array","Any"]))for(var u=a.iter(r);!u.done;u.next()){var c=u.value,p=i.TextPathSegment.decodeFromJson(a.as(c,["Dictionary","String","Any"]));if(null==p)return null;l.push(p)}return new o(a.clone(l),s)}return null},areSegmentsContiguous:function(e){for(var t=a.iter(a.toSequence(e));!t.done;t.next()){var n=t.value,r=n.offset,o=n.element;if(r<e.length-1){var i=e[r+1];if(!o.p3.equal(i.p0))return!1}}return!0},PROPERTY_FLEX:"flex",PROPERTY_SEGMENTS:"segment"},props:{segments:{get:function(){return this._segments}},numSegments:{get:function(){return this._segments.length}},flex:{get:function(){return this._flex}},isClosed:function(){return!(this.numSegments<2)&&o.areSegmentsContiguous(a.clone(this._segments))&&a.first(this._segments).p0.equal(a.last(this._segments).p3)},clone:function(){var e=this._segments.map((function(e){return e.clone()}),this);return new o(a.clone(e),this._flex)},pointAt:function(e){var t;return null!=(t=this.getSegementIndex(e))?this._segments[t].pointAt(e-a.toDouble(t)):u.TheoPoint.INVALID},tangentUnitVectorAt:function(e){var t;return null!=(t=this.getSegementIndex(e))?this._segments[t].tangentUnitVectorAt(e-a.toDouble(t)):u.TheoPoint.INVALID},getBounds:function(){for(var e,t=a.iter(this._segments);!t.done;t.next()){var n=t.value.getBounds();e=null==e?n:e.unionWith(n)}return e||c.TheoRect.Zero},multiply:function(e){var t=this._segments.map((function(t){return t.multiply(new u.TheoPoint(e.width,e.height))}),this);return new o(a.clone(t),this._flex)},offset:function(e){var t=this._segments.map((function(t){return t.offset(e)}),this);return new o(a.clone(t),this._flex)},truncate:function(e){if(e>=0&&e<a.toDouble(this.numSegments)){var t=a.toInt(Math.floor(e)),n=a.clone(this._segments),r=n.splice(0,t),i=e-a.toDouble(t);if(i>0){var s=n[0].truncate(i),l=s.prefix,u=s.suffix,c=l;n[0]=u,r.push(c)}return{prefix:new o(a.clone(r)),suffix:new o(a.clone(n),this._flex)}}return{prefix:new o,suffix:this.clone()}},getLength:function(e){if(0==this.numSegments)return 0;for(var t=e/a.toDouble(this.numSegments),n=0,r=a.iter(this._segments);!r.done;r.next())n+=r.value.getLength(t);return n},getCorrectedLength:function(e,t,n){for(var r=n/a.toDouble(this.numSegments),o=0,i=a.iter(this._segments);!i.done;i.next())o+=i.value.getCorrectedLength(e,t,r);return o},findTValueByCorrectedPrefixLength:function(e,t,n,r){for(var o=r/a.toDouble(this.numSegments),i=n,s=0;s<this.numSegments&&i>0;){var l=this._segments[s].getCorrectedLength(e,t,o);if(i<=l-o){var u=this._segments[s].findTValueByCorrectedPrefixLength(e,t,i,o);return a.toDouble(s)+u}i-=l,s+=1}return a.toDouble(s)},encodeJson:function(){var e={};e[o.PROPERTY_FLEX]=this.flex;for(var t=[],n=a.iter(this.segments);!n.done;n.next()){var r=n.value;t.push(r.encodeJson())}return e[o.PROPERTY_SEGMENTS]=t,e},isEqual:function(e){return this.isEqualWithAccuracy(e,1e-6)},isEqualWithAccuracy:function(e,t){var n;if(n=a.as(e,o)){if(this.numSegments!=n.numSegments||Math.abs(this.flex-n.flex)>t)return!1;for(var r=a.iter(a.toSequence(this.segments));!r.done;r.next()){var i=r.value,s=i.offset;if(!i.element.isEqualWithAccuracy(n.segments[s],t))return!1}return!0}return!1},getSegementIndex:function(e){return e<0||e>a.toDouble(this.numSegments)?null:Math.min(a.toInt(Math.floor(e)),this.numSegments-1)}}}),o)},Bqrn:function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("7Pku"),l=n("w/+j"),u=n("9Lk3"),c=n("pnSN"),p=n("RBTN"),f=n("fNpk"),d=n("Ird5"),h=n("jfma"),m=n("yjxF"),P=n("Aj79"),M=n("g6aL"),g=n("8t9B"),T=n("QgdZ");a.gvar(i,"_groupSingleton",(function(){return new i.GroupFormaToPGMMapper})),a.gvar(i,"_typeLockupSingleton",(function(){return new T.TypeLockupToPGMMapper})),a.gvar(i,"_gridSingleton",(function(){return new p.GridToPGMMapper})),i.GroupFormaToPGMMapper=(r=function e(){s.FormaToPGMMapper.call(this,e.FORMA_KIND)},o={},a.defineClass({name:"GroupFormaToPGMMapper",ctor:r,superName:"FormaToPGMMapper",statics:{FORMA_KIND:{get:function(){return void 0===o.FORMA_KIND&&(o.FORMA_KIND=c.GroupForma.KIND),o.FORMA_KIND}},createMapper:function(e){var t;if(t=e.controller){if(t instanceof g.TypeLockupController)return i._typeLockupSingleton;if(t instanceof u.GridController)return i._gridSingleton}return i._groupSingleton}},props:{makePGMRef:function(e,t,n,r){var o,i;return(o=a.as(e,c.GroupForma))&&(i=n.childReferences(o))?l.FormaToPGMUtils.applyAnimations(t,e,new P.PGMReference(new M.PGMSimpleGroup(o.formaID,new m.PGMNodeMetadata(o.formaID,"group"),d.PGMAnimationList.EMPTY,a.clone(i)),new h.PGMCompositingParams(o.placement,o.style.opacity))):(f.LegacyCoreAssert.fail("group forma child reference generation failed",void 0,"GroupFormaToPGMMapper.makePGMRef","GroupFormaToPGMMapper.swift",64),null)}}}),r)},ML5t:function(e,t,n){var r,o=t,i=n("oAGj"),a=n("hndY"),s=n("fNpk");o.FormaPagePGMSource=(r=function(e){this.caches_={},this.page=e},i.defineClass({name:"FormaPagePGMSource",ctor:r,superName:"PGMSource",props:{getCache:function(e){var t,n,r=e.asString,o=e.backgroundOpacityOverride<1;if(t=this.caches_[r])return t;if(n=this.page){var i=new a.FormaPGMCache(n,e,o);return o||(this.caches_[r]=i),i}return s.LegacyCoreAssert.fail("FormaPagePGMSource.getGraph: page is out of scope",void 0,"FormaPagePGMSource.getCache","FormaPagePGMSource.swift",46),null},getGraph:function(e){var t;if(t=this.getCache(e)){var n=t.getGraph();return t.adhoc&&t.destroy(),n}return null},getGraphForForma:function(e,t){var n;if(n=this.getCache(t)){var r=n.getGraphForForma(e);return n.adhoc&&n.destroy(),r}return null}}}),r)},QgZx:function(e,t,n){var r,o=t,i=n("oAGj"),a=n("gXiO"),s=n("iCxV"),l=n("fNpk"),u=n("9YN4");o.FontOrigin=i.defineEnum("FontOrigin",{UNKNOWN_ORIGIN:0,USER_CHOSEN:1,STARTUP:2,ACTIVATE_MISSING:3}),o.describeFontOrigin=function(e){switch(e){case 0:return"unknown";case 1:return"user-chosen";case 2:return"startup";case 3:return"activate-missing"}},o.FontSource=i.defineEnum("FontSource",{UNKNOWN_SOURCE:0,WEB_FONT:1,EMBEDDED:2,SPARK_PROVIDED:3,USER_UPLOAD:4,TYPEKIT_FREE:5,TYPEKIT_PREMIUM:6}),o.describeFontSource=function(e){switch(e){case 0:return"unknown";case 1:return"web";case 2:return"embedded";case 3:return"spark";case 4:return"user-upload";case 5:return"typekit-free";case 6:return"typekit-premium"}},o.FontAvailability=i.defineEnum("FontAvailability",{UNKNOWN:0,LOADABLE:1,LOADED:2,NOT_LOADABLE:3}),i.gvar(o,"fontDescriptorStrings",(function(){return{familyName:function(e,t){e.familyName=t},displaySample:function(e,t){e.displaySample=t},label:function(e,t){e.label=t},postScriptName:function(e,t){e.postScriptName=t},macPostScriptName:function(e,t){e.macPostScriptName=t},filename:function(e,t){e.filename=t},family:function(e,t){e.family=t},original_family:function(e,t){e.original_family=t},faceName:function(e,t){e.faceName=t},category:function(e,t){e.category=t},subfamilyName:function(e,t){e.subfamilyName=t},preferredFamilyName:function(e,t){e.preferredFamilyName=t},preferredSubfamilyName:function(e,t){e.preferredSubfamilyName=t},cssName:function(e,t){e.cssName=t},tkSyncId:function(e,t){e.tkSyncId=t},tkWebId:function(e,t){e.tkWebId=t},style:function(e,t){e.style=t}}})),i.gvar(o,"fontDescriptorDoubles",(function(){return{capAccentRatio:function(e,t){e.capAccentRatio=t},capRatio:function(e,t){e.capRatio=t},meanAccentRatio:function(e,t){e.meanAccentRatio=t},meanRatio:function(e,t){e.meanRatio=t},ascentRatio:function(e,t){e.ascentRatio=t},baselineOffsetRatio:function(e,t){e.baselineOffsetRatio=t},tailRatio:function(e,t){e.tailRatio=t},descentRatio:function(e,t){e.descentRatio=t},italicAngle:function(e,t){e.italicAngle=t},popularity:function(e,t){e.popularity=t}}})),i.gvar(o,"fontDescriptorInts",(function(){return{weight:function(e,t){e.weight=t},source:function(e,t){var n;e.source=(n=o.FontSource.toCaseValue(t))||null!=n?n:o.FontSource.UNKNOWN_SOURCE},formality:function(e,t){e.formality=t},blackness:function(e,t){e.blackness=t},drama:function(e,t){e.drama=t},width:function(e,t){e.width=t},usWidthClass:function(e,t){e.usWidthClass=t},usWeightClass:function(e,t){e.usWeightClass=t}}})),i.gvar(o,"fontDescriptorBools",(function(){return{allCapsAllowed:function(e,t){e.allCapsAllowed=t},displayAllowed:function(e,t){e.displayAllowed=t},bodyAllowed:function(e,t){e.bodyAllowed=t},serif:function(e,t){e.serif=t},slab:function(e,t){e.slab=t},handdrawn:function(e,t){e.handdrawn=t},calligraphic:function(e,t){e.calligraphic=t},decorative:function(e,t){e.decorative=t},square:function(e,t){e.square=t},geometric:function(e,t){e.geometric=t},italic:function(e,t){e.italic=t}}})),o.FontDescriptor=(r=function(e){this.displayFamilyName_="",this.displayFaceName_="",this._source=o.FontSource.UNKNOWN_SOURCE,this.availability=o.FontAvailability.LOADABLE,this._spaceWidthRatio=0,this.capAccentRatio=0,this.capRatio=0,this.meanAccentRatio=0,this.meanRatio=0,this.ascentRatio=0,this.baselineOffsetRatio=0,this.tailRatio=0,this.descentRatio=0,this.italicAngle=0,this.displaySample="",this.upperCaseCharsDict={},this.lowerCaseCharsDict={},this.capAccentCharsDict={},this.capCharsDict={},this.ascentCharsDict={},this.meanAccentCharsDict={},this.meanCharsDict={},this.baseCharsDict={},this.tailCharsDict={},this.descentCharsDict={},this.characterFeatures={},this.label="",this.postScriptName="",this.macPostScriptName="",this.filename="",this.family="",this.original_family="",this.category="",this.familyName="",this.subfamilyName="",this.preferredFamilyName="",this.preferredSubfamilyName="",this.faceName="",this.cssName="",this.tkSyncId="",this.tkWebId="",this.style="",this.popularity=0,this.weight=0,this.formality=0,this.blackness=0,this.drama=0,this.width=0,this.usWidthClass=0,this.usWeightClass=0,this.allCapsAllowed=!1,this.displayAllowed=!1,this.bodyAllowed=!1,this.serif=!1,this.slab=!1,this.handdrawn=!1,this.calligraphic=!1,this.decorative=!1,this.square=!1,this.geometric=!1,this.italic=!1,a.CoreObject.call(this);for(var t=i.iter(o.fontDescriptorStrings);!t.done;t.next()){var n=t.key,r=t.value;null!=(d=e[n])&&r(this,d)}for(var s=i.iter(o.fontDescriptorDoubles);!s.done;s.next())n=s.key,r=s.value,null!=(d=e[n])&&r(this,d);for(var l=i.iter(o.fontDescriptorInts);!l.done;l.next())if(n=l.key,r=l.value,null!=(d=e[n]))if("weight"==n&&null!=i.as(d,"String")){var u=d,c=i.isEmpty(u)?0:i.toInt(u);r(this,c>0?c:400)}else if("source"==n){var p=d;this.source=null!=o.FontSource.toCaseValue(p)?o.FontSource.toCaseValue(p):o.FontSource.UNKNOWN_SOURCE}else r(this,d);for(var f=i.iter(o.fontDescriptorBools);!f.done;f.next()){var d;n=f.key,r=f.value,null!=(d=e[n])&&r(this,d)}for(var h=e.uppercaseChars,m=e.lowercaseChars,P=e.capAccentChars,M=e.capChars,g=e.ascentChars,T=e.meanAccentChars,F=e.meanChars,A=e.baseChars,G=e.tailChars,y=e.descentChars,v=i.clone(i.as(e.characterFeatures,["Dictionary","String","Double"])),R=i.iter(i.chars(h));!R.done;R.next()){var _=R.value;this.upperCaseCharsDict[_]=!0}for(var C=i.iter(i.chars(m));!C.done;C.next()){var w=C.value;this.lowerCaseCharsDict[w]=!0}for(var S=i.iter(i.chars(P));!S.done;S.next()){var E=S.value;this.capAccentCharsDict[E]=!0}for(var N=i.iter(i.chars(M));!N.done;N.next()){var D=N.value;this.capCharsDict[D]=!0}for(var b=i.iter(i.chars(g));!b.done;b.next()){var x=b.value;this.ascentCharsDict[x]=!0}for(var O=i.iter(i.chars(T));!O.done;O.next()){var k=O.value;this.meanAccentCharsDict[k]=!0}for(var I=i.iter(i.chars(F));!I.done;I.next()){var L=I.value;this.meanCharsDict[L]=!0}for(var Y=i.iter(i.chars(A));!Y.done;Y.next()){var B=Y.value;this.baseCharsDict[B]=!0}for(var U=i.iter(i.chars(G));!U.done;U.next()){var K=U.value;this.tailCharsDict[K]=!0}for(var W=i.iter(i.chars(y));!W.done;W.next()){var j=W.value;this.descentCharsDict[j]=!0}if(null!=v)for(var V=i.iter(i.keys(v));!V.done;V.next()){var H=V.value;this.characterFeatures[H]=v[H]}},i.defineClass({name:"FontDescriptor",ctor:r,superName:"CoreObject",statics:{PROPERTY_POSTSCRIPT_NAME:"postscript-name",PROPERTY_SOURCE:"source",decodeJson:function(e,t){var n=i.as(e,["Dictionary","String","Any"]);if(null==n)return l.LegacyCoreAssert.fail("FontDescriptorAttribute: Data is missing or not a dictionary",void 0,"FontDescriptor.decodeJson","FontDescriptor.swift",434),null;var a=n[r.PROPERTY_POSTSCRIPT_NAME],c=s.Host.fontProvider.descriptorForPostScriptName(a,i.as(t,u.TheoDocument));return c.postScriptName==a&&c.availability==o.FontAvailability.LOADED||t.recordMissingFont(a),c}},props:{displayFamilyName:{get:function(){return""==this.displayFamilyName_&&(this.displayFamilyName_=this.preferredFamilyName),""==this.displayFamilyName_&&(this.displayFamilyName_=this.familyName),""==this.displayFamilyName_&&(this.displayFamilyName_=this.family),""==this.displayFamilyName_&&(this.displayFamilyName_=this.postScriptName),this.displayFamilyName_},set:function(e){this.displayFamilyName_=e}},displayFaceName:{get:function(){return""==this.displayFaceName_&&(this.displayFaceName_=this.preferredSubfamilyName),""==this.displayFaceName_&&(this.displayFaceName_=this.subfamilyName),""==this.displayFaceName_&&(this.displayFaceName_=this.faceName),""==this.displayFaceName_&&(this.displayFaceName_=this.label),""==this.displayFaceName_&&(this.displayFaceName_=this.postScriptName),this.displayFaceName_},set:function(e){this.displayFaceName_=e}},source:{get:function(){return this._source},set:function(e){this._source==o.FontSource.EMBEDDED?e!=o.FontSource.EMBEDDED&&i.info("Font "+this.postScriptName+" is already marked as EMBEDDED. Ignoring new font source"):this._source=e}},privateSetFontSource:function(e){this._source=e},spaceWidthRatio:{get:function(){if(0==this._spaceWidthRatio){var e=s.Host.textModelUtils.measureBoundsForLayout(" ",this,100,0);this._spaceWidthRatio=e.width/100}return this._spaceWidthRatio}},resolveFamily:function(){return this.family!=this.cssName||""==this.original_family?this.family:this.original_family},isEqual:function(e){var t=i.as(e,r);return null!=t&&this.postScriptName==t.postScriptName},encodeJson:function(){var e={};return e[r.PROPERTY_POSTSCRIPT_NAME]=this.postScriptName,e[r.PROPERTY_SOURCE]=o.describeFontSource(this.source),e}}}),r),o._equality_FontDescriptor_FontDescriptor=function(e,t){return e.isEqual(t)}},QgdZ:function(e,t,n){var r,o=t,i=n("oAGj"),a=n("w/+j"),s=n("pnSN"),l=n("Bqrn"),u=n("fNpk"),c=n("c+uM"),p=n("Ird5"),f=n("jfma"),d=n("dmHI"),h=n("vTQu"),m=n("yjxF"),P=n("Aj79"),M=n("g6aL"),g=n("Zifs"),T=n("djAF"),F=n("3HaQ"),A=n("enh0"),G=n("8Quq");o.TypeLockupToPGMMapper=(r=function(){l.GroupFormaToPGMMapper.call(this)},i.defineClass({name:"TypeLockupToPGMMapper",ctor:r,superName:"GroupFormaToPGMMapper",statics:{usesPageAnchoredStyle:function(e){var t;if(t=i.as(e.style,c.LockupStyle)){var n=t.backing;return n==c.LockupBacking.BannerHorizontal||n==c.LockupBacking.BannerVertical||n==c.LockupBacking.Banner||n==c.LockupBacking.Knockout}return!1},getPGMForTypeLockup:function(e,t,n){var r=0,o=0,l=function t(l){var d,h,y,v=null,R=null,_=null,C=null;if(d=i.as(l,s.GroupForma)){var w=null,S=null,E=null,N=null;d.childrenAsArray.forEach((function(e){var n=t(e),r=n.shapeRef,o=n.bottomTextRef,i=n.textRef,a=n.knockoutRef;null!=r&&(null==w&&(w=[]),w.push(r)),null!=o&&(null==S&&(S=[]),S.push(o)),null!=i&&(null==E&&(E=[]),E.push(i)),null!=a&&(null==N&&(N=[]),N.push(a))}));var D=f.PGMCompositingParams.smartInit(d.placement,d.style.opacity);null!=w&&(v=a.FormaToPGMUtils.applyAnimations(e,d,new P.PGMReference(new M.PGMSimpleGroup(d.formaID+"-shapes",new m.PGMNodeMetadata(d.formaID,"group"),p.PGMAnimationList.EMPTY,i.clone(w)),D))),null!=S&&(R=a.FormaToPGMUtils.applyAnimations(e,d,new P.PGMReference(new M.PGMSimpleGroup(d.formaID+"-bottomTexts",new m.PGMNodeMetadata(d.formaID,"group"),p.PGMAnimationList.EMPTY,i.clone(S)),D))),null!=E&&(_=a.FormaToPGMUtils.applyAnimations(e,d,new P.PGMReference(new M.PGMSimpleGroup(d.formaID+"-texts",new m.PGMNodeMetadata(d.formaID,"group"),p.PGMAnimationList.EMPTY,i.clone(E)),D))),null!=N&&(C=a.FormaToPGMUtils.applyAnimations(e,d,new P.PGMReference(new M.PGMSimpleGroup(d.formaID+"-knockouts",new m.PGMNodeMetadata(d.formaID,"group"),p.PGMAnimationList.EMPTY,i.clone(N)),D)))}else if(h=i.as(l,A.TextForma)){r+=1;var b=h.textLook,x=h.fontStrokeWidth;switch(D=new f.PGMCompositingParams(h.placement,h.style.opacity),u.LegacyCoreAssert.isTrue(!c.LockupStyle.isKnockoutLook(b)||b==c.LockupTextLook.KnockoutAndFill||b==c.LockupTextLook.KnockoutAndShadow||i.eq(g._equality_SolidColor_SolidColor,h.fontColor,g.SolidColor.BLACK),"did not set the fill color to black for knockout looks that don't fill",void 0,"TypeLockupToPGMMapper.getPGMForTypeLockup","TypeLockupToPGMMapper.swift",186),b){case 0:var O=G.TextFormaToPGMMapper.getPGMNodeForTextForma(e,h,n+"-txt#"+r);if(_=new P.PGMReference(O,D),e.asDynamic){var k=a.FormaToPGMUtils.createAnimations(_,h);_=_.withAnimations(k)}break;case 1:C=a.FormaToPGMUtils.applyAnimations(e,h,new P.PGMReference(G.TextFormaToPGMMapper.getPGMNodeForTextForma(e,h,n+"-txt#"+r),D));break;case 2:case 6:C=a.FormaToPGMUtils.applyAnimations(e,h,new P.PGMReference(G.TextFormaToPGMMapper.getPGMNodeForTextForma(e,h,n+"-txt-ko#"+r,g.SolidColor.BLACK),D)),_=a.FormaToPGMUtils.applyAnimations(e,h,new P.PGMReference(G.TextFormaToPGMMapper.getPGMNodeForTextForma(e,h,n+"-txt-fg#"+r),D));break;case 9:x>0?R=a.FormaToPGMUtils.applyAnimations(e,h,new P.PGMReference(G.TextFormaToPGMMapper.getPGMNodeForTextForma(e,h,n+"-txt-bg#"+r),D)):C=a.FormaToPGMUtils.applyAnimations(e,h,new P.PGMReference(G.TextFormaToPGMMapper.getPGMNodeForTextForma(e,h,n+"-txt-ko#"+r),D));break;default:_=a.FormaToPGMUtils.applyAnimations(e,h,new P.PGMReference(G.TextFormaToPGMMapper.getPGMNodeForTextForma(e,h,n+"-txt#"+r),D))}}else(y=i.as(l,T.ShapeForma))&&(o+=1,v=a.FormaToPGMUtils.applyAnimations(e,y,F.ShapeFormaToPGMMapper.makePGMRefForShape(e,y,n+"-shp#"+o)));return{shapeRef:v,bottomTextRef:R,textRef:_,knockoutRef:C}}(t),y=l.shapeRef,v=l.bottomTextRef,R=l.textRef,_=l.knockoutRef,C=i.clone(i.opt(i.as(i.opt(y,(function(e){return e.child})),M.PGMSimpleGroup),(function(e){return e.children}))),w=i.clone(i.opt(i.as(i.opt(v,(function(e){return e.child})),M.PGMSimpleGroup),(function(e){return e.children}))),S=i.clone(i.opt(i.as(i.opt(R,(function(e){return e.child})),M.PGMSimpleGroup),(function(e){return e.children}))),E=i.clone(i.opt(i.as(i.opt(_,(function(e){return e.child})),M.PGMSimpleGroup),(function(e){return e.children})));if(null!=E&&null!=C){var N=new M.PGMSimpleGroup(n+"-mask",new m.PGMNodeMetadata(t.formaID,"mask"),p.PGMAnimationList.EMPTY,i.clone(E)),D=new M.PGMSimpleGroup(n+"-art",new m.PGMNodeMetadata(t.formaID,"art"),p.PGMAnimationList.EMPTY,i.clone(C));if(null!=S||null!=w){var b=[];return null!=w&&b.push(new P.PGMReference(new M.PGMSimpleGroup(n+"-bg",new m.PGMNodeMetadata(t.formaID,"text-on-bottom-of-knockout"),p.PGMAnimationList.EMPTY,i.clone(w)))),b.push(new P.PGMReference(new d.PGMFilter(n+"-ko",new m.PGMNodeMetadata(t.formaID,"shape-knocked-out-by-text"),p.PGMAnimationList.EMPTY,[new P.PGMReference(D),new P.PGMReference(N)],new h.PGMMaskFilterSpec(g.SolidColor.WHITE)))),null!=S&&b.push(new P.PGMReference(new M.PGMSimpleGroup(n+"-fg",new m.PGMNodeMetadata(t.formaID,"text-on-top-of-knockout"),p.PGMAnimationList.EMPTY,i.clone(S)))),new M.PGMSimpleGroup(n,new m.PGMNodeMetadata(t.formaID,"lockup-sandwich"),p.PGMAnimationList.EMPTY,i.clone(b))}return new d.PGMFilter(n,new m.PGMNodeMetadata(t.formaID,"simple-text-knockout"),p.PGMAnimationList.EMPTY,[new P.PGMReference(D),new P.PGMReference(N)],new h.PGMMaskFilterSpec(g.SolidColor.WHITE))}var x=[];return null!=C&&(x=x.concat(C)),null!=S&&(x=x.concat(S)),new M.PGMSimpleGroup(n,new m.PGMNodeMetadata(t.formaID,"simple-lockup"),p.PGMAnimationList.EMPTY,i.clone(x))}},props:{makePGMRef:function(e,t,n,o){return a.FormaToPGMUtils.applyAnimations(t,e,new P.PGMReference(r.getPGMForTypeLockup(t,e,e.formaID),new f.PGMCompositingParams(e.placement,e.style.opacity)))},canDoSimpleTransformUpdate:function(e){return!r.usesPageAnchoredStyle(e.forma)}}}),r)},RBTN:function(e,t,n){var r,o=t,i=n("oAGj"),a=n("Bqrn");o.GridToPGMMapper=(r=function(){a.GroupFormaToPGMMapper.call(this)},i.defineClass({name:"GridToPGMMapper",ctor:r,superName:"GroupFormaToPGMMapper",props:{makePGMRef:function(e,t,n,r){return a.GroupFormaToPGMMapper.prototype.makePGMRef.call(this,e,t,n,r)}}}),r)},VJ9E:function(e,t,n){var r,o=t,i=n("oAGj"),a=n("QgZx"),s=n("iCxV"),l=n("3lr5"),u=n("fNpk");o.TheoFont=(r=function(){this.roleOrder=["headline-font","body-font","body-font-italic","body-font-bold","body-font-bold-italic","secondary-font"]},i.defineClass({name:"TheoFont",ctor:r,superName:"CoreObject",statics:{SPARK_FONT_ROLE_HEADLINE:"headline-font",SPARK_FONT_ROLE_BODY:"body-font",SPARK_FONT_ROLE_BODY_ITALIC:"body-font-italic",SPARK_FONT_ROLE_BODY_BOLD:"body-font-bold",SPARK_FONT_ROLE_BODY_BOLD_ITALIC:"body-font-bold-italic",SPARK_FONT_ROLE_SECONDARY:"secondary-font",SPARK_FONT_ROLE_CUSTOM:"custom",decodeJson:function(e,t){if(null==e)return null;var n=i.as(e,["Dictionary","String","Any"]);if(null==n)return u.LegacyCoreAssert.fail("TheoFont.decodeJson: object passed isn't a dictionary",void 0,"TheoFont.decodeJson","TheoFont.swift",106),null;var o,s=i.as(n[a.FontDescriptor.PROPERTY_POSTSCRIPT_NAME],"String");if(o=a.FontDescriptor.decodeJson(e,t)){if(s==o.postScriptName){var l=i.as(n.sparkElementID,"String"),c=i.clone(i.as(n.sparkRoles,["Array","String"]));return r.init_9e5c(o,l,i.clone(c))}return r.init_9e5c(o)}return null}},props:{init_9e5c:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.fontData=e,this.sparkElementID=t,this.sparkRoles=i.clone(n)},init_a314:function(e){this.sparkElementID=e.id,this.sparkRoles=i.clone(e.acRoles);var t,n,r=s.Host.fontProvider.getIncludedFonts(l.ANY_DOCUMENT);(t=e.descriptor)?null!=(n=r.indexOf(t))?this.fontData=r.fontAt(n):(i.opt(s.Host.logging,(function(e){return e.warning("Failed to find brandkit font "+t.postScriptName+" in list of available fonts, using 0th")})),this.fontData=r.fontAt(0)):"faux-font"==e.sourceType?(i.opt(s.Host.logging,(function(e){return e.warning("TheoFont: Failed to find synthesized brandkit font in list of available fonts, using 0th font")})),this.fontData=r.fontAt(0)):(i.opt(s.Host.logging,(function(e){return e.warning("TheoFont: Failed to find brandkit font in list of available fonts, using 0th font")})),this.fontData=r.fontAt(0))},isSparkFont:function(){return null!=this.sparkRoles||null!=this.sparkElementID},getSparkFontRole:function(){if(null==this.sparkRoles)return null;for(var e=i.iter(this.roleOrder);!e.done;e.next()){var t=e.value;if(this.sparkRoles.includes(t))return t}return null},hasSparkFontRole:function(e){return null!=this.sparkRoles&&this.sparkRoles.includes(e)},encodeJson:function(){var e=this.fontData.encodeJson();return null!=this.sparkElementID&&(e.sparkElementID=this.sparkElementID),null!=this.sparkRoles&&(e.sparkRoles=i.clone(this.sparkRoles)),e},isEqual:function(e){var t;return!!(t=i.as(e,r))&&t.fontData.isEqual(this.fontData)&&t.sparkElementID==this.sparkElementID&&t.getSparkFontRole()==this.getSparkFontRole()}}}),r),o._equality_TheoFont_TheoFont=function(e,t){return e.isEqual(t)}},a9ow:function(e,t,n){var r,o,i,a,s,l,u,c,p,f=t,d=n("oAGj"),h=n("qsM9"),m=n("SpAV"),P=n("dJuF"),M=n("QgZx"),g=n("iCxV"),T=n("fNpk"),F=n("Zifs");f.TextAttribute=(r=function(e){this.value_=e},d.defineClass({name:"TextAttribute",ctor:r,superName:"CoreObject",statics:{PROPERTY_VALUE:"value",PROPERTY_START:"start",PROPERTY_LENGTH:"length"},props:{isEqual:function(e){return m.CoreAssert.fail("unimplemented override of isEqual",void 0,"TextAttribute.isEqual","TextAttribute.swift",23),!1},hash:{get:function(){return m.CoreAssert.fail("unimplemented override of hash",void 0,"TextAttribute","TextAttribute.swift",28),0}},description:{get:function(){return T.LegacyCoreAssert.fail("missing override of description",void 0,"TextAttribute","TextAttribute.swift",33),"TextAttribute"}},clone:function(){return new r(this.value_)}}}),r),f.UTF16Attribute=(o=function(e){f.TextAttribute.call(this,e)},d.defineClass({name:"UTF16Attribute",ctor:o,superName:"TextAttribute",statics:{NAME:{get:function(){return"text"}},codec:{get:function(){var e,t="UTF16Attribute";return P.DBPropertyCodec.typeCodec(t)||P.DBPropertyCodec.registerCodec(t,P.DBPropertyCodec.codec((function(e,n,r){var i,a=P.DBProperty.deleted(e);return(i=d.as(n,o))&&(a=P.DBProperty.dictEncoded(e,{start:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_START),0),length:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_LENGTH),0),value:P.DBProperty.stringProperty(e.append(f.TextAttribute.PROPERTY_VALUE),i.value)},t)),a}),(function(t,n){var r;return((e=d.opt(t,(function(e){return e.isDictionary})))||null!=e)&&e&&null!=(r=d.opt(t.getDictionaryProperty(f.TextAttribute.PROPERTY_VALUE),(function(e){return e.stringValue})))?new o(r):null}),t))}}},props:{value:{get:function(){return this.value_}},isEqual:function(e){var t;return!!(t=d.as(e,o))&&t.value==this.value},hash:{get:function(){return d.hashValue(this.value)}},description:{get:function(){return this.value}},clone:function(){return new o(this.value)}}}),o),f.FontDescriptorAttribute=(i=function(e){f.TextAttribute.call(this,e)},d.defineClass({name:"FontDescriptorAttribute",ctor:i,superName:"TextAttribute",statics:{NAME:{get:function(){return"font-name"}},codec:{get:function(){var e,t="FontDescriptorAttribute";return P.DBPropertyCodec.typeCodec(t)||P.DBPropertyCodec.registerCodec(t,P.DBPropertyCodec.codec((function(e,n,r){var o,a=P.DBProperty.deleted(e);return(o=d.as(n,i))&&(a=P.DBProperty.dictEncoded(e,{start:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_START),0),length:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_LENGTH),0),value:h.Codecs.fontDescriptorCodec.encode(e.append(f.TextAttribute.PROPERTY_VALUE),o.value_,r)},t)),a}),(function(t,n){var r;return((e=d.opt(t,(function(e){return e.isDictionary})))||null!=e)&&e&&(r=d.as(h.Codecs.fontDescriptorCodec.decode(t.getDictionaryProperty(f.TextAttribute.PROPERTY_VALUE),n),M.FontDescriptor))?new i(r):null}),t))}}},props:{postscriptName:{get:function(){return this.value.postScriptName}},value:{get:function(){var e;return(e=d.as(this.value_,M.FontDescriptor))||null!=e?e:g.Host.textModelUtils.defaultFont()}},isEqual:function(e){var t;return!!(t=d.as(e,i))&&(t.value===this.value||d.eq(M._equality_FontDescriptor_FontDescriptor,t.value,this.value))},hash:{get:function(){return this.value.hash}},description:{get:function(){return this.value.postScriptName}},clone:function(){return new i(this.value)}}}),i),f.FontSizeAttribute=(a=function(e){f.TextAttribute.call(this,e)},d.defineClass({name:"FontSizeAttribute",ctor:a,superName:"TextAttribute",statics:{NAME:{get:function(){return"font-size"}},codec:{get:function(){var e,t="FontSizeAttribute";return P.DBPropertyCodec.typeCodec(t)||P.DBPropertyCodec.registerCodec(t,P.DBPropertyCodec.codec((function(e,n,r){var o,i=P.DBProperty.deleted(e);return(o=d.as(n,a))&&(i=P.DBProperty.dictEncoded(e,{start:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_START),0),length:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_LENGTH),0),value:P.DBProperty.doubleProperty(e.append(f.TextAttribute.PROPERTY_VALUE),o.value)},t)),i}),(function(t,n){var r;return((e=d.opt(t,(function(e){return e.isDictionary})))||null!=e)&&e&&null!=(r=d.opt(t.getDictionaryProperty(f.TextAttribute.PROPERTY_VALUE),(function(e){return e.doubleValue})))?new a(r):null}),t))}}},props:{value:{get:function(){return this.value_}},isEqual:function(e){var t;return!!(t=d.as(e,a))&&t.value==this.value},hash:{get:function(){return d.hashValue(this.value)}},description:{get:function(){return this.value}},clone:function(){return new a(this.value)}}}),a),f.FontColorAttribute=(s=function(e){f.TextAttribute.call(this,e)},d.defineClass({name:"FontColorAttribute",ctor:s,superName:"TextAttribute",statics:{NAME:{get:function(){return"font-color"}},codec:{get:function(){var e,t="FontColorAttribute";return P.DBPropertyCodec.typeCodec(t)||P.DBPropertyCodec.registerCodec(t,P.DBPropertyCodec.codec((function(e,n,r){var o,i=P.DBProperty.deleted(e);return(o=d.as(n,s))&&(i=P.DBProperty.dictEncoded(e,{start:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_START),0),length:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_LENGTH),0),value:h.Codecs.solidColorCodec.encode(e.append(f.TextAttribute.PROPERTY_VALUE),o.value_,r)},t)),i}),(function(t,n){var r;return((e=d.opt(t,(function(e){return e.isDictionary})))||null!=e)&&e&&(r=d.as(h.Codecs.solidColorCodec.decode(t.getDictionaryProperty(f.TextAttribute.PROPERTY_VALUE),n),F.SolidColor))?new s(r):null}),t))}}},props:{value:{get:function(){return this.value_}},isEqual:function(e){var t;return!!(t=d.as(e,s))&&d.eq(F._equality_SolidColor_SolidColor,t.value,this.value)},hash:{get:function(){return this.value.hash}},description:{get:function(){return this.value.asString}},clone:function(){return new s(this.value)}}}),s),f.FontStrokeColorAttribute=(l=function(e){f.TextAttribute.call(this,e)},d.defineClass({name:"FontStrokeColorAttribute",ctor:l,superName:"TextAttribute",statics:{NAME:{get:function(){return"font-strokecolor"}},codec:{get:function(){var e,t="FontStrokeColorAttribute";return P.DBPropertyCodec.typeCodec(t)||P.DBPropertyCodec.registerCodec(t,P.DBPropertyCodec.codec((function(e,n,r){var o,i=P.DBProperty.deleted(e);return(o=d.as(n,l))&&(i=P.DBProperty.dictEncoded(e,{start:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_START),0),length:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_LENGTH),0),value:h.Codecs.solidColorCodec.encode(e.append(f.TextAttribute.PROPERTY_VALUE),o.value_,r)},t)),i}),(function(t,n){var r;return((e=d.opt(t,(function(e){return e.isDictionary})))||null!=e)&&e&&(r=d.as(h.Codecs.solidColorCodec.decode(t.getDictionaryProperty(f.TextAttribute.PROPERTY_VALUE),n),F.SolidColor))?new l(r):null}),t))}}},props:{value:{get:function(){return this.value_}},isEqual:function(e){var t;return!!(t=d.as(e,l))&&d.eq(F._equality_SolidColor_SolidColor,t.value,this.value)},hash:{get:function(){return this.value.hash}},description:{get:function(){return this.value.asString}},clone:function(){return new l(this.value)}}}),l),f.FontStrokeWidthAttribute=(u=function(e){f.TextAttribute.call(this,e)},d.defineClass({name:"FontStrokeWidthAttribute",ctor:u,superName:"TextAttribute",statics:{NAME:{get:function(){return"font-strokewidth"}},codec:{get:function(){var e,t="FontStrokeWidthAttribute";return P.DBPropertyCodec.typeCodec(t)||P.DBPropertyCodec.registerCodec(t,P.DBPropertyCodec.codec((function(e,n,r){var o,i=P.DBProperty.deleted(e);return(o=d.as(n,u))&&(i=P.DBProperty.dictEncoded(e,{start:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_START),0),length:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_LENGTH),0),value:P.DBProperty.doubleProperty(e.append(f.TextAttribute.PROPERTY_VALUE),o.value)},t)),i}),(function(t,n){var r;return((e=d.opt(t,(function(e){return e.isDictionary})))||null!=e)&&e&&null!=(r=d.opt(t.getDictionaryProperty(f.TextAttribute.PROPERTY_VALUE),(function(e){return e.doubleValue})))?new u(r):null}),t))}}},props:{value:{get:function(){return this.value_}},isEqual:function(e){var t;return!!(t=d.as(e,u))&&t.value==this.value},hash:{get:function(){return d.hashValue(this.value)}},description:{get:function(){return this.value}},clone:function(){return new u(this.value)}}}),u),f.TextLookAttribute=(c=function(e){f.TextAttribute.call(this,e)},d.defineClass({name:"TextLookAttribute",ctor:c,superName:"TextAttribute",statics:{NAME:{get:function(){return"text-look"}},codec:{get:function(){var e,t="TextLookAttribute";return P.DBPropertyCodec.typeCodec(t)||P.DBPropertyCodec.registerCodec(t,P.DBPropertyCodec.codec((function(e,n,r){var o,i=P.DBProperty.deleted(e);return(o=d.as(n,c))&&(i=P.DBProperty.dictEncoded(e,{start:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_START),0),length:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_LENGTH),0),value:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_VALUE),o.value)},t)),i}),(function(t,n){var r;return((e=d.opt(t,(function(e){return e.isDictionary})))||null!=e)&&e&&null!=(r=d.opt(t.getDictionaryProperty(f.TextAttribute.PROPERTY_VALUE),(function(e){return e.intValue})))?new c(r):null}),t))}}},props:{value:{get:function(){return this.value_}},isEqual:function(e){var t;return!!(t=d.as(e,c))&&t.value==this.value},hash:{get:function(){return d.hashValue(this.value)}},description:{get:function(){return this.value}},clone:function(){return new c(this.value)}}}),c),f.TrackingAttribute=(p=function(e){f.TextAttribute.call(this,e)},d.defineClass({name:"TrackingAttribute",ctor:p,superName:"TextAttribute",statics:{NAME:{get:function(){return"tracking"}},codec:{get:function(){var e,t="TrackingAttribute";return P.DBPropertyCodec.typeCodec(t)||P.DBPropertyCodec.registerCodec(t,P.DBPropertyCodec.codec((function(e,n,r){var o,i=P.DBProperty.deleted(e);return(o=d.as(n,p))&&(i=P.DBProperty.dictEncoded(e,{start:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_START),0),length:P.DBProperty.intProperty(e.append(f.TextAttribute.PROPERTY_LENGTH),0),value:P.DBProperty.doubleProperty(e.append(f.TextAttribute.PROPERTY_VALUE),o.value)},t)),i}),(function(t,n){var r;return((e=d.opt(t,(function(e){return e.isDictionary})))||null!=e)&&e&&null!=(r=d.opt(t.getDictionaryProperty(f.TextAttribute.PROPERTY_VALUE),(function(e){return e.doubleValue})))?new p(r):null}),t))}}},props:{value:{get:function(){return this.value_}},isEqual:function(e){var t;return!!(t=d.as(e,p))&&t.value==this.value},hash:{get:function(){return d.hashValue(this.value)}},description:{get:function(){return this.value}},clone:function(){return new p(this.value)}}}),p)},"dX/e":function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("VQVe"),l=n("6ZWm"),u=n("7Pku"),c=n("w/+j"),p=n("Qlvz"),f=n("NkBu"),d=n("U010"),h=n("fdtz"),m=n("SDdr"),P=n("lmwz"),M=n("uWOl"),g=n("fNpk"),T=n("Ird5"),F=n("WjWV"),A=n("Iv44"),G=n("GDe9"),y=n("jfma"),v=n("ZTPx"),R=n("+ASD"),_=n("dmHI"),C=n("jfiy"),w=n("bauG"),S=n("jSYS"),E=n("vTQu"),N=n("yjxF"),D=n("dz2e"),b=n("Aj79"),x=n("sJQG"),O=n("44Iz"),k=n("JQ9Y"),I=n("g6aL"),L=n("zW52"),Y=n("Zifs");i.ImageFormaToPGMMapper=(r=function e(){u.FormaToPGMMapper.call(this,e.FORMA_KIND)},o={},a.defineClass({name:"ImageFormaToPGMMapper",ctor:r,superName:"FormaToPGMMapper",statics:{FORMA_KIND:{get:function(){return void 0===o.FORMA_KIND&&(o.FORMA_KIND=h.ImageForma.KIND),o.FORMA_KIND}},instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}},createMapper:function(e){return r.instance}},props:{canDoSimpleTransformUpdate:function(e){var t,n;return!((t=P.ImageFacade.getFrameFormaForForma(e.forma))&&(n=a.as(t.controller,l.FrameController))&&n.hasCutout)&&u.FormaToPGMMapper.prototype.canDoSimpleTransformUpdate.call(this,e)},getCutoutImageRef:function(e){var t,n,r,o,i;if((t=P.ImageFacade.getFrameFormaForForma(e))&&(n=a.as(t.controller,l.FrameController))&&(r=n.cutout)&&(o=r.bounds)&&null!=(i=r.contentID)){g.LegacyCoreAssert.isTrue(n.cutoutMode==d.CutoutMode.BackgroundRemoval,"Only BackgroundRemoval type is supported",void 0,"ImageFormaToPGMMapper.getCutoutImageRef","ImageFormaToPGMMapper.swift",55);var s=new w.PGMImage(r.formaID,new N.PGMNodeMetadata(r.formaID,"image"),T.PGMAnimationList.EMPTY,o,i);return new b.PGMReference(s,new y.PGMCompositingParams(r.placement,1))}return null},makePGMRef:function(e,t,n,r){var o,i,s;if((i=a.as(e,h.ImageForma))&&null!=(s=i.contentID)){var l;if(l=i.bounds){var u,p,f=new w.PGMImage(i.formaID,new N.PGMNodeMetadata(i.formaID,"image"),T.PGMAnimationList.EMPTY,l,s),d=new y.PGMCompositingParams(i.placement,i.style.opacity);if(p=this.getCutoutImageRef(i)){var m=new b.PGMReference(f,d);u=this.applyMask(m,p),d=y.PGMCompositingParams.DEFAULT}else u=f;var P=null,M=0;t==O.PGMExportSettings.DYNAMIC&&null!=i.animation&&(P=a.opt(i.animation,(function(e){return e.animationStyle.name})),M=(o=a.opt(i.animation,(function(e){return e.animationStyle.variant})))||null!=o?o:0);var F=this.applyFilters(P,M,i.style,u,f,i.controller),A=new b.PGMReference(F,d),G=c.FormaToPGMUtils.applyAnimations(t,e,A);return this.applyStillAnimations(e,G)}return g.LegacyCoreAssert.fail("ImageFormaToPGMMapper: image is missing bounds or content ID",void 0,"ImageFormaToPGMMapper.makePGMRef","ImageFormaToPGMMapper.swift",158),null}return g.LegacyCoreAssert.fail("ImageFormaToPGMMapper called for something that's not an ImageForma",void 0,"ImageFormaToPGMMapper.makePGMRef","ImageFormaToPGMMapper.swift",163),null},applyFilters:function(e,t,n,r,o,i){var l,u,c,d=r,m=!0;if((l=a.as(i,f.ImageController))&&(u=a.as(l.forma,h.ImageForma))&&(m=!(l.floating||u.hasAlpha())),c=a.as(n,M.ImageStyle)){var P,g=!1;if(P=c.adjustments){var T=p.ImageAdjustments.createDefault();g=P.blur!=T.blur,P.sharpness!=T.sharpness&&(d=this.applySharpen(P,d,o,m)),d=this.applyColorAdjustments(P,d)}var A=d;if(d=this.applyStyleEffects(c,d,o,m),e==s.AnimationStyle.NAME_GRAYSCALE){var G=c.colors,y=a.opt(a.opt(G.library,(function(e){return e.color("themeDerivedDark")})),(function(e){return e.rgbColor}))||Y.SolidColor.BLACK,v=a.opt(a.opt(G.library,(function(e){return e.color("themeDerivedLight")})),(function(e){return e.rgbColor}))||Y.SolidColor.WHITE,_=this.wrapInFilter([A],"Greyscale",new R.PGMDuotoneFilterSpec(y,v,1));d=this.wrapInFilter([d,_],"AnimationBlend",new F.PGMBlendFilterSpec([0,1]))}else if(e==s.AnimationStyle.NAME_FILL){var w=Y.SolidColor.BLACK;(E=a.as(i,f.ImageController))&&(N=a.as(E.forma,h.ImageForma))&&(b=a.clone(N.page.colorLibraryController.getThemeColorKeys())).length>t&&(w=N.page.colorLibraryController.getSolidColorForKey(a.as(b[t],"String"))||Y.SolidColor.BLACK);var S=this.wrapInFilter([A],s.AnimationStyle.NAME_FILL,new C.PGMFillFilterSpec(w));d=this.wrapInFilter([d,S],"AnimationBlend",new F.PGMBlendFilterSpec([0,1]))}else if(e==s.AnimationStyle.NAME_COLOR){var E,N,b,x=Y.SolidColor.BLACK;(E=a.as(i,f.ImageController))&&(N=a.as(E.forma,h.ImageForma))&&(b=a.clone(N.page.colorLibraryController.getThemeColorKeys())).length>t&&(x=N.page.colorLibraryController.getSolidColorForKey(a.as(b[t],"String"))||Y.SolidColor.BLACK);var O=this.wrapInFilter([A],s.AnimationStyle.NAME_COLOR,new D.PGMOverlayFilterSpec(x));d=this.wrapInFilter([d,O],"AnimationBlend",new F.PGMBlendFilterSpec([1,0]))}g&&(d=this.applyBlur(c.adjustments.scaledBlur,d,o,m)),e==s.AnimationStyle.NAME_BLUR&&(d=this.applyBlur(0,d,o,m))}return d},getRootAnimation:function(e){for(var t=e;null!=t.parent;)t=t.parent;return t.animation},applyStillAnimations:function(e,t){var n;if(n=e.animation){var r,o,i=n.animationStyle;if((i.name==s.AnimationStyle.NAME_ZOOM||i.name==s.AnimationStyle.NAME_PAN)&&(r=this.getRootAnimation(e))&&n.endTime.earlierThan(r.endTime)&&(o=a.as(t.animations.animations.find((function(e){return e instanceof L.PGMTransformAnimation&&e.timeFn.domain.contains(i.endTime.seconds)}),this),L.PGMTransformAnimation))){var l=new x.PGMRange(i.endTime.seconds,r.endTime.seconds),u=new S.PGMLinearFunction(l,new x.PGMRange(1,1)),c=new L.PGMTransformAnimation(u,o.endXBounds,o.endXBounds),p=t.animations.append(c);return t.withAnimations(p)}}return t},applyMask:function(e,t){return this.wrapRefsInFilter([e,t],"CutoutMask",new E.PGMMaskFilterSpec)},applySharpen:function(e,t,n,r){var o=t,i=e.scaledSharpness/4,a=o;return o=this.wrapInFilter([a],"Blur",new A.PGMBlurFilterSpec(r,i,n.entity)),o=this.wrapInFilter([a,o],"Sharpen_mixback",new F.PGMBlendFilterSpec([1.5,-.5]))},applyBlur:function(e,t,n,r){var o=t;return o=this.wrapInFilter([o],"Blur",new A.PGMBlurFilterSpec(r,e,n.entity))},applyColorAdjustments:function(e,t){var n=t,r=p.ImageAdjustments.createDefault(),o=e.copyWithNewValues(r.blur,r.sharpness);return o.equals(r)||(n=this.wrapInFilter([n],"ColorAdjustment",new G.PGMColorAdjustmentFilterSpec(o.shadows,o.highlights,o.saturation,o.brightness,o.exposure,o.contrast,o.warmth,o.tint,o.fade,o.vibrance))),n},applyStyleEffects:function(e,t,n,r){var o,i=t;if(o=a.as(e.filter,m.CompositeFilter)){var s,l;if(1!=o.contrast?i=this.wrapInFilter([i],o.name+"_contrast",v.PGMColorTransformFilterSpec.createContrastTransform(o.contrast)):o.grayscale&&(i=this.wrapInFilter([i],o.name,new R.PGMDuotoneFilterSpec(Y.SolidColor.BLACK,Y.SolidColor.WHITE,1))),(s=o.colors)&&(l=s.fieldPrimary))switch(o.blend){case"normal":var u;i=(u=s.fieldSecondary)?this.wrapInFilter([i],o.name,new R.PGMDuotoneFilterSpec(l,u,1)):this.wrapInFilter([i],o.name,new C.PGMFillFilterSpec(l));break;case"overlay":i=this.wrapInFilter([i],o.name+"_overlay",new D.PGMOverlayFilterSpec(l));break;case"screen":i=this.wrapInFilter([i],o.name,new k.PGMScreenFilterSpec(l));break;case"multiply":i=this.wrapInFilter([i],o.name,v.PGMColorTransformFilterSpec.createColorizeTransform(l))}if(o.blurRadius>.05&&(i=this.wrapInFilter([i],o.name,new A.PGMBlurFilterSpec(r,o.blurRadius,n.entity))),1!=o.mix){var c=new I.PGMSimpleGroup(i.entity+"-mix-filtered",new N.PGMNodeMetadata(i.meta.id,"filter-"+o.name+"-mix-opacity"),T.PGMAnimationList.EMPTY,[new b.PGMReference(i)]),p=new b.PGMReference(c,y.PGMCompositingParams.DEFAULT.withOpacity(o.mix),T.PGMAnimationList.EMPTY);i=new I.PGMSimpleGroup(i.entity+"-mix",new N.PGMNodeMetadata(i.meta.id,"filter-"+o.name+"-mix"),T.PGMAnimationList.EMPTY,[new b.PGMReference(t),p])}}return i},wrapInFilter:function(e,t,n){var r=e.map((function(e){return new b.PGMReference(e)}),this);return this.wrapRefsInFilter(a.clone(r),t,n)},wrapRefsInFilter:function(e,t,n){var r=e[0].child.entity+"-"+t,o=new N.PGMNodeMetadata(e[0].child.meta.id,"filter-"+t),i=T.PGMAnimationList.EMPTY;return new _.PGMFilter(r,o,i,a.clone(e),n)}}}),r)},hndY:function(e,t,n){var r,o,i,a=t,s=n("oAGj"),l=n("OdB2"),u=n("Bcdx"),c=n("w/+j"),p=n("P83h"),f=n("iCxV"),d=n("IUM5"),h=n("fNpk"),m=n("K17h"),P=n("sq5L"),M=n("bauG"),g=n("euLT"),T=n("PlOi"),F=n("b94u"),A=n("ZA1K"),G=n("bAjp"),y=n("mj5y"),v=n("s3Tu"),R=n("t+nd"),_=n("fnrT"),C=n("uYSz"),w=n("KDc2"),S=n("T6jX"),E=n("sIWg"),N=n("qSCS");a.FormaDamage=(r=function(){this.descendants=!1,this.transform=!1},s.defineClass({name:"FormaDamage",ctor:r,props:{onlyTransform:function(){return!this.descendants&&this.transform},onlyDescendants:function(){return this.descendants&&!this.transform}}}),r),a.FormaPGMCacheEntry=(o=function(e,t){this.damage=null,this.forma=e,this.ref=t},s.defineClass({name:"FormaPGMCacheEntry",ctor:o,props:{addDamage:function(){return null==this.damage&&(this.damage=new a.FormaDamage),this.damage},damageDescendants:function(){this.addDamage().descendants=!0},damageTransform:function(){this.addDamage().transform=!0}}}),o),a.FormaPGMCache=(i=function(e,t,n){this.graph_=null,this.formaCache_={},this.mappers=u.FormaToPGMMapperFactory.instance,this.cachedGraphRef_=null,this.cachedGraph_=P.PGMGraph.EMPTY,this.validationCount_=0,this.fastValidationCount_=0,this.pageSubscription_=null,this.page=e,this.settings=t,this.adhoc=n,this.log=h.LegacyCoreAssert.newLog("FormaPGMCache-"+t.asString),this.pageSubscription_=e.subscribe(this,l.FormaEndUpdateMessage.TYPE)},s.defineClass({name:"FormaPGMCache",ctor:i,statics:{reportedFailures:{},failOnce:function(e){var t;((t=i.reportedFailures[e])||null!=t)&&t||(i.reportedFailures[e]=!0,h.LegacyCoreAssert.fail(e,void 0,"FormaPGMCache.failOnce","FormaPGMCache.swift",385))},_implements:function(e){return"TheoMessageSubscriber"==e||"FormaToPGMFactory"==e}},props:{destroy:function(){var e;(e=this.pageSubscription_)&&(s.opt(this.page,(function(t){return t.unsubscribe(e)})),this.pageSubscription_=null),s.removeAll(this.formaCache_)},onMessage:function(e){var t;if(t=s.as(e,l.FormaEndUpdateMessage)){var n,r,o=t.event.forma,i=!0;if((n=o)&&(r=this.formaCache_[n.formaID])&&(t.event instanceof p.FormaTransformChangedEvent?r.damageTransform():t.event instanceof p.FormaNullChangedEvent||t.event instanceof p.FormaAlignmentChangedEvent?i=!1:t.event instanceof p.FormaAnimationChangedEvent?this.settings.asDynamic?(this.log.info("animation changed invalidation on "+n.kind),s.removeKey(this.formaCache_,n.formaID)):i=!1:s.removeKey(this.formaCache_,n.formaID),o=n.parent),i){for(;null!=o;)s.opt(this.formaCache_[o.formaID],(function(e){return e.damageDescendants()})),o=o.parent;this.graph_=null}}},getPGMReferenceForForma:function(e){var t,n=this.formaCache_[e.formaID];if(t=this.mappers.getMapper(e)){var r,o;if(r=n){var s;if(!(s=r.damage))return r.ref;if(s.onlyTransform()&&t.canDoSimpleTransformUpdate(r))return r.ref=r.ref.withPlacement(e.placement),r.damage=null,r.ref}return this.validationCount_+=1,(o=t.makePGMRef(e,this.settings,this,n))?o.child instanceof g.PGMNullNode?null:(this.formaCache_[e.formaID]=new a.FormaPGMCacheEntry(e,o),o):(i.failOnce("Mapper at path "+S.TheoDocumentUtils.debugFormaPath(e)+" did not produce a reference."),null)}return i.failOnce("No pgm mapper available at path "+S.TheoDocumentUtils.debugFormaPath(e)+" "),null},childReferences:function(e){for(var t=[],n=s.iter(e.childrenAsArray);!n.done;n.next()){var r,o=n.value;(r=this.getPGMReferenceForForma(o))&&t.push(r)}return t},referenceForForma:function(e){return this.getPGMReferenceForForma(e)},getGraph:function(){return this.validate(),this.graph_},resourcesForGraph:function(e){var t=this,n={},r={};return e.visit((function(e){var o,a,l,u,p,h,m=null;if(o=s.as(e,M.PGMImage))m=o.contentID;else if(a=s.as(e,v.PGMVideo))m=a.contentID;else if(l=s.as(e,A.PGMSVG))m=l.contentID;else if(u=s.as(e,G.PGMText)){var P,g=u.style.font.postScriptName;if(null==r[g]&&(r[g]=u.style.font,(y=s.opt(t.page,(function(e){return e.document})))&&(P=s.opt(f.Host.fontProvider,(function(e){return e.descriptorForPostScriptName(g,y)}))))){var F;switch(P.source){case 2:F=new _.StorageSpecApplicationResource(d.CATEGORY_ID_FONT,d.FONT_RESOURCE_ID_EMBEDDED_PREFIX+g);break;case 1:case 3:F=new _.StorageSpecApplicationResource(d.CATEGORY_ID_FONT,d.FONT_RESOURCE_ID_SPARK_PREFIX+g);break;case 4:var y,S;(y=s.opt(t.page,(function(e){return e.document})))&&(S=s.opt(f.Host.brandkitManager,(function(e){return e.brandkitForDocument(y)})))?F=new C.StorageSpecExternalCC(C.StorageSpecExternalCC.BRANDKIT_SYNC_GROUP,S.id,null,g,null,null,null):(i.failOnce("can't obtain a brandkit for a custom font "+g),F=new w.StorageSpecInvalid);break;case 5:case 6:F=new R.StorageSpecAdobeFont(g);break;default:i.failOnce("unexpected font source for "+g),F=new w.StorageSpecInvalid}n["font:"+g]=new T.PGMResourceProvider("font/otf",F)}}null!=(p=m)&&(y=s.opt(t.page,(function(e){return e.document})))&&null==n[p]&&((h=s.as(y.content.nodeByID(p),N.URLBasedContentNode))?n[p]=c.FormaToPGMUtils.createResourceProviderForContentNode(h):i.failOnce("couldn't look up content by ID; no resource available"))})),new F.PGMResourceProviderList(s.clone(n))},getGraphForForma:function(e){var t;return(t=this.getPGMReferenceForForma(e))?(t===this.cachedGraphRef_||(this.cachedGraph_=new P.PGMGraph(t.child,e.bounds,this.settings.asDynamic?y.PGMUtils.calculateDuration(t):0,this.resourcesForGraph(t.child)),this.cachedGraphRef_=t),this.cachedGraph_):(i.failOnce("getGraphForForma: couldn't get a reference from which to build a graph."),null)},validate:function(){var e,t;if(null==this.graph_&&(e=this.page))if(this.validationCount_=0,this.fastValidationCount_=0,t=this.getPGMReferenceForForma(e.root)){var n=0;if(this.settings.asDynamic){var r,o=!1;(r=e.animationController.animationStyle)&&(o=!r.isNoStyle()),n=o?m.MotionUtils.determineTotalDuration(e).seconds:y.PGMUtils.calculateDuration(t)}this.log.info("validate: "+this.validationCount_+" slow, "+this.fastValidationCount_+" fast");var a=e.pageSize;this.graph_=new P.PGMGraph(t.child,E.TheoRect.fromSize(a),n,this.resourcesForGraph(t.child))}else i.failOnce("failed to generate a reference for root")}}}),i)},kwVJ:function(e,t,n){var r,o=t,i=n("oAGj"),a=n("IUM5"),s=n("tGKA"),l=n("Ird5"),u=n("jfma"),c=n("sq5L"),p=n("bauG"),f=n("yjxF"),d=n("Aj79"),h=n("PlOi"),m=n("g6aL"),P=n("fnrT"),M=n("sIWg");o.PGMWatermarkingUtils=(r=function(){},i.defineClass({name:"PGMWatermarkingUtils",ctor:r,statics:{WATERMARK_ENTITY:"watermark",WATERMARK_GROUP_ENTITY:"add-watermark-group",WATERMARK_CONTENT_TYPE:"image/png",WATERMARK_RESOURCE_ID:"watermark-spark.png",WATERMARK_V2_RESOURCE_ID:"watermark-spark-v2.png",WATERMARK_WIDTH:380,WATERMARK_HEIGHT:80,WATERMARK_SCALE:.5,addWatermark:function(e){var t,n,o=new p.PGMImage(r.WATERMARK_ENTITY,f.PGMNodeMetadata.EMPTY,l.PGMAnimationList.EMPTY,M.TheoRect.fromXYWH(0,0,r.WATERMARK_WIDTH,r.WATERMARK_HEIGHT),r.WATERMARK_V2_RESOURCE_ID),g=new d.PGMReference(o,new u.PGMCompositingParams(s.Matrix2D.translationXY(e.bounds.width-r.WATERMARK_WIDTH,e.bounds.height-r.WATERMARK_HEIGHT).scaleXYfromPoint(e.bounds.evalXY(1,1),r.WATERMARK_SCALE,r.WATERMARK_SCALE)));return t=(n=i.as(e.root,m.PGMSimpleGroup))?n.withEntityAndChildren(n.entity,n.children.concat([g])):new m.PGMSimpleGroup(r.WATERMARK_GROUP_ENTITY,f.PGMNodeMetadata.EMPTY,l.PGMAnimationList.EMPTY,[new d.PGMReference(e.root),g]),new c.PGMGraph(t,e.bounds,e.duration,e.resources.adding(o.contentID,new h.PGMResourceProvider(r.WATERMARK_CONTENT_TYPE,new P.StorageSpecApplicationResource(a.CATEGORY_ID_IMAGES,r.WATERMARK_V2_RESOURCE_ID))))}}}),r)},mGL3:function(e,t,n){var r,o=t,i=n("oAGj"),a=n("gXiO"),s=n("QgZx"),l=n("ZhwN"),u=n("iCxV"),c=n("fNpk");o.OrderedFontSet=(r=function(){this.descriptors_=[],this.familyKeys_=[],this.familyFaces_=[],this.clock_=0,this.fontSetID=l.GUIDUtils.makeGUID(),a.CoreObject.call(this)},i.defineClass({name:"OrderedFontSet",ctor:r,superName:"CoreObject",statics:{fromList:function(e){for(var t=new r,n=i.iter(e);!n.done;n.next()){var o=n.value;t.append(o)}return t}},props:{descriptors:{get:function(){return this.descriptors_.concat()}},count:{get:function(){return this.descriptors_.length}},familyCount:{get:function(){return this.familyKeys_.length}},familyAt:function(e){return i.as(this.familyKeys_[e],"String")},facesInFamily:function(e){var t=i.indexOf(this.familyKeys_,e);return null==t?(i.opt(u.Host.logging,(function(t){return t.warning("Invalid family ("+e+") in facesInFamily()")})),null):i.sort(this.familyFaces_[t],(function(e,t){var n=e.source==s.FontSource.TYPEKIT_PREMIUM||e.source==s.FontSource.TYPEKIT_FREE,r=t.source==s.FontSource.TYPEKIT_PREMIUM||t.source==s.FontSource.TYPEKIT_FREE;return!(!n||r)||!(!n&&r)&&(0==e.usWeightClass||0==t.usWeightClass?e.weight==t.weight?(e.italic||0!=e.italicAngle)==(t.italic||0!=t.italicAngle)?e.label.length<t.label.length:!e.italic&&0==e.italicAngle:e.weight<t.weight:e.usWeightClass==t.usWeightClass?e.usWidthClass==t.usWidthClass?e.weight==t.weight?(e.italic||0!=e.italicAngle)==(t.italic||0!=t.italicAngle)?e.label.length<t.label.length:!e.italic&&0==e.italicAngle:e.weight<t.weight:e.usWidthClass<t.usWidthClass:e.usWeightClass<t.usWeightClass)}))},defaultFaceInFamily:function(e){var t=i.clone(this.facesInFamily(e)||[]);function n(e){for(var n=i.iter(t);!n.done;n.next()){var r=n.value;if(r.displayFaceName.includes(e))return r}return null}c.LegacyCoreAssert.isTrue(0==!t.length,"facesInFamily is empty",{family:e},"OrderedFontSet.defaultFaceInFamily","OrderedFontSet.swift",111);for(var r=i.iter(["Regular","Normal","Plain","Book","Display"]);!r.done;r.next())if(o=n(r.value))return o;for(var o,a,s=1e5,l=1e5,u=i.iter(t);!u.done;u.next()){var p=u.value,f=p.usWeightClass;f=0==f?p.weight:f,!p.italic&&Math.abs(f-400)<s?(s=Math.abs(f-400),o=p):p.italic&&Math.abs(f-400)<l&&(l=Math.abs(f-400),a=p)}return null!=o?o:null!=a?a:i.first(t)},fontAt:function(e){return e<0||e>=this.descriptors_.length?(c.LegacyCoreAssert.fail("Invalid index in fontAt()",{index:e},"OrderedFontSet.fontAt","OrderedFontSet.swift",165),null):this.descriptors_[e]},forEach:function(e){this.descriptors_.forEach(e)},indexOf:function(e){return i.indexOfEq(this.descriptors_,e,s._equality_FontDescriptor_FontDescriptor)},getIndexOfPostScriptName:function(e){for(var t=0,n=i.iter(this.descriptors_);!n.done;n.next()){if(n.value.postScriptName==e)return t;t+=1}return null},filter:function(e){return this.descriptors_.filter(e,this)},find:function(e){return this.descriptors_.find(e,this)},append:function(e){if(!this.contains(e)){this.clock_+=1,this.descriptors_.push(e);var t=e.displayFamilyName,n=i.indexOf(this.familyKeys_,t);null==n&&(this.familyKeys_.push(t),this.familyFaces_.push([])),n=i.indexOf(this.familyKeys_,t),this.familyFaces_[n].push(e)}},contains:function(e){return i.containsEq(this.descriptors_,e,s._equality_FontDescriptor_FontDescriptor)},remove:function(e){this.clock_+=1,i.remove(this.descriptors_,e);var t=e.displayFamilyName,n=i.indexOf(this.familyKeys_,t);if(null!=n){var r=this.familyFaces_[n];i.remove(r,e),0==r.length&&(i.remove(this.familyKeys_,t),this.familyFaces_.splice(n,1))}},clone:function(){var e=new r;return this.descriptors_.forEach((function(t){return e.append(t)})),e},sort:function(){var e=i.sort(this.descriptors_,(function(e,t){return e.postScriptName>t.postScriptName}));this.descriptors_=[];for(var t=i.iter(e);!t.done;t.next()){var n=t.value;this.descriptors_.push(n)}},revisionNumber:{get:function(){return this.clock_}}}}),r)},"pR+7":function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("7Pku"),l=n("w/+j"),u=n("fNpk"),c=n("Ird5"),p=n("jLWG"),f=n("jfma"),d=n("yjxF"),h=n("Aj79"),m=n("Ucb9"),P=n("K0Rh"),M=n("Zifs"),g=n("hgLm");i.RootFormaToPGMMapper=(r=function e(){s.FormaToPGMMapper.call(this,e.FORMA_KIND)},o={},a.defineClass({name:"RootFormaToPGMMapper",ctor:r,superName:"FormaToPGMMapper",statics:{FORMA_KIND:{get:function(){return void 0===o.FORMA_KIND&&(o.FORMA_KIND=P.RootForma.KIND),o.FORMA_KIND}},instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}},createMapper:function(e){return r.instance}},props:{makePGMRef:function(e,t,n,r){var o,i,s;if((o=a.as(e,P.RootForma))&&(i=n.childReferences(o))&&(s=o.bounds)){var T,F=new g.TheoRectanglePath(s),A=o.style.colors.fieldPrimary||M.SolidColor.WHITE,G=A.withAlphaOf(A.alpha*t.backgroundOpacityOverride);if(G.alpha>0){var y=new h.PGMReference(new m.PGMShape(o.formaID+"-background",new d.PGMNodeMetadata(o.formaID,"background"),c.PGMAnimationList.EMPTY,s,[F],G));T=[l.FormaToPGMUtils.applyAnimations(t,e,y)].concat(a.clone(i))}else T=a.clone(i);return l.FormaToPGMUtils.applyAnimations(t,e,new h.PGMReference(new p.PGMClip(o.formaID,new d.PGMNodeMetadata(o.formaID,"clip"),c.PGMAnimationList.EMPTY,a.clone(T),[F]),new f.PGMCompositingParams(o.placement,o.style.opacity)))}return u.LegacyCoreAssert.fail("root forma child reference generation failed",void 0,"RootFormaToPGMMapper.makePGMRef","RootFormaToPGMMapper.swift",87),null}}}),r)},s3ad:function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("7Pku"),l=n("w/+j"),u=n("iCxV"),c=n("fNpk"),p=n("Ird5"),f=n("jfma"),d=n("bauG"),h=n("jSYS"),m=n("KB91"),P=n("wH/i"),M=n("yjxF"),g=n("Aj79"),T=n("sJQG"),F=n("s3Tu"),A=n("zjod"),G=n("mxdD");i.VideoFormaToPGMMapper=(r=function e(){s.FormaToPGMMapper.call(this,e.FORMA_KIND)},o={},a.defineClass({name:"VideoFormaToPGMMapper",ctor:r,superName:"FormaToPGMMapper",statics:{FORMA_KIND:{get:function(){return void 0===o.FORMA_KIND&&(o.FORMA_KIND=A.VideoForma.KIND),o.FORMA_KIND}},instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}},createMapper:function(e){return r.instance}},props:{makePGMRef:function(e,t,n,r){var o,i,s,y;if((s=a.as(e,A.VideoForma))&&(y=s.bounds)){var v,R,_="unknown";if((v=s.videoContentNode)&&(_=v.isGIF?"gif":"video"),((o=a.opt(u.Host.videoUtils,(function(e){return e.hostSupportsPGMVideos()})))||null!=o)&&o){var C;if(null!=(C=s.videoContentID)){var w,S=G.VideoFacade.getDurationForVideo(s),E=G.VideoFacade.getStartTimeForVideoForma(s,!(!(i=a.opt(s.videoContentNode,(function(e){return e.isForLocalVideo})))&&null==i)&&i),N=E.seconds,D=E;if(s.mode==A.VideoMode.trim&&(D=s.currentTime),S.seconds>0){var b=new h.PGMLinearFunction(new T.PGMRange(0,S.seconds),T.PGMRange.UNIT),x=new m.PGMLoopingFunction(new T.PGMRange(0,S.seconds),b);w=new p.PGMAnimationList([new P.PGMMediaPlayAnimation(x)])}else w=p.PGMAnimationList.EMPTY;return l.FormaToPGMUtils.applyAnimations(t,e,new g.PGMReference(new F.PGMVideo(s.formaID,new M.PGMNodeMetadata(s.formaID,_),w,y,C,N,D.seconds),new f.PGMCompositingParams(s.placement,s.style.opacity)))}return c.LegacyCoreAssert.fail("videoForma has a nil videoContentID",void 0,"VideoFormaToPGMMapper.makePGMRef","VideoFormaToPGMMapper.swift",86),null}return _="poster",null!=(R=s.contentID)?l.FormaToPGMUtils.applyAnimations(t,e,new g.PGMReference(new d.PGMImage(s.formaID+"-"+_,new M.PGMNodeMetadata(s.formaID,_),p.PGMAnimationList.EMPTY,y,R),new f.PGMCompositingParams(s.placement,s.style.opacity))):(c.LegacyCoreAssert.fail("videoForma has a nil contentID",void 0,"VideoFormaToPGMMapper.makePGMRef","VideoFormaToPGMMapper.swift",110),null)}return c.LegacyCoreAssert.fail("not a video forma, or no bounds",void 0,"VideoFormaToPGMMapper.makePGMRef","VideoFormaToPGMMapper.swift",115),null}}}),r)},uUew:function(e,t,n){var r,o=t,i=n("oAGj"),a=n("gXiO"),s=n("fNpk");o.TextRange=(r=function(e,t){this.start=e,this.end=t,s.LegacyCoreAssert.isTrue(t>=e&&e>=0,"TextRange is invalid",{start:e,end:t},"TextRange.init","TextRange.swift",19),a.CoreObject.call(this)},i.defineClass({name:"TextRange",ctor:r,superName:"CoreObject",statics:{makeRangesContiguous:function(e){for(var t=i.iter(i.toSequence(e));!t.done;t.next()){var n=t.value,o=n.offset,a=n.element;o+1<e.length&&(e[o]=new r(a.start,e[o+1].start))}}},props:{length:{get:function(){return this.end-this.start}},asString:{get:function(){return"["+this.start+"-"+this.end+"]"}},contains:function(e){return e.start>=this.start&&e.end<=this.end},unionWith:function(e){return new r(Math.min(this.start,e.start),Math.max(this.end,e.end))}}}),r)},"w/+j":function(e,t,n){var r,o=t,i=n("oAGj"),a=n("ko5Z"),s=n("WF+G"),l=n("iCxV"),u=n("SDdr"),c=n("fNpk"),p=n("c+uM"),f=n("tGKA"),d=n("Ird5"),h=n("WjWV"),m=n("Iv44"),P=n("dmHI"),M=n("9MJV"),g=n("jSYS"),T=n("WUDy"),F=n("sJQG"),A=n("PlOi"),G=n("W6ub"),y=n("Ucb9"),v=n("9K9k"),R=n("/eOI"),_=n("bAjp"),C=n("f/aw"),w=n("zW52"),S=n("bJhu"),E=n("mj5y"),N=n("KQHZ"),D=n("6ftY"),b=n("uYSz"),x=n("VXZl"),O=n("KDc2"),k=n("GOtr"),I=n("ll2+"),L=n("GtBD"),Y=n("sIWg"),B=n("xm77"),U=n("sW6f");o.FormaToPGMUtils=(r=function(){},i.defineClass({name:"FormaToPGMUtils",ctor:r,statics:{cpEnv:"prod",createTimeFunc:function(e,t){var n,r=new F.PGMRange(e.time.seconds,t.time.seconds);switch(t.timingFunction){case"Linear":n=new g.PGMLinearFunction(r,F.PGMRange.UNIT);break;case"Step":case"Step0":case"Step1":n=new g.PGMLinearFunction(r,new F.PGMRange(0,0));break;case"EaseIn":case"EaseOut":case"EaseInOut":var o=e.timingFunction==B.TimingFunctionType.EaseIn?R.PGMEasingType.EaseIn:e.timingFunction==B.TimingFunctionType.EaseOut?R.PGMEasingType.EaseOut:R.PGMEasingType.EaseInAndOut;n=new R.PGMSineEasingFunction(o,r,F.PGMRange.UNIT);break;default:i.opt(l.Host.logging,(function(t){return t.warning("Timing-func not yet converyed to PGM: "+e.timingFunction)})),n=new g.PGMLinearFunction(r,F.PGMRange.UNIT)}return n},determineOpacity:function(e){var t;return(t=i.as(e.style,p.LockupStyle))?t.textOpacity:i.opt(e.style,(function(e){return e.opacity}))},createTransformAnimation:function(e,t,n){var o,i=e.compositing.placement,a=t.placement,s=n.placement;return a.isIdentity&&s.isIdentity||(o=new w.PGMTransformAnimation(r.createTimeFunc(t,n),new w.PGMTransformedBounds(i.concat(a),E.PGMUtils.calcBounds(e.child,f.Matrix2D.Identity)||Y.TheoRect.Zero),new w.PGMTransformedBounds(i.concat(s),E.PGMUtils.calcBounds(e.child,f.Matrix2D.Identity)||Y.TheoRect.Zero))),o},createOpacityAnimation:function(e,t){var n,o=r.determineOpacity(e);if(null==o)return n;var i=r.determineOpacity(t);return null==i?n:n=new T.PGMOpacityAnimation(r.createTimeFunc(e,t),o,i)},createTextAnimation:function(e,t,n){var o,a=i.as(e,_.PGMText);if(null==a)return o;var s=i.opt(t.style,(function(e){return e.colors.fieldPrimary}));if(null==s)return o;var l=i.opt(n.style,(function(e){return e.colors.fieldPrimary}));if(null==l)return o;null==a.style.fillColor&&(s=null,l=null);var u=i.opt(t.style,(function(e){return e.colors.fieldSecondary})),c=i.opt(n.style,(function(e){return e.colors.fieldSecondary}));null==u&&(u=a.style.strokeColor),null==c&&(c=a.style.strokeColor);var p=new S.PGMTextStyle(a.style.font,s,u,a.style.strokeWidth,a.style.tracking),f=new S.PGMTextStyle(a.style.font,l,c,a.style.strokeWidth,a.style.tracking);return o=new C.PGMTextAnimation(r.createTimeFunc(t,n),t.bounds||a.bounds,p,n.bounds||a.bounds,f,G.PGMRenderRuns.init_378c(t.renderRuns),G.PGMRenderRuns.init_378c(n.renderRuns))},createShapeAnimation:function(e,t,n){var o,a=i.as(e,y.PGMShape);if(null==a)return o;var s=i.opt(t.style,(function(e){return e.colors.fieldPrimary}));if(null==s)return o;var l=i.opt(n.style,(function(e){return e.colors.fieldPrimary}));return null==l?o:o=new v.PGMShapeAnimation(r.createTimeFunc(t,n),s,t.bounds||a.bounds,l,n.bounds||a.bounds)},createFilterAnimation:function(e,t,n){var o,a,s,l,c,p;if(a=i.as(e,P.PGMFilter))if((s=i.as(a.spec,m.PGMBlurFilterSpec))&&(l=i.as(i.opt(t.style,(function(e){return e.filter})),u.CompositeFilter))&&(c=i.as(i.opt(n.style,(function(e){return e.filter})),u.CompositeFilter))){var f=new m.PGMBlurFilterSpec(s.edgeClamp,l.blurRadius,s.originalImageEntity),d=new m.PGMBlurFilterSpec(s.edgeClamp,c.blurRadius,s.originalImageEntity);o=new M.PGMFilterAnimation(r.createTimeFunc(t,n),f,d)}else if(p=i.as(a.spec,h.PGMBlendFilterSpec)){var g=p.weights[0],T=p.weights[1],F=new h.PGMBlendFilterSpec([g,T]),A=new h.PGMBlendFilterSpec([T,g]);o=new M.PGMFilterAnimation(r.createTimeFunc(t,n),F,A)}return o},createContentAnimation:function(e,t,n){var o,i=e.child;return i instanceof _.PGMText?o=r.createTextAnimation(i,t,n):i instanceof y.PGMShape?o=r.createShapeAnimation(i,t,n):i instanceof P.PGMFilter&&(o=r.createFilterAnimation(i,t,n)),o},convertAnimation:function(e,t,n,o){void 0===n&&(n=!0),void 0===o&&(o=!0);var a=[];if(!(t.keyFrames.length>1))return a;for(var s=t.keyFrames.length-2,l=i.iter(i.range(0,s,!0));!l.done;l.next()){var u,c,p,f=l.value,d=t.keyFrames[f],h=t.keyFrames[f+1];if(h.time!=d.time)n&&((u=r.createTransformAnimation(e,d,h))&&a.push(u),(c=r.createOpacityAnimation(d,h))&&a.push(c)),o&&(p=r.createContentAnimation(e,d,h))&&a.push(p)}return a},createAnimations:function(e,t){var n,o=[];if(n=t.animation){var a=i.clone(r.convertAnimation(e,n));i.append(o,a)}return d.PGMAnimationList.fromArray(o)},applyAnimations:function(e,t,n){if(!e.asDynamic)return n;var o=r.createAnimations(n,t),i=n.animations.merge(o);return n.withAnimations(i)},createResourceProviderForContentNode:function(e){var t,n,o,l=e.type,u=e.localIdentifier,p=i.as(e,U.VideoContentNode);if(null!=u&&null!=p&&p.isForLocalVideo){var f,d=null;null!=(f=p.url)&&f.startsWith("file:")&&(d=new s.CorePath(f.substr("file:".length))),o=new L.StorageSpecLocalIdentifier(u,d)}else if(null!=(f=e.url))if(f.startsWith("component:"))(M=f.substr("component:".length).split("/")).length>2&&"logo"==M[2]&&M.splice(2,1),l=M.length>=3?i.replaceAll(M[2],"+","/"):l,M.length>=2?o=new k.StorageSpecLocalComposite(M[1],l):(c.LegacyCoreAssert.fail("unexpected component encoding",void 0,"FormaToPGMUtils.createResourceProviderForContentNode","FormaToPGMUtils.swift",363),o=new O.StorageSpecInvalid);else if(f.startsWith("cp:")){var h=f.substr("cp:".length),m=(M=h.split("/"))[0];if(M.splice(0,1),"original"==M[0]&&M.splice(0,1),M.length>=1){var P=M.join("/");o=new D.StorageSpecCommunityPlatform(m,new s.CorePath(P),null,r.cpEnv)}else c.LegacyCoreAssert.fail("unexpected component encoding",void 0,"FormaToPGMUtils.createResourceProviderForContentNode","FormaToPGMUtils.swift",381),o=new O.StorageSpecInvalid}else if(f.startsWith("ac:")){var M;(M=f.substr("ac:".length).split("/")).length>=3&&"logo"==M[2]&&M.splice(2,1);var g=M.length>=3&&null!=["image+","video+","audio+","font+","application+"].find((function(e){return M[2].startsWith(e)}),this),T=M.length>=3&&!g?M[2]:null,F=null==T?2:3;M.length>F&&(l=i.replaceAll(M[F],"+","/")),o=new b.StorageSpecExternalCC(b.StorageSpecExternalCC.BRANDKIT_SYNC_GROUP,M[0],M[1],null,l,null,T)}else if(f.startsWith("file:")){var G=f.substr("file:".length);o=new I.StorageSpecLocalFile(new s.CorePath(G))}else if(f.startsWith("data:")){var y;if(null!=(y=i.indexOf(f,"base64,"))){var v=f.substr(y+"base64,".length),R=f.substr("data:".length,y-"data:".length);R.endsWith(";")&&(l=R.substr(0,R.length-1)),o=new N.StorageSpecContentLiteral(new a.CoreContentBase64(v,(t=l)||null!=t?t:""))}else c.LegacyCoreAssert.fail("data URL is not base64; unsupported",void 0,"FormaToPGMUtils.createResourceProviderForContentNode","FormaToPGMUtils.swift",431),o=new O.StorageSpecInvalid}else f.startsWith("http:")||f.startsWith("https:")||f.startsWith("blob:")?o=new x.StorageSpecHTTP(f):f.startsWith("/storage/")?o=new I.StorageSpecLocalFile(new s.CorePath(f)):(c.LegacyCoreAssert.fail("URL does not have a known pattern",void 0,"FormaToPGMUtils.createResourceProviderForContentNode","FormaToPGMUtils.swift",448),o=new O.StorageSpecInvalid);else c.LegacyCoreAssert.fail("no URL to inspect",void 0,"FormaToPGMUtils.createResourceProviderForContentNode","FormaToPGMUtils.swift",452),o=new O.StorageSpecInvalid;return new A.PGMResourceProvider((n=l)||null!=n?n:"",o)}}}),r)},x4Gy:function(e,t,n){var r,o,i,a,s,l,u,c=t,p=n("oAGj"),f=n("SpAV"),d=n("gXiO"),h=n("dJuF"),m=n("QgZx"),P=n("ZhwN"),M=n("iCxV"),g=n("fNpk"),T=n("c+uM"),F=n("Quhx"),A=n("Zifs"),G=n("a9ow"),y=n("enh0"),v=n("90dd");c.SolidColorRun=(r=function(e,t){this.attr=e,this.range=t},p.defineClass({name:"SolidColorRun",ctor:r}),r),c.SolidColorRuns=(o=function(){this.runArrays_=[],d.CoreObject.call(this)},p.defineClass({name:"SolidColorRuns",ctor:o,superName:"CoreObject",props:{apply:function(e,t){0!=t.length&&this.runArrays_.push(new c.SolidColorRun(e,t))},clear:function(){this.runArrays_.splice(0)},applyNewAlpha:function(e,t){for(var n=p.iter(e.runArrays);!n.done;n.next()){var r=n.value,o=(1-t)*r.attr.alpha+1*t,i=new A.SolidColor(r.attr.red,r.attr.green,r.attr.blue,o);this.apply(i,r.range)}},runArrays:{get:function(){return this.runArrays_}},clone:function(){for(var e=new o,t=p.iter(this.runArrays_);!t.done;t.next()){var n=t.value;e.apply(n.attr,n.range)}return e},asString:{get:function(){for(var e="",t=p.iter(this.runArrays_);!t.done;t.next()){var n=t.value;e=e+" "+n.range.asString+" "+n.attr.asString}return e}}}}),o),c.RenderRuns=(i=function(){this.fillColors=new c.SolidColorRuns,this.strokeColors=new c.SolidColorRuns,d.CoreObject.call(this)},p.defineClass({name:"RenderRuns",ctor:i,superName:"CoreObject",props:{applyColors:function(e,t,n){0!=n.length&&(this.fillColors.apply(e,n),this.strokeColors.apply(t,n))},copyColorAlpha:function(e,t){for(var n=e.fontColor,r=e.fontStrokeColor,o=p.iter(t.fillColors.runArrays);!o.done;o.next()){var i=o.value,a=new A.SolidColor(n.red,n.green,n.blue,i.attr.alpha);this.fillColors.apply(a,i.range)}for(var s=p.iter(t.strokeColors.runArrays);!s.done;s.next()){var l=s.value,u=new A.SolidColor(r.red,r.green,r.blue,l.attr.alpha);this.strokeColors.apply(u,l.range)}},setAlphaFromAnimation:function(e,t,n){this.clear(),this.fillColors.applyNewAlpha(e.fillColors,n),this.strokeColors.applyNewAlpha(e.strokeColors,n)},clear:function(){this.fillColors.clear(),this.strokeColors.clear()},clone:function(){var e=new i;return e.fillColors=this.fillColors.clone(),e.strokeColors=this.strokeColors.clone(),e},asString:{get:function(){return"Fill:"+this.fillColors.asString+" Stroke:"+this.strokeColors.asString}}}}),i),c.ContentTextModel=(a=function(){},p.defineClass({name:"ContentTextModel",ctor:a,superName:"TextModel",statics:{SCHEMA_CLASS_NAME:{get:function(){return"ContentTextModel"}},codec:{get:function(){return h.DBPropertyCodec.registerCodec(a.SCHEMA_CLASS_NAME,h.DBPropertyCodec.directObjectCodec(a.SCHEMA_CLASS_NAME))}},factory:{get:function(){return function(e,t,n,r){return a.init_866e(n,e)}}},_implements:function(e){return"IDBObject"==e||"TheoMessagePublisher"==e}},props:{init_d41d:function(){var e={text:[new G.UTF16Attribute("")]};p.super_init(this,c.TextModel,c.TextModel.prototype.init_dd5d,{},p.clone(e))},init_5aae:function(e){var t={},n={};if(null!=e)t=p.clone(e.state.allProperties);else{var r=[new G.UTF16Attribute("")];n[c.TextModel.PROPERTY_UTF16_NAME]=p.clone(r)}p.super_init(this,c.TextModel,c.TextModel.prototype.init_dd5d,p.clone(t),p.clone(n))},init_866e:function(e,t){p.super_init(this,c.TextModel,c.TextModel.prototype.init_866e,e,t);for(var n=p.iter(c.TextModel.allAttributeNames_);!n.done;n.next()){var r=n.value;r!=c.TextModel.PROPERTY_UTF16_NAME&&p.opt(this.getProperty(r),(function(e){return e.shouldWrite=!1}))}},className:{get:function(){return a.SCHEMA_CLASS_NAME}},clone:function(){return a.init_5aae(this)},match:function(e){this.set(c.TextModel.PROPERTY_UTF16_NAME,e.get(c.TextModel.PROPERTY_UTF16_NAME)),this.publish(new c.TextModelDidInsertMessage(this,0,this.text))},isEqual:function(e){var t;return!!(t=p.as(e,c.TextModel))&&this.text==t.text}}}),a),c.TextModel=(s=function(){},l={},p.defineClass({name:"TextModel",ctor:s,superName:"PostPublishingObject",statics:{PROPERTY_UTF16_NAME:"text",PROPERTY_FONT_NAME:"font-name",PROPERTY_FONT_SIZE:"font-size",PROPERTY_FONT_COLOR:"font-color",PROPERTY_FONT_STROKE_COLOR:"font-strokecolor",PROPERTY_FONT_STROKE_WIDTH:"font-strokewidth",PROPERTY_TEXT_LOOK:"text-look",PROPERTY_TRACKING:"tracking",SCHEMA_CLASS_NAME:{get:function(){return"TextModel"}},codec:{get:function(){return h.DBPropertyCodec.registerCodec(s.SCHEMA_CLASS_NAME,h.DBPropertyCodec.directObjectCodec(s.SCHEMA_CLASS_NAME))}},factory:{get:function(){return function(e,t,n,r){return s.init_866e(n,e)}}},defaultText:{get:function(){return null==s.defaultText_&&(s.defaultText_=new G.UTF16Attribute("")),s.defaultText_}},defaultFontColor:{get:function(){return null==s.defaultFontColor_&&(s.defaultFontColor_=new G.FontColorAttribute(M.Host.textModelUtils.defaultColor())),s.defaultFontColor_}},defaultFontName:{get:function(){return null==s.defaultFontName_&&(s.defaultFontName_=new G.FontDescriptorAttribute(M.Host.textModelUtils.defaultFont())),s.defaultFontName_}},defaultFontSize:{get:function(){return null==s.defaultFontSize_&&(s.defaultFontSize_=new G.FontSizeAttribute(M.Host.textModelUtils.defaultFontSize())),s.defaultFontSize_}},defaultFontStrokeColor:{get:function(){return null==s.defaultFontStrokeColor_&&(s.defaultFontStrokeColor_=new G.FontStrokeColorAttribute(M.Host.textModelUtils.defaultColor())),s.defaultFontStrokeColor_}},defaultFontStrokeWidth:{get:function(){return null==s.defaultFontStrokeWidth_&&(s.defaultFontStrokeWidth_=new G.FontStrokeWidthAttribute(y.TextForma.STROKEWIDTH_ZERO)),s.defaultFontStrokeWidth_}},defaultTextLook:{get:function(){return null==s.defaultTextLook_&&(s.defaultTextLook_=new G.TextLookAttribute(T.LockupTextLook.Fill)),s.defaultTextLook_}},defaultTracking:{get:function(){return null==s.defaultTracking_&&(s.defaultTracking_=new G.TrackingAttribute(y.TextForma.TRACKING_ZERO)),s.defaultTracking_}},allAttributeNames_:{get:function(){return void 0===l.allAttributeNames_&&(l.allAttributeNames_=[s.PROPERTY_UTF16_NAME,s.PROPERTY_FONT_COLOR,s.PROPERTY_FONT_NAME,s.PROPERTY_FONT_SIZE,s.PROPERTY_FONT_STROKE_COLOR,s.PROPERTY_FONT_STROKE_WIDTH,s.PROPERTY_TEXT_LOOK,s.PROPERTY_TRACKING]),l.allAttributeNames_}},defaultAttribute:function(e){switch(e){case"text":return s.defaultText;case"font-color":return s.defaultFontColor;case"font-name":return s.defaultFontName;case"font-size":return s.defaultFontSize;case"font-strokecolor":return s.defaultFontStrokeColor;case"font-strokewidth":return s.defaultFontStrokeWidth;case"text-look":return s.defaultTextLook;case"tracking":return s.defaultTracking;default:return null}},_implements:function(e){return"IDBObject"==e||"TheoMessagePublisher"==e}},props:{init_d41d:function(){p.super_init(this,F.PostPublishingObject,F.PostPublishingObject.prototype.init_dd5d,{},p.clone({}))},init_dd5d:function(e,t){p.super_init(this,F.PostPublishingObject,F.PostPublishingObject.prototype.init_dd5d,p.clone(e),p.clone(t))},init_36cd:function(e){p.super_init(this,F.PostPublishingObject,F.PostPublishingObject.prototype.init_dd5d,p.clone(p.opt(e,(function(e){return e.state.allProperties}))||{}),{})},init_866e:function(e,t){p.super_init(this,F.PostPublishingObject,F.PostPublishingObject.prototype.init_866e,e,t)},className:{get:function(){return s.SCHEMA_CLASS_NAME}},textAttr:{get:function(){var e;return(e=p.as(p.opt(p.as(this.get(s.PROPERTY_UTF16_NAME),["Array",G.TextAttribute]),(function(e){return e[0]})),G.UTF16Attribute))||null!=e?e:s.defaultText},set:function(e){this.set(s.PROPERTY_UTF16_NAME,[e])}},fontColor:{get:function(){var e;return(e=p.as(this.get(s.PROPERTY_FONT_COLOR),["Array",G.TextAttribute]))?p.as(p.first(e),G.FontColorAttribute):null}},fontName:{get:function(){var e;return(e=p.as(this.get(s.PROPERTY_FONT_NAME),["Array",G.TextAttribute]))?p.as(p.first(e),G.FontDescriptorAttribute):null}},fontSize:{get:function(){var e;return(e=p.as(this.get(s.PROPERTY_FONT_SIZE),["Array",G.TextAttribute]))?p.as(p.first(e),G.FontSizeAttribute):null}},fontStrokeColor:{get:function(){var e;return(e=p.as(this.get(s.PROPERTY_FONT_STROKE_COLOR),["Array",G.TextAttribute]))?p.as(p.first(e),G.FontStrokeColorAttribute):null}},fontStrokeWidth:{get:function(){var e;return(e=p.as(this.get(s.PROPERTY_FONT_STROKE_WIDTH),["Array",G.TextAttribute]))?p.as(p.first(e),G.FontStrokeWidthAttribute):null}},textLook:{get:function(){var e;return(e=p.as(this.get(s.PROPERTY_TEXT_LOOK),["Array",G.TextAttribute]))?p.as(p.first(e),G.TextLookAttribute):null}},tracking:{get:function(){var e;return(e=p.as(this.get(s.PROPERTY_TRACKING),["Array",G.TextAttribute]))?p.as(p.first(e),G.TrackingAttribute):null}},description:{get:function(){for(var e,t="TextModel: ",n=p.iter(s.allAttributeNames_);!n.done;n.next()){var r=n.value;t+=r+": "+((e=p.opt(p.first(p.as(this.get(r),["Array",G.TextAttribute])),(function(e){return e.description})))||null!=e?e:"<unset>")+" | "}return t}},runArraysByAttrName:{get:function(){for(var e={},t=p.iter(s.allAttributeNames_);!t.done;t.next()){var n=t.value,r=p.clone(p.as(this.get(n),["Array",G.TextAttribute]));if(null!=r)e[n]=p.clone(r);else{var o=s.defaultAttribute(n);null!=o&&(e[n]=[o])}}return e}},text:{get:function(){return this.textAttr.value},set:function(e){e!=this.textAttr.value&&(this.textAttr=new G.UTF16Attribute(e))}},isEqual:function(e){var t;if(t=p.as(e,s)){var n=p.clone(this.runArraysByAttrName),r=p.clone(t.runArraysByAttrName);if(p.count(r)!=p.count(n))return!1;for(var o=p.iter(n);!o.done;o.next()){var i,a=o.key,l=o.value;if(!(i=r[a]))return!1;if(i[0]!=l[0])return!1}return!0}return!1},hash:{get:function(){return p.hashValue(this.text)}},setAttr:function(e,t){var n;if(null!=e)if(t!=s.PROPERTY_UTF16_NAME)if(t==s.PROPERTY_FONT_NAME)(n=p.as(e,m.FontDescriptor))&&(p.eq(m._equality_FontDescriptor_FontDescriptor,n,p.opt(this.fontName,(function(e){return e.value})))||this.set(t,[new G.FontDescriptorAttribute(n)]));else if(t==s.PROPERTY_FONT_SIZE){var r;if(null!=(r=p.as(e,"Double"))){if(r==p.opt(this.fontSize,(function(e){return e.value})))return;if(0==r){g.LegacyCoreAssert.fail("attempted to set font size to 0.0",void 0,"TextModel.setAttr","TextModel.swift",476);var o=new G.FontSizeAttribute(1);this.set(t,[o])}else this.set(t,[new G.FontSizeAttribute(r)])}}else if(t==s.PROPERTY_FONT_COLOR)(i=p.as(e,A.SolidColor))&&(p.eq(A._equality_SolidColor_SolidColor,i,p.opt(this.fontColor,(function(e){return e.value})))||this.set(t,[new G.FontColorAttribute(i)]));else if(t==s.PROPERTY_FONT_STROKE_COLOR){var i;(i=p.as(e,A.SolidColor))&&(p.eq(A._equality_SolidColor_SolidColor,i,p.opt(this.fontStrokeColor,(function(e){return e.value})))||this.set(t,[new G.FontStrokeColorAttribute(i)]))}else if(t==s.PROPERTY_FONT_STROKE_WIDTH){var a;null!=(a=p.as(e,"Double"))&&a!=p.opt(this.fontStrokeWidth,(function(e){return e.value}))&&this.set(t,[new G.FontStrokeWidthAttribute(a)])}else if(t==s.PROPERTY_TEXT_LOOK){var l;null!=(l=p.as(e,T.LockupTextLook))&&l!=p.opt(this.textLook,(function(e){return e.value}))&&this.set(t,[new G.TextLookAttribute(l)])}else if(t==s.PROPERTY_TRACKING){var u;null!=(u=p.as(e,"Double"))&&u!=p.opt(this.tracking,(function(e){return e.value}))&&this.set(t,[new G.TrackingAttribute(u)])}else f.CoreAssert.fail("Missing setAttr code for "+t,void 0,"TextModel.setAttr","TextModel.swift",521);else f.CoreAssert.fail("Attempted to set text through apply!",void 0,"TextModel.setAttr","TextModel.swift",459);else null!=this.get(t)&&this.set(t,null)},match:function(e){for(var t=p.iter(s.allAttributeNames_);!t.done;t.next()){var n=t.value;this.set(n,e.get(n))}this.publish(new c.TextModelDidInsertMessage(this,0,this.text))},clone:function(){return this.fork(P.GUIDUtils.makeGUID())},insertTextUsingSubstring:function(e){var t=e+this.text.substr(0);this.text=t,this.publish(new c.TextModelDidInsertMessage(this,0,e))},replaceText:function(e){this.text=e,this.publish(new c.TextModelDidInsertMessage(this,0,e))}}}),s),c.TextModelDidInsertMessage=(u=function e(t,n,r){this.model=t,this.index=n,this.text=r,v.TheoMessage.call(this,e.TYPE,t)},p.defineClass({name:"TextModelDidInsertMessage",ctor:u,superName:"TheoMessage",statics:{TYPE:{get:function(){return"TextModelDidInsertMessage"}}}}),u)},"zW/s":function(e,t,n){var r,o,i=t,a=n("oAGj"),s=n("7Pku"),l=n("w/+j"),u=n("fNpk"),c=n("Ird5"),p=n("jfma"),f=n("yjxF"),d=n("Aj79"),h=n("ZA1K"),m=n("WWR6");i.VectorFormaToPGMMapper=(r=function e(){s.FormaToPGMMapper.call(this,e.FORMA_KIND)},o={},a.defineClass({name:"VectorFormaToPGMMapper",ctor:r,superName:"FormaToPGMMapper",statics:{FORMA_KIND:{get:function(){return void 0===o.FORMA_KIND&&(o.FORMA_KIND=m.VectorForma.KIND),o.FORMA_KIND}},instance:{get:function(){return void 0===o.instance&&(o.instance=new r),o.instance}},createMapper:function(e){return r.instance}},props:{makePGMRef:function(e,t,n,r){var o;return(o=a.as(e,m.VectorForma))?l.FormaToPGMUtils.applyAnimations(t,e,new d.PGMReference(new h.PGMSVG(o.formaID,new f.PGMNodeMetadata(o.formaID,"VectorForma"),c.PGMAnimationList.EMPTY,o.bounds,o.contentNode.url),new p.PGMCompositingParams(o.placement,o.style.opacity))):(u.LegacyCoreAssert.fail("VectorFormaToPGMMapper called for something that's not a VectorForma",void 0,"VectorFormaToPGMMapper.makePGMRef","VectorFormaToPGMMapper.swift",49),null)}}}),r)}}]);
//# sourceMappingURL=vendors_npm_spark_6bc71c67-8227bc4a.js.map