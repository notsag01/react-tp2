(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[43],{"2Srg":function(e,t,n){var a,i=t,o=n("oAGj"),r=n("cmoc"),l=n("cYVN");i.ImageRoleData=(a=function(e,t,n){l.RoleData.call(this,e,o.clone(t),o.clone(n))},o.defineClass({name:"ImageRoleData",ctor:a,superName:"RoleData",statics:{getImageRoleData:function(e){return e instanceof r.FrameForma?new a(e,[],{}):null}}}),a)},"7Ta2":function(e,t,n){var a,i,o,r=t,l=n("oAGj"),s=n("gXiO"),h=n("6ZWm"),u=n("iCxV"),g=n("2Srg"),c=n("ws+m"),p=n("fNpk"),d=n("xRbc"),f=n("zbwF"),m=n("nrTo"),y=n("JO5d"),T=n("ERpL"),L=n("lYNH"),A=n("8t9B");r.RoleSuggesterProtocol=l.defineProtocol("RoleSuggesterProtocol",{getRole:"(RoleData) -> InferredRole"}),r.RoleSuggester=(a=function(){s.CoreObject.call(this)},i={},l.defineClass({name:"RoleSuggester",ctor:a,superName:"CoreObject",statics:{cache:{get:function(){var e;return void 0===i.cache&&(i.cache=((e=l.opt(u.Host.platform,(function(e){return e.isService})))||null!=e)&&e?l.opt(u.Host.learning,(function(e){return e.getHostPredictionCache()})):new m.PredictionCacheInferredRole),i.cache},set:function(e){i.cache=e}},ROLE_SHORT_LABELS:{Undefined:"udf",Title:"ttl",Subtitle:"stl",BodyText:"bdy",ContactInfo:"ctc",SocialMediaReference:"soc",Quote:"qot",CalltoAction:"act",GraphicContent:"gct",Seperator:"sep",Backing:"bkg",Background:"bgd",Decoration:"dec",Logo:"log"},getShortLabel:function(e){var t;return null!=(t=a.ROLE_SHORT_LABELS[e])?t:(p.LegacyCoreAssert.fail("didn't find role in short label dictionary!",void 0,"RoleSuggester.getShortLabel","RoleSuggester.swift",120),"???")}},props:{getRole:function(e){var t,n,i,o,s,p,m=null,R=null;if(l.as(e.controller,A.TypeLockupController)&&(n=d.LockupRoleData.getLockupRoleData(e))&&(m=n,R=f.LockupRoleSuggesterFactory.Create("MLP"),l.clone(R.getRole(n)).role==r.InferredRoleType.Undefined&&(R=f.LockupRoleSuggesterFactory.Create())),e.controller instanceof y.ShapeController&&(i=T.ShapeRoleData.getShapeRoleData(e))&&(m=i,R=e.isGridCell()?L.ShapeRoleSuggesterFactory.Create("Simple"):L.ShapeRoleSuggesterFactory.Create("MLP")),l.as(e.controller,h.FrameController)&&(o=g.ImageRoleData.getImageRoleData(e))&&(m=o,R=c.ImageRoleSuggesterFactory.Create("Simple")),(s=m)&&(p=R)){var S=s.getUniqueKey();return((t=l.opt(u.Host.platform,(function(e){return e.isService})))||null!=t)&&t||a.cache.cleanup(e.page.document.uuid),null==a.cache.getCacheValue(S)&&a.cache.setCacheValue(S,l.clone(this.getRoleForData(s,p))),a.cache.getCacheValue(S)}return r.InferredRole.init_84d1()},getRoleForData:function(e,t){var n=l.clone(t.getRole(e));return p.LegacyCoreAssert.isTrue(null!=a.ROLE_SHORT_LABELS[n.role],"no label for role",void 0,"RoleSuggester.getRoleForData","RoleSuggester.swift",92),p.LegacyCoreAssert.isTrue(null!=a.ROLE_SHORT_LABELS[n.secondaryRole],"no label for secondary role",void 0,"RoleSuggester.getRoleForData","RoleSuggester.swift",93),n}}}),a),r.InferredRoleType=l.defineEnum("InferredRoleType",{Undefined:"Undefined",Title:"Title",SubTitle:"Subtitle",Body:"BodyText",Contact:"ContactInfo",Social:"SocialMediaReference",Quote:"Quote",Action:"CalltoAction",GraphicContent:"GraphicContent",Seperator:"Seperator",Backing:"Backing",Background:"Background",Decoration:"Decoration",Logo:"Logo"}),r.InferredRole=(o=function(){},l.defineClass({name:"InferredRole",ctor:o,props:{init_84d1:function(e,t,n,a){void 0===e&&(e=r.InferredRoleType.Undefined),void 0===t&&(t=0),void 0===n&&(n=r.InferredRoleType.Undefined),void 0===a&&(a=0),this.role=e,this.confidence=t,this.secondaryRole=n,this.secondaryConfidence=a},init_implicit:function(e,t,n,a){this.role=e,this.confidence=t,this.secondaryRole=n,this.secondaryConfidence=a},clone:function(){return o.init_implicit(this.role,this.confidence,this.secondaryRole,this.secondaryConfidence)}}}),o)},"7l9C":function(e,t,n){var a,i,o,r,l,s,h=t,u=n("oAGj"),g=n("gXiO"),c=n("fNpk"),p=n("tGKA"),d=n("3DEm"),f=n("ol4x"),m=n("oKlP"),y=n("sIWg");h.AlignmentIdiom=u.defineEnum("AlignmentIdiom",{LRBB:0,LLtb:1,LLbt:2,RRtb:3,RRbt:4,CCtb:5,CCbt:6,LRtb:7,LRbt:8,RLtb:9,LRtt:10,RLtt:11,LRbb:12,RLbb:13,LRmm:14,cCCtb:15,cLCtb:16,cRCtb:17,LRctt:18,LRcbb:19,LLtbo:20,RRtbo:21,LLbto:22,LRott:23}),h.GlyphType=u.defineEnum("GlyphType",{GENERIC:0,DROPCAP:1,PUNCTUATION:2,SYMBOL:3}),h.NodeMeasurements=(a=function(e,t,n){this.node=e,this.minY=t,this.maxY=n},u.defineClass({name:"NodeMeasurements",ctor:a}),a),h.TypographyNode=(i=function(){this.parent=null,this.globalMat=p.Matrix2D.Identity,this.transMat=p.Matrix2D.Identity,this.scaleMat=p.Matrix2D.Identity,this.rotateMat=p.Matrix2D.Identity,this.rotateAlign=0,this.scaleAlign=1,g.CoreObject.call(this)},u.defineClass({name:"TypographyNode",ctor:i,superName:"CoreObject",statics:{Clockwise:90,CounterClockwise:270},props:{isSame:function(e){return this.getId()==e.getId()},getRoot:function(){for(var e=this;null!=e.parent;)e=e.parent;return e},getWeight:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.getWeight","TypographyNode.swift",97),null},resetScale:function(){this.scaleAlign=1},propagateDown:function(e){},transformToLocalBounds:function(e){var t=this.local(),n=t.transformPoint(new m.TheoPoint(e.minX,e.minY)),a=t.transformPoint(new m.TheoPoint(e.maxX,e.minY)),i=t.transformPoint(new m.TheoPoint(e.maxX,e.maxY)),o=t.transformPoint(new m.TheoPoint(e.minX,e.maxY)),r=d.MathUtils.minDouble(d.MathUtils.minDouble(d.MathUtils.minDouble(n.x,a.x),i.x),o.x),l=d.MathUtils.maxDouble(d.MathUtils.maxDouble(d.MathUtils.maxDouble(n.x,a.x),i.x),o.x),s=d.MathUtils.minDouble(d.MathUtils.minDouble(d.MathUtils.minDouble(n.y,a.y),i.y),o.y),h=d.MathUtils.maxDouble(d.MathUtils.maxDouble(d.MathUtils.maxDouble(n.y,a.y),i.y),o.y);return new y.TheoRect(r,s,l,h)},transformTo:function(e,t){if(e.getId()==this.getId())return new y.TheoRect(t.minX,t.minY,t.maxX,t.maxY);for(var n=t,a=this.parent;null!=a&&a.getId()!=e.getId();)n=a.transformToLocalBounds(n),a=a.parent;return c.LegacyCoreAssert.isTrue(null!=a,"did not find node with requested id",void 0,"TypographyNode.transformTo","TypographyNode.swift",137),e.getId()!=this.getId()&&(n=e.transformToLocalBounds(n)),n},translateXY:function(e,t){this.transMat=this.transMat.translate(new m.TheoPoint(e,t))},rotateTo:function(e){var t=e*Math.PI/180;this.rotateMat=p.Matrix2D.Identity.rotateTo(Math.cos(t),Math.sin(t))},scaleXY:function(e){this.scaleMat=p.Matrix2D.Identity.scaleXY(e,e)},local:function(){return this.scaleMat.concat(this.rotateMat).concat(this.transMat)},global:function(){return this.globalMat},isRotated:function(){return 0!=this.rotateAlign},getId:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.getId","TypographyNode.swift",170),null},localbounds:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.localbounds","TypographyNode.swift",175),null},getHSpace:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.getHSpace","TypographyNode.swift",180),null},getMinHSpace:function(){return c.LegacyCoreAssert.fail("Calling an abstreact method.",void 0,"TypographyNode.getMinHSpace","TypographyNode.swift",185),null},getMargin:function(){return c.LegacyCoreAssert.fail("Calling an abstreact method.",void 0,"TypographyNode.getMargin","TypographyNode.swift",190),null},getAscent:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.getAscent","TypographyNode.swift",205),null},getDescent:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.getDescent","TypographyNode.swift",210),null},getLeading:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.getLeading","TypographyNode.swift",215),null},getBaseline:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.getBaseline","TypographyNode.swift",220),null},getMidline:function(){return this.localbounds().height/2},getSemanticWidth:function(){return c.LegacyCoreAssert.fail("Calling an abstract method.",void 0,"TypographyNode.getSemanticWidth","TypographyNode.swift",229),null},getRightmostTextNode:function(){return null},getLeftmostTextNode:function(){return null},depthFirstSearch:function(e){},calcTransform:function(){this.rotateTo(this.rotateAlign),this.scaleXY(this.scaleAlign)},getConcatScale:function(){return this.scaleAlign},getTextNodes:function(){return[]},childrenAreHorizAligned:function(){return!1},childrenAreVertAligned:function(){return!1},getText:function(){return""},description:{get:function(){var e="  ",t="";if(null==this.parent)t="ROOT:";else{for(var n=this.parent;null!=n;)n=n.parent,e+="  ";t+=e,this.isSame(this.parent.getChild(!0))?t+="LEFT:":t+="RIGHT:"}this instanceof h.SpacerNode?t+="SpacerNode ":this instanceof h.TextNode?t+="TextNode ":t+="GroupNode ",t+="id ="+this.getId()+" < "+this.getText()+" >",t+=u.toString(" weight:%.0f ",u.toDouble(this.getWeight())),this instanceof h.GroupNode&&(t+=" align: "+u.toString(this.transAlign)+" ");var a=this.localbounds();return t+=u.toString(" bounds:[x:%.2f",a.minX)+u.toString(" y:%.2f",a.minY)+u.toString(" w:%.2f",a.width)+u.toString(" h:%.2f]",a.height)+u.toString(" | scale:%.2f",this.scaleAlign)+u.toString(" | rotate:%.2f",this.rotateAlign),t+=u.toString(" | leading:%.2f",this.getLeading())+u.toString(" | baseline:%.2f",this.getBaseline())+"\r\n"}}}}),i),h.TextToken=(o=function(e,t,n,a,i,o,r,l,s,h){this.text=e,this.bounds=n,this.midline=a,this.hspace=i,this.ascent=o,this.descent=r,this.leading=l,this.preVertOffset=s,this.postVertOffset=h,this.weight=t,this.range=null},u.defineClass({name:"TextToken",ctor:o,statics:{symbols:["$","£","€","¥","¢","%"],punctuation:["!","?",'"',"'","“","”","‘","’"],getGlyphType:function(e){return o.symbols.includes(e)?h.GlyphType.SYMBOL:o.punctuation.includes(e)?h.GlyphType.PUNCTUATION:h.GlyphType.GENERIC}}}),o),h.SpacerNode=(r=function(e,t){this.id_=e,this.size_=t,h.TypographyNode.call(this)},u.defineClass({name:"SpacerNode",ctor:r,superName:"TypographyNode",props:{getId:function(){return".S"+u.toString(this.id_)},getWeight:function(){return 0},localbounds:function(){return this.transformToLocalBounds(new y.TheoRect(0,0,this.size_.width,this.size_.height))},getHSpace:function(){return 0},getMinHSpace:function(){return 0},getMargin:function(){return 0},getAscent:function(){return 0},getDescent:function(){return 0},getLeading:function(){return 0},getBaseline:function(){return this.localbounds().height},getSemanticWidth:function(){return this.localbounds().width/2},getVerticalOffset:function(){return 0}}}),r),h.TextNode=(l=function(e,t){this.token_=e,this.id_=t,h.TypographyNode.call(this)},u.defineClass({name:"TextNode",ctor:l,superName:"TypographyNode",props:{getId:function(){return"."+u.toString(this.id_)},setToken:function(e){this.token_=e},getWeight:function(){return this.token_.weight},localbounds:function(){return this.transformToLocalBounds(this.token_.bounds)},globalbounds:function(){var e=this.global(),t=this.token_.bounds,n=e.transformPoint(new m.TheoPoint(t.minX,t.minY)),a=e.transformPoint(new m.TheoPoint(t.maxX,t.minY)),i=e.transformPoint(new m.TheoPoint(t.maxX,t.maxY)),o=e.transformPoint(new m.TheoPoint(t.minX,t.maxY)),r=d.MathUtils.minDouble(d.MathUtils.minDouble(d.MathUtils.minDouble(n.x,a.x),i.x),o.x),l=d.MathUtils.maxDouble(d.MathUtils.maxDouble(d.MathUtils.maxDouble(n.x,a.x),i.x),o.x),s=d.MathUtils.minDouble(d.MathUtils.minDouble(d.MathUtils.minDouble(n.y,a.y),i.y),o.y),h=d.MathUtils.maxDouble(d.MathUtils.maxDouble(d.MathUtils.maxDouble(n.y,a.y),i.y),o.y);return new y.TheoRect(r,s,l,h)},getHSpace:function(){return this.token_.hspace*this.scaleMat.a},getMinHSpace:function(){return this.getHSpace()},getMargin:function(){return.3*this.token_.leading*this.scaleMat.a},getAscent:function(){return this.token_.ascent*this.scaleMat.d},getDescent:function(){return this.token_.descent*this.scaleMat.d},getLeading:function(){return this.token_.leading*this.scaleMat.d},getBaseline:function(){return this.isRotated()?this.localbounds().height:this.token_.ascent*this.scaleMat.d},getMidline:function(){return this.isRotated()?h.TypographyNode.prototype.getMidline.call(this):this.token_.midline*this.scaleMat.d},getSemanticWidth:function(){return this.localbounds().width/2},getVerticalOffset:function(){return this.token_.preVertOffset},getRightmostTextNode:function(){return this},getLeftmostTextNode:function(){return this},depthFirstSearch:function(e){e.push(this)},getTextNodes:function(){return[this]},getText:function(){return this.token_.text}}}),l),h.GroupNode=(s=function(e,t){this.leftChild=e,this.rightChild=t,this.transAlign=h.AlignmentIdiom.LRBB,this.leadingAdjustment=0,this.cachedWeight=0,this.dirtyWeight=!0,this.cachedID="",this.dirtyID=!0,h.TypographyNode.call(this),e.parent=this,t.parent=this},u.defineClass({name:"GroupNode",ctor:s,superName:"TypographyNode",props:{getChild:function(e){return e?this.leftChild:this.rightChild},setChild:function(e,t){t?this.leftChild=e:this.rightChild=e,e.parent=this;for(var n=this;null!=n;)n.dirtyID=!0,n.dirtyWeight=!0,n=n.parent},getId:function(){return this.dirtyID&&(this.cachedID=this.leftChild.getId()+this.rightChild.getId(),this.dirtyID=!1),this.cachedID},getWeight:function(){if(this.dirtyWeight){var e=this.leftChild.getWeight();e==this.rightChild.getWeight()?this.cachedWeight=e:this.cachedWeight=-1,this.dirtyWeight=!1}return this.cachedWeight},localbounds:function(){var e=this.leftChild.localbounds(),t=new y.TheoRect(e.minX,e.minY,e.maxX,e.maxY);e=this.rightChild.localbounds();var n=new y.TheoRect(e.minX,e.minY,e.maxX,e.maxY);return this.transformToLocalBounds(new y.TheoRect(d.MathUtils.minDouble(t.minX,n.minX),d.MathUtils.minDouble(t.minY,n.minY),d.MathUtils.maxDouble(t.maxX,n.maxX),d.MathUtils.maxDouble(t.maxY,n.maxY)))},getHSpace:function(){return this.scaleMat.a*d.MathUtils.maxDouble(this.leftChild.getHSpace(),this.rightChild.getHSpace())},getMinHSpace:function(){return this.scaleMat.a*d.MathUtils.minDouble(this.leftChild.getMinHSpace(),this.rightChild.getMinHSpace())},getMargin:function(){return this.scaleMat.a*d.MathUtils.minDouble(this.leftChild.getMargin(),this.rightChild.getMargin())},getLeading:function(){var e;switch(this.transAlign){case 1:case 3:case 5:case 7:case 16:case 17:case 15:e=this.rightChild.getLeading();break;case 2:case 4:case 6:case 8:e=this.leftChild.getLeading();break;default:e=d.MathUtils.maxDouble(this.leftChild.getLeading(),this.rightChild.getLeading())}return this.scaleMat.d*e},getInternalHSpace:function(){return this.childrenAreHorizAligned()?d.MathUtils.minDouble(this.leftChild.getMinHSpace(),this.rightChild.getMinHSpace()):d.MathUtils.minDouble(this.leftChild.getMargin(),this.rightChild.getMargin())},getConcatScale:function(){for(var e=this.scaleAlign,t=u.clone(this.getTextNodes()),n=u.iter(t);!n.done;n.next()){for(var a=n.value,i=a.parent,o=a.scaleAlign;i.getId()!=this.getId();)o*=i.scaleAlign,i=i.parent;o>e&&(e=o)}return e},getInternalVSpace:function(){return this.leftChild.isRotated()!=this.rightChild.isRotated()?d.MathUtils.minDouble(this.leftChild.getHSpace(),this.rightChild.getHSpace()):this.leadingAdjustment},getBaseline:function(){if(this.isRotated())return this.localbounds().height;var e=this.leftChild.localbounds(),t=this.transformToLocalBounds(new y.TheoRect(e.minX,e.minY,e.maxX,e.minY+this.leftChild.getBaseline()));e=this.rightChild.localbounds();var n=this.transformToLocalBounds(new y.TheoRect(e.minX,e.minY,e.maxX,e.minY+this.rightChild.getBaseline()));return e=this.localbounds(),d.MathUtils.maxDouble(t.maxY,n.maxY)-e.minY},getSemanticWidth:function(){if(this.getWeight()<0){for(var e=this.rightChild;e.getWeight()<0;)e=e.rightChild;for(var t=e.parent.leftChild,n=t.localbounds().minX<e.localbounds().minX?t:e,a=n.localbounds();!n.isSame(this);)a=(n=n.parent).transformToLocalBounds(a);return a.maxX-this.localbounds().minX}return this.localbounds().width/2},getMidline:function(){return this.isRotated()||this.transAlign!=h.AlignmentIdiom.LRBB||this.rightChild.isRotated()&&this.leftChild.isRotated()?h.TypographyNode.prototype.getMidline.call(this):d.MathUtils.maxDouble(this.leftChild.getMidline(),this.rightChild.getMidline())*this.scaleMat.d},getRightmostTextNode:function(){return this.rightChild.getRightmostTextNode()},getLeftmostTextNode:function(){return this.leftChild.getLeftmostTextNode()},swapChildren:function(){var e=this.leftChild;this.leftChild=this.rightChild,this.rightChild=e},depthFirstSearch:function(e){this.leftChild.depthFirstSearch(e),this.rightChild.depthFirstSearch(e)},getTextNodes:function(){var e=[];return this.depthFirstSearch(e),e},getTextRuns:function(){for(var e=[],t=u.clone(this.getTextNodes()),n=u.iter(t);!n.done;n.next()){for(var a=n.value;null!=a.parent&&a.parent.getWeight()==a.getWeight();)a=a.parent;for(var i=!1,o=u.iter(e);!o.done;o.next())if(o.value.isSame(a)){i=!0;break}i||e.push(a)}return e},getAscent:function(){switch(this.transAlign){case 1:case 3:case 5:case 7:case 16:case 17:case 15:return this.rightChild.getAscent();case 2:case 4:case 6:case 8:return this.leftChild.getAscent();case 10:case 11:case 18:return d.MathUtils.minDouble(this.leftChild.getAscent(),this.rightChild.getAscent())}return d.MathUtils.maxDouble(this.leftChild.getAscent(),this.rightChild.getAscent())},getDescent:function(){switch(this.transAlign){case 1:case 3:case 5:case 7:case 16:case 17:case 15:return this.rightChild.getDescent();case 2:case 4:case 6:case 8:return this.leftChild.getDescent();case 12:case 13:case 19:return d.MathUtils.minDouble(this.leftChild.getDescent(),this.rightChild.getDescent())}return d.MathUtils.maxDouble(this.leftChild.getDescent(),this.rightChild.getDescent())},childrenAreHorizAligned:function(){switch(this.transAlign){case 0:case 10:case 11:case 12:case 13:case 14:case 18:case 19:return!0}return!1},childrenAreVertAligned:function(){switch(this.transAlign){case 1:case 3:case 5:case 2:case 4:case 6:var e=this.leftChild,t=this.rightChild;return 0==e.rotateAlign&&1==e.scaleAlign&&0==t.rotateAlign&&1==t.scaleAlign}return!1},findEndChainLeadingNodes:function(e){if(this.childrenAreVertAligned()){var t=this.leftChild,n=this.rightChild;t.childrenAreVertAligned()?t.findEndChainLeadingNodes(e):0==t.rotateAlign&&1==t.scaleAlign&&e.push(t),n.childrenAreVertAligned()?n.findEndChainLeadingNodes(e):0==n.rotateAlign&&1==n.scaleAlign&&e.push(n)}else 0==this.rotateAlign&&1==this.scaleAlign&&e.push(this)},calculateLeadings:function(e){var t=[];this.findEndChainLeadingNodes(t);for(var n=99999.9,a=[],i=u.iter(t);!i.done;i.next()){var o=i.value,r=o.localbounds(),l=o.transformTo(this,new y.TheoRect(r.minX,r.minY,r.maxX,r.maxY));a.push(new h.NodeMeasurements(o,l.minY,l.maxY)),o.getLeading()<n&&(n=o.getLeading())}for(var s=u.sort(a,(function(e,t){return e.minY<t.minY})),g=0,c=u.iter(u.range(1,s.length-1,!0));!c.done;c.next())s[d=c.value].minY-s[d-1].maxY>g&&(g=s[d].minY-s[d-1].maxY);0==s[0].node.parent.leadingAdjustment&&(s[0].node.parent.leadingAdjustment=s[0].node.parent.getLeading()*e);for(var p=u.iter(u.range(1,s.length-1,!0));!p.done;p.next()){var d;s[d=p.value].node.parent.leadingAdjustment=(g-(s[d].minY-s[d-1].maxY)+n)*e}},resetLeadings:function(){this.leadingAdjustment=0,this.leftChild instanceof s&&this.leftChild.childrenAreVertAligned()&&(this.leftChild.leadingAdjustment=0,this.leftChild.resetLeadings()),this.rightChild instanceof s&&this.rightChild.childrenAreVertAligned()&&(this.rightChild.leadingAdjustment=0,this.rightChild.resetLeadings())},calcTransform:function(){var e=this.leftChild,t=this.rightChild;this.childrenAreVertAligned()?null!=this.parent&&this.parent.childrenAreVertAligned()||(this.resetLeadings(),e.calcTransform(),t.calcTransform(),this.internalCalcTransform(),this.calculateLeadings(f.TypographyLayout.lineSpacing)):this.leadingAdjustment=d.MathUtils.minDouble(this.leftChild.getLeading(),this.rightChild.getLeading())*f.TypographyLayout.lineSpacing,e.calcTransform(),t.calcTransform(),h.TypographyNode.prototype.calcTransform.call(this),this.internalCalcTransform()},internalCalcTransform:function(){var e=this.leftChild,t=this.rightChild,n=e.localbounds(),a=t.localbounds();switch(this.transAlign){case 0:t.translateXY(n.maxX-a.minX+this.getInternalHSpace(),n.minY-a.minY+(e.getBaseline()-t.getBaseline()));break;case 1:t.translateXY(n.minX-a.minX,n.maxY-a.minY+this.getInternalVSpace());break;case 2:t.translateXY(n.minX-a.minX,n.minY-a.maxY-this.getInternalVSpace());break;case 3:t.translateXY(n.maxX-a.maxX,n.maxY-a.minY+this.getInternalVSpace());break;case 4:t.translateXY(n.maxX-a.maxX,n.minY-a.maxY-this.getInternalVSpace());break;case 5:t.translateXY(n.minX+(n.width-a.width)/2-a.minX,n.maxY-a.minY+this.getInternalVSpace());break;case 6:t.translateXY(n.minX+(n.width-a.width)/2-a.minX,n.minY-a.maxY-this.getInternalVSpace());break;case 7:t.translateXY(n.maxX-a.minX+this.getInternalHSpace(),n.maxY-a.minY+this.getInternalVSpace());break;case 8:t.translateXY(n.maxX-a.minX+this.getInternalHSpace(),n.minY-a.maxY-this.getInternalVSpace());break;case 9:t.translateXY(n.minX-a.maxX-this.getInternalHSpace(),n.maxY-a.minY+this.getInternalVSpace());break;case 10:t.translateXY(n.maxX-a.minX+this.getInternalHSpace(),n.minY-a.minY);break;case 11:t.translateXY(n.minX-a.maxX-this.getInternalHSpace(),n.minY-a.minY);break;case 12:t.translateXY(n.maxX-a.minX+this.getInternalHSpace(),n.minY+(n.height-a.height)-a.minY);break;case 13:t.translateXY(n.minX-a.maxX-this.getInternalHSpace(),n.minY+(n.height-a.height)-a.minY);break;case 14:t.translateXY(n.maxX-a.minX+this.getInternalHSpace(),n.minY+(e.getMidline()-t.getMidline())-a.minY);break;case 15:t.translateXY(n.minX+e.getSemanticWidth()-(a.minX+t.getSemanticWidth()),n.maxY-a.minY+this.getInternalVSpace());break;case 16:t.translateXY(n.minX+e.getSemanticWidth()-a.minX,n.maxY-a.minY+this.getInternalVSpace());break;case 17:t.translateXY(n.minX+e.getSemanticWidth()-a.maxX,n.maxY-a.minY+this.getInternalVSpace());break;case 18:for(var i=(r=e.getRightmostTextNode()).localbounds(),o=r.parent;null!=o;)i=o.transformToLocalBounds(i),o=o.parent;t.translateXY(i.maxX-a.minX+this.getInternalHSpace(),i.minY-a.minY);break;case 19:var r;for(i=(r=e.getRightmostTextNode()).localbounds(),o=r.parent;null!=o;)i=o.transformToLocalBounds(i),o=o.parent;t.translateXY(i.maxX-a.minX+this.getInternalHSpace(),i.minY+(i.height-a.height)-a.minY);break;case 20:t.translateXY(n.minX-a.minX,n.maxY-a.minY-d.MathUtils.minDouble(n.height,a.height)/3);break;case 21:t.translateXY(n.maxX-a.maxX,n.maxY-a.minY-d.MathUtils.minDouble(n.height,a.height)/2);break;case 22:t.translateXY(n.minX-a.minX,n.minY-a.maxY+d.MathUtils.minDouble(n.height,a.height)/2);break;case 23:t.translateXY(n.maxX-a.minX-d.MathUtils.minDouble(n.width,a.width)/2,n.minY-a.minY)}},description:{get:function(){var e=h.TypographyNode._getters.description.call(this);return e+=this.leftChild.description,e+=this.rightChild.description}},getText:function(){for(var e=u.clone(this.getTextNodes()),t="",n=u.iter(e);!n.done;n.next())" "!=(t+=n.value.getText()).substr(t.length-1)&&(t+=" ");return t.trim()},getLines:function(){for(var e=[],t=[],n=u.clone(this.getTextNodes()),a=u.iter(n);!a.done;a.next())for(var i=a.value,o=i,r=i.parent;null!=r;){if(r.transAlign!=h.AlignmentIdiom.LRBB){e.includes(o.getId())||(e.push(o.getId()),t.push(o));break}if(r.getId()==this.getId())break;o=r,r=r.parent}return 0==t.length&&t.push(this),t},optimizeFlow:function(e,t,n,a,i){var o=u.clone(this.getTextNodes());if(o.length<2)return 1;u.assert(t.width>0&&t.height>0,"container size is 0"),this.resetScale();for(var r=0,l=0,s=0,h=u.iter(o);!h.done;h.next()){var g=h.value,c=g.localbounds();r+=c.width,l+=c.height,s+=g.token_.text.length}l/=u.toDouble(o.length);for(var p=d.MathUtils.maxInt(1,u.toInt(Math.sqrt(t.height*r/(l*t.width)))),m=d.MathUtils.maxInt(1,u.toInt(s/p)),y=[],T=0,L=o.length-1,A=u.iter(u.range(0,L,!0));!A.done;A.next()){var R=A.value;a&&R>0&&o[R-1].getWeight()!=o[R].getWeight()||T>=m?(y.push(R),T=o[R].token_.text.length):T+=o[R].token_.text.length}if(y.push(o.length),i>0)if(i>L){y.splice(0);for(var S=u.iter(u.range(0,L,!0));!S.done;S.next()){var v=S.value;y.push(v+1)}}else{var C=u.toInt(L/i);if(C>0){for(y.splice(0),v=C;v<L;)y.push(v),v+=C;y.push(o.length)}}if(this.buildBranchFromLines(u.clone(o),u.clone(y),e),n){this.calcTransform(),p=u.clone(this.getLines());for(var b=f.TypographyLayout.longestLine(u.clone(p)).localbounds().width,_=u.iter(p);!_.done;_.next()){var x=_.value;x.scaleAlign=b/x.localbounds().width}}return y.length},buildBranchFromLines:function(e,t,n){for(var a,i=0,o=[],r=u.iter(t);!r.done;r.next()){var l=r.value,h=l;if(h-i==1)o.push(e[i]);else{for(a=new s(e[h-2],e[h-1]),h-=3;h>=i;)a=new s(e[h],a),h-=1;o.push(a)}i=l}if(c.LegacyCoreAssert.isTrue(t.length==o.length,"did not find sub-branch for each line",void 0,"GroupNode.buildBranchFromLines","TypographyNode.swift",1269),o.length>1){var g=o.length;for((a=new s(o[g-2],o[g-1])).transAlign=n,g-=3;g>=0;)(a=new s(o[g],a)).transAlign=n,g-=1}else c.LegacyCoreAssert.isTrue(o[0]instanceof s,"if there's only one sub-branch node, it should be a group node",void 0,"GroupNode.buildBranchFromLines","TypographyNode.swift",1281),a=o[0];this.leftChild=a.leftChild,this.rightChild=a.rightChild,this.leftChild.parent=this,this.rightChild.parent=this,this.transAlign=a.transAlign},resetScale:function(){h.TypographyNode.prototype.resetScale.call(this),this.leftChild.resetScale(),this.rightChild.resetScale()},propagateDown:function(e){this.leftChild.propagateDown(e),this.rightChild.propagateDown(e),this.transAlign=e}}}),s)},ERpL:function(e,t,n){var a,i=t,o=n("oAGj"),r=n("wc1n"),l=n("cYVN"),s=n("djAF"),h=n("LGJg");i.ShapeRoleFeatures=o.defineEnum("ShapeRoleFeatures",{Area:"Area",ShapeWidth:"ShapeWidth",ShapeHeight:"ShapeHeight",CenterX:"CenterX",CenterY:"CenterY",RotCosine:"RotCosine",RotSine:"RotSine",PercentageDesignArea:"PercentageDesignArea",PercentageOutofBounds:"PercentageOutofBounds",OverlappingGraphicCount:"OverlappingGraphicCount",OverlappingTextCount:"OverlappingTextCount",PercentageTextOverlap:"PercentageTextOverlap",PercentageGraphicOverlap:"PercentageGraphicOverlap",MaskAverage:"MaskAverage",MaskAverageEdge:"MaskAverageEdge",PageHeight:"PageHeight",PageWidth:"PageWidth",ShapeCount:"ShapeCount",TextCount:"TextCount",BackgroundImageCount:"BackgroundImageCount",ForegroundImageCount:"ForegroundImageCount"}),i.ShapeRoleData=(a=function(e,t,n){l.RoleData.call(this,e,o.clone(t),o.clone(n))},o.defineClass({name:"ShapeRoleData",ctor:a,superName:"RoleData",statics:{getShapeRoleData:function(e){var t,n,l;if(l=o.as(e,s.ShapeForma)){var u=[i.ShapeRoleFeatures.Area,i.ShapeRoleFeatures.ShapeWidth,i.ShapeRoleFeatures.ShapeHeight,i.ShapeRoleFeatures.CenterX,i.ShapeRoleFeatures.CenterY,i.ShapeRoleFeatures.RotCosine,i.ShapeRoleFeatures.RotSine,i.ShapeRoleFeatures.PercentageDesignArea,i.ShapeRoleFeatures.PercentageOutofBounds,i.ShapeRoleFeatures.OverlappingGraphicCount,i.ShapeRoleFeatures.OverlappingTextCount,i.ShapeRoleFeatures.PercentageTextOverlap,i.ShapeRoleFeatures.PercentageGraphicOverlap,i.ShapeRoleFeatures.MaskAverage,i.ShapeRoleFeatures.MaskAverageEdge,i.ShapeRoleFeatures.PageHeight,i.ShapeRoleFeatures.PageWidth,i.ShapeRoleFeatures.ShapeCount,i.ShapeRoleFeatures.TextCount,i.ShapeRoleFeatures.BackgroundImageCount,i.ShapeRoleFeatures.ForegroundImageCount],g=r.FeatureExtractorFactory.getFeatureExtractor(r.FeatureExtractorType.Shape,l,o.clone(u)),c={};u.forEach((function(e){c[e]=(t=g.numericFeatureForKey(e))||null!=t?t:-1}));for(var p=o.iter(["line","heart","circle","arrow","square","instagram","rectangle","flower","star","love","triangle","food","music","party","?","birthday","sun","facebook","phone","youtube","badge"]);!p.done;p.next()){var d,f,m=p.value,y="search-"+m;u.push(y),c[y]=0,(d=o.as(l.contentNode,h.VectorContentNode))&&null!=(f=o.opt(o.opt(d.mediaMetadata,(function(e){return e.searchTerm})),(function(e){return e.toLowerCase()})))&&f==m&&(c[y]=1)}n=new a(e,o.clone(u),o.clone(c))}return n}}}),a)},EoOi:function(e,t,n){var a,i,o,r,l,s,h=t,u=n("oAGj"),g=n("iCxV"),c=n("fNpk"),p=n("c+uM"),d=n("3DEm"),f=n("ol4x"),m=n("8t9B"),y=n("3UhB"),T=n("7l9C"),L=n("uUew"),A=n("d2x6");h.FontMetricsParams=(a=function(e,t,n){this.font=e,this.fontSize=t,this.kerning=n},u.defineClass({name:"FontMetricsParams",ctor:a}),a),h.TypographyParams=(i=function(e,t,n){this.size_=e,this.lineSpacing_=t,this.relativeFontScale_=n},u.defineClass({name:"TypographyParams",ctor:i}),i),h.TypographyResult=(o=function(e,t,n){this.tree=e,this.tokens=u.clone(t),this.matrices=u.clone(n)},u.defineClass({name:"TypographyResult",ctor:o,statics:{isEqual:function(e,t){if(e.matrices.length==t.matrices.length){for(var n=u.iter(u.toSequence(e.matrices));!n.done;n.next()){var a=n.value,i=a.offset;if(!a.element.equal(t.matrices[i]))return!1}return!0}return!1}}}),o),h.TypographyWeighting=(r=function(e,t){this.alignment=e,this.weighting=u.clone(t)},u.defineClass({name:"TypographyWeighting",ctor:r}),r),h.MutableTypographyRange=(l=function(){},u.defineClass({name:"MutableTypographyRange",ctor:l,props:{init_4142:function(e,t){this.start=e,this.end=t},init_37b1:function(e){this.start=e.start,this.end=e.end}}}),l),h.TypographyComposer=(s=function e(t,n){e.initializeLayouts(),f.TypographyLayout.lineSpacing=t.lineSpacing_,this.params_=t,this.words_=u.clone(n)},u.defineClass({name:"TypographyComposer",ctor:s,statics:{DEFAULT_FONT_SIZE:32,GLYPH_HSPACE_ADJUSTMENT:.1,layouts:null,alignments:null,modifyHighlightRanges:!0,initializeLayouts:function(){null==s.alignments&&((s.alignments=[]).push(p.LockupAlignment.ScaledLeft),s.alignments.push(p.LockupAlignment.ScaledRight),s.alignments.push(p.LockupAlignment.ScaledCenter),s.alignments.push(p.LockupAlignment.FitEmphasized),s.alignments.push(p.LockupAlignment.FitTripletEmphasized),s.alignments.push(p.LockupAlignment.Triplet),s.alignments.push(p.LockupAlignment.TripletRotatedMiddle),s.alignments.push(p.LockupAlignment.TripletRotatedMiddleMulti),s.alignments.push(p.LockupAlignment.TripletRotatedEnds),s.alignments.push(p.LockupAlignment.LeftSpanRight),s.alignments.push(p.LockupAlignment.RightSpanLeft),s.alignments.push(p.LockupAlignment.RotateEmphasized),s.alignments.push(p.LockupAlignment.RotateEmphasized2),s.alignments.push(p.LockupAlignment.RotateEmphasizedMulti),s.alignments.push(p.LockupAlignment.RotateEmphasizedMultiFit),s.alignments.push(p.LockupAlignment.RotateUnemphasized),s.alignments.push(p.LockupAlignment.RotateUnemphasized2),s.alignments.push(p.LockupAlignment.RotateUnemphasizedAdjacent),s.alignments.push(p.LockupAlignment.DiagonalRightLeft),s.alignments.push(p.LockupAlignment.DiagonalFitFit),s.alignments.push(p.LockupAlignment.Corners),s.alignments.push(p.LockupAlignment.Corners2),s.alignments.push(p.LockupAlignment.Stagger),s.alignments.push(p.LockupAlignment.AltStagger),s.alignments.push(p.LockupAlignment.DropCap),s.alignments.push(p.LockupAlignment.DropCapFit),s.alignments.push(p.LockupAlignment.SingleTokenGrid)),null==s.layouts&&((s.layouts={})[p.LockupAlignment.Left]=f.ReflowAlignmentTypographyLayout.init_a5f3(T.AlignmentIdiom.LLtb,!1),s.layouts[p.LockupAlignment.Right]=f.ReflowAlignmentTypographyLayout.init_a5f3(T.AlignmentIdiom.RRtb,!1),s.layouts[p.LockupAlignment.Center]=f.ReflowAlignmentTypographyLayout.init_a5f3(T.AlignmentIdiom.CCtb,!1),s.layouts[p.LockupAlignment.LeftBreakOnRuns]=f.ReflowAlignmentTypographyLayout.init_a5f3(T.AlignmentIdiom.LLtb,!0),s.layouts[p.LockupAlignment.RightBreakOnRuns]=f.ReflowAlignmentTypographyLayout.init_a5f3(T.AlignmentIdiom.RRtb,!0),s.layouts[p.LockupAlignment.CenterBreakOnRuns]=f.ReflowAlignmentTypographyLayout.init_a5f3(T.AlignmentIdiom.CCtb,!0),s.layouts[p.LockupAlignment.ScaledLeft]=new f.ScaledSimpleAlignmentTypographyLayout(T.AlignmentIdiom.LLtb),s.layouts[p.LockupAlignment.ScaledRight]=new f.ScaledSimpleAlignmentTypographyLayout(T.AlignmentIdiom.RRtb),s.layouts[p.LockupAlignment.ScaledCenter]=new f.ScaledSimpleAlignmentTypographyLayout(T.AlignmentIdiom.CCtb),s.layouts[p.LockupAlignment.FitEmphasized]=new f.FitEmphasizedTypographyLayout,s.layouts[p.LockupAlignment.FitTripletEmphasized]=new f.FitTripletEmphasizedTypographyLayout,s.layouts[p.LockupAlignment.FitAll]=new f.FitAllTypographyLayout(!1,!0),s.layouts[p.LockupAlignment.FitAllBreakOnRuns]=new f.FitAllTypographyLayout(!0,!0),s.layouts[p.LockupAlignment.Triplet]=new f.MiddleTypographyLayout(f.MiddleTypographyLayout.TRIPLET),s.layouts[p.LockupAlignment.TripletRotatedMiddle]=new f.MiddleTypographyLayout(f.MiddleTypographyLayout.TRIPLET_ROTATED_MIDDLE),s.layouts[p.LockupAlignment.TripletRotatedMiddleMulti]=new f.MiddleTypographyLayout(f.MiddleTypographyLayout.TRIPLET_ROTATED_MIDDLE_MULTI),s.layouts[p.LockupAlignment.TripletRotatedEnds]=new f.MiddleTypographyLayout(f.MiddleTypographyLayout.TRIPLET_ROTATED_ENDS),s.layouts[p.LockupAlignment.LeftSpanRight]=new f.SpanMiddleTypographyLayout(f.SpanMiddleTypographyLayout.LEFT_RIGHT),s.layouts[p.LockupAlignment.RightSpanLeft]=new f.SpanMiddleTypographyLayout(f.SpanMiddleTypographyLayout.RIGHT_LEFT),s.layouts[p.LockupAlignment.RotateEmphasized]=new f.RotateTypographyLayout(f.RotateTypographyLayout.ROTATE_EMPHASIZED),s.layouts[p.LockupAlignment.RotateEmphasized2]=new f.RotateTypographyLayout(f.RotateTypographyLayout.ROTATE_EMPHASIZED2),s.layouts[p.LockupAlignment.RotateEmphasizedMulti]=new f.RotateTypographyLayout(f.RotateTypographyLayout.ROTATE_EMPHASIZED_MULTI),s.layouts[p.LockupAlignment.RotateEmphasizedMultiFit]=new f.RotateTypographyLayout(f.RotateTypographyLayout.ROTATE_EMPHASIZED_MULTI_FIT),s.layouts[p.LockupAlignment.RotateUnemphasized]=new f.RotateTypographyLayout(f.RotateTypographyLayout.ROTATE_UNEMPHASIZED),s.layouts[p.LockupAlignment.RotateUnemphasized2]=new f.RotateTypographyLayout(f.RotateTypographyLayout.ROTATE_UNEMPHASIZED2),s.layouts[p.LockupAlignment.RotateUnemphasizedAdjacent]=new f.RotateTypographyLayout(f.RotateTypographyLayout.ROTATE_UNEMPHASIZED_ADJACENT),s.layouts[p.LockupAlignment.RotateAndFit]=new f.RotateAndFitTypographyLayout,s.layouts[p.LockupAlignment.DiagonalRightLeft]=new f.DiagonalBoxTypographyLayout(f.DiagonalBoxTypographyLayout.RIGHT_LEFT),s.layouts[p.LockupAlignment.DiagonalFitFit]=new f.DiagonalBoxTypographyLayout(f.DiagonalBoxTypographyLayout.FIT_FIT),s.layouts[p.LockupAlignment.FitRotateFit]=new f.FitRotateFitTypographyLayout,s.layouts[p.LockupAlignment.Corners]=new f.CornersTypographyLayout(f.CornersTypographyLayout.RIGHTTOP_LEFTBOTTOM),s.layouts[p.LockupAlignment.Corners2]=new f.CornersTypographyLayout(f.CornersTypographyLayout.LEFTTOP_RIGHTBOTTOM),s.layouts[p.LockupAlignment.Step]=new f.StepTypographyLayout(f.StepTypographyLayout.STEP),s.layouts[p.LockupAlignment.StepRotate]=new f.StepTypographyLayout(f.StepTypographyLayout.STEP_ROTATE),s.layouts[p.LockupAlignment.StepReverse]=new f.StepTypographyLayout(f.StepTypographyLayout.STEP_REVERSE),s.layouts[p.LockupAlignment.StepRotateReverse]=new f.StepTypographyLayout(f.StepTypographyLayout.STEP_ROTATE_REVERSE),s.layouts[p.LockupAlignment.Drop]=new f.DropTypographyLayout(f.DropTypographyLayout.DROP_DOWN),s.layouts[p.LockupAlignment.Lift]=new f.DropTypographyLayout(f.DropTypographyLayout.DROP_UP),s.layouts[p.LockupAlignment.Stagger]=new f.StaggerTypographyLayout(!1),s.layouts[p.LockupAlignment.AltStagger]=new f.StaggerTypographyLayout(!0),s.layouts[p.LockupAlignment.DropCap]=new f.DropCapTypographyLayout(!1),s.layouts[p.LockupAlignment.DropCapFit]=new f.DropCapTypographyLayout(!0),s.layouts[p.LockupAlignment.SingleTokenGrid]=new f.SingleTokenGridTypographyLayout)},getWordRuns:function(e){for(var t=[],n=null,a=-1,i=u.iter(e);!i.done;i.next()){var o=i.value;o.weight!=a&&(null!=n&&t.push(u.clone(n)),n=[],a=o.weight),n.push(o)}return t.push(u.clone(n)),t},getLayout:function(e){return u.opt(this.layouts,(function(t){return t[e]}))},getApplicableLayoutWeightings:function(e,t){void 0===t&&(t=null),s.initializeLayouts();for(var n=[],a=s.getWordRanges(e,null),i=u.iter(s.alignments);!i.done;i.next()){var o=i.value,r=u.clone(s.layouts[o].calculateWeightings(e,a,u.clone(t)));if(null!=r)for(var l=u.iter(r);!l.done;l.next()){var g=l.value;n.push(new h.TypographyWeighting(o,u.clone(g)))}}return u.assert(n.length>0,"There are no valid layouts that apply."),n},getApplicableWeightedLayouts:function(e,t){void 0===t&&(t=null),s.initializeLayouts();for(var n=[],a=s.getWordRanges(e,null),i=u.iter(s.alignments);!i.done;i.next()){var o=i.value;null!=u.clone(s.layouts[o].calculateWeightings(e,a,u.clone(t)))&&n.push(o)}return 0==n.length&&n.push(p.LockupAlignment.Left),n},getApplicableLayouts:function(e,t){s.initializeLayouts();for(var n=[],a=u.iter(s.alignments);!a.done;a.next()){var i=a.value;s.isLayoutValid(i,u.clone(e),t)&&n.push(i)}return 0==n.length&&n.push(p.LockupAlignment.Left),n},isLayoutValid:function(e,t,n){var a=s.layouts[e],i=u.clone(s.getWordRuns(u.clone(t)));return!!a.conditionsMet(u.clone(i))&&a.constraintsMet(u.clone(t),n)},supportsRelativeFontScale:function(e){return e==p.LockupAlignment.ScaledLeft||e==p.LockupAlignment.ScaledRight||e==p.LockupAlignment.ScaledCenter||e==p.LockupAlignment.FitEmphasized||e==p.LockupAlignment.Triplet||e==p.LockupAlignment.TripletRotatedMiddle||e==p.LockupAlignment.TripletRotatedEnds||e==p.LockupAlignment.DropCapTop||e==p.LockupAlignment.DropCapBottom||e==p.LockupAlignment.SingleTokenTop||e==p.LockupAlignment.SingleTokenBottom||e==p.LockupAlignment.Corners||e==p.LockupAlignment.Corners2},getNextBestLayout:function(e){return s.layouts[p.LockupAlignment.Left]},canHandleText:function(e,t){var n=s.getWordRanges(e,u.clone(t)),a=0==t.length?15:20;return n.length<=a},getNextValidLayoutAlignment:function(e,t,n,a,i,o){var r,l;if(s.modifyHighlightRanges){var g,c;if(!o&&(g=s.getLayout(i))&&(c=g.calculateWeightings(e,s.getWordRanges(e,null)))&&c.length>0)return i;var d=u.clone(s.getApplicableWeightedLayouts(e));if(i!=p.LockupAlignment.UNSET&&d.length>1){var f=i,m=d.length;return f=((r=S=u.indexOf(d,f))||null!=r?r:-1)>=0?d[(S+1)%d.length]:u.first(d)}return u.first(d)}if(!s.canHandleText(e,u.clone(n)))return p.LockupAlignment.Left;var y=u.clone(s.buildTokenList(e,u.clone(n),t)),T=new h.TypographyParams(a,t.spacing,t.relativeFontScale),L=new s(T,u.clone(y));if(!o&&null!=s.layouts[i]&&s.isLayoutValid(i,u.clone(y),T))return i;var A=L.layout(i),R=null;if(d=u.clone(s.getApplicableLayouts(u.clone(y),T)),!(i!=p.LockupAlignment.UNSET&&d.length>1))return u.first(d);for(f=i,m=d.length;m>0;){var S;if(f=((l=S=u.indexOf(d,f))||null!=l?l:-1)>=0?d[(S+1)%d.length]:u.first(d),R=L.layout(f),!h.TypographyResult.isEqual(R,A))return f;m-=1}return i},layoutTree:function(e){e.calcGlobalMatrices();for(var t=[],n=[],a=u.clone(e.getRoot().getTextNodes()),i=u.iter(a);!i.done;i.next()){var o=i.value;t.push(o.token_),n.push(o.global())}return new h.TypographyResult(e,u.clone(t),u.clone(n))},getDefaultRanges:function(e){var t=[];if(e.length>1){var n=u.sort(e,(function(e,t){return e.length>t.length}));t.push(n[0])}return t},getWordRanges:function(e,t){for(var n=[],a=0,i=-1,o=u.iter(u.range(0,e.length-1,!0));!o.done;o.next()){var r=o.value;y.TypeLockupUtils.isWhiteSpace(e.substr(r,1))?(a<=i&&n.push(new L.TextRange(a,i+1)),a=r+1):i=r}if(a<=i&&n.push(new L.TextRange(a,i+1)),null==t||0==t.length)return n;for(var l=[],s=u.iter(n);!s.done;s.next()){var g=s.value;l.push(h.MutableTypographyRange.init_37b1(g))}for(var c=u.iter(t);!c.done;c.next()){var p=c.value;l.push(h.MutableTypographyRange.init_37b1(p))}var d=u.sort(l,(function(e,t){return e.start<t.start}));for(r=1;r<d.length;)d[r].start==d[r-1].start&&d[r].end==d[r-1].end?d.splice(r,1):(d[r].start<d[r-1].end&&(d[r-1].start<d[r].start?(i=d[r-1].end,d[r-1].end=d[r].start,d[r].end<i&&d.splice(r,0,h.MutableTypographyRange.init_4142(d[r].end,i))):(i=d[r-1].end,d[r].end<i?(d[r-1].end=d[r].end,d[r].start=d[r].end,d[r].end=i):d[r].start=d[r-1].end)),r+=1);for(var f=[],m=u.iter(d);!m.done;m.next())p=m.value,f.push(new L.TextRange(p.start,p.end));return f},buildTokenList:function(e,t,n){for(var a=[],i=e,o=0,r=u.clone(0==t.length?s.getDefaultRanges(s.getWordRanges(e,null)):t),l=s.getWordRanges(e,u.clone(r)),c=new h.FontMetricsParams(n.font.fontData,s.DEFAULT_FONT_SIZE,n.tracking),p=u.iter(l);!p.done;p.next()){for(var f=p.value,y=0,T=u.iter(r);!T.done;T.next()){var A=T.value;if(f.start<A.end&&f.end-1>=A.start){y=1;break}}for(var R=e.substr(f.start,f.length).trim();o<e.length&&!i.startsWith(R);)i=i.substr(1),o+=1;0==t.length||0==y?c.font=n.font.fontData:c.font=u.opt(u.opt(n.characterStyles[m.TypeLockupController.HIGHLIGHT_STYLE],(function(e){return e.font})),(function(e){return e.fontData}))||n.font.fontData;var S=g.Host.textModelUtils.calcFontMetrics(R,y,c);S.range=new L.TextRange(o,o+S.text.length),S.range.end<e.length&&e.substr(S.range.end,1).trim().length>0&&(S.hspace*=d.MathUtils.maxDouble(s.GLYPH_HSPACE_ADJUSTMENT,c.kerning)),a.push(S),o+=S.text.length,i=i.substr(S.text.length)}return a}},props:{layout:function(e){var t=A.TypographyTree.buildArchetypeTree(u.clone(this.words_)),n=u.clone(t.getRoot().getTextRuns()),a=s.layouts[e];return null==a?(c.LegacyCoreAssert.isTrue(null==a,"No typgraphy rule.",void 0,"TypographyComposer.layout","TypographyComposer.swift",446),a=s.layouts[p.LockupAlignment.Left]):a.conditionsMet(u.clone(s.getWordRuns(u.clone(this.words_))))||(a=s.getNextBestLayout(e)),a.arrangeText(t,u.clone(n),this.params_),s.layoutTree(t)}}}),s)},XupS:function(e,t,n){var a,i=t,o=n("oAGj"),r=n("JEnV"),l=n("VDg0"),s=n("cEEQ"),h=n("c+uM"),u=n("tGKA"),g=n("EoOi"),c=n("VJ9E"),p=n("8t9B"),d=n("oKlP"),f=n("1NAc");i.AutoTextLayoutStrategy=(a=function(){this.tokens_=null,this.text_=null,this.typeParams_=null,this.hiliteRanges_=null,this.previousAutoAlignment_=h.LockupAlignment.UNSET,this.scale_=1,this.prevStyle_=null,this.prevFont_=null,this.prevHiliteFont_=null,this.prevTracking_=null,this.defaultStrategy_=null,s.BaseLockupLayoutStrategy.call(this)},o.defineClass({name:"AutoTextLayoutStrategy",ctor:a,superName:"BaseLockupLayoutStrategy",statics:{_implements:function(e){return"LockupLayoutStrategy"==e}},props:{sameStyle:function(e){if(!o.eq(c._equality_TheoFont_TheoFont,this.prevFont_,e.font)||this.prevTracking_!=e.tracking)return!1;var t=o.opt(e.characterStyles[p.TypeLockupController.HIGHLIGHT_STYLE],(function(e){return e.font}));return null==this.prevHiliteFont_?null==t:null!=t&&o.eq(c._equality_TheoFont_TheoFont,this.prevHiliteFont_,t)},supportsConfiguration:function(e){return h.LockupStyle.isAutoLayout(e.style.layout)},calculateTracking:function(e,t){return null!=this.defaultStrategy_?this.defaultStrategy_.calculateTracking(e,t):e.style.tracking},calculateLeading:function(e,t){return null!=this.defaultStrategy_?this.defaultStrategy_.calculateLeading(e,t):e.style.spacing},adjustSizeForTracking:function(e,t,n,a){if(null!=this.defaultStrategy_)return this.defaultStrategy_.adjustSizeForTracking(e,t,n,a);if(this.previousAutoAlignment_!=h.LockupAlignment.UNSET){var i=this.scale_;this.typeParams_.size_=t.size;var r=new g.TypographyComposer(this.typeParams_,o.clone(this.tokens_)),l=r.layout(this.previousAutoAlignment_),s=l.tree.getBounds().size.multiply(i);this.prevStyle_.tracking=a,this.tokens_=o.clone(g.TypographyComposer.buildTokenList(this.text_,o.clone(this.hiliteRanges_),this.prevStyle_));var u=(l=(r=new g.TypographyComposer(this.typeParams_,o.clone(this.tokens_))).layout(this.previousAutoAlignment_)).tree.getBounds().size.multiply(i);return this.scale_=i,new f.TheoSize(u.width-s.width,u.height-s.height)}return null},adjustSizeForLeading:function(e,t,n,a){if(null!=this.defaultStrategy_)return this.defaultStrategy_.adjustSizeForLeading(e,t,n,a);if(this.previousAutoAlignment_!=h.LockupAlignment.UNSET){var i=this.scale_;this.typeParams_.size_=t.size,this.typeParams_.lineSpacing_=n;var r=new g.TypographyComposer(this.typeParams_,o.clone(this.tokens_)),l=r.layout(this.previousAutoAlignment_),s=l.tree.getBounds().size.multiply(i);this.typeParams_.lineSpacing_=a;var u=(l=(r=new g.TypographyComposer(this.typeParams_,o.clone(this.tokens_))).layout(this.previousAutoAlignment_)).tree.getBounds().size.multiply(i);return this.scale_=i,new f.TheoSize(u.width-s.width,u.height-s.height)}return f.TheoSize.Zero},updateTokens:function(e,t,n){null!=this.tokens_&&null!=this.text_&&this.text_==e&&null!=this.prevStyle_&&this.sameStyle(t)&&null!=this.hiliteRanges_&&p.TypeLockupController.rangesEqual(o.clone(this.hiliteRanges_),o.clone(n))||(this.text_=e,this.hiliteRanges_=n.concat(),this.previousAutoAlignment_=h.LockupAlignment.UNSET,this.prevStyle_=t,this.prevFont_=t.font,this.prevHiliteFont_=o.opt(t.characterStyles[p.TypeLockupController.HIGHLIGHT_STYLE],(function(e){return e.font})),this.prevTracking_=t.tracking,this.tokens_=o.clone(g.TypographyComposer.buildTokenList(this.text_,o.clone(this.hiliteRanges_),t)))},layout:function(e){if(!g.TypographyComposer.canHandleText(e.text,o.clone(e.characterStyleRanges)))return null==this.defaultStrategy_&&(this.defaultStrategy_=new r.EvenRowHeightsLayoutStrategy(h.LockupAlignment.Left)),o.opt(this.defaultStrategy_,(function(t){return t.layout(e)}));this.defaultStrategy_=null;var t,n,a,i=[],c=p.TypeLockupController.HIGHLIGHT_STYLE,f=e.containerSize,m=o.clone(e.characterStyleRanges),y=g.TypographyComposer.getNextValidLayoutAlignment(e.text,e.style,o.clone(m),f,e.style.alignment,!1);(n=g.TypographyComposer.getLayout(y))&&(a=n.calculateWeightings(e.text,g.TypographyComposer.getWordRanges(e.text,null)))&&(m=o.clone(a[0])),this.updateTokens(e.text,e.style,o.clone(m)),this.typeParams_=new g.TypographyParams(f,e.style.spacing,e.style.relativeFontScale);var T=new g.TypographyComposer(this.typeParams_,o.clone(this.tokens_)).layout(y);this.previousAutoAlignment_=y;var L=T.tree.getBounds();l.LockupConfiguration.fitToContainerArea?this.scale_=Math.sqrt(f.width*f.height/(L.width*L.height)):f.aspectRatio>L.aspectRatio?this.scale_=f.height/L.height:this.scale_=f.width/L.width;for(var A=new s.TypographicBoundingRatios(0,0,0,0,0,!1),R=o.clone(T.matrices),S=e.style,v=new d.TheoPoint(L.minX,L.minY),C=o.iter(o.toSequence(T.tokens));!C.done;C.next()){var b,_=C.value,x=_.offset,I=_.element,M=T.matrices[x].calculateTransformValuesSKRT(),w=this.scale_*M.yscale*g.TypographyComposer.DEFAULT_FONT_SIZE,D=u.Matrix2D.Identity.rotate(M.rotCosine,M.rotSine).translateTo((M.tx-v.x)*this.scale_,(M.ty-v.y)*this.scale_-I.postVertOffset*w);b=1==I.weight&&o.opt(o.opt(S.characterStyles[c],(function(e){return e.font})),(function(e){return e.fontData}))||S.font.fontData;var k=s.LockupItem.init_38d4(!0,1==I.weight?c:null,R[x].transformRect(I.bounds).size,D,I.text,b,w,w,A,x,I.range);i.push(k)}return t=L.size.multiply(this.scale_),new s.LayoutResults(o.clone(i),t,u.Matrix2D.Identity,A,0)}}}),a)},cYVN:function(e,t,n){var a,i=t,o=n("oAGj"),r=n("fNpk");i.RoleData=(a=function(e,t,n){for(var a=o.iter(t);!a.done;a.next()){var i=a.value;r.LegacyCoreAssert.isTrue(null!=n[i],"nil feature value",void 0,"RoleData.init","RoleData.swift",24)}for(var l=o.iter(o.keys(n));!l.done;l.next())i=l.value,r.LegacyCoreAssert.isTrue(t.includes(i),"missing feature order",void 0,"RoleData.init","RoleData.swift",27);this.forma=e,this.featureOrder=o.clone(t),this.featureValues=o.clone(n)},o.defineClass({name:"RoleData",ctor:a,props:{feat:function(e){return this.featureValues[e]},getUniqueKey:function(){for(var e="",t=o.iter(this.getFeatureVector());!t.done;t.next()){var n=t.value;e=e+o.toString("%.2f",n)+"-"}return e=o.replaceAll(e,".","")},asString:{get:function(){for(var e="",t=o.iter(this.featureOrder);!t.done;t.next()){var n=t.value,a=Math.round(1e3*this.featureValues[n])/1e3;e+=n+": "+o.toString(a)+",\n"}return e}},asJson:{get:function(){return"{\n"+this.asString+"\n}"}},getFeatureVector:function(){for(var e=[],t=o.iter(this.featureOrder);!t.done;t.next()){var n=t.value;e.push(this.featureValues[n])}return e}}}),a)},d2x6:function(e,t,n){var a,i=t,o=n("oAGj"),r=n("gXiO"),l=n("fNpk"),s=n("tGKA"),h=n("7l9C"),u=n("1NAc");i.TypographyTree=(a=function(){r.CoreObject.call(this),this.root_=null},o.defineClass({name:"TypographyTree",ctor:a,superName:"CoreObject",statics:{buildArchetypeTree:function(e){var t=new a;if(e.length>1){for(var n=-1,i=[],r=[],l=o.iter(o.toSequence(e));!l.done;l.next()){var s=l.value,g=s.offset,c=s.element,p=a.createTextNode(c,g);if(i.length>0&&c.weight!=n){var d=i[0];i.shift();for(var f=o.iter(i);!f.done;f.next()){var m=f.value;d=A=a.createGroupNode(d,m,h.AlignmentIdiom.LRBB)}r.push(d),i.splice(0)}i.push(p),n=c.weight}if(i.length>0){d=i[0],i.shift();for(var y=o.iter(i);!y.done;y.next())m=y.value,d=A=a.createGroupNode(d,m,h.AlignmentIdiom.LRBB);r.push(d)}var T=r[0];r.shift();for(var L=o.iter(r);!L.done;L.next())d=L.value,T=A=a.createGroupNode(T,d,h.AlignmentIdiom.LRBB);t.setRoot(T)}else{p=a.createTextNode(o.first(e),0);var A=a.createGroupNode(p,new h.SpacerNode(1,new u.TheoSize(0,0)),h.AlignmentIdiom.LRBB);t.setRoot(A)}return t},createTextNode:function(e,t){return new h.TextNode(e,t)},createGroupNode:function(e,t,n){var a=new h.GroupNode(e,t);return a.transAlign=n,a}},props:{setRoot:function(e){this.root_=e},getRoot:function(){return this.root_},getBounds:function(){return this.root_.localbounds()},calcGlobal:function(e){if(e.isSame(this.root_)){var t=e.local();e.globalMat=new s.Matrix2D(t.a,t.b,t.c,t.d,t.tx,t.ty)}else if(o.opt(e.parent,(function(e){return null==e.globalMat}))&&this.calcGlobal(e.parent),e instanceof h.TextNode){var n=new s.Matrix2D(1,0,0,1,0,e.getVerticalOffset());e.globalMat=n.concat(e.local()).concat(e.parent.globalMat)}else e.globalMat=e.local().concat(e.parent.globalMat);e instanceof h.GroupNode&&(this.calcGlobal(e.getChild(!0)),this.calcGlobal(e.getChild(!1)))},calcGlobalMatrices:function(){this.root_.calcTransform(),this.calcGlobal(this.root_)},rotateNode:function(e){if(null!=e.parent&&!o.opt(e.parent,(function(e){return null==e.parent}))){var t=e.parent,n=t.parent;if(null!=n.parent){var a=n.parent;t.parent=a,a.getChild(!0).isSame(n)?a.setChild(t,!0):a.setChild(t,!1)}else t.parent=null,this.setRoot(t);n.getChild(!0).isSame(t)?(n.setChild(t.getChild(!1),!0),t.setChild(n,!1)):(n.setChild(t.getChild(!0),!1),t.setChild(n,!0)),n.parent=t}},findCommonAncestor:function(e){l.LegacyCoreAssert.isTrue(e.length>1,"findCommonAncestor expects at least two nodes",void 0,"TypographyTree.findCommonAncestor","TypographyTree.swift",155);for(var t=[],n=[],a=e[0].parent;null!=a;)t.push(a),n.push(1),a=a.parent;for(var i=o.iter(o.range(1,e.length-1,!0));!i.done;i.next())for(a=e[i.value].parent;null!=a;){for(var r=a.getId(),s=o.iter(o.toSequence(t));!s.done;s.next()){var h=s.value,u=h.offset;if(h.element.getId()==r){n[u]+=1;break}}a=a.parent}for(var g=o.iter(o.toSequence(n));!g.done;g.next()){var c=g.value;if(u=c.offset,c.element==e.length)return t[u]}return l.LegacyCoreAssert.fail("Can't find common ancestor TypographyNode",void 0,"TypographyTree.findCommonAncestor","TypographyTree.swift",184),null},description:{get:function(){var e="TypographyTree:\r\n";return null!=this.root_&&(e+=this.root_.description),e}}}}),a)},lYNH:function(e,t,n){var a,i,o,r=t,l=n("oAGj"),s=n("uj1m"),h=n("7Ta2"),u=n("taeg");r.ShapeRoleSuggesterFactory=(a=function(){},l.defineClass({name:"ShapeRoleSuggesterFactory",ctor:a,statics:{Create:function(e){return void 0===e&&(e=""),"MLP"==e?new r.ShapeRoleSuggesterMLP:new r.ShapeRoleSuggesterSimple}}}),a),r.ShapeRoleSuggesterMLP=(i=function(){u.RoleSuggesterMLP.call(this)},l.defineClass({name:"ShapeRoleSuggesterMLP",ctor:i,superName:"RoleSuggesterMLP",statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRoleModel:function(){var e=s.MLPModel.loadNNModel("ShapeRole");return l.opt(e,(function(e){return e.finalSoftmax=!1})),e}}}),i),r.ShapeRoleSuggesterSimple=(o=function(){},l.defineClass({name:"ShapeRoleSuggesterSimple",ctor:o,statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRole:function(e){var t=h.InferredRoleType.Undefined;return e.forma.isGridCell()&&(t=e.forma.controller.floating?h.InferredRoleType.Backing:h.InferredRoleType.Background),h.InferredRole.init_84d1(t,1)}}}),o)},ol4x:function(e,t,n){var a,i,o,r,l,s,h,u,g,c,p,d,f,m,y,T,L,A,R,S,v,C,b,_=t,x=n("oAGj"),I=n("iCxV"),M=n("3DEm"),w=n("EoOi"),D=n("7l9C"),k=n("uUew"),E=n("1NAc"),F=n("d2x6");_.SpacerIdiom=x.defineEnum("SpacerIdiom",{insertLeft:0,insertRight:1,insertAbove:2,insertBelow:3}),_.LineMeasurements=(a=function(e,t){this.node=e,this.index=t,this.leaves=x.clone(e.getTextNodes()),this.width=e.localbounds().width},x.defineClass({name:"LineMeasurements",ctor:a}),a),_.TypographyLayout=(i=function(){this.fontScalingDiff=.25},x.defineClass({name:"TypographyLayout",ctor:i,statics:{worstScore:9999999.9,lineSpacing:.2,weightText:function(e,t,n,a){if(void 0===a&&(a=null),n<2)return null;for(var i=[],o=x.iter(x.range(2,n,!0));!o.done;o.next()){for(var r=o.value,l=[],s=[],h=x.toDouble(t.length)/x.toDouble(2*r),u=h,g=0,c=x.iter(x.range(0,r-1,!0));!c.done;c.next()){for(var p=M.MathUtils.minInt(x.toInt(u),t.length);g<p;)l.push(t[g]),g+=1;for(u+=h,p=M.MathUtils.minInt(x.toInt(u),t.length);g<p;)s.push(t[g]),g+=1;u+=h}if(g<t.length)for(;g<t.length;)s.push(t[g]),g+=1;i.push(x.clone(l)),i.push(x.clone(s))}return i},divideIntoPairs:function(e,t,n){void 0===n&&(n=null);var a=x.toInt(t.length/2);if(a<2)return null;for(var o=[],r=x.iter(x.range(2,a,!0));!r.done;r.next()){var l,s=r.value;if(l=i.weightText(e,t,s,x.clone(n)))for(var h=x.iter(l);!h.done;h.next()){var u=h.value;o.push(x.clone(u))}}return o},preWeightText:function(e,t,n){for(var a=[],i=x.iter(t);!i.done;i.next()){var o=i.value;o.end<=n&&a.push(o)}return a.length>0?a:null},postWeightText:function(e,t,n){var a=[],i=e.length-n;if(i>0){a=[];for(var o=x.iter(t);!o.done;o.next()){var r=o.value;r.start>=i&&a.push(r)}}return a.length>0?a:null},longestWord:function(e){return x.sort(e,(function(e,t){return e.length>t.length}))[0]},longestRun:function(e,t){for(var n=0,a=null,i=x.iter(e);!i.done;i.next()){var o=i.value;t&&o.propagateDown(D.AlignmentIdiom.LRBB),o.calcTransform();var r=o.localbounds().width;r>n&&(n=r,a=o)}return a},longestLine:function(e){for(var t=null,n=0,a=x.iter(e);!a.done;a.next()){var i=a.value,o=i.localbounds().width;o>n&&(n=o,t=i)}return t},canRotate:function(e){e.calcTransform();var t=e.localbounds();return t.width/t.height>1},getDesiredSize:function(e,t){var n=t.aspectRatio,a=e.width,i=a/n;return i<e.height&&(a*=e.height/i,i=e.height),new E.TheoSize(a,i)},insertSpacer:function(e,t,n,a,i,o){var r=t.parent,l=new D.SpacerNode(a,n),s=i==_.SpacerIdiom.insertLeft||i==_.SpacerIdiom.insertAbove?new D.GroupNode(l,t):new D.GroupNode(t,l);return s.transAlign=o,s.parent=r,r.getChild(!0).isSame(t)?r.setChild(s,!0):r.setChild(s,!1),l},getScore:function(e,t){return M.MathUtils.absDouble(e.aspectRatio/t.aspectRatio-1)}},props:{calculateWeightings:function(e,t,n){return void 0===n&&(n=null),null},conditionsMet:function(e){return!0},constraintsMet:function(e,t){if(this.scalesFonts()){var n=F.TypographyTree.buildArchetypeTree(x.clone(e)),a=x.clone(n.getRoot().getTextRuns());this.arrangeText(n,x.clone(a),t),n.calcGlobalMatrices();for(var i=x.clone(n.getRoot().getTextNodes()),o=Number.MAX_VALUE,r=-Number.MAX_VALUE,l=x.iter(i);!l.done;l.next()){var s=l.value.global().extractedScale.scale.y;o=M.MathUtils.minDouble(s,o),r=M.MathUtils.maxDouble(s,r)}return o/r>=this.fontScalingDiff}return!0},scalesFonts:function(){return!1},arrangeWeightedText:function(e,t,n){},arrangeText:function(e,t,n){}}}),i),_.SimpleAlignmentTypographyLayout=(o=function(e){this.alignment_=e,_.TypographyLayout.call(this)},x.defineClass({name:"SimpleAlignmentTypographyLayout",ctor:o,superName:"TypographyLayout",props:{calculateWeightings:function(e,t,n){return void 0===n&&(n=null),x.toInt(t.length/2)<1?null:_.TypographyLayout.divideIntoPairs(e,t,x.clone(n))},arrangeText:function(e,t,n){for(var a=x.iter(t);!a.done;a.next()){var i=a.value;i.propagateDown(D.AlignmentIdiom.LRBB),null!=i.parent&&(i.parent.transAlign=this.alignment_)}}}}),o),_.ReflowAlignmentTypographyLayout=(r=function(){},x.defineClass({name:"ReflowAlignmentTypographyLayout",ctor:r,superName:"SimpleAlignmentTypographyLayout",props:{init_d41d:function(){this.breakOnRuns_=!1,_.SimpleAlignmentTypographyLayout.call(this,D.AlignmentIdiom.LRBB)},init_a5f3:function(e,t){this.breakOnRuns_=t,_.SimpleAlignmentTypographyLayout.call(this,e)},conditionsMet:function(e){return!!_.SimpleAlignmentTypographyLayout.prototype.conditionsMet.call(this,x.clone(e))&&(e.length>1||(1==e[0].length?!this.breakOnRuns_&&this.alignment_==D.AlignmentIdiom.LLtb:!this.breakOnRuns_))},arrangeText:function(e,t,n){if(1!=e.getRoot().getTextNodes().length){var a;if(t.length>1)a=e.findCommonAncestor(x.clone(t));else{if(!(x.first(t)instanceof D.GroupNode))return;a=x.first(t)}a.optimizeFlow(this.alignment_,n.size_,!1,this.breakOnRuns_,0)}else _.SimpleAlignmentTypographyLayout.prototype.arrangeText.call(this,e,x.clone(t),n)}}}),r),_.scaleToRange=function(e,t,n,a){return e<0||e>1?a:t+e*(n-t)},_.ScaledSimpleAlignmentTypographyLayout=(l=function(e){this.MIN_SCALE=.33,this.MAX_SCALE=3,this.DEFAULT_SCALE=.75,_.SimpleAlignmentTypographyLayout.call(this,e)},x.defineClass({name:"ScaledSimpleAlignmentTypographyLayout",ctor:l,superName:"SimpleAlignmentTypographyLayout",props:{conditionsMet:function(e){return e.length>1},scalesFonts:function(){return!0},calculateWeightings:function(e,t,n){void 0===n&&(n=null);var a=x.toInt(t.length/2);if(a<2)return null;for(var i=[],o=x.iter(x.range(1,a,!0));!o.done;o.next()){for(var r=o.value,l=[],s=[],h=x.iter(x.range(0,r,!0));!h.done;h.next()){var u=h.value;l.push(t[u])}for(var g=x.iter(x.range(r+1,t.length-1,!0));!g.done;g.next())u=g.value,s.push(t[u]);i.push(x.clone(l)),i.push(x.clone(s))}return i.length>0?i:null},getScale:function(e){return _.scaleToRange(e,this.MIN_SCALE,this.MAX_SCALE,this.DEFAULT_SCALE)},arrangeText:function(e,t,n){_.SimpleAlignmentTypographyLayout.prototype.arrangeText.call(this,e,x.clone(t),n);for(var a=0,i=0,o=x.iter(t);!o.done;o.next()){(h=o.value).calcTransform();var r=h.localbounds().width;1==h.getWeight()?r>a&&(a=r):r>i&&(i=r)}if(a>=i)for(var l=x.iter(t);!l.done;l.next())0==(h=l.value).getWeight()&&(h.scaleAlign=this.getScale(n.relativeFontScale_));else for(var s=x.iter(t);!s.done;s.next()){var h;0==(h=s.value).getWeight()?h.scaleAlign=this.getScale(n.relativeFontScale_):h.scaleAlign=i/a}}}}),l),_.FitAllTypographyLayout=(s=function(e,t){this.breakOnRuns_=e,this.reflow_=t,_.SimpleAlignmentTypographyLayout.call(this,D.AlignmentIdiom.CCtb)},x.defineClass({name:"FitAllTypographyLayout",ctor:s,superName:"SimpleAlignmentTypographyLayout",props:{conditionsMet:function(e){return!!_.SimpleAlignmentTypographyLayout.prototype.conditionsMet.call(this,x.clone(e))&&(1!=e.length||1!=e[0].length)&&(!this.breakOnRuns_||e.length>1)},scalesFonts:function(){return!0},arrangeText:function(e,t,n){if(_.SimpleAlignmentTypographyLayout.prototype.arrangeText.call(this,e,x.clone(t),n),this.reflow_){var a;if(t.length>1)a=e.findCommonAncestor(x.clone(t));else{if(!(x.first(t)instanceof D.GroupNode))return;a=x.first(t)}a.optimizeFlow(this.alignment_,n.size_,!0,this.breakOnRuns_,0)}else for(var i=_.TypographyLayout.longestRun(x.clone(t),!0).localbounds().width,o=x.iter(t);!o.done;o.next()){var r=o.value;r.scaleAlign=i/r.localbounds().width}}}}),s),_.FitEmphasizedTypographyLayout=(h=function(){this.MIN_SCALE=.1,this.MAX_SCALE=2,this.DEFAULT_SCALE=.75,_.SimpleAlignmentTypographyLayout.call(this,D.AlignmentIdiom.CCtb)},x.defineClass({name:"FitEmphasizedTypographyLayout",ctor:h,superName:"SimpleAlignmentTypographyLayout",props:{conditionsMet:function(e){return _.SimpleAlignmentTypographyLayout.prototype.conditionsMet.call(this,x.clone(e))&&e.length>1},scalesFonts:function(){return!0},getScale:function(e){return _.scaleToRange(e,this.MIN_SCALE,this.MAX_SCALE,this.DEFAULT_SCALE)},calculateWeightings:function(e,t,n){if(void 0===n&&(n=null),t.length<2)return null;var a=x.sort(t,(function(e,t){return e.length>t.length})),i=[],o=[];return o.push(a[0]),i.push(x.clone(o)),i.length>0?i:null},arrangeText:function(e,t,n){_.SimpleAlignmentTypographyLayout.prototype.arrangeText.call(this,e,x.clone(t),n);for(var a=_.TypographyLayout.longestRun(x.clone(t),!0).localbounds().width,i=x.iter(t);!i.done;i.next()){var o=i.value;1==o.getWeight()?(o.calcTransform(),o.scaleAlign=a/o.localbounds().width):o.scaleAlign=this.getScale(n.relativeFontScale_)}}}}),h),_.StepTypographyLayout=(u=function e(t){this.flavor_=t,_.SimpleAlignmentTypographyLayout.call(this,t>=e.STEP_REVERSE?D.AlignmentIdiom.LRbt:D.AlignmentIdiom.LRtb)},x.defineClass({name:"StepTypographyLayout",ctor:u,superName:"SimpleAlignmentTypographyLayout",statics:{STEP:0,STEP_ROTATE:1,STEP_REVERSE:2,STEP_ROTATE_REVERSE:3},props:{conditionsMet:function(e){return e.length>2},scalesFonts:function(){return!0},calculateWeightings:function(e,t,n){return void 0===n&&(n=null),x.toInt(t.length/2)<2?null:_.TypographyLayout.divideIntoPairs(e,t,x.clone(n))},arrangeText:function(e,t,n){if(_.SimpleAlignmentTypographyLayout.prototype.arrangeText.call(this,e,x.clone(t),n),this.flavor_==u.STEP_ROTATE||this.flavor_==u.STEP_ROTATE_REVERSE){for(var a=x.iter(x.toSequence(t));!a.done;a.next()){var i=a.value,o=i.offset,r=i.element;o%2!=0?this.flavor_==u.STEP_ROTATE?(r.rotateAlign=D.TypographyNode.Clockwise,r.parent.transAlign=D.AlignmentIdiom.LRctt):(r.rotateAlign=D.TypographyNode.CounterClockwise,r.parent.transAlign=D.AlignmentIdiom.LRcbb):r.parent.transAlign=this.flavor_==u.STEP_ROTATE_REVERSE?D.AlignmentIdiom.LRtt:D.AlignmentIdiom.LRBB}e.getRoot().calcTransform();for(var l=0,s=x.iter(x.toSequence(t));!s.done;s.next()){var h=s.value,g=(o=h.offset,(r=h.element).localbounds().size);o%2!=0&&(l+=g.width)}for(var c=e.getBounds().size,p=_.TypographyLayout.getDesiredSize(c,n.size_),d=p.height/c.height,f=(p.width-l*d)/(c.width-l),m=x.iter(x.toSequence(t));!m.done;m.next()){var y=m.value;o=y.offset,(r=y.element).scaleAlign=o%2!=0?d:f}}}}}),u),_.DropTypographyLayout=(g=function e(t){this.flavor_=t,_.SimpleAlignmentTypographyLayout.call(this,t==e.DROP_DOWN?D.AlignmentIdiom.LRtt:D.AlignmentIdiom.LRBB)},x.defineClass({name:"DropTypographyLayout",ctor:g,superName:"SimpleAlignmentTypographyLayout",statics:{DROP_DOWN:0,DROP_UP:1},props:{calculateWeightings:function(e,t,n){return void 0===n&&(n=null),x.toInt(t.length/2)<2?null:_.TypographyLayout.divideIntoPairs(e,t,x.clone(n))},conditionsMet:function(e){return e.length>2&&e.length%2==0},arrangeText:function(e,t,n){_.SimpleAlignmentTypographyLayout.prototype.arrangeText.call(this,e,x.clone(t),n);for(var a=x.iter(x.toSequence(t));!a.done;a.next()){var i=a.value,o=i.offset,r=i.element;o%2!=0&&(r.rotateAlign=this.flavor_==g.DROP_DOWN?D.TypographyNode.Clockwise:D.TypographyNode.CounterClockwise)}}}}),g),_.StaggerTypographyLayout=(c=function(e){this.alternate_=e,_.TypographyLayout.call(this)},x.defineClass({name:"StaggerTypographyLayout",ctor:c,superName:"TypographyLayout",props:{conditionsMet:function(e){return e.length>=4&&(this.alternate_||e.length%2==0)},scalesFonts:function(){return!0},calculateWeightings:function(e,t,n){return void 0===n&&(n=null),x.toInt(t.length/2)<2?null:_.TypographyLayout.divideIntoPairs(e,t,x.clone(n))},arrangeText:function(e,t,n){var a;if(t.length%2==0)a=x.clone(t);else{a=[];for(var i=x.iter(t);!i.done;i.next()){var o=i.value;a.push(o)}a.push(new D.SpacerNode(e.getRoot().getTextNodes().length,new E.TheoSize(1,1)))}for(var r=[],l=[],s=0,h=a.length;s<h;)a[s].propagateDown(D.AlignmentIdiom.LRBB),a[s+1].propagateDown(D.AlignmentIdiom.LRBB),1==a[s].getWeight()?a[s].scaleAlign=1.5+2*(1-n.relativeFontScale_):a[s+1].scaleAlign=1.5+2*(1-n.relativeFontScale_),(u=new D.GroupNode(a[s],a[s+1])).transAlign=this.alternate_?D.AlignmentIdiom.LRtb:D.AlignmentIdiom.LRmm,r.push(u),l.push(u),s+=2;for(;l.length>1;){var u;(u=new D.GroupNode(l[0],l[1])).transAlign=D.AlignmentIdiom.cCCtb,l.splice(1,1),l[0]=u}e.setRoot(l[0])}}}),c),_.DoubletTypographyLayout=(p=function(){_.TypographyLayout.call(this)},x.defineClass({name:"DoubletTypographyLayout",ctor:p,superName:"TypographyLayout",props:{conditionsMet:function(e){return 2==e.length},calculateWeightings:function(e,t,n){if(void 0===n&&(n=null),t.length<4)return null;for(var a=[],i=x.toInt(e.length/2),o=[],r=[],l=x.iter(t);!l.done;l.next()){var s=l.value;s.start<i?o.push(s):r.push(s)}return a.push(x.clone(o)),a.push(x.clone(r)),a}}}),p),_.RotateTypographyLayout=(d=function(e){this.flavor_=e,_.DoubletTypographyLayout.call(this)},x.defineClass({name:"RotateTypographyLayout",ctor:d,superName:"DoubletTypographyLayout",statics:{ROTATE_EMPHASIZED:0,ROTATE_EMPHASIZED_MULTI:1,ROTATE_UNEMPHASIZED:2,ROTATE_UNEMPHASIZED_ADJACENT:3,ROTATE_EMPHASIZED2:4,ROTATE_UNEMPHASIZED2:5,ROTATE_EMPHASIZED_MULTI_FIT:6},props:{calculateWeightings:function(e,t,n){if(void 0===n&&(n=null),t.length<2)return null;var a=[];switch(this.flavor_){case 3:var i=x.clone(I.Host.pathUtils.matchesForRegexInString("^[0-9]+",e));if(i.length>0)(o=[]).push(new k.TextRange(0,i[0].length)),a.push(x.clone(o));else{if(t[0].length<5){for(var o=[],r=x.iter(x.range(1,t.length-1,!0));!r.done;r.next()){var l=r.value;o.push(t[l])}a.push(x.clone(o))}if(t[t.length-1].length<5){o=[];for(var s=x.iter(x.range(0,t.length-2,!0));!s.done;s.next())l=s.value,o.push(t[l]);a.push(x.clone(o))}}break;default:if(this.flavor_!=d.ROTATE_EMPHASIZED_MULTI&&this.flavor_!=d.ROTATE_EMPHASIZED_MULTI_FIT||t.length>=3){var h=x.sort(t,(function(e,t){return e.length>t.length}));(h[0]==t[0]||h[0]==t[t.length-1])&&a.push([h[0]])}}return a.length>0?a:null},runToRotate:function(e){return this.flavor_==d.ROTATE_EMPHASIZED||this.flavor_==d.ROTATE_EMPHASIZED2||this.flavor_==d.ROTATE_EMPHASIZED_MULTI||this.flavor_==d.ROTATE_EMPHASIZED_MULTI_FIT?1==e[0].getWeight()?0:1:0==e[0].getWeight()?0:1},conditionsMet:function(e){var t;return!!_.DoubletTypographyLayout.prototype.conditionsMet.call(this,x.clone(e))&&(t=this.flavor_==d.ROTATE_EMPHASIZED||this.flavor_==d.ROTATE_EMPHASIZED2||this.flavor_==d.ROTATE_EMPHASIZED_MULTI||this.flavor_==d.ROTATE_EMPHASIZED_MULTI_FIT?1==e[0][0].weight?0:1:0==e[0][0].weight?0:1,(this.flavor_!=d.ROTATE_EMPHASIZED_MULTI&&this.flavor_!=d.ROTATE_EMPHASIZED_MULTI_FIT||1!=e[(t+1)%2].length)&&(e[t].length>1||e[t][0].text.length>2))},scalesFonts:function(){return!0},arrangeText:function(e,t,n){var a,i=this.runToRotate(x.clone(t)),o=1==t[i].getWeight()?i:(i+1)%2,r=t[o],l=t[(o+1)%2];switch(r.propagateDown(D.AlignmentIdiom.LRBB),l.propagateDown(D.AlignmentIdiom.LRBB),t[i].rotateAlign=0==i?D.TypographyNode.CounterClockwise:D.TypographyNode.Clockwise,r.calcTransform(),l.calcTransform(),this.flavor_){case 3:l.scaleAlign=r.localbounds().height/l.localbounds().height,a=D.AlignmentIdiom.LRtt;break;case 2:if(0==o){var s=r.localbounds();if(l.scaleAlign=(s.width/n.size_.aspectRatio-s.height-l.getMargin())/l.localbounds().height,l.scaleAlign>1){var h=s.width/l.localbounds().width;l.scaleAlign=M.MathUtils.minDouble(M.MathUtils.minDouble(1/this.fontScalingDiff,h),l.scaleAlign)}else l.scaleAlign=M.MathUtils.maxDouble(this.fontScalingDiff,l.scaleAlign);a=D.AlignmentIdiom.RRtb}else s=l.localbounds(),r.scaleAlign=(s.height*n.size_.aspectRatio-s.width-r.getMargin())/r.localbounds().width,r.scaleAlign>1?(h=s.height/r.localbounds().height,r.scaleAlign=M.MathUtils.minDouble(M.MathUtils.minDouble(1/this.fontScalingDiff,h),r.scaleAlign)):r.scaleAlign=M.MathUtils.maxDouble(this.fontScalingDiff,r.scaleAlign),a=D.AlignmentIdiom.LRtt;break;case 5:0==o?(s=l.localbounds(),r.scaleAlign=(s.height*n.size_.aspectRatio-s.width-r.getMargin())/r.localbounds().width,r.scaleAlign>1?(h=s.height/r.localbounds().height,r.scaleAlign=M.MathUtils.minDouble(M.MathUtils.minDouble(1/this.fontScalingDiff,h),r.scaleAlign)):r.scaleAlign=M.MathUtils.maxDouble(this.fontScalingDiff,r.scaleAlign),a=D.AlignmentIdiom.LRtt):(s=r.localbounds(),l.scaleAlign=(s.width/n.size_.aspectRatio-s.height-l.parent.getMargin())/l.localbounds().height,l.scaleAlign>1?(h=s.width/l.localbounds().width,l.scaleAlign=M.MathUtils.minDouble(M.MathUtils.minDouble(1/this.fontScalingDiff,h),l.scaleAlign)):l.scaleAlign=M.MathUtils.maxDouble(this.fontScalingDiff,l.scaleAlign),a=D.AlignmentIdiom.LLbt);break;case 1:case 6:var u=(s=r.localbounds()).height*n.size_.aspectRatio-s.width-l.getMargin();u<s.width&&(u=s.width);var g=new E.TheoSize(u,s.height);l.optimizeFlow(1==o?D.AlignmentIdiom.RRtb:D.AlignmentIdiom.LLtb,g,this.flavor_==d.ROTATE_EMPHASIZED_MULTI_FIT,!1,0),a=0==o?D.AlignmentIdiom.LRbb:D.AlignmentIdiom.LRtt,t[1].parent.transAlign=a,e.getRoot().calcTransform();var c=l.localbounds();l.scaleAlign=g.width/c.width,l.scaleAlign>g.height/c.height&&(l.scaleAlign=g.height/c.height);break;case 4:1==o?(s=r.localbounds(),l.scaleAlign=(s.height*n.size_.aspectRatio-s.width-l.getMargin())/l.localbounds().width,l.scaleAlign=M.MathUtils.maxDouble(this.fontScalingDiff,l.scaleAlign),a=D.AlignmentIdiom.LRtt):(s=l.localbounds(),r.scaleAlign=(s.width/n.size_.aspectRatio-s.height-r.getMargin())/r.localbounds().height,r.scaleAlign>1?(h=s.width/r.localbounds().width,r.scaleAlign=M.MathUtils.minDouble(M.MathUtils.minDouble(1/this.fontScalingDiff,h),r.scaleAlign)):r.scaleAlign=M.MathUtils.maxDouble(this.fontScalingDiff,r.scaleAlign),a=D.AlignmentIdiom.LLbt);break;default:0==o?(s=r.localbounds(),l.scaleAlign=(s.height*n.size_.aspectRatio-s.width-l.getMargin())/l.localbounds().width,l.scaleAlign>1?(h=s.height/l.localbounds().height,l.scaleAlign=M.MathUtils.minDouble(M.MathUtils.minDouble(1/this.fontScalingDiff,h),l.scaleAlign)):l.scaleAlign=M.MathUtils.maxDouble(this.fontScalingDiff,l.scaleAlign),a=D.AlignmentIdiom.LRtt):(s=l.localbounds(),r.scaleAlign=(s.width/n.size_.aspectRatio-s.height-r.getMargin())/r.localbounds().height,r.scaleAlign>1?(h=s.width/r.localbounds().width,r.scaleAlign=M.MathUtils.minDouble(M.MathUtils.minDouble(1/this.fontScalingDiff,h),r.scaleAlign)):r.scaleAlign=M.MathUtils.maxDouble(this.fontScalingDiff,r.scaleAlign),a=D.AlignmentIdiom.RRtb)}t[1].parent.transAlign=a}}}),d),_.DiagonalBoxTypographyLayout=(f=function(e){this.flavor_=e,_.DoubletTypographyLayout.call(this)},x.defineClass({name:"DiagonalBoxTypographyLayout",ctor:f,superName:"DoubletTypographyLayout",statics:{RIGHT_LEFT:0,FIT_FIT:1},props:{scalesFonts:function(){return!0},arrangeText:function(e,t,n){e.rotateNode(t[0].parent),this.flavor_==f.RIGHT_LEFT?(_.ReflowAlignmentTypographyLayout.init_a5f3(D.AlignmentIdiom.RRtb,!0).arrangeText(e,[t[0]],n),_.ReflowAlignmentTypographyLayout.init_a5f3(D.AlignmentIdiom.LLtb,!0).arrangeText(e,[t[1]],n)):(new _.FitAllTypographyLayout(!0,!0).arrangeText(e,[t[0]],n),new _.FitAllTypographyLayout(!0,!0).arrangeText(e,[t[1]],n)),t[1].parent.transAlign=D.AlignmentIdiom.LRtb}}}),f),_.DropCapTypographyLayout=(m=function(e){this.MIN_SCALE=1,this.MAX_SCALE=5,this.DEFAULT_SCALE=2,this.fit_=e,_.SimpleAlignmentTypographyLayout.call(this,D.AlignmentIdiom.LLtb),this.fontScalingDiff=.1},x.defineClass({name:"DropCapTypographyLayout",ctor:m,superName:"SimpleAlignmentTypographyLayout",props:{getScale:function(e){return _.scaleToRange(e,this.MIN_SCALE,this.MAX_SCALE,this.DEFAULT_SCALE)},calculateWeightings:function(e,t,n){void 0===n&&(n=null);var a,i=[],o=x.clone(I.Host.pathUtils.matchesForRegexInString("^[0-9]+[%¢]$",e));return o.length>0?((a=[]).push(new k.TextRange(0,o[0].length-1)),a.push(new k.TextRange(o[0].length-1,o[0].length)),i.push(x.clone(a)),i):(o=x.clone(I.Host.pathUtils.matchesForRegexInString("^\\$[0-9]+[\\.][0-9][0-9]",e))).length>0?((a=[]).push(new k.TextRange(0,o[0].length-3)),a.push(new k.TextRange(o[0].length-3,o[0].length)),i.push(x.clone(a)),i):((o=x.clone(I.Host.pathUtils.matchesForRegexInString("^[0-9a-zA-Z]",e))).length>0&&((a=[]).push(new k.TextRange(0,o[0].length)),i.push(x.clone(a))),i.length>0?i:null)},arrangeText:function(e,t,n){var a=t[0]instanceof D.TextNode?t[0]:t[0].getTextNodes()[0],i=a.parent;if(i.getId()!=e.getRoot().getId()){var o;o=i.getChild(!0).getId()==a.getId()?i.getChild(!1):i.getChild(!0);var r=i.parent;r.getChild(!0).getId()==i.getId()?r.setChild(o,!0):r.setChild(o,!1),i.parent=null,i.setChild(e.getRoot(),!1),e.setRoot(i)}e.getRoot().transAlign=D.AlignmentIdiom.LRtt,a.calcTransform();var l,s=a.localbounds(),h=new E.TheoSize(M.MathUtils.maxDouble(1,s.height*n.size_.aspectRatio-s.width-a.getMargin()),s.height),u=e.getRoot().getChild(!1);l=u instanceof D.GroupNode?this.fit_?u.optimizeFlow(D.AlignmentIdiom.LLtb,h,!0,!0,0):u.optimizeFlow(D.AlignmentIdiom.LLtb,h,!1,!0,0):1,e.getRoot().calcTransform(),u.scaleAlign=l>1?s.height/u.localbounds().height:s.height/(this.getScale(n.relativeFontScale_)*u.localbounds().height)}}}),m),_.SingleTokenGridTypographyLayout=(y=function(){_.TypographyLayout.call(this)},x.defineClass({name:"SingleTokenGridTypographyLayout",ctor:y,superName:"TypographyLayout",props:{conditionsMet:function(e){return 1==e.length},scalesFonts:function(){return!0},calculateWeightings:function(e,t,n){if(void 0===n&&(n=null),1==t.length&&t[0].length>=3&&x.clone(I.Host.pathUtils.matchesForRegexInString("^[a-zA-Z]+$",e)).length>0){for(var a=[],i=[],o=x.iter(x.range(0,t[0].length-1,!0));!o.done;o.next()){var r=o.value;i.push(new k.TextRange(r,r+1))}return a.push(x.clone(i)),a}return null},arrangeText:function(e,t,n){var a,i=x.clone(e.getRoot().getTextNodes()),o=i[0];i.splice(0,1);var r=i.length-1;a=r<3?1:x.toInt(Math.ceil(x.toDouble(r)/2));for(var l=null,s=1;s<i.length;){var h=null;if(1==a){var u=i[s];l=null!=l?F.TypographyTree.createGroupNode(l,u,D.AlignmentIdiom.LLtb):u}else{a=i.length-s<a?i.length-s:a;for(var g=x.iter(x.range(0,a-1,!0));!g.done;g.next())u=i[s+g.value],h=null!=h?F.TypographyTree.createGroupNode(h,u,D.AlignmentIdiom.LRBB):u;l=null!=l?F.TypographyTree.createGroupNode(l,h,D.AlignmentIdiom.LLtb):h}s+=a}var c=F.TypographyTree.createGroupNode(o,l,D.AlignmentIdiom.LRtt);e.setRoot(c),c.calcTransform(),o.scaleAlign=c.getChild(!1).localbounds().height/o.localbounds().height}}}),y),_.TripletTypographyLayout=(T=function(){_.TypographyLayout.call(this)},x.defineClass({name:"TripletTypographyLayout",ctor:T,superName:"TypographyLayout",props:{conditionsMet:function(e){return 3==e.length},calculateWeightings:function(e,t,n){if(void 0===n&&(n=null),t.length<3)return null;for(var a=[],i=x.toInt(e.length/3),o=x.toInt(2*e.length/3),r=0,l=0,s=[];r<e.length&&l<t.length;)r>=i&&r<o&&s.push(t[l]),r+=t[l].length,l+=1;return a.push(x.clone(s)),a.length>0?a:null}}}),T),_.MiddleTypographyLayout=(L=function(e){this.MIN_SCALE=.2,this.MAX_SCALE=.8,this.DEFAULT_SCALE=.333,this.flavor_=e,_.TripletTypographyLayout.call(this)},x.defineClass({name:"MiddleTypographyLayout",ctor:L,superName:"TripletTypographyLayout",statics:{TRIPLET:0,TRIPLET_ROTATED_MIDDLE:1,TRIPLET_ROTATED_MIDDLE_MULTI:2,TRIPLET_ROTATED_ENDS:3},props:{getScale:function(e){return _.scaleToRange(e,this.MIN_SCALE,this.MAX_SCALE,this.DEFAULT_SCALE)},scalesFonts:function(){return!0},calculateWeightings:function(e,t,n){void 0===n&&(n=null);var a=null;if(this.flavor_==L.TRIPLET_ROTATED_MIDDLE_MULTI)return t.length<8&&(a=[],(i=[]).push(t[0]),i.push(t[t.length-1]),a.push(x.clone(i))),a;if(t.length>2){a=[];for(var i=[],o=x.sort(t,(function(e,t){return e.length>t.length})),r=0;o[r]==t[0]||o[r]==t[t.length-1];)r+=1;i.push(o[r]),a.push(x.clone(i))}return a},arrangeText:function(e,t,n){t[1].propagateDown(D.AlignmentIdiom.LRBB),this.flavor_==L.TRIPLET_ROTATED_ENDS?(t[0].propagateDown(D.AlignmentIdiom.LRBB),t[2].propagateDown(D.AlignmentIdiom.LRBB)):(t[0].propagateDown(D.AlignmentIdiom.RRtb),t[2].propagateDown(D.AlignmentIdiom.LLtb)),this.flavor_==L.TRIPLET_ROTATED_MIDDLE?t[1].rotateAlign=D.TypographyNode.Clockwise:this.flavor_==L.TRIPLET_ROTATED_MIDDLE_MULTI?t[1].rotateAlign=D.TypographyNode.CounterClockwise:this.flavor_==L.TRIPLET_ROTATED_ENDS&&(t[0].rotateAlign=D.TypographyNode.CounterClockwise,t[2].rotateAlign=D.TypographyNode.Clockwise),t[1].calcTransform();var a,i=t[1].localbounds();if(x.clone(t[1].getTextNodes()).length>1){t[0].calcTransform();var o=t[0].localbounds();t[2].calcTransform();var r,l=t[2].localbounds(),s=M.MathUtils.maxDouble(o.height,l.height);a=M.MathUtils.maxDouble(i.width,s*n.size_.aspectRatio-(o.width+l.width)),r=this.flavor_==L.TRIPLET_ROTATED_MIDDLE?new E.TheoSize(s,a):new E.TheoSize(a,s),t[1].optimizeFlow(D.AlignmentIdiom.LLtb,r,!0,!1,2),t[1].calcTransform(),a=(i=t[1].localbounds()).height*n.size_.aspectRatio-i.width}else a=i.height*n.size_.aspectRatio-i.width;if(t[0].calcTransform(),t[2].calcTransform(),o=t[0].localbounds(),l=t[2].localbounds(),this.flavor_==L.TRIPLET_ROTATED_MIDDLE_MULTI)t[1].scaleAlign=M.MathUtils.maxDouble(o.height,l.height)/i.height;else{var h=M.MathUtils.maxDouble(this.fontScalingDiff,a/(o.width+l.width+t[0].getMargin()+t[2].getMargin()));t[0].scaleAlign=h,t[2].scaleAlign=h,t[0].calcTransform(),t[2].calcTransform(),o=t[0].localbounds(),l=t[2].localbounds(),(o.height>i.height||l.height>i.height)&&(t[0].scaleAlign=h*i.height/o.height,t[2].scaleAlign=h*i.height/l.height)}t[0].parent.transAlign=D.AlignmentIdiom.LRtt,t[2].parent.transAlign=D.AlignmentIdiom.LRbb}}}),L),_.SpanMiddleTypographyLayout=(A=function(e){this.flavor_=e,_.TripletTypographyLayout.call(this)},x.defineClass({name:"SpanMiddleTypographyLayout",ctor:A,superName:"TripletTypographyLayout",statics:{LEFT_RIGHT:0,RIGHT_LEFT:1},props:{conditionsMet:function(e){return _.TripletTypographyLayout.prototype.conditionsMet.call(this,x.clone(e))&&e[0].length>1&&e[2].length>1},scalesFonts:function(){return!0},calculateWeightings:function(e,t,n){if(void 0===n&&(n=null),t.length<5)return null;var a=[],i=[];return i.push(t[x.toInt(t.length/2)]),a.push(x.clone(i)),a.length>0?a:null},arrangeText:function(e,t,n){t[1].propagateDown(D.AlignmentIdiom.LRBB),t[1].calcTransform();var a,i,o=t[1].localbounds(),r=_.TypographyLayout.getDesiredSize(o.size,n.size_),l=r.width/2,s=(r.height-o.height)/2;s<=0&&(s=1),this.flavor_==A.LEFT_RIGHT?(a=D.AlignmentIdiom.LLtb,i=D.AlignmentIdiom.RRtb):(a=D.AlignmentIdiom.RRtb,i=D.AlignmentIdiom.LLtb);var h=new E.TheoSize(l,s);t[0]instanceof D.GroupNode&&t[0].optimizeFlow(a,h,!1,!1,0),t[2]instanceof D.GroupNode&&t[2].optimizeFlow(i,h,!1,!1,0),t[1].parent.transAlign=D.AlignmentIdiom.LLtb,t[2].parent.transAlign=D.AlignmentIdiom.RRtb,t[0].calcTransform(),t[2].calcTransform(),t[1].scaleAlign=(t[0].localbounds().width+t[2].localbounds().width)/o.width}}}),A),_.FitTripletEmphasizedTypographyLayout=(R=function(){_.TripletTypographyLayout.call(this)},x.defineClass({name:"FitTripletEmphasizedTypographyLayout",ctor:R,superName:"TripletTypographyLayout",props:{scalesFonts:function(){return!0},calculateWeightings:function(e,t,n){void 0===n&&(n=null);var a=x.sort(t,(function(e,t){return e.length>t.length}));if(a[0]!=t[0]&&a[0]!=t[t.length-1]){var i=[],o=[];return o.push(a[0]),i.push(x.clone(o)),i}return _.TripletTypographyLayout.prototype.calculateWeightings.call(this,e,t,x.clone(n))},arrangeText:function(e,t,n){t[0].propagateDown(D.AlignmentIdiom.LRBB),t[1].propagateDown(D.AlignmentIdiom.LRBB),t[2].propagateDown(D.AlignmentIdiom.LRBB),t[0].scaleAlign=.75,t[2].scaleAlign=.75,t[0].parent.transAlign=D.AlignmentIdiom.LLtb,t[2].parent.transAlign=D.AlignmentIdiom.RRtb,e.getRoot().calcTransform(),t[1].scaleAlign=(t[0].localbounds().width+t[2].localbounds().width)/t[1].localbounds().width}}}),R),_.QuadraticTypographyLayout=(S=function(){_.TypographyLayout.call(this)},x.defineClass({name:"QuadraticTypographyLayout",ctor:S,superName:"TypographyLayout",props:{conditionsMet:function(e){return 4==e.length}}}),S),_.RotateAndFitTypographyLayout=(v=function(){_.QuadraticTypographyLayout.call(this)},x.defineClass({name:"RotateAndFitTypographyLayout",ctor:v,superName:"QuadraticTypographyLayout",props:{scalesFonts:function(){return!0},arrangeText:function(e,t,n){e.rotateNode(t[0].parent);var a=new w.TypographyParams(new E.TheoSize(n.size_.width/2,n.size_.height),n.lineSpacing_,n.relativeFontScale_);new _.RotateTypographyLayout(_.RotateTypographyLayout.ROTATE_EMPHASIZED).arrangeText(e,[t[0],t[1]],a),new _.FitAllTypographyLayout(!0,!1).arrangeText(e,[t[2],t[3]],a),e.getRoot().calcTransform();var i=t[0].parent.localbounds().width,o=t[2].parent.localbounds().width;t[2].parent.scaleAlign=i/o,t[2].parent.transAlign=D.AlignmentIdiom.RRtb,e.getRoot().transAlign=D.AlignmentIdiom.LRbb}}}),v),_.FitRotateFitTypographyLayout=(C=function(){_.QuadraticTypographyLayout.call(this)},x.defineClass({name:"FitRotateFitTypographyLayout",ctor:C,superName:"QuadraticTypographyLayout",props:{scalesFonts:function(){return!0},arrangeText:function(e,t,n){e.rotateNode(t[0].parent),new _.FitAllTypographyLayout(!0,!1).arrangeText(e,[t[0],t[1]],n),new _.FitAllTypographyLayout(!0,!1).arrangeText(e,[t[2],t[3]],n),t[2].parent.rotateAlign=D.TypographyNode.CounterClockwise,t[0].parent.calcTransform(),t[2].parent.calcTransform();var a=t[0].parent.localbounds().height,i=t[2].parent.localbounds().height;t[2].parent.scaleAlign=a/i,t[2].parent.parent.transAlign=D.AlignmentIdiom.LRtt}}}),C),_.CornersTypographyLayout=(b=function(e){this.MIN_SCALE=1,this.MAX_SCALE=4,this.DEFAULT_SCALE=3.5,this.flavor_=e,_.QuadraticTypographyLayout.call(this)},x.defineClass({name:"CornersTypographyLayout",ctor:b,superName:"QuadraticTypographyLayout",statics:{RIGHTTOP_LEFTBOTTOM:0,LEFTTOP_RIGHTBOTTOM:1},props:{getScale:function(e){return this.MAX_SCALE-_.scaleToRange(e,this.MIN_SCALE,this.MAX_SCALE,this.DEFAULT_SCALE)+this.MIN_SCALE},calculateWeightings:function(e,t,n){if(void 0===n&&(n=null),t.length<4)return null;var a=[];a.push([]),a.push([]),a.push([]),a.push([]);for(var i=0,o=t.length%2==0?x.toInt(t.length/2)-1:x.toInt(t.length/2),r=o;i<r;)a[0].push(t[i]),a[1].splice(0,0,t[r]),i+=1,r-=1;if(i==r){var l=a[0][a[0].length-1].end-a[0][0].start,s=a[1][a[1].length-1].end-a[1][0].start;M.MathUtils.absInt(s+t[i].length-l)>M.MathUtils.absInt(l+t[i].length-s)?a[0].push(t[i]):a[1].push(t[i])}if(a[0][a[0].length-1].end-a[0][0].start<2||a[1][a[1].length-1].end-a[1][0].start<2)return null;for(i=o+1,r=t.length-1;i<r;)a[2].push(t[i]),a[3].splice(0,0,t[r]),i+=1,r-=1;if(i==r){var h=a[2][a[2].length-1].end-a[2][0].start,u=a[3][a[3].length-1].end-a[3][0].start;M.MathUtils.absInt(u+t[i].length-h)>M.MathUtils.absInt(h+t[i].length-u)?a[2].push(t[i]):a[3].push(t[i])}if(a[2][a[2].length-1].end-a[2][0].start<2||a[3][a[3].length-1].end-a[3][0].start<2)return null;var g=[],c=[];return x.append(c,x.clone(a[0])),x.append(c,x.clone(a[2])),g.push(x.clone(c)),c.splice(0),x.append(c,x.clone(a[1])),x.append(c,x.clone(a[3])),g.push(x.clone(c)),g.length>0?g:null},arrangeText:function(e,t,n){t[0].propagateDown(D.AlignmentIdiom.LRBB),t[1].propagateDown(D.AlignmentIdiom.LRBB),t[2].propagateDown(D.AlignmentIdiom.LRBB),t[3].propagateDown(D.AlignmentIdiom.LRBB),this.flavor_==b.RIGHTTOP_LEFTBOTTOM?(t[1].rotateAlign=D.TypographyNode.Clockwise,t[2].rotateAlign=D.TypographyNode.Clockwise):(t[0].rotateAlign=D.TypographyNode.CounterClockwise,t[3].rotateAlign=D.TypographyNode.CounterClockwise),t[0].calcTransform(),t[1].calcTransform(),t[2].calcTransform(),t[3].calcTransform();var a=t[0].localbounds().size,i=t[1].localbounds().size,o=t[2].localbounds().size,r=t[3].localbounds().size;if(this.flavor_==b.LEFTTOP_RIGHTBOTTOM){var l=F.TypographyTree.createGroupNode(t[1],t[2],i.width>o.width?D.AlignmentIdiom.RRtb:D.AlignmentIdiom.LLtb),s=F.TypographyTree.createGroupNode(l,t[0],D.AlignmentIdiom.RLtt);e.getRoot().setChild(s,!0),e.getRoot().setChild(t[3],!1),e.getRoot().transAlign=D.AlignmentIdiom.LRbb,e.getRoot().calcTransform();var h=e.getBounds().size,u=M.MathUtils.maxDouble(i.width,o.width),g=_.TypographyLayout.getDesiredSize(h,n.size_),c=new E.TheoSize(g.width*this.getScale(n.relativeFontScale_),g.height*this.getScale(n.relativeFontScale_)),p=M.MathUtils.maxDouble(c.width-h.width,0)+u;if((m=c.height-h.height+M.MathUtils.maxDouble(a.height,r.height)-(i.height+o.height)-t[2].getMargin())>0){var d=new E.TheoSize(p,m);_.TypographyLayout.insertSpacer(e,t[2],d,1,_.SpacerIdiom.insertAbove,D.AlignmentIdiom.RRtb),p>u&&(l.transAlign=D.AlignmentIdiom.LLtb)}}else{l=F.TypographyTree.createGroupNode(t[1],t[2],i.height>o.height?D.AlignmentIdiom.RLbb:D.AlignmentIdiom.RLtt),s=F.TypographyTree.createGroupNode(t[0],l,D.AlignmentIdiom.RRtb),e.getRoot().setChild(s,!0),e.getRoot().setChild(t[3],!1),e.getRoot().transAlign=D.AlignmentIdiom.LLtb,e.getRoot().calcTransform(),h=e.getBounds().size;var f=M.MathUtils.maxDouble(i.height,o.height),m=(g=_.TypographyLayout.getDesiredSize(h,n.size_),c=new E.TheoSize(g.width*this.getScale(n.relativeFontScale_),g.height*this.getScale(n.relativeFontScale_)),M.MathUtils.maxDouble(c.height-h.height,0)+f);p=M.MathUtils.maxDouble(1,c.width-h.width+M.MathUtils.maxDouble(a.width,r.width)-(i.width+o.width)),m>0&&(d=new E.TheoSize(p,m),_.TypographyLayout.insertSpacer(e,t[1],d,1,_.SpacerIdiom.insertAbove,D.AlignmentIdiom.LRtt),m>f&&(l.transAlign=D.AlignmentIdiom.RLbb))}}}}),b)},"p+tC":function(e,t,n){var a,i,o,r=t,l=n("oAGj"),s=n("fNpk"),h=n("uj1m"),u=n("txj3"),g=n("nrTo"),c=n("35Q0"),p=n("UqVc"),d=n("ThKb");r.predictCategory=!0,r.RawDataShapeSuggester=(a=function(){},l.defineClass({name:"RawDataShapeSuggester",ctor:a,props:{init_b1f8:function(e,t,n,a,i,o,r,l,s,h){this.numImages=e,this.numShapes=t,this.charLength=n,this.lineHeight=a,this.font=i,this.layout=o,this.textWidth=r,this.textHeight=l,this.centerX=s,this.centerY=h},getUniqueKey:function(){var e="";return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e+l.toString(this.numImages)+"-")+l.toString(this.numShapes)+"-")+l.toString(this.charLength)+"-")+l.toString(this.lineHeight)+"-")+this.font+"-")+this.layout+"-")+l.toString(this.textWidth)+"-")+l.toString(this.textHeight)+"-")+l.toString(this.centerX)+"-")+l.toString(this.centerY)+"-"},init_implicit:function(e,t,n,a,i,o,r,l,s,h){this.numImages=e,this.numShapes=t,this.charLength=n,this.lineHeight=a,this.font=i,this.layout=o,this.textWidth=r,this.textHeight=l,this.centerX=s,this.centerY=h},clone:function(){return a.init_implicit(this.numImages,this.numShapes,this.charLength,this.lineHeight,this.font,this.layout,this.textWidth,this.textHeight,this.centerX,this.centerY)}}}),a),r.ShapeSuggester=(i=function(){this.shapeCatMap={},this.shapeCatMap.banner=c.TagGroup.banner,this.shapeCatMap.square=c.TagGroup.square,this.shapeCatMap.other=c.TagGroup.other,this.shapeCatMap.circle=c.TagGroup.circle,this.shapeCatMap.decorative=c.TagGroup.decorative,this.shapeCatMap.none=c.TagGroup.none,l.defctor(this)},o={},l.defineClass({name:"ShapeSuggester",ctor:i,statics:{cache:{get:function(){return void 0===o.cache&&(o.cache=new g.PredictionCacheDouble),o.cache},set:function(e){o.cache=e}}},props:{getShapeSuggesterFeatures:function(e,t){var n=e.numImages,a=e.shapeCount,o=e.selectedLockup.charCount,s=l.toInt(e.selectedLockup.lineHeight),h=e.selectedLockup.font,u=e.selectedLockup.styleAttributes.layout,g=l.clone(e.selectedLockup.pts),c=(g[0].x+g[3].x)/2/e.width,p=(g[0].y+g[3].y)/2/e.height,d=l.toInt(e.selectedLockup.width),f=l.toInt(e.selectedLockup.height),m=l.clone(r.RawDataShapeSuggester.init_b1f8(n,a,o,s,h,u,d,f,c,p));return i.cache.cleanup(t.page.document.uuid),m},getScores:function(e,t){var n=this,a=t.getUniqueKey();if(null==i.cache.getCacheValue(a)){var o,g=[],f=0;if(o=h.MLPModel.loadNNModel("Shape")){var m,y,T,L=l.repeat(0,55),A=l.repeat(0,4),R=l.repeat(0,8);R[0]=l.toDouble(t.numShapes),R[1]=l.toDouble(t.numShapes),R[2]=l.toDouble(t.charLength),R[3]=l.toDouble(t.lineHeight),R[4]=l.toDouble(t.textWidth),R[5]=l.toDouble(t.textHeight),R[6]=l.toDouble(t.centerX),R[7]=l.toDouble(t.centerY),null!=(y=l.indexOf(o.fonts,t.font))&&(L[y]=1),null!=(T=l.indexOf(o.layouts,t.layout))&&(A[T]=1);var S=R.concat(l.clone(L)).concat(l.clone(A));s.LegacyCoreAssert.isTrue(67==S.length,"unexpected feature vector size",{count:S.length},"ShapeSuggester.getScores","ShapeSuggester.swift",148);var v=new d.TheoMatrix([S]).subtract(o.featureScalingMean).divide(o.featureScalingStd),C=new u.NNMLPClassifier(l.clone(o.coefficients),l.clone(o.intercepts)).predict(v.transpose()),b=l.clone(C.transpose().asArray);m=l.clone(o.shapes);for(var _={},x=l.iter(l.toSequence(b[0]));!x.done;x.next()){var I=x.value,M=I.offset,w=I.element;_[m[M]]=w,f=Math.max(f,w)}0==r.predictCategory?e.forEach((function(e){var t;null!=(t=_[e])?g.push(t+.2):g.push(0)})):e.forEach((function(e){var t=0;m.forEach((function(a){var i;l.opt(c.ShapeLibrary.getShapeDataForArtworkId(e),(function(e){return 1==e.tags.includes(n.shapeCatMap[a])}))&&null!=(i=_[a])&&(t=i)})),"row"==e?t=f+.5:l.opt(c.ShapeLibrary.getShapeDataForArtworkId(e),(function(e){return 1==e.tags.includes(n.shapeCatMap.none)}))&&(t=.1),g.push(t)}))}i.cache.setCacheValue(a,l.clone((new p.SuggestionUtils).normalizedWeights(l.clone(g))))}return i.cache.getCacheValue(a)}}}),i)},taeg:function(e,t,n){var a,i,o=t,r=n("oAGj"),l=n("iCxV"),s=n("txj3"),h=n("nrTo"),u=n("7Ta2"),g=n("ThKb");o.RoleSuggesterMLP=(a=function(){},i={},r.defineClass({name:"RoleSuggesterMLP",ctor:a,statics:{cache:{get:function(){var e;return void 0===i.cache&&(i.cache=((e=r.opt(l.Host.platform,(function(e){return e.isService})))||null!=e)&&e?r.opt(l.Host.learning,(function(e){return e.getHostPredictionCache()})):new h.PredictionCacheInferredRole),i.cache},set:function(e){i.cache=e}},_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRoleModel:function(){return null},getRole:function(e){var t,n,i=r.clone(u.InferredRole.init_84d1()),o=e.getUniqueKey();if(null==a.cache.getCacheValue(o)){var l,h=0,c="",p=0,d="";if(l=this.getRoleModel()){var f,m=r.clone(e.getFeatureVector()),y=r.clone(m),T=new g.TheoMatrix([y]).subtract(l.featureScalingMean).divide(l.featureScalingStd),L=new s.NNMLPClassifier(r.clone(l.coefficients),r.clone(l.intercepts),l.finalSoftmax).predict(T.transpose()),A=r.clone(L.transpose().asArray);f=r.clone(l.roles);for(var R={},S=r.iter(r.toSequence(A[0]));!S.done;S.next()){var v=S.value,C=v.offset,b=v.element;R[f[C]]=b,b>h?(p=h,d=c,h=b,c=f[C]):b>p&&(p=b,d=f[C])}}var _=(t=u.InferredRoleType.toCaseValue(c))||null!=t?t:u.InferredRoleType.Undefined,x=(n=u.InferredRoleType.toCaseValue(d))||null!=n?n:u.InferredRoleType.Undefined;i=r.clone(u.InferredRole.init_84d1(_,h,x,p)),a.cache.setCacheValue(o,r.clone(i))}return a.cache.getCacheValue(o)}}}),a)},"ws+m":function(e,t,n){var a,i,o=t,r=n("oAGj"),l=n("6ZWm"),s=n("7Ta2");o.ImageRoleSuggesterFactory=(a=function(){},r.defineClass({name:"ImageRoleSuggesterFactory",ctor:a,statics:{Create:function(e){return void 0===e&&(e=""),new o.ImageRoleSuggesterSimple}}}),a),o.ImageRoleSuggesterSimple=(i=function(){},r.defineClass({name:"ImageRoleSuggesterSimple",ctor:i,statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRole:function(e){var t,n=e.forma,a=s.InferredRoleType.Undefined;if(t=r.as(n.controller,l.FrameController)){if(n.isGridCell())return s.InferredRole.init_84d1(s.InferredRoleType.Background,1);if(n.isLogo())return s.InferredRole.init_84d1(s.InferredRoleType.Logo,1,s.InferredRoleType.GraphicContent,.5);if(t.floating)return s.InferredRole.init_84d1(s.InferredRoleType.GraphicContent,1)}return s.InferredRole.init_84d1(a,1)}}}),i)},xRbc:function(e,t,n){var a,i=t,o=n("oAGj"),r=n("wc1n"),l=n("cYVN"),s=n("35Q0");i.LockupRoleFeatures=o.defineEnum("LockupRoleFeatures",{WordCount:"WordCount",CharacterCount:"CharacterCount",intsSpecialsCount:"intsSpecialsCount",webReferencesCount:"webReferencesCount",checkSocialChar:"checkSocialChar",Spacing:"Spacing",Padding:"Padding",ShapeFilled:"ShapeFilled",TextWidth:"TextWidth",TextHeight:"TextHeight",PercentageArea:"PercentageArea",CenterX:"CenterX",CenterY:"CenterY",PageHeight:"PageHeight",PageWidth:"PageWidth",otherLockupPercDesignArea:"otherLockupPercDesignArea",TextCount:"TextCount",actionWordsCount:"actionWordsCount",TextString:"TextString",BackingShape:"BackingShape",PerAreaAllLockups:"PercentageAreaAllLockups",CollisionPercentage:"CollisionPercentage",SurroundingAlignment:"SurroundingAlignment"}),i.LockupRoleData=(a=function(e,t,n){l.RoleData.call(this,e,o.clone(t),o.clone(n))},o.defineClass({name:"LockupRoleData",ctor:a,superName:"RoleData",statics:{digits:"0123456789/@|",webReferenceStrings:[".com","http",".edu",".org",".gov"],actionWordStrings:["join","now","today","try","view","swipe"],socialMediaStrings:["#","instagram"],getLockupRoleData:function(e){var t=[i.LockupRoleFeatures.WordCount,i.LockupRoleFeatures.CharacterCount,i.LockupRoleFeatures.intsSpecialsCount,i.LockupRoleFeatures.checkSocialChar,i.LockupRoleFeatures.webReferencesCount,i.LockupRoleFeatures.Spacing,i.LockupRoleFeatures.Padding,i.LockupRoleFeatures.ShapeFilled,i.LockupRoleFeatures.TextWidth,i.LockupRoleFeatures.TextHeight,i.LockupRoleFeatures.PercentageArea,i.LockupRoleFeatures.CenterX,i.LockupRoleFeatures.CenterY,i.LockupRoleFeatures.PageWidth,i.LockupRoleFeatures.PageHeight,i.LockupRoleFeatures.otherLockupPercDesignArea,i.LockupRoleFeatures.TextCount,i.LockupRoleFeatures.actionWordsCount],n=[i.LockupRoleFeatures.TextString,i.LockupRoleFeatures.BackingShape,i.LockupRoleFeatures.PerAreaAllLockups],l=r.FeatureExtractorFactory.getFeatureExtractor(r.FeatureExtractorType.LockupStyle,e,o.clone(o.as(t.concat(n),["Array","String"]))),s=o.clone(l.numericalFeatures);o.removeKey(s,i.LockupRoleFeatures.PerAreaAllLockups);var h=l.categoricalFeatureForKey(i.LockupRoleFeatures.TextString),u=l.categoricalFeatureForKey(i.LockupRoleFeatures.BackingShape),g=l.numericFeatureForKey(i.LockupRoleFeatures.PerAreaAllLockups);return s[i.LockupRoleFeatures.actionWordsCount]=o.toDouble(a.getNumActionWordReferences(h)),s[i.LockupRoleFeatures.checkSocialChar]=a.checkSocialMediaCharacters(h,u)?1:0,s[i.LockupRoleFeatures.intsSpecialsCount]=o.toDouble(a.getNumIntsAndSpecials(h)),s[i.LockupRoleFeatures.webReferencesCount]=o.toDouble(a.getNumWebReferences(h)),s[i.LockupRoleFeatures.otherLockupPercDesignArea]=g-s[i.LockupRoleFeatures.PercentageArea],new a(e,o.clone(t),o.clone(s))},getNumIntsAndSpecials:function(e){for(var t=0,n=o.iter(o.range(0,e.length,!1));!n.done;n.next()){var i=n.value,r=e.substr(i,1);a.digits.includes(r)&&(t+=1)}return t},getNumWebReferences:function(e){for(var t=0,n=o.iter(a.webReferenceStrings);!n.done;n.next()){var i=n.value;e.toLowerCase().includes(i)&&(t+=1)}return t},getNumActionWordReferences:function(e){for(var t=0,n=o.iter(a.actionWordStrings);!n.done;n.next()){var i=n.value;e.toLowerCase().includes(i)&&(t+=1)}return t},checkSocialMediaCharacters:function(e,t){for(var n,i=!1,r=o.iter(a.socialMediaStrings);!r.done;r.next()){var l=r.value;e.includes(l)&&(i=!0)}return(n=s.ShapeLibrary.shapeDictionary[t])&&n.category==s.ShapeCategory.Social&&(i=!0),i},checkLockupIsGraphic:function(e,t){for(var n=!1,a="",i=o.iter(o.range(0,e.length,!1));!i.done;i.next()){var r=i.value,l=e.substr(r,1);" "!=l&&"\n"!=l&&"\t"!=l&&"\r"!=l&&(a+=l)}return a.length<=1&&t.category!=s.ShapeCategory.None&&(n=!0),n}}}),a)},zbwF:function(e,t,n){var a,i,o,r=t,l=n("oAGj"),s=n("xRbc"),h=n("uj1m"),u=n("7Ta2"),g=n("taeg");r.LockupRoleSuggesterFactory=(a=function(){},l.defineClass({name:"LockupRoleSuggesterFactory",ctor:a,statics:{Create:function(e){return void 0===e&&(e=""),"MLP"==e?new r.LockupRoleSuggesterMLP:new r.LockupRoleSuggesterSimple}}}),a),r.LockupRoleSuggesterMLP=(i=function(){g.RoleSuggesterMLP.call(this)},l.defineClass({name:"LockupRoleSuggesterMLP",ctor:i,superName:"RoleSuggesterMLP",statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRoleModel:function(){return h.MLPModel.loadNNModel("TextRole")}}}),i),r.LockupRoleSuggesterSimple=(o=function(){},l.defineClass({name:"LockupRoleSuggesterSimple",ctor:o,statics:{_implements:function(e){return"RoleSuggesterProtocol"==e}},props:{getRole:function(e){var t,n=u.InferredRoleType.Undefined;if(t=l.as(e,s.LockupRoleData)){var a=t.feat(s.LockupRoleFeatures.WordCount),i=t.feat(s.LockupRoleFeatures.TextCount),o=t.feat(s.LockupRoleFeatures.TextHeight),r=t.feat(s.LockupRoleFeatures.intsSpecialsCount),h=t.feat(s.LockupRoleFeatures.checkSocialChar)>0,g=t.feat(s.LockupRoleFeatures.PercentageArea),c=t.feat(s.LockupRoleFeatures.otherLockupPercDesignArea);n=a<=5&&o>=80||a<=9&&o>=250?u.InferredRoleType.Title:a<=14?u.InferredRoleType.SubTitle:u.InferredRoleType.Body,r>=5&&a<=18&&o<=220&&(n=u.InferredRoleType.Contact),h&&(n=u.InferredRoleType.Social),i<=3&&g>c&&(n!=u.InferredRoleType.Body&&n!=u.InferredRoleType.Social||(n=u.InferredRoleType.Title))}return u.InferredRole.init_84d1(n,1)}}}),o)}}]);
//# sourceMappingURL=vendors_npm_spark_f5b5a342-926caaba.js.map