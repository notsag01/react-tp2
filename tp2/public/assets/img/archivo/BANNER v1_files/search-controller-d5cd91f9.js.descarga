(window.webpackJsonp=window.webpackJsonp||[]).push([["search-controller"],{1430:function(e,s,t){var r,i;r=[t(6),t(2),t(5),t(0)],void 0===(i=function(e,s,t,r){"use strict";return new(t.Model.extend({isClipboardSupported:function(){return document.queryCommandSupported("copy")},copyFieldToClipboard:function(e){var s;e.select();try{document.execCommand("copy")||(s="execCommand returned false")}catch(t){s="caught-error: "+t.message,window.marvel.logger.debug("Clipboard copy error:"+t.message,t)}if(s)throw new Error("Could not copy string to clipboard: "+s)},copyStringToClipboard:function(s){var t=e("<input>");t.css({position:"absolute",transform:"translateX(-5000px)"}),e("body").append(t),t.val(s);try{this.copyFieldToClipboard(t)}finally{t.remove()}}}))}.apply(s,r))||(e.exports=i)},1752:function(e,s,t){e.exports=function(){var e=[],s=[],t={},r={},i={};function a(e){return"string"==typeof e?new RegExp("^"+e+"$","i"):e}function l(e,s){return e===s?s:e===e.toUpperCase()?s.toUpperCase():e[0]===e[0].toUpperCase()?s.charAt(0).toUpperCase()+s.substr(1).toLowerCase():s.toLowerCase()}function n(e,s){return e.replace(/\$(\d{1,2})/g,(function(e,t){return s[t]||""}))}function o(e,s){return e.replace(s[0],(function(t,r){var i=n(s[1],arguments);return l(""===t?e[r-1]:t,i)}))}function h(e,s,r){if(!e.length||t.hasOwnProperty(e))return s;for(var i=r.length;i--;){var a=r[i];if(a[0].test(s))return o(s,a)}return s}function c(e,s,t){return function(r){var i=r.toLowerCase();return s.hasOwnProperty(i)?l(r,i):e.hasOwnProperty(i)?l(r,e[i]):h(i,r,t)}}function d(e,s,t,r){return function(r){var i=r.toLowerCase();return!!s.hasOwnProperty(i)||!e.hasOwnProperty(i)&&h(i,i,t)===i}}function u(e,s,t){return(t?s+" ":"")+(1===s?u.singular(e):u.plural(e))}return u.plural=c(i,r,e),u.isPlural=d(i,r,e),u.singular=c(r,i,s),u.isSingular=d(r,i,s),u.addPluralRule=function(s,t){e.push([a(s),t])},u.addSingularRule=function(e,t){s.push([a(e),t])},u.addUncountableRule=function(e){"string"!=typeof e?(u.addPluralRule(e,"$0"),u.addSingularRule(e,"$0")):t[e.toLowerCase()]=!0},u.addIrregularRule=function(e,s){s=s.toLowerCase(),e=e.toLowerCase(),i[e]=s,r[s]=e},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["whiskey","whiskies"]].forEach((function(e){return u.addIrregularRule(e[0],e[1])})),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|tlas|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[emjzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/(m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach((function(e){return u.addPluralRule(e[0],e[1])})),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/(m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|tlas|gas|(?:her|at|gr)o|ris)(?:es)?$/i,"$1"],[/(analy|ba|diagno|parenthe|progno|synop|the|empha|cri)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach((function(e){return u.addSingularRule(e[0],e[1])})),["adulthood","advice","agenda","aid","alcohol","ammo","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","flounder","fun","gallows","garbage","graffiti","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","manga","news","pike","plankton","pliers","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","species","staff","swine","tennis","traffic","transporation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(u.addUncountableRule),u}()},1774:function(e,s){e.exports='{{#inVbSearchHeader}}\n<div class="vb-search-header-background"></div>\n<div class="search-header-logo-and-back">\n    {{^inMainSearchHeader}}\n    <a class="mrvl-logo-link" href="/{{localePathPrefix}}"><p class="mrvl-logo" data-auto="brand-logo">{{header-title}}<span class="mrvl-logo-preload"></span></p></a>\n    {{/inMainSearchHeader}}\n    <button class="npw-visual-browse-header-back-arrow{{#backArrowText}} has-text{{/backArrowText}}" title="{{backArrowText}}" data-auto="npwfu-close-btn">{{backArrowText}}</button>\n</div>\n<div class="vb-search-header-short-v-filler"></div>\n{{#showFavoritesInHeader}}\n<div class="npw-visual-browser-header-favorites" data-id="favorites">{{npw-vg-search-results-header-button-favorites}}</div>\n{{/showFavoritesInHeader}}\n<div class="npw-visual-browse-header-create-new-dropdown">\n</div>\n<div class="npw-visual-browse-header-create-new-dropdown-v-spacer"></div>\n{{#formatFilters}}\n{{#filtersInHeader}}\n<div class="vb-search-header-filters-background {{#filtersInHeaderCss}}{{.}}{{/filtersInHeaderCss}}">\n<div class="vb-search-header-formats">\n{{#format}}\n{{^hide}}\n{{^sep}}\n<div class="vb-search-header-formats-format{{#selected}} selected{{/selected}}" data-id="{{id}}" data-app="{{#app}}{{.}}{{/app}}">{{label}}</div>\n{{/sep}}\n{{#sep}}\n<div class="vb-search-header-formats-format-sep">|</div>\n{{/sep}}\n{{/hide}}\n{{/format}}\n</div>\n</div>\n{{/filtersInHeader}}\n{{/formatFilters}}\n{{/inVbSearchHeader}}\n<div class="search-results-grid-view-holder hide {{#searchViewInContainer}} search-view-in-container search-view-common{{/searchViewInContainer}}" data-auto="search-results-grid-holder"></div>\n<div class="search-view hide{{^inMainSearchHeader}}{{#inVbSearchHeader}} in-vb-search-header{{/inVbSearchHeader}}{{/inMainSearchHeader}}{{#inMainSearchHeader}} in-main-search-header{{/inMainSearchHeader}}{{#searchViewInContainer}} search-view-in-container{{/searchViewInContainer}}{{#searchViewInHeader}} search-view-in-header{{/searchViewInHeader}}{{#searchViewBarOnly}} search-view-bar-only{{/searchViewBarOnly}}{{#searchParentHeightControl}} search-view-parent-height-control{{/searchParentHeightControl}}">\n    <div class="search-overlay hide" data-auto="search-view-search-overlay"></div>\n    <div class="search-top-container">\n        {{^searchViewNoBackground}}\n        <div class="search-bg-underlay{{#showUnderlay}} showing{{/showUnderlay}}"></div>\n        {{/searchViewNoBackground}}\n        <div class="search-bar{{#searchViewBarHasButton}} show-search-button{{/searchViewBarHasButton}}">\n            <div class="search-input-holder">\n                <div class="search-button" type="text" data-auto="search-view-search-input-search-button"></div>\n                <button class="search-input-escape-focus hide"></button>\n                <input class="search-input" placeholder="{{placeholder}}{{^placeholder}}{{npw-search-field-placeholder}}{{/placeholder}}" id="search-view-search-input" type="text" data-auto="search-view-search-input" autocomplete="off">\n                <button class="search-clear disabled" type="text" data-auto="search-view-search-input-search-button"></button>\n            </div>\n            <div class="search-input-tooltip-holder off">\n                <div class="search-input-tooltip"></div>\n            </div>\n            <div class="search-input-disabled hide" type="text"></div>\n            <div class="search-results hide" data-auto="search-view-results-menu"></div>\n        </div>\n    </div>\n</div>\n'},2304:function(e,s){e.exports="<style>\n    {{#assets}}\n    #{{id}} {\n        {{^hideAssetUntilLoaded}}\n        {{^rendition}}\n        background-image: url('{{{url}}}.{{fileType}}');\n        {{/rendition}}\n        {{#rendition}}\n        background-image: url('{{{.}}}');\n        {{/rendition}}\n        {{/hideAssetUntilLoaded}}\n        {{#hwar}}\n        padding-top: {{.}};\n        {{/hwar}}\n        {{#w}}\n        width: {{.}};\n        {{/w}}\n        {{#h}}\n        height: {{.}};\n        {{/h}}\n    }\n\n    {{/assets}}\n    @media\n        only screen and (-webkit-min-device-pixel-ratio: 1.5),\n        only screen and (min--moz-device-pixel-ratio: 1.5),\n        only screen and (-o-min-device-pixel-ratio: 1.5/1),\n        only screen and (min-device-pixel-ratio: 1.5),\n        only screen and (min-resolution: 192dpi),\n        only screen and (min-resolution: 1.5dppx) {\n\n        {{#assets}}\n        #{{id}} {\n            {{^hideAssetUntilLoaded}}\n            {{^rendition}}\n            background-image: url('{{{url}}}@2x.{{fileType}}');\n            {{/rendition}}\n            {{#rendition2x}}\n            background-image: url('{{{.}}}');\n            {{/rendition2x}}\n            {{/hideAssetUntilLoaded}}\n        }\n        {{/assets}}\n</style>\n"},2503:function(e,s,t){var r,i;r=[t(6),t(2),t(5),t(0),t(123),t(76),t(3420),t(3421),t(2504),t(62),t(1),t(22),t(15),t(1325),t(3423),t(3429),t(368)],void 0===(i=function(e,s,t,r,i,a,l,n,o,h,c,d,u,g,m,p,f){"use strict";var v={borderSpace:20,minHeight:80,maxHeight:300,targetNumRows:2.5,rowVSpace:32,maxWidth:1600,rowHMargin:32},w={project:10,learn:10,template:5},b=(c.cpTemplateSearchRemixFeedTag,c.cpTemplateSearchRemixPaidTag,c.cpTemplateSearchMappedTagRemixPaid),_=b.split("-")[1],x=c.cpTemplateSearchGiphyTag,y=c.cpTemplateSearchMaxStringLength,S=[i.DOM_VK_LEFT,i.DOM_VK_RIGHT,i.DOM_VK_UP,i.DOM_VK_DOWN];return t.View.extend({events:{"click .search-button":this._handleSearchBtnClick,"click .search-input":this._handleSearchInputBoxClick,"click .search-term-link":this._handleSearchResultClick,"click .search-results":this._handleSearchResultClick},initialize:function(e){e=s.assign({},e||{}),s.bindAll(this,s.functionsIn(this)),this._debouncedGetSearch=s.debounce(this._getSearchResults.bind(this),500),this._debouncedContainerResized=s.debounce(this._containerResized.bind(this),500),this._initializeOptions(e),this._initSearchSuggestAndTotalTemplates(e),this._options.doNotRenderOnInit||(this.render(),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData))},_initializeOptions:function(e){this._options=e,this._setSearchRequestsController(this._options.SearchRequestsController),this._gridDims=s.assign({},v,e.gridDims||{}),this._options.popularSearchStrings&&this._initPopularSearchesFromStrings(this._options.popularSearchStrings),this._options.debugTagging?this._debugSettings={debugCssStr:"debug-tagging",cpAssetPathTemplate:this._options.debugTaggingAssetPathTemplate}:this._debugSettings=null,this.preferredNumSuggestedResults=s.isUndefined(this._options.preferredNumSuggestedResults)?5:this._options.preferredNumSuggestedResults||0,this.maxTotalResultLinesToDisplay=s.isUndefined(this._options.maxTotalResultLinesToDisplay)?this._options.maxTotalResultLinesToDisplay||0:10,this.maxItemsToDisplayInGroup=8,this.maxKeywordFiltersToDisplay=8,this.maxKeywordFilters=50,this.maxNumSelectedTags=this._options.maxNumSelectedTags||6,this._setSearchForCurrentRoutePath({initializing:!0})},_setSearchRequestsController:function(e){this.SearchRequestsController=e,this._boundSearchCallbacks||(this._boundSearchCallbacks=!0,this._setSearchingForResults=this._setSearchingForResults.bind(this),this.renderCpSearchResults=this.renderCpSearchResults.bind(this)),this.SearchRequestsController.setCallbacks({setSearchingForResults:this._setSearchingForResults,renderCpSearchResults:this.renderCpSearchResults})},doInitialRender:function(e){e&&(this._options.el=e,this.setElement(e)),this.render(),this._nextInitialRenderIsUpdate?(this.searchResultsGridView&&this._reapplyGridViewInitOptions(),this._nextInitialRenderIsUpdate=!1,this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered&&this.triggerAutoSearch(this._options.autoSearch)):this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData)},updateOptions:function(t){if(t.SearchRequestsController&&t.SearchRequestsController!==this.SearchRequestsController&&this._setSearchRequestsController(t.SearchRequestsController),t.reset){var r=s.assign({},t);delete r.reset,this._initializeOptions(r)}else s.assign(this._options,t);this._eventsBoundEl$&&(s.each(this._eventsBoundEl$.children(),(function(s){e(s).remove()})),this._eventsBoundEl$=null),this._options.doNotRenderOnInit?(this._nextInitialRenderIsUpdate=!0,this.searchResultsGridView&&(this._reapplyGridViewInitOptionsOnNextResults=!0)):(this.setElement(t.el),this.render(),this.searchResultsGridView&&this._reapplyGridViewInitOptions(),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered?this.triggerAutoSearch(this._options.autoSearch):this._options.searchData&&this.restoreSearchAfterReRender(this._options.searchData))},_initSearchSuggestAndTotalTemplates:function(e){var s={MAX_TEMPLATE_SEARCH_STRING_LENGTH:c.cpTemplateSearchMaxStringLength,MAX_TEMPLATE_SEARCH_TERMS:c.cpTemplateSearchMaxSearchTerms,REMIX_PAID_MAP_TAG:c.cpTemplateSearchMappedTagRemixPaid,GIPHY_TAG:c.cpTemplateSearchGiphyTag,searchServiceSuggestOptions:e.searchServiceSuggestOptions,SearchRequestsController:e.SearchRequestsController,optionsForAllQuery:this._getSuggestQueryOptions()};this._searchSuggest=new p(s),this._totalTemplates={marvel:0},this._searchSuggest.getTotalTemplatesCount().then(function(e){this._totalTemplates.marvel=e,e<1e3&&!this._options.usingStageContent&&window.marvel.logger.warn("[SearchView] user has less than 1000 total templates:"+e),this._calcPlaceholderText(),this._setPlaceholderAttr()}.bind(this))},_getAllAsCatSearch:function(e){var s={label:"All",labelG11n:u.getString("npw-vb-search-box-cat-all"),commandType:"searchAll"};return this._updateLineDataWithApp(s,e,!0),s},_getAllPremiumAsCatSearch:function(e){var s={label:_,labelG11n:u.getString("npw-vb-search-box-cat-all-premium"),commandType:"searchAllPremium"};return this._updateLineDataWithApp(s,e,!0),s},_getAllAnimatedAsCatSearch:function(e){var s={label:_,labelG11n:u.getString("npw-vb-search-box-cat-all-animated"),commandType:"searchAllAnimated"};return this._updateLineDataWithApp(s,e,!0),s},_initPopularSearchesFromStrings:function(e){var t=e.length-1;this.popularSearches=[],this.popularCategories=[];var r=e.categories;e=e.searchStrings,s.each(e,function(e,r){var i=[],a=[];s.each(e.tags,(function(e){i.push(e),a.push(e.substring(e.indexOf("-")+1))}));var l=a.join(" "),n=u.getString("npw-vb-search-box-popular-translation-"+a.join("-")),o=n||l,h={tags:i.join(":"),label:o,srcLabel:l};e.app&&this._updateLineDataWithApp(h,e.app),r===t&&(h.last=!0),this.popularSearches.push(h)}.bind(this)),s.each(r,function(e,s){var r=e.split("-")[1],i={tags:e,keywords:r,labelG11n:u.getString("npw-vb-search-box-category-"+r)||r,label:r};s===t&&(i.last=!0),this.popularCategories.push(i)}.bind(this))},_trackEvent:function(e,s){d.trackEvent(e,s||{},this._getAnalyticsPage())},_getAnalyticsPage:function(){var e=(this._options.context||"npw")+":search";return this._showingCpResults&&(e+="ResultsGrid"),e},_handleSearchBtnClick:function(e){this._handleKeyUp(e)},hideResultsForHomeRender:function(){this._showingCpResults&&this._hideCpSearchResults()},_setShowingResults:function(){this.$el.addClass("showing-results-grid"),this._options.inMainSearchHeader&&e(document.body).addClass("showing-search-header-results-grid"),this._showingCpResults=!0},_hideCpSearchResults:function(){this._showingCpResults=!1,this.$el.removeClass("showing-results-grid"),this._options.inMainSearchHeader&&e(document.body).removeClass("showing-search-header-results-grid"),this._options.showFormatFilters&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.removeClass("hide-formats"),this.searchResultsGridView&&this.searchResultsGridView.hide(),this.hideTextForFieldIfNeeded()},_isASearchPage:function(){return"template"===this._currentRoutePathInfo.type?this._showingCpResults:window.location.pathname.includes("/sp/"+this._currentRoutePathInfo.type+"-search")},hideTextForFieldIfNeeded:function(){this._options.showPlaceholderIfNotShowingResultsGrid&&!this._isASearchPage()&&(this._restoreTextOnClick={text:this._$searchInput.val()},this._$searchInput.val(""),this._calcPlaceholderText(),this._setPlaceholderAttr({unfocused:!0}))},reshowForFieldOnly:function(){this._$searchInput.val(this._restoreTextOnClick.text),this._restoreTextOnClick=null},returningToHome:function(){this._showingCpResults&&(this._hideCpSearchResults(),this.setBackText())},_handleBrowseHeaderBackArrow:function(t){e(t.target).blur();var r={showingCpResults:!(!this._showingCpResults||!this.searchResultsGridView),currentSearch:s.clone(this.SearchRequestsController.getCurrentSearch()),filters:this._searchFilters.current,searchFieldStr:this._getTrimmedInputText(),searchView:this};this.searchResultsGridView&&this.searchResultsGridView._showingDetail?this.searchResultsGridView.closeDetail():this._options.navBackClickHandler?this._options.navBackClickHandler(t,r).then(function(){r.showingCpResults&&(this._hideCpSearchResults(),this.setBackText(null,{hidingResults:!0}))}.bind(this)):this._showingCpResults&&(this._hideCpSearchResults(),this.setBackText(null,{hidingResults:!0}))},_getCleanedSearchInput:function(e){if((e=("string"==typeof e?e:this._$searchInput.val()).replace(/\+/g," ").replace(/  +/g," ").trim()).length&&e.length>y){var s=e.substring(0,y);if(" "!==e[y]){var t=s.lastIndexOf(" ");-1!==t&&(s=s.substring(0,t))}e=s}return e},_handleReturnPressedForArrows:function(e){e.stopImmediatePropagation(),e.preventDefault();var s=this._getSelectedLine();if(this._waitingForInputParseReturn=null,this._doesInputFieldMatchBoxResults())this._handleSearchResultClick(null,s.line$,{selType:s.selType,fromArrowReturn:!0});else if(!s.line$||"returnField"===s.selType){if("returnField"===s.selType)return void this._handleSearchResultClick(null,s.line$,{selType:s.selType,fromArrowReturn:!0});this._waitingForInputParseReturn={text:this._getCleanedSearchInput().toLowerCase()}}},_getSelectedLine:function(){var s=this._arrowPresses.selectedLine$,t=s&&"lineReturn";return s||(t="returnField",s=e('<div class="empty-line search-result-line-can-arrow-nav"/>')),{selType:t,line$:s}},_handleArrowKeyPressed:function(e){if(this._arrowPresses.enabled){e.stopImmediatePropagation(),e.preventDefault();var s=e.keyCode===i.DOM_VK_UP;if(!this._arrowPresses.pressesSinceReset){var t=this._$searchInput.val();t!==this._arrowPresses.searchStr&&(this._arrowPresses.searchStr=t)}this._arrowPresses.pressesSinceReset++,this._incSelectedLine(s?-1:1)}},_getFirstGoodLine:function(){var s=this._$searchResults.find(".search-result-result-line");return s.length&&e(s[0])},_incSelectedLine:function(s){if(!this._arrowPresses.numLines)return!1;var t=this._arrowPresses.lineIndex+s;if(t>=this._arrowPresses.numLines?t=this._arrowPresses.fieldIndex:t<this._arrowPresses.fieldIndex&&(t=this._arrowPresses.numLines-1),t!=this._arrowPresses.lineIndex)if(this._arrowPresses.selectedLine$&&this._arrowPresses.selectedLine$.removeClass("arrow-selected"),this._arrowPresses.lineIndex=t,t>=0){if(window.marvel.logger.debug(t),this._arrowPresses.selectedLine$=e(this._arrowPresses.lines$[t]),this._arrowPresses.selectedLine$.addClass("arrow-selected"),this._arrowPresses.selectedLine$.hasClass("search-add-text-tag")){if(!this._arrowPresses.selectedLine$.hasClass("show-more-tags-btn")){this._arrowPresses.hasCachedAddText||(this._arrowPresses.hasCachedAddText=!0,this._arrowPresses.cachedAddText=this._arrowPresses.searchStr);var r=this._arrowPresses.selectedLine$.data("text");this._setSearchInput(this._arrowPresses.cachedAddText+" "+r)}}else if(!this._arrowPresses.selectedLine$.hasClass("search-result-result-line-all")){var i=this._arrowPresses.selectedLine$.data("label");if(!i)i=this._arrowPresses.selectedLine$.data("keywords").split(":").join(" ");this._setSearchInput(i)}}else this._arrowPresses.selectedLine$=null,this._setSearchInput(this._arrowPresses.searchStr),t===this._arrowPresses.tagsIndex&&(this._arrowPresses.clearTags$.hasClass("enabled")?this._arrowPresses.clearTags$.focus():this._arrowPresses.selectedTags$[0].focus())},_handleKeyDown:function(s){var t;if(this._debouncedGetSearch.cancel(),this._cancelCurrentGetSearchResults(),e(s.target).hasClass("search-clear")){if(s.keyCode===i.DOM_VK_RETURN)return s.stopImmediatePropagation(),s.preventDefault(),void s.stopPropagation();s.keyCode===i.DOM_VK_TAB&&(t=!s.shiftKey)}else s.keyCode===i.DOM_VK_UP||s.keyCode===i.DOM_VK_DOWN?(s.preventDefault(),this._handleArrowKeyPressed(s)):s.keyCode===i.DOM_VK_TAB&&(t=s.shiftKey||this._$searchClear.hasClass("disabled"));t&&(this._applyInputTextForFocus(),this._blurFieldAndHideResults())},_recalculateSearchButtonActive:function(e){var s=!0;return(s=""!==(e=this._getCleanedSearchInput(e)))?this._$searchButton.addClass("active"):this._$searchButton.removeClass("active"),s},_triggerNonTemplateSearch:function(e){if(this._currentRoutePathInfo.currentData.queryPath){e=e&&s.trim(e)||"";var t=a.format({pathname:this._currentRoutePathInfo.currentData.queryPath,query:s.assign({q:e},this._currentRoutePathInfo.currentData.extraQueryValues)});return this._setSearchInput(e),this._blurFieldAndHideResults(),window.marvel.navigate(t,{trigger:!0}),!0}return!1},_escapeKeyUp:function(e,s){this._trackEvent("NPWSearchPressedEscKey",{searchTerm:s}),this._applyInputTextForFocus(),this._blurFieldAndHideResults({applyEscapeFocus:!0}),this.hideTextForFieldIfNeeded()},_handleKeyupInResults:function(e){e.keyCode===i.DOM_VK_ESCAPE&&this._escapeKeyUp(e,this._getTrimmedInputText())},_handleKeyUp:function(s){var t=this._getTrimmedInputText();if(t.length?this._$searchClear.removeClass("disabled"):this._$searchClear.addClass("disabled"),s.keyCode===i.DOM_VK_ESCAPE)this._escapeKeyUp(s,t);else if(e(s.currentTarget).hasClass("search-button"))this._$searchResults.hasClass("hide")?(this._waitingForInputParseReturn={text:this._getCleanedSearchInput().toLowerCase()},this._handleInputFocusOrClearX({fromContext:"fromSearchBtn"})):(this._trackEvent("NPWSearchClickedSearchBtn",{searchTerm:t}),t.length&&this._arrowPresses.enabled&&this._handleReturnPressedForArrows(s));else if(e(s.currentTarget).hasClass("search-clear"))s.keyCode===i.DOM_VK_RETURN&&this._handleClearSearchClick(s);else if(s.keyCode===i.DOM_VK_RETURN){if(this._arrowPresses.lastTagKeydownEventTime&&s.timeStamp-this._arrowPresses.lastTagKeydownEventTime<500)return void(this._arrowPresses.lastTagKeydownEventTime=0);if(this._trackEvent("NPWSearchPressedReturnKey",{searchTerm:t}),this._triggerNonTemplateSearch(t))return;this._arrowPresses.enabled&&this._handleReturnPressedForArrows(s)}else if(-1===S.indexOf(s.keyCode)){if(this._recalculateSearchButtonActive(t),this._currentRoutePathInfo.currentData.queryPath)return;this._debouncedGetSearch(s,null,{ifDifferentThanLast:!0,keyWasSpace:s.keyCode===i.DOM_VK_SPACE}),this._arrowPresses.enabled&&(this._arrowPresses.hasCachedAddText=!1)}},_getLinesFromServerData:function(e){if(!e.mustacheData)if(e.splitLinesData){var t=e.splitLinesData.textLines.concat(e.splitLinesData.suggestionLines||[]);s.each(t,function(e){var t,r=[];r=e.keysArray,t=s.map(e.tagsData,(function(e){return e.tag||e})),e.keywords=r.join(":"),e.tags=t.length&&t.join(":")||"",(this._options.debugTagging||this._options.showNumbersInLines)&&(e.showAnyCounts=!0)}.bind(this)),e.mustacheData={textLines:e.splitLinesData.textLines,suggestionLines:e.splitLinesData.suggestionLines,tagLinesGroups:e.tagLinesGroups,selectedTags:e.selectedTags&&s.cloneDeep(e.selectedTags)}}else e.mustacheData={lines:[]};return e.mustacheData},_updateLineDataWithApp:function(e,s,t){if(this._options.searchHistoryAppSpecific){"object"==typeof s&&(s=s.typeName);var r=g.getFormatInfo(s);r?(e.app=r.type,e.appLabel=r.formatLabel):t||window.marvel.logger.debug("bad app id for search line:"+s,e)}},_searchHistoryForBox:function(e){var s=w[e||"template"],t={searches:[]};if(this._searchHistory&&this._searchHistory.searches.length){s=Math.min(s,this._searchHistory.searches.length);for(var r=0;r<s;r++){var i=this._searchHistory.searches[r],a={label:i.s};i.app&&this._updateLineDataWithApp(a,i.app),t.searches.push(a)}}return t.numSearches=t.searches.length,t.historyLabel=this._getHistoryLabel(),t.numSearches||(t.historySubLabel=this._getHistoryLabel({none:!0})),t},_doesInputFieldMatchBoxResults:function(){return void 0!==this._lastDisplayedSearchBoxInput&&(!!this._arrowPresses.pressesSinceReset||this._getTrimmedInputText().toLowerCase()===this._lastDisplayedSearchBoxInput.toLowerCase())},_lastDisplayedSearchBoxInput:void 0,_getHistoryLabel:function(e){var s="npw-vb-search-box-section-history";return e&&e.none&&(s="npw-vb-search-box-section-history-none"),u.formatMessage(s,{type:this._currentRoutePathInfo.type})},_makeResultBoxForNonTemplates:function(e,s){var t=this._currentRoutePathInfo.type;s=s||{};var r={historySearches:this._searchHistoryForBox(t),fromNoResults:!0,isLearn:!0,scrollInnerHeight:this._maxResultsInnerHeightStr};this._$searchResults.html(u.mustacheRender(l,r,{lineLabels:n})),this._showSearchResults(e),"fromClearX"!==s.fromContext?this._focusInputIgnoreEvent():(this._cacheInputTextForFocus(),this._restoreTextOnClick=null)},_makeResultBoxFromNoSearchResults:function(e,t){this._$searchResults.empty();var r=this._searchHistoryForBox(),i=this.popularSearches&&this.popularSearches.length&&{searches:this.popularSearches},a=this.popularCategories;if(a){var o=[this._getAllAsCatSearch(this._searchFilters.current.format.app||"")];this._options.allowPremiumTemplates&&o.push(this._getAllPremiumAsCatSearch(this._searchFilters.current.format.app||"")),this._options.animationEnabled&&o.push(this._getAllAnimatedAsCatSearch(this._searchFilters.current.format.app||"")),a=o.concat(a)}var h=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.templateOptions&&this._lastShownResultBoxSettings.templateOptions.selectedTags;h&&!h.items&&(h=null);var c={showPopular:i,showCategorySearches:!!a,categorySearches:a,historySearches:r.numSearches&&r,selectedTags:this._searchSuggest.getSelectedTagsForNoResults(t,h),fromNoResults:!0,scrollInnerHeight:this._maxResultsInnerHeightStr};this._extendDebugSettingsToTemplateSettings(c),this._$searchResults.html(u.mustacheRender(l,c,{lineLabels:n})),this._lastShownResultBoxSettings=s.assign({},this._lastShownResultBoxSettings,{searchInput:e,templateOptions:c,options:this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options||{}}),this._trackEvent("NPWSearchTermsResultsShown",{searchTerm:e,context:"noSearchResults"}),this._showSearchResults(e),this._focusInputIgnoreEvent()},_focusInputIgnoreEvent:function(){this._ignoreNextFocus=!0,this._$searchInput.focus()},_makeResultBoxFromSearchData:function(e,t){t=t||{};var r,i=this._getCleanedSearchInput(e).toLowerCase().split(" "),a=1===i.length&&""===i[0],o=!t.doNotShow;this._lastDisplayedSearchBoxInput=e,t.resultsFromServer?r=this._getLinesFromServerData(t.resultsFromServer):a?r={lines:[]}:(window.marvel.logger.debug("called _makeResultBoxFromSearchData with bad options",{options:t,searchInput:e}),r={lines:[]}),this._$searchResults.empty();var h=0;r.lines?h=r.lines.length:(r.suggestionLines&&(h+=r.suggestionLines.length),r.textLines&&(h+=r.textLines.length));var c=this._searchHistoryForBox(),d=!h&&this.popularSearches&&this.popularSearches.length&&{searches:this.popularSearches},g=!h&&this.popularCategories;if(g){var m=[this._getAllAsCatSearch(this._searchFilters.current.format.app||"")];this._options.allowPremiumTemplates&&m.push(this._getAllPremiumAsCatSearch(this._searchFilters.current.format.app||"")),this._options.animationEnabled&&m.push(this._getAllAnimatedAsCatSearch(this._searchFilters.current.format.app||"")),g=m.concat(g)}o&&0===h&&(e?this._trackEvent("NPWSearchTermsYieldedZeroResults",{searchTerm:e}):this._trackEvent("NPWSearchDefaultSuggestionBoxShown",{searchTerm:"searchTerm:none"}));var p={tagLinesGroups:r.tagLinesGroups,selectedTags:r.selectedTags,numResults:h,showPopular:d,showCategorySearches:!!g,categorySearches:g,historySearches:c.numSearches&&c,fromNoResults:!1,scrollInnerHeight:this._maxResultsInnerHeightStr};if(r.textLines||r.suggestionLines?(p.textLines=r.textLines,p.hasTextLines=p.textLines&&p.textLines.length,p.suggestionLines=r.suggestionLines,p.hasSuggestionLines=p.suggestionLines&&p.suggestionLines.length,p.hasTextOrSuggestionLines=p.hasTextLines||p.hasSuggestionLines):p.tagLines=r.lines&&r.lines.length&&r.lines,this._extendDebugSettingsToTemplateSettings(p),this._$searchResults.html(u.mustacheRender(l,p,{lineLabels:n})),o){var f=t.fromContext;f||(window.marvel.logger.warn("unknown context in _makeResultBoxFromSearchData",{searchInput:e,options:t}),f="unknownContext"),this._trackEvent("NPWSearchTermsResultsShown",{searchTerm:e,context:f});var v="fromFocus"===f&&this._$searchResults.hasClass("hide");this._showSearchResults(e),v&&this._scrollResults(0)}if(this._lastShownResultBoxSettings={searchInput:e,options:s.cloneDeep(t),templateOptions:p},this._waitingForInputParseReturn){if(this._waitingForInputParseReturn.text===this._lastDisplayedSearchBoxInput){var w=this._getFirstGoodLine();w&&this._handleSearchResultClick(null,w,{selType:"returnFieldDelayed"})}this._waitingForInputParseReturn=null}},_extendDebugSettingsToTemplateSettings:function(e){this._debugSettings&&(e.debugCssStr=this._debugSettings.debugCssStr)},_searchStringFromResultLine:function(e,s){if("noResultLineCategory"===s)return"";var t=e.data("label");return t||(e.hasClass("search-results-tag-button")?this._$searchInput.val():(e.data("keywords")||"").split(":").join(" "))},_setSearchInput:function(e){e=e||"",this._$searchInput.val(e),e.length?this._$searchClear.removeClass("disabled"):this._$searchClear.addClass("disabled"),this._recalculateSearchButtonActive(e)},_tagsAboveResultsEnabled:function(){return this._gridDims&&!this._gridDims.hideTagsAboveResults},_handleSearchResultClickClear:function(s){s.stopImmediatePropagation(),s.preventDefault(),this._handleClearFiltersClick(e(s.target))},_handleSearchResultClick:function(t,r,i){if(i=i||{},t&&(t.stopImmediatePropagation(),r=r||e(t.currentTarget)),r.hasClass("search-add-text-tag"))this.searchAddTextTagClicked(r,i);else{var a=i.fromTag,l=i.selType||"lineClick";if(this._inputTextOnFocus=void 0,r.hasClass("search-result-line-can-arrow-nav")||a){var n,o=this._getTrimmedInputText(),c=r.data("tags"),d=r.data("keywords"),g=r.data("app"),m=r.data("command-type"),p=("searchAll"===m||"searchAllPremium"===m||"searchAllAnimated"===m)&&m,f=r.data("use-case")||r.data("src-label")||r.data("label")||r.text();g&&(n=h.getAppByType(g)),!n&&this._searchFilters.current.format.app&&(n=h.getAppByType(this._searchFilters.current.format.app));var v,w,b,_="NPWSearchSelectedSuggestedResultLine",x=!0,y=!1;r.hasClass("search-result-result-line")?v="resultLine":r.hasClass("search-result-search-suggest-line-user-text")?(v="resultSuggestLine",w=!0):r.hasClass("search-result-search-suggest-line-history")?v="noResultLineHistory":r.hasClass("search-result-search-suggest-line-popular-category")?(v="noResultLineCategory",w=!0,b=c&&c.length&&c.split(":")):r.hasClass("search-result-search-suggest-line-popular-search")?v="noResultLinePopularTerm":r.hasClass("search-results-tag-button")?v=r.hasClass("search-results-selected-tag")?"resultSelectedTag":"resultSuggestedTag":r.hasClass("empty-line")&&(x=!0,y=!0,v="userStr"),x&&!this._options.allowFieldDefault&&0===l.indexOf("returnField")&&r.find(".search-result-result-line-span-hint").length&&(x=!1),x||(_="NPWVisualBrowseTemplateFieldReturnIgnored");var S=y?o:!p&&this._searchStringFromResultLine(r,v)||"",T={searchTerm:((y?o:this._arrowPresses.searchStr)||"").trim(),contextualData2:"searchStr:"+S,contextualData4:"suggestedTerms:"+f,type:v,trigger:l};if(n&&(T.sparkFormat=n.typeName),this._trackEvent(_,T),x){this._debouncedGetSearch.cancel(),T.type=v,p||""!==S||b||(p="searchAll");var k={findAllType:p,commandType:m,searchString:S,addHistory:!m,app:n};if(!this._triggerNonTemplateSearch(k.searchString)){if(!w){var C=this._getLastResultsFromServer(),R=!this._$searchResults.hasClass("hide")&&C&&C.srcTagFilters;R?k.tagFilters=R:this._currentSelectedTags&&this._currentSelectedTags.length&&(k.tagFilters=this._currentSelectedTags)}if(!p&&!a){this._options.keysForTags&&c&&!b&&(d?c=null:(d=s.map(c.split(":"),(function(e){return c.split("-")[1]})).join(":"),c=null));var F="returnFieldDelayed"!==l;if(b)k.tagFilters=s.map(b,(function(e){var s=e.split("-").slice(1).join("-");return{assets:[],id:e,tag:e,key:s,keyword:s,tags:[e],selected:!0,label:u.getString("npw-vb-search-box-category-"+s),needsLabel:!0}})),c=null;else if(c){if(k.tags=c.split(":"),F){var A=s.map(k.tags,(function(e){return e.substring(e.indexOf("-")+1)}));this._getSearchResults(null,A.join(" "),{doNotShow:!0})}}else if(d)k.keywords=d.split(":"),F&&this._getSearchResults(null,k.keywords.join(" "),{doNotShow:!0});else if(y)k.keywords=S.split(" ");else{var I=r.data("label");if(!I)return void window.marvel.logger.debug("no data in search line:"+r.text(),r);k.keywords=I.split(" ")}}var D;this._setSearchInput(k.searchString),"header"===this._options.context&&(D=this._options.SearchController.getHeaderBackInfo()),this.setBackText(D),k.analyticsData=T,k.backInfo=D,this._options.asHeader||this._options.editorApp?this.SearchRequestsController.isSearchDifferent(k)||!this.searchResultsGridView?this._getTemplateResults(k):0===this._numResultsLastSearch?this._makeResultBoxFromNoSearchResults(k.searchString,k.tagFilters):(this._blurFieldAndHideResults({applyEscapeFocus:!0}),this._setShowingResults(),this._reapplyGridViewInitOptionsOnNextResults&&(this._reapplyGridViewInitOptionsOnNextResults=!1,this._reapplyGridViewInitOptions()),this.searchResultsGridView.render({isReRender:!0})):this._getTemplateResults(k)}}}}},_cancelCurrentGetSearchResults:function(){this._currentGetSearchResultsCancellableObj&&(this._currentGetSearchResultsCancellableObj.cancel=!0,this._currentGetSearchResultsCancellableObj=null)},_sendAddTextTagClickedAnalytic:function(e,s){var t=s.inputText,r=s.newText,i=s.selType,a={searchTerm:t,contextualData2:"searchStr:"+r,contextualData4:"suggestedTerms:"+(e.data("src-key")||e.data("id")),type:"noResultLineAddText",trigger:i||"lineClick"};this._trackEvent("NPWSearchSelectedSuggestedResultLine",a)},searchAddTextTagClicked:function(e,t){if(e.hasClass("show-more-tags-btn")){var r;this._$searchResults.find(".search-add-text-tag.if-showing-all").addClass("show-more-tags-tags search-result-line-can-arrow-nav"),e.addClass("hide").removeClass("search-result-line-can-arrow-nav"),t.fromArrowReturn&&(r=this._arrowPresses.lineIndex);var i=this._arrowPresses.hasCachedAddText?this._arrowPresses.cachedAddText:this._arrowPresses.searchStr;return this._resetArrowNav(!0,i),void(t.fromArrowReturn&&(this._arrowPresses.lineIndex=r-1,this._incSelectedLine(1)))}var a=e.data("text"),l=this._$searchInput.val(),n="";(e.addClass("hide").removeClass("search-result-line-can-arrow-nav"),t.fromArrowReturn)?n=l:n=-1===l.toLowerCase().split(" ").indexOf(a.toLowerCase())?l.trim()+" "+a:l.trim();this._resetArrowNav(!0,n),this._$searchInput.val(n),this._focusInputIgnoreEvent(),t=s.assign({},t,{newText:n,inputText:l}),this._sendAddTextTagClickedAnalytic(e,t)},_handleClearFiltersClick:function(e){var t=this._lastShownResultBoxSettings.options.resultsFromServer.srcTagFilters;t||(t=[],this._lastShownResultBoxSettings.options.resultsFromServer.srcTagFilters=t),t.splice(0);var r=this._lastShownResultBoxSettings.options.resultsFromServer.mustacheData.selectedTags;s.each(r.items,(function(e){e.selected=!1})),r.numMaxTagsSelected=0,r.atMaxTags=!1,this._$searchResults.find(".search-result-group-line-tags-tags").removeClass("at-max-tags"),e.closest(".search-result-group-line").find(".search-result-group-line-tag").removeClass("selected"),this._setClearAllFiltersButtonEnabled(!1),this._focusInputIgnoreEvent()},_setClearAllFiltersButtonEnabled:function(e){this._$clearAllFiltersButton=this._$searchResults.find(".search-box-filters-clear-all"),e?(this._$clearAllFiltersButton.addClass("enabled"),this._$clearAllFiltersButton.prop("disabled","")):(this._$clearAllFiltersButton.removeClass("enabled"),this._$clearAllFiltersButton.prop("disabled",!0))},_getLastResultsFromServer:function(){return this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options&&this._lastShownResultBoxSettings.options.resultsFromServer},_setAtMaxSelectedTagsForSelect:function(e,s){e.maxNumSelectedTags&&(s.selected?e.numMaxTagsSelected++:e.numMaxTagsSelected--,e.atMaxTags=e.numMaxTagsSelected>=e.maxNumSelectedTags,e.atMaxTags?this._$searchResults.find(".search-result-group-line-tags-tags").addClass("at-max-tags"):this._$searchResults.find(".search-result-group-line-tags-tags").removeClass("at-max-tags"))},searchResultSelectedTagClicked:function(e){var t,r=this._getLastResultsFromServer();if(r){(t=r.srcTagFilters)||(t=[],r.srcTagFilters=t);var i=e.data("src-key")+"",a=r.mustacheData.selectedTags,l=s.find(a.items,(function(e){return e.srcKey===i}));if(l){var n=l.customFilterType||l.aggTag&&l.aggTag.customFilterType,o=-1,h=s.find(t,(function(e,s){if(e.srcKey===i)return o=s,!0}));l.selected?(l.selected=!1,e.removeClass("selected"),-1!==o&&t.splice(o,1)):!a.atMaxTags||n?(l.selected=!0,e.addClass("selected"),h||t.push(l.aggTag)):l=null,l&&!n&&this._setAtMaxSelectedTagsForSelect(a,l)}}else window.marvel.logger.warn("[SearchView] null lastResultsFromServer in searchResultSelectedTagClicked",this._lastShownResultBoxSettings),t=[];this._setClearAllFiltersButtonEnabled(t.length>0),this._focusInputIgnoreEvent()},_getSuggestQueryOptions:function(e){var t=s.assign({},{prefix:"",tagFilters:null,spaceAggsRecalc:!1},e||{});return t.keysForTags=this._options.keysForTags,this._options.searchPageAndVideoAsRelated?t.app="post":t.app=this._searchFilters.current.format.app,t.preferredNumSuggestedResults=this.preferredNumSuggestedResults,t.maxTotalResultLinesToDisplay=this.maxTotalResultLinesToDisplay,t.maxItemsToDisplayInGroup=this.maxItemsToDisplayInGroup,t.maxKeywordFiltersToDisplay=this.maxKeywordFiltersToDisplay,t.maxKeywordFilters=this.maxKeywordFilters,t.maxNumSelectedTags=this.maxNumSelectedTags,t.showOnlySelectedKeywordFilters=!this._tagsAboveResultsEnabled(),t.lastSearchResults=this._lastRenderedResults&&this._lastRenderedResults.results,t.debug=!!this._debugSettings,this._options.allowPremiumTemplates&&(t[b]="allow"),this._options.allowGiphyTemplates&&(t[x]="allow"),t},_getSearchResults:function(e,t,r){var i={},a=!this._$searchResults.hasClass("hide")&&this._lastShownResultBoxSettings;this._currentGetSearchResultsCancellableObj&&(this._currentGetSearchResultsCancellableObj.cancel=!0),this._currentGetSearchResultsCancellableObj=i,r=r||{};var l=t;l||(l=this._$searchInput.val()),this._debouncedGetSearch.cancel();var n=r.keyWasSpace&&this._searchSuggest.suggestAggsOnSpace();if(n&&this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.options&&this._lastShownResultBoxSettings.options.keyWasSpace&&(n=!1),l=this._getCleanedSearchInput(l),r.ifDifferentThanLast){var o=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.searchInput||"";if(l===o&&!n)return;delete r.ifDifferentThanLast}var h,c=r.fromContext;h=r.tagFilters?r.tagFilters:a&&a.options&&a.options.resultsFromServer?a.options.resultsFromServer.srcTagFilters:this._currentSelectedTags,e&&(c="fromKeyUp");var d=this._getSuggestQueryOptions({prefix:l,tagFilters:h,spaceAggsRecalc:n});this._searchSuggest.getCpPrefixData(d,i).then(function(e){this._currentGetSearchResultsCancellableObj===i&&(this._currentGetSearchResultsCancellableObj=null,i.cancel||e.cancelled||this._makeResultBoxFromSearchData(l,s.assign({resultsFromServer:e,fromContext:c},r)))}.bind(this),(function(e){window.marvel.logger.warn("[SearchView] getCpPrefixData rejected:",e)}))},_handleSearchInputBoxClick:function(){this._trackEvent("NPWSearchBoxClicked",{}),this._setPlaceholderAttr({clear:!0})},setViewHeight:function(e){this._$searchView.css("height",e)},_handleInputFocusOrClearX:function(e){this._setPlaceholderAttr({remove:!0});var t,r,i=this._getTrimmedInputText(),a=this._lastShownResultBoxSettings&&i===this._lastShownResultBoxSettings.searchInput,l=!this._$searchResults.hasClass("hide");if(a&&this._showingCpResults){var n;this._currentSelectedTags&&this._currentSelectedTags.length&&(t=this._currentSelectedTags),r=this._lastShownResultBoxSettings&&this._lastShownResultBoxSettings.templateOptions&&this._lastShownResultBoxSettings.templateOptions.selectedTags&&this._lastShownResultBoxSettings.templateOptions.selectedTags.items;var o=0;r&&(n=s.reduce(r,(function(e,s){return s.selected&&(e[s.id]=!0,o++),e}),{})),a=t&&t.length?o===t.length&&!s.find(t,(function(e){return!n[e.id]})):!o}this._currentRoutePathInfo.currentData.queryPath?this._makeResultBoxForNonTemplates(i,e):a&&l?(this._lastShownResultBoxSettings.options.doNotShow&&(this._lastShownResultBoxSettings.options.doNotShow=!1),this._makeResultBoxFromSearchData(this._lastShownResultBoxSettings.searchInput,s.assign({},this._lastShownResultBoxSettings.options,e))):this._getSearchResults(null,null,{fromContext:e.fromContext||"fromFocus"})},_arrowPresses:{enabled:!1},_resetArrowNav:function(e,s){var t=this._$searchResults.find(".search-results-selected-tag").filter(":visible");this._arrowPresses.selectedTags$=t.length&&t,this._arrowPresses.selectedTags$?(this._arrowPresses.clearTags$=this._$searchResults.find(".search-box-filters-clear-all"),this._arrowPresses.showMoreTags$=this._$searchResults.find(".show-more-tags-btn").filter(":visible"),this._arrowPresses.showMoreTags$.length||(this._arrowPresses.showMoreTags$=null)):(this._arrowPresses.clearTags$=null,this._arrowPresses.showMoreTags$=null),this._arrowPresses.lines$=this._$searchResults.find(".search-result-line-can-arrow-nav"),this._arrowPresses.numLines=this._arrowPresses.lines$.length,this._arrowPresses.lines$.removeClass("arrow-selected"),this._arrowPresses.selectedLine$=null,this._arrowPresses.fieldIndex=this._arrowPresses.selectedTags$?-2:-1,this._arrowPresses.tagsIndex=this._arrowPresses.selectedTags$?-1:-100,this._arrowPresses.lineIndex=this._arrowPresses.fieldIndex,this._arrowPresses.enabled=!!e,this._arrowPresses.searchStr=s,this._arrowPresses.pressesSinceReset=0,this._arrowPresses.hasCachedAddText=!1,this._arrowPresses.cachedAddText=""},_showSearchResults:function(e){this._$searchResults.removeClass("hide"),this._$searchView.addClass("searching"),this._$searchOverlay.addClass("overlay-showing").removeClass("hide"),this._resetArrowNav(!0,e),""===e&&this._setPlaceholderAttr()},_scrollResults:function(e){e=e||0,this._$searchResults.find(".search-results-ul-scroller").scrollTop(e)},_hideSearchResults:function(){this._$searchResults.addClass("hide"),this._$searchOverlay.addClass("hide").removeClass("overlay-showing"),this._$searchView.removeClass("searching")},_setSearchingForResults:function(e,t){if(t=t||{},e){var r;if("searchAll"===t.commandType||this._$searchInput.width()>300){var i,a={appId:t.app&&g.getAppType(t.app)||""};if("searchAll"===t.commandType)i="npw-search-field-progress-all";else this._getTrimmedInputText()?(i="npw-search-field-progress",a.searchString=this._getTrimmedInputText()):i="npw-search-field-progress-all";r=u.formatMessage(i,a)}else r=this._getTrimmedInputText();this._$searchInput.addClass("hide"),this._$searchInputDisabled.removeClass("hide"),this._$searchInputDisabled.text(r),this._$searchResults.addClass("hide"),this._$searchView.removeClass("searching"),this._$searchButton.addClass("searching"),t.noProgressOverlay||(t.opaqueProgressOverlay&&this._$searchOverlay.addClass("overlay-opaque"),this._$searchOverlay.removeClass("hide").addClass("overlay-showing"))}else this._$searchInput.removeClass("hide"),this._$searchInputDisabled.addClass("hide"),this._$searchButton.removeClass("searching"),this._$searchOverlay.removeClass("overlay-showing"),this._$searchOverlay.removeClass("overlay-opaque"),t.showImmediately?this._$searchOverlay.addClass("hide"):s.delay(function(){this._$searchOverlay.addClass("hide")}.bind(this),300),this._calcPlaceholderText(),this._setPlaceholderAttr({unfocused:!0})},moveFocusToBeforeSearchField:function(){this._$searchEscapeFocus.removeClass("hide"),this._$searchEscapeFocus.focus(),this._$searchEscapeFocus.addClass("hide"),this._$searchEscapeFocus.blur()},_blurFieldAndHideResults:function(e){this._hideSearchResults(),e&&e.applyEscapeFocus?this.moveFocusToBeforeSearchField():this._$searchInput.blur()},_cacheInputTextForFocus:function(){this._$searchOverlay.hasClass("overlay-showing")||(this._inputTextOnFocus=this._$searchInput.val())},_applyInputTextForFocus:function(){s.isUndefined(this._inputTextOnFocus)||(this._setSearchInput(this._inputTextOnFocus),this._inputTextOnFocus=void 0)},_handleClearSearchClick:function(e){this._cacheInputTextForFocus(),this._setSearchInput(""),this._handleInputFocusOrClearX({fromContext:"fromClearX"}),this._focusInputIgnoreEvent()},_clearSearchResults:function(e){(e=e||{}).hideOverlay&&this._$searchOverlay.addClass("hide").removeClass("overlay-showing"),this._setPlaceholderAttr({unfocused:!e.showResultsForEmpty}),e.showResultsForEmpty?this._makeResultBoxFromSearchData("",{fromContext:e.fromContext}):(this._$searchResults.addClass("hide"),this._$searchView.removeClass("searching"))},_setPlaceholderAttr:function(e){var s=this.placeholderText||"";if((e=e||{}).clear)s="";else if(e.remove)return void this._$searchInput.removeAttr("placeholder");e.unfocused&&(s=this.unfocusedPlaceholderText),this._$tooltipHolder.addClass("off"),s=this._currentRoutePathInfo.currentData.placeholder||s;var t=this._currentRoutePathInfo.currentData.tooltip;t&&g.shouldShowSearchTooltip(t.type).then(function(e){e&&setTimeout(function(){this._$tooltipHolder.find(".search-input-tooltip").text(t.label),this._$tooltipHolder.removeClass("off"),g.searchTooltipShown(t.type)}.bind(this),3e3)}.bind(this)),this._$searchInput.attr("placeholder",s),this._$searchInput.attr("data-placeholder",s)},_calcPlaceholderText:function(){var e="npw-search-field-placeholder-templates-home";if(this._$searchInput){var s=this._$searchInput.width();s&&s<=300&&(e="npw-search-field-placeholder-templates-short")}if("npw-search-field-placeholder-templates-home"===e){var t=this._totalTemplates.marvel,r=1*Math.floor(t/1e3);this.placeholderText=r?u.formatMessage(e,{appId:"marvel",numThousands:r}):t?u.formatMessage("npw-search-field-placeholder-templates",{appId:"marvel"}):""}else this.placeholderText=u.formatMessage(e,{appId:"marvel"});this.unfocusedPlaceholderText=this.placeholderText},render:function(){if(this._options.template){var e=this._options.templateOptions||{};if(this._options.showFormatFilters){var t=[{id:"all",app:"marvel",label:u.formatMessage("npw-vb-format-marvel",{count:2})}];if(s.each(g.getOrderedApps(),function(e){t.push({id:e.id,app:e.type,label:e.formatLabel})}.bind(this)),this._options.favoritesEnabled){var r=!!this._options.showFavoritesInHeader;r||t.push({sep:!0}),t.push({id:"favorites",label:u.formatMessage("npw-vb-format-capitalized-plural",{appId:"favorite"}),hide:!!r})}s.each(t,function(e){e.id===this._options.defaultFilters.format.id&&(e.selected=!0,this._searchFilters.current.format=e)}.bind(this)),e.formatFilters={format:t,filtersInHeader:this._options.filtersInHeader,filtersInHeaderCss:this._options.filtersInHeaderCss},this._searchFilters.formatFilters={settings:t,hideInResults:this._options.searchPageAndVideoAsRelated}}e.localePathPrefix=u.localePathPrefix,this._extendDebugSettingsToTemplateSettings(e);var i=u.mustacheRender(this._options.template,e);this.$el.html(i.toString())}return this._$searchView=this.$el.find(".search-view").removeClass("hide"),this._$searchInput=this.$el.find(".search-input"),this._$searchInputDisabled=this.$el.find(".search-input-disabled"),this._$searchOverlay=this.$el.find(".search-overlay"),this._$searchUnderlay=this.$el.find(".search-bg-underlay"),this._$searchResults=this.$el.find(".search-results"),this._$searchBar=this.$el.find(".search-bar"),this._$searchClear=this.$el.find(".search-clear"),this._$searchButton=this.$el.find(".search-button"),this._$searchEscapeFocus=this.$el.find(".search-input-escape-focus"),this._$backArrow=this.$el.find(".npw-visual-browse-header-back-arrow"),this._$mrvlLogo=this.$el.find(".mrvl-logo-link"),this._$tooltipHolder=this.$el.find(".search-input-tooltip-holder"),this._bindEvents(),this.dropdown$=this._options.dropdownSelectorStr&&this.$el.find(this._options.dropdownSelectorStr),this._options.asHeader&&(this.headerBackground$=this.$el.find(".vb-search-header-background ")),this.$el.removeClass("hide"),this._calcPlaceholderText(),this._setPlaceholderAttr(),this._initialRenderSearchFieldText&&(this._setSearchInput(this._initialRenderSearchFieldText),this._initialRenderSearchFieldText=void 0),this.dropdown$&&this.dropdown$[0]&&this._createDropdownAfterRender(this.dropdown$),this._options.containerDims&&this._sizeResultsMaxHeightForContainer(),this},_bindEvents:function(){this._eventsBoundEl$&&this._eventsBoundEl$!==this.$el&&(s.each(this._eventsBoundEl$.children(),(function(s){e(s).remove()})),this._eventsBoundEl$=null),this._eventsBoundEl$||(this._eventsBoundEl$=this.$el,this._$searchInput.keyup(this._handleKeyUp),this._$searchInput.keydown(this._handleKeyDown),this._$searchClear.keyup(this._handleKeyUp),this._$searchClear.keydown(this._handleKeyDown),this._$searchInput.focus(function(){this._$tooltipHolder.addClass("off"),this._restoreTextOnClick&&this.reshowForFieldOnly(),this._ignoreNextFocus?this._ignoreNextFocus=!1:(this._cacheInputTextForFocus(),this._handleInputFocusOrClearX({fromContext:"fromFocus"}))}.bind(this)),this._$searchOverlay.click(function(){this._$searchResults.is(":focus")||(this._applyInputTextForFocus(),this._clearSearchResults({hideOverlay:!0}),this.hideTextForFieldIfNeeded())}.bind(this)),this._options.handleSearchUnderlayClicked&&this._$searchUnderlay.click(function(){this._options.handleSearchUnderlayClicked()}.bind(this)),this._$searchResults.on("click","li",this._handleSearchResultClick),this._$searchResults.on("click",".search-box-filters-clear-all",this._handleSearchResultClickClear),this._$searchResults.on("click",".search-result-group-line-tag",this._handleTagClickInSearchGroup),this._$searchResults.on("keydown",".search-result-group-line-tag, .search-box-filters-clear-all",this._handleKeydownInTagSearchGroup),this._$searchResults.on("keyup",this._handleKeyupInResults),this._$searchClear.on("click",this._handleClearSearchClick.bind(this)),this._$searchButton.on("click",this._handleSearchBtnClick.bind(this)),this._$backArrow.on("click",this._handleBrowseHeaderBackArrow.bind(this)),this._$mrvlLogo.length&&this._$mrvlLogo.on("click",this._handleBrowseHeaderBackArrow.bind(this)),this._options.showFormatFilters&&(this._searchFilters.formatFilters.holder$=this.$el.find(".vb-search-header-filters-background"),this._searchFilters.formatFilters.divs$=this.$el.find(".vb-search-header-formats-format"),this._searchFilters.formatFilters.divs$.on("click",this._handleFormatFilterClick),this._options.autoSearch&&this._options.autoSearch.needsToBeTriggered&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.addClass("hide-formats")),this._options.showFavoritesInHeader&&(this._$favoritesBtn=this.$el.find(".npw-visual-browser-header-favorites"),this._$favoritesBtn.on("click",this._handleFavoritesBtnClick.bind(this)))),window.marvel.events.on("sp-route-change-for-search",function(e){this._setSearchForCurrentRoutePath(e)}.bind(this)),window.marvel.events.on("add-search-history",function(e){this._handleAddSearchHistory(e)}.bind(this))},_handleAddSearchHistory:function(e){this.SearchRequestsController.addSearchHistoryForResults(e)},_currentRoutePathInfo:{typesData:{}},_getTrimmedInputText:function(){return this._$searchInput?this._$searchInput.val().trim():""},_setupExtraQueryValues:function(e){var t=window.location.pathname,r={};if("template"!==e.type&&t.includes("/sp/"+e.type+"-search")){var i=a.parse(window.location.href,!0);i.query&&(delete i.query.q,s.isEmpty(i.query)||(r=i.query))}"learn"===e.type&&(r.trigger="search"),e.currentData.extraQueryValues=r},_setSearchForCurrentRoutePath:function(e){e=e||{};var t,r=window.location.pathname,i="template",a=e&&e.searchStr||"";if(r.includes("/sp/project-search")||r.includes("/sp/shared")||r.includes("/sp/recents")||r.includes("/sp/projects")||r.includes("/sp/folders")?i="project":r.includes("/sp/learn")&&(i="learn"),this._currentRoutePathInfo.type===i)return e.initializing?this._initialRenderSearchFieldText=a:this._setSearchInput(a),void this._setupExtraQueryValues(this._currentRoutePathInfo);if(this._currentRoutePathInfo.currentData&&(this._currentRoutePathInfo.currentData.restoreText=this._restoreTextOnClick&&s.cloneDeep(this._restoreTextOnClick),!this._currentRoutePathInfo.currentData.restoreText)){var l=this._getTrimmedInputText();l&&(this._currentRoutePathInfo.currentData.restoreText={text:l})}(t=this._currentRoutePathInfo.typesData[i])||(t={type:i},"template"!==i&&(t.placeholder=u.getString(i+"-search-searchbar-placeholder"),t.tooltip={type:i,label:u.getString("npw-search-input-tooltip-"+i)},t.queryPath=i+"-search"),this._currentRoutePathInfo.typesData[i]=t),this._restoreTextOnClick=t.restoreText&&s.cloneDeep(t.restoreText),this._options.enableSearchHistory&&(this._searchHistory=this.SearchRequestsController.getMySearchHistory(this,i)),this._currentRoutePathInfo.type=i,this._currentRoutePathInfo.currentData=t,this._setupExtraQueryValues(this._currentRoutePathInfo),e.initializing?this._initialRenderSearchFieldText=a:(this._setPlaceholderAttr(),this._setSearchInput(a))},_createMenuItemClick:function(){},_onCreateProjectMenuOpen:function(){},_onCreateProjectMenuClose:function(){},_navigateToBrandingFromCreateProjectMenu:function(){this._options.SearchController.navigateToBrandingFromCreateProjectMenu(this)},_createDropdownAfterRender:function(e){if(this._options.searchReact){var s=this._options.searchReact;if(this.wrappedCreateMenuModel=this.wrappedCreateMenuModel||new t.Model,this.wrappedCreateMenuModel.set({userProps:this._options.userProps,context:this._options.context+":createProjectMenu",iconOnlyTrigger:this._options.userProps.createMenuIconOnlyTrigger,onButtonClick:this._createMenuItemClick,onOpen:this._onCreateProjectMenuOpen,onClose:this._onCreateProjectMenuClose,hideViewAll:!0,el:e,dataAuto:"search-create-project-menu",isInSearch:!0,handleNavigateToBranding:this._navigateToBrandingFromCreateProjectMenu.bind(this),handleHomeCreateFromScratch:function(e,s){e&&this._options.SearchController.handleHomeCreateFromScratchInSearch(this,e,s)}.bind(this)}),!this.wrappedReactCreateProjectsMenuCls){var r=s.reactWrapper.wrapComponentSpectrum(s.CreateProjectMenu,this.wrappedCreateMenuModel);this.wrappedReactCreateProjectsMenuCls=r.extend({cachename:"reactsearchcreatefromscratch",remove:function(){r.prototype.remove.call(this)}})}this.wrappedReactCreateFromScratch?this.wrappedReactCreateFromScratch.setElement(e):(this.wrappedReactCreateFromScratch=this._renderReactView(this.wrappedReactCreateProjectsMenuCls,e,this.wrappedCreateMenuModel),this.wrappedReactCreateFromScratch.listenToModelChange()),this.wrappedReactCreateFromScratch.render()}},viewCache:{},_renderReactView:function(e,s,r){var i,a=!1,l=!0;try{e.prototype.cachename&&this.viewCache[e.prototype.cachename]?i=this.viewCache[e.prototype.cachename]:a=!0,a&&((i=Object.create(e.prototype)).el=s,e.apply(i,Array.prototype.slice.call(arguments,1)),e.prototype.cachename&&(this.viewCache[e.prototype.cachename]=i)),r&&l&&(i.model=r),l&&i.render(t.history.fragment,{})}catch(n){window.marvel.logger.warn("render exception ["+n+"], View = "+e.prototype.cachename,n)}return i},hidingVisualBrowse:function(){this._options.asHeader&&this.$el.addClass("hide")},_getSearchOptionsFromUseCase:function(e){var t,r=e.searchTags||[],i=e.searchStr||e.matchedSearchStr||"",a={assetId:e.assetId,assetIdApp:e.app};return i.length&&!r.length&&(r=i.split(" ")),r.length||(a.findAllType="searchAll"),a.findAllType?t="":-1!==r[0].indexOf("-")?(a.tags=r,a.keywords=s.map(r,(function(e,s){return e.split("-")[1]})),t=a.keywords.join(" ")):(a.keywords=r,t=r.join(" ")),{options:a,fieldSearchStr:t}},getSearchQueryFromUseCase:function(e){var s=this._getSearchOptionsFromUseCase(e),t={assetId:e.alias||e.id};return s.options.findAllType?t.all=!0:t.keys=s.options.keywords.join(" "),t},doSearchFromUseCaseInfo:function(e,t){var r=this._getSearchOptionsFromUseCase(e.useCase);this._setSearchInput(r.fieldSearchStr),r.options.findAllType||this._getSearchResults(null,r.fieldSearchStr,{doNotShow:!0}),this._options.searchPageAndVideoAsRelated?"page"!==e.useCase.app&&"video"!==e.useCase.app||(r.options.assetId=null):this._setFormatFilter(e.useCase.app),r.options.analyticsData=s.assign({useCase:e.useCase.id,sparkFormat:e.useCase.app,searchTerm:r.fieldSearchStr,trigger:"seeMore"},t||{}),this._getTemplateResults(r.options)},_getTagNamesAnalyticValForAsset:function(e){return this._options.SearchController.getTagNamesAnalyticValForAsset(e)},_sendTemplatePressedAnalytics:function(e){this._options.SearchController.sendTemplatePressedAnalyticsFromSearchResult(this,e)},_finishSearchAfterError:function(e){this._setSearchingForResults(!1,{showImmediately:!0}),this._numResultsLastSearch=0,this._makeResultBoxFromNoSearchResults(e.searchString,e.tagFilters),e.resultsDefer&&e.resultsDefer.resolve()},_getTemplateResults:function(e){var s=e.app||this._searchFilters.current.format.app;s&&this._options.searchPageAndVideoAsRelated&&(s=null),e.app=s,e.isUserSearch=!0,this.SearchRequestsController.getTemplateResults(e).then(function(s){var t=this._options.asHeader;s.err?this._finishSearchAfterError(e):(s.assets.length||!this._showingCpResults?this.renderCpSearchResults(s,{jumpToDetailAssetId:e.jumpToDetailAssetId,backInfo:e.backInfo}):t=!0,t&&this._setSearchingForResults(!1,{showImmediately:!0}),s.assets.length?(this._numResultsLastSearch=s.assets.length,this._blurFieldAndHideResults({applyEscapeFocus:!0})):(this._numResultsLastSearch=0,this._makeResultBoxFromNoSearchResults(e.searchString,e.tagFilters)),e.resultsDefer&&e.resultsDefer.resolve())}.bind(this)).done()},createFromSearchResultsThumb:function(e,s){var t=this.SearchRequestsController.getCurrentSearch().searchStr||"";s.analytics.searchTerm=t||"searchTerm:none",this._sendTemplatePressedAnalytics({createOptions:s,asset:e}),s.analyticsPage=s.analyticsPage||this._getAnalyticsPage(),s.analyticsFullTagNames=this._getTagNamesAnalyticValForAsset(e),s.searchStr=t,!this._options.defaultCreateAction&&this._options.handleCreateFromSearchResultsThumbClick?this._options.handleCreateFromSearchResultsThumbClick(e,s):this._handleDefaultCreateFromSearchResults(e,s)},_handleDefaultCreateFromSearchResults:function(e,s){this._showDefaultCreateConfirm(e,s)},_showDefaultCreateConfirm:function(e,s,t){var r=[],i=r,a=this._getPreviewLocation(s.previewLocation);r.push({id:"create",text:"search-results-confirm-cta-create",primary:!0,textIfAssetRequiresUpgrade:"search-results-confirm-cta-create-upgrade"}),this.showDetailConfirmForCurrentClickedThumb({asset:e,premiumTemplateBadge:s.premiumTemplateBadge,ctasForPremium:i,gridlessOptions:t,previewNavType:"side",title:void 0,subtitle:void 0,ctas:r,stringsAreIds:!0,cssClass:"vertical-default",isVertical:!0,previewLocation:a,analytics:{templatePreviewed:{data:{}},templatePreviewClosed:{callback:function(e,s){var t;t=s.cancelled?"cancel":s.asset.premium&&s.showUpgradeForPremium?"createNeedUpgrade":"create",e.contextualData5="action:"+t}}}}).then(function(e){e.closeDefer.resolve(),e.cta&&(s.detailRenditionInfo=e.detailRenditionInfo,t&&(s.searchQueryForReopen=t.searchInfoForReopen.query,s.searchQueryForReopen.assetId=e.asset.id),this.defaultCreateFromSearchResultsThumbClick(e.asset,s))}.bind(this))},_triggeringRemix:function(e){this._options.SearchController.vbTriggeringRemixFromSearchThumb(e,this)},getTotalTemplates:function(){return this._totalTemplates.marvel},defaultCreateFromSearchResultsThumbClick:function(e,s){if(e.isPremiumTemplate&&this._options.showUpgradeForPremium){var t=this._totalTemplates.marvel;this._options.SearchController.showPremiumUpgradeModalForPremiumTemplate(e,s,t)}else this._options.SearchController.remixFromSearchThumb(e,this,s),"header"===this._options.context&&this._hideCpSearchResults()},getCurrentSearchAnalytics:function(){return this.SearchRequestsController.getCurrentSearchAnalytics()},_ensureGridView:function(){this.searchResultsGridView||(this.searchResultsGridView=new m({el:this._options.resultsHolder$||this.$el.find(".search-results-grid-view-holder"),parentRerendersOnResize:this._options.parentRerendersOnResize,SearchController:this._options.SearchController}))},showCreateConfirmWithoutGrid:function(e){var s=e.gridOptions;this._ensureGridView();var t="npw"===this._options.context?"search":this._options.context,r={analytics:e.analytics||{},previewLocation:e.previewLocation};s||(s=this._getGridOptions()),r.analytics.context=r.analytics.context||t,this._showDefaultCreateConfirm(e.asset,r,{gridOptions:s,searchInfoForReopen:e.searchInfoForReopen,assets:e.resultAssets,searchAnalytics:e.searchAnalytics})},_getPreviewLocation:function(e){var s=e;return s||("header"===(s=this._options.context)||"npw"===s?s="search":"editor:post"===s&&(s="editorPost")),s},showDetailConfirmForCurrentClickedThumb:function(e){"npw"===this._options.context||this._options.context;return e.analytics||(e.analytics={}),e.previewLocation=this._getPreviewLocation(e.previewLocation),e.premiumTemplateBadge=this._options.premiumTemplateBadge,!this._options.userProps.isPremiumUser&&this._options.userProps.allowPremiumTemplates?e.premiumRequiresUpgrade=!0:e.ctasForPremium=null,this.searchResultsGridView.showDetailConfirmForCurrentClickedThumb(e)},getDataForReopenRedraw:function(e){var s={isResize:!!(e=e||{}).isResize,lastRenderedResults:this._lastRenderedResults,showingCpResults:this._showingCpResults,dataToRestore:this._getDataForRestoringAfterRedraw()};return s.showingCpResults&&(s.cpResultsRedrawData=this.searchResultsGridView.getDataForRedraw()),s},loadMoreFromResultsClicked:function(e){var s={searchTerm:this.SearchRequestsController.getCurrentSearch().searchStr,type:e.isClick?"click":"scroll",loadAssets:e.pagination.lastShowing,numAssets:e.pagination.total,contextualData16:"tagSelected:"+(e.selectedTags||"NULL")},t=this.SearchRequestsController.getCurrentSearch();this._trackEvent("NPWVisualBrowseSearchLoadMoreInTemplateResults",s),t.targetTotal+=40,this.SearchRequestsController.repeatSearch({loadNext:!0,targetTotal:t.targetTotal,noProgressOverlay:!0,splitQuery:t.splitQuery,totalPulled:t.totalPulled,extraResults:t.extraResults,aggregations:t.aggregations})},assetDetailShownInResults:function(e){this._sendTemplatePressedAnalytics({detailOptions:e})},_searchFilters:{current:{format:{}}},_setFormatFilter:function(t,r){if("object"==typeof t&&(t=t.typeName),this._searchFilters.formatFilters&&this._searchFilters.formatFilters.divs$){if(r)t=r.data("app");else{var i=s.find(this._searchFilters.formatFilters.divs$,(function(s){return e(s).data("app")===t}));r=e(i)}this._searchFilters.formatFilters.divs$.removeClass("selected"),r.addClass("selected")}return this._searchFilters.current.format=this._getFilterFormatFromApp(t),this._calcPlaceholderText(),this._setPlaceholderAttr(),r},_getFilterFormatFromApp:function(e){return s.find(this._searchFilters.formatFilters.settings,function(s){return s.app==e}.bind(this))},_handleFavoritesBtnClick:function(e){this._handleFormatFilterClick(e)},_handleFormatFilterClick:function(t){var r=e(t.currentTarget),i=this._searchFilters.current.format.app,a={format:{app:r.data("app"),id:r.data("id")}};this._setFormatFilter(a.format.app,r),"favorites"===a.format.id&&(this._searchFilters.current.format.app=i),this._options.handleFilterSelectedInSearch({filter:a,showingCpResults:this._showingCpResults,currentSearch:s.cloneDeep(this.SearchRequestsController.getCurrentSearch())}).startSearchTimer&&this._filterClickWantsRepeat()},triggerAutoSearch:function(e){var t=function(e){var s=e.searchOptions&&e.searchOptions.fallbackSearch&&e.searchOptions.fallbackSearch.triggered,t=s?s.fieldSearchStr:e.fieldSearchStr,r=s?s.isFindAll:e.searchOptions.isFindAll;this._setSearchInput(t),r||this._getSearchResults(null,t,{doNotShow:!0}),e.appInfo&&(this._options.searchPageAndVideoAsRelated||this._setFormatFilter(e.searchQuery.app))}.bind(this);this.SearchRequestsController.triggerAutoSearch(e,t).then(function(t){var r="";e.fallbackSearch&&e.fallbackSearch.triggered&&(r=e.fallbackSearch.triggered.fieldSearchStr,this._setSearchInput(e.fallbackSearch.triggered.fieldSearchStr)),t.err?(s.assign({},e,{searchString:r}),this._finishSearchAfterError(e)):this.renderCpSearchResults(t,{hideProgressWhenRendered:!0,jumpToDetailAssetId:e.jumpToDetailAssetId,backInfo:e.backInfo})}.bind(this))},restoreSearchAfterReRender:function(e){e=e||{},s.assign(this,e.dataToRestore||{});var t,r=this.SearchRequestsController.restoreSearchAfterReRender(e);r&&(t=s.isUndefined(e.searchFieldStr)?r.userStr||r.searchStr:e.searchFieldStr,this._setSearchInput(t),e.showingCpResults&&(e.lastRenderedResults.options.hideProgressWhenRendered=!0,this.renderCpSearchResults(null,null,e.lastRenderedResults)))},_tagClickWantsRepeat:function(e){this._showingCpResults&&(this.searchResultsGridView.searchTriggered(),this._getTemplateResults(e))},_filterClickWantsRepeat:function(){this._showingCpResults&&(window.marvel.logger.debug("calling _filterClickWantsRepeat while showing results"),this.searchResultsGridView.searchTriggered(),this.SearchRequestsController.repeatSearch({targetTotal:80,forceApp:{app:this._searchFilters.current.format.app}}))},_handleKeydownInTagSearchGroup:function(s){if(-1!==S.concat([i.DOM_VK_RETURN,i.DOM_VK_TAB]).indexOf(s.keyCode))if(s.stopImmediatePropagation(),s.preventDefault(),s.keyCode===i.DOM_VK_RETURN)this._arrowPresses.lastTagKeydownEventTime=s.timeStamp,e(s.currentTarget).hasClass("search-box-filters-clear-all")?this._handleSearchResultClickClear(s):this._handleTagClickInSearchGroup(s,{focusTagIfMore:!0});else if(s.keyCode===i.DOM_VK_UP)this._focusInputIgnoreEvent(),this._incSelectedLine(-1);else if(s.keyCode===i.DOM_VK_DOWN)this._focusInputIgnoreEvent(),this._incSelectedLine(1);else{var t=e(document.activeElement),r=!1;s.keyCode===i.DOM_VK_RIGHT||s.keyCode===i.DOM_VK_TAB&&!s.shiftKey?t.hasClass("search-box-filters-clear-all")||t.hasClass("show-more-tags-btn")?this._arrowPresses.selectedTags$[0].focus():t[0].nextElementSibling&&e(t[0].nextElementSibling).is(":visible")?t[0].nextElementSibling.focus():this._arrowPresses.showMoreTags$?this._arrowPresses.showMoreTags$.focus():this._arrowPresses.clearTags$&&this._arrowPresses.clearTags$.hasClass("enabled")?this._arrowPresses.clearTags$.focus():this._arrowPresses.selectedTags$[0].focus():t.hasClass("search-box-filters-clear-all")?this._arrowPresses.showMoreTags$?this._arrowPresses.showMoreTags$.focus():r=!0:t.hasClass("show-more-tags-btn")?r=!0:t[0].previousElementSibling?t[0].previousElementSibling.focus():t.hasClass("search-results-selected-tag")&&(this._arrowPresses.clearTags$.hasClass("enabled")?this._arrowPresses.clearTags$.focus():this._arrowPresses.showMoreTags$?this._arrowPresses.showMoreTags$.focus():r=!0),r&&this._arrowPresses.selectedTags$[this._arrowPresses.selectedTags$.length-1].focus()}},_handleTagClickInSearchGroup:function(s,t){var r=e(s.currentTarget),i=r.hasClass("show-more-tags-btn");if(s.stopImmediatePropagation(),s.preventDefault(),i){var a;if(t&&t.focusTagIfMore){var l=this._arrowPresses.selectedTags$[this._arrowPresses.selectedTags$.length-1];a=l.nextElementSibling||l}r.parents(".search-result-group-line").addClass("show-more-tags-tags"),this._arrowPresses.selectedTags$=this._$searchResults.find(".search-results-selected-tag"),this._arrowPresses.showMoreTags$=null,a?a.focus():this._focusInputIgnoreEvent()}else if(r.hasClass("search-results-selected-tag"))this.searchResultSelectedTagClicked(r);else{var n,o=this._getSelectedLine(),c=this._options.keysForTags,d=r.data("id"),u=h.getAppByType(this._searchFilters.current.format.app),g=o.line$&&o.line$.data(c?"keywords":"tags")||"",m=g&&g.split(":")||[],p=!0;if(c){var f=m.indexOf(d);-1===f?m.push(d):(m.splice(f,1),p=!1),n=m.join(" ")}else{var v=r.data("groupId")+"-"+d,w=m.indexOf(v);-1===w?m.push(v):(m.splice(w,1),p=!1),n=this.SearchRequestsController.keysStrFromTagsArray(m)}var b={searchString:n,addHistory:!0,app:u};c?b.keys=m:b.tags=m,this._getSearchResults(null,b.searchString,{doNotShow:!0}),this._setSearchInput(b.searchString),this._handleSearchResultClick(null,r,{tagId:d,fromTag:!0,selType:p?"tagAddInSearchBox":"tagRemoveInSearchBox"})}},tagClickedInResults:function(e,t){var r=this.SearchRequestsController.getCurrentSearch(),i=r&&r.searchStr||"";t=t||{};var a=this._$searchInput.val(),l=!1,n=!0,o=!s.isUndefined(t.changeSelectionValue),h=s.isUndefined(t.changeSelectionValue)?!e.selected:t.changeSelectionValue;if(this.searchResultsGridView&&this.searchResultsGridView._showingDetail&&(this.searchResultsGridView.tagClickedSinceChangingToGridDetail||(this.searchResultsGridView.tagClickedSinceChangingToGridDetail=!0)),h)e.selected=!0,this._currentSelectedTags.push(e);else{var c=-1;s.find(this._currentSelectedTags,(function(s,t){if(s.id===e.id)return c=t,!0})),e.selected=!1,-1!==c?this._currentSelectedTags.splice(c,1):n=!1}this._trackEvent("NPWVisualBrowseSearchClickedTagInTemplateResults",{contextualData17:"tagId:"+(e.srcKey||e.id),contextualData16:"tagSelected:"+t.selectedTagKeys,trigger:e.selected?"tagClickAdd":"tagClickRemove",contextualData2:"searchStr:"+i}),(n||o)&&(a=r.searchStr,l=!0,this._tagClickWantsRepeat({userStr:a,searchStr:a,searchString:a,tagFilters:this._currentSelectedTags,analyticsData:{trigger:e.selected?"tagClickAdd":"tagClickRemove",contextualData17:"tagId:"+(e.srcKey||e.id)}})),l&&this._setSearchInput(a)},setFavoriteForAsset:function(e,s){return this._options.VisualBrowseUseCasesController.applyFavoriteStateToSearchResultAsset(e,s,this.SearchRequestsController.getCurrentSearch()).then(function(e){return e}.bind(this))},redisplayCachedSearchResults:function(e){this._setCurrentSelectedTagsFromResults(e.results),this._setSearchInput(this.SearchRequestsController.getCurrentSearch().searchStr),this._setFormatFilter(e.currentFilter.format.app),this.renderCpSearchResults(e.results,e.originalOptions)},_getDataForRestoringAfterRedraw:function(){return this.SearchRequestsController.getDataForRestoringAfterRedraw()},setBackText:function(e,s){var t,r,i;if(s=s||{},e)t=this._options.SearchController.getBackArrowText(e.backType),r=e.backPath,i=e.backType;else if("npw"!==this._options.context)i="home",t=this._options.SearchController.getBackArrowText(i);else{var a=!s.hidingResults;if(e=this._options.SearchController.getBackInfoFromNPWCurrentPath(null,a))i=e.backId,t=e.text,r=e.backPath;else{var l=this.SearchRequestsController.getTriggeredAutoSearchOptions();i=l&&l.backType?l.backType:this._showingCpResults?"visualBrowse":"projects",t=this._options.SearchController.getBackArrowText(i)}}this._$backArrow.text(t),this._$backArrow.attr("title",t),this._$backArrow.addClass("has-text"),this._$backArrow.data("back-id",i),this._$backArrow.data("back-path",r||"")},_setCurrentSelectedTagsFromResults:function(e){this._currentSelectedTags=e.tagFilters||[],e.tagsData.currentSelectedTags=this._currentSelectedTags},handleInputFocusFromGrid:function(){this._$searchInput.focus()},_getGridOptions:function(e,t){var r=s.assign({},{analytics:{context:this._options.context},gridDims:this._gridDims,showLoadMoreButton:this._options.showLoadMoreButton,tagClickHandler:this.tagClickedInResults.bind(this),loadMoreClickHandler:this.loadMoreFromResultsClicked.bind(this),assetDetailShownCallback:this.assetDetailShownInResults.bind(this),createFromThumbClickHandler:this.createFromSearchResultsThumb.bind(this),favoritesEnabled:this._options.favoritesEnabled,setFavorite:this.setFavoriteForAsset.bind(this),detailViewEnabled:this._options.detailViewEnabled||e&&e.enableDetailView,allowPremiumTemplates:this._options.allowPremiumTemplates,showUpgradeForPremium:this._options.showUpgradeForPremium,allowGiphyTemplates:this._options.allowGiphyTemplates,animationEnabled:this._options.animationEnabled,autoPlayDetailAnimation:this._options.autoPlayDetailAnimation,premiumTemplateBadge:this._options.premiumTemplateBadge,preloadAllResultMp4s:this._options.preloadAllResultMp4s,backArrowTextForDetail:this._options.detailViewEnabled&&this._options.SearchController.getBackArrowText("searchResults"),hideAssetUntilLoaded:this._options.hideAssetUntilLoaded,isReRender:t,maxResultsBeforeAutoLoadFromScroll:80,assetLoadFailed:this.SearchRequestsController.assetLoadFailed,uiStrings:this._options.uiStrings,containerDims:this._options.containerDims,preDetailViewCallback:this._options.preDetailViewCallback&&this.preDetailViewCallback.bind(this),maxNumSelectedTags:this._options.maxNumSelectedTags||6,maxNumTagsInResults:this._options.maxNumTagsInGridResults||8,getTagNamesAnalyticValForAsset:this._getTagNamesAnalyticValForAsset.bind(this),handleInputFocusFromGrid:this.handleInputFocusFromGrid},e||{},this._options.resultsOptions||{});return r.debugSettings=this._debugSettings,r},renderCpSearchResults:function(e,t,r){var i=!1;r?(i=!0,e=r.results,t=r.options,this._lastRenderedResults=r):this._lastRenderedResults={results:s.cloneDeep(e),options:s.cloneDeep(t)},this._setCurrentSelectedTagsFromResults(e),this._setShowingResults(),this._options.showFormatFilters&&this._searchFilters.formatFilters.hideInResults&&this._searchFilters.formatFilters.holder$.addClass("hide-formats"),this.setBackText(t.backInfo),t=this._getGridOptions(t,i),this.searchResultsGridView?this._reapplyGridViewInitOptionsOnNextResults&&(this._reapplyGridViewInitOptionsOnNextResults=!1,this._reapplyGridViewInitOptions()):this._ensureGridView(),this.searchResultsGridView.renderResults(e,t),t.hideProgressWhenRendered&&this._setSearchingForResults(!1,{showImmediately:i}),this.moveFocusToBeforeSearchField()},_reapplyGridViewInitOptions:function(){this.searchResultsGridView.applyNewInitOptions({el:this._options.resultsHolder$||this.$el.find(".search-results-grid-view-holder"),parentRerendersOnResize:this._options.parentRerendersOnResize})},searchViewShown:function(e){(e=e||{}).gridDims&&s.assign(this._gridDims,e.gridDims),e.containerDims&&(this._options.containerDims=s.assign(this._options.containerDims||{},e.containerDims)),this._showingCpResults&&this.searchResultsGridView.searchViewShown(e),this._sizeResultsMaxHeightForContainer(),this._calcPlaceholderText(),this._setPlaceholderAttr()},containerResized:function(e){e.isWindowResize?this._debouncedContainerResized(e):this._containerResized(e)},_maxResultsInnerHeightStr:"",_sizeResultsMaxHeightForContainer:function(){var e=this._$searchInput.offset().top-this.$el.offset().top+this._$searchInput.height(),s=this._options.containerDims.height-(e+48);this._maxResultsInnerHeightStr=s-24+"px",this._$searchResults.css("max-height",s)},_containerResized:function(e){this._options.containerDims=s.assign(this._options.containerDims||{},e.containerDims),e.gridDims&&s.assign(this._gridDims,e.gridDims),s.isUndefined(e.showUnderlay)||(e.showUnderlay?this._$searchUnderlay.addClass("showing"):this._$searchUnderlay.removeClass("showing")),this._showingCpResults&&this.searchResultsGridView.containerResized({containerDims:e.containerDims,gridDims:this._gridDims}),this._sizeResultsMaxHeightForContainer(),this._calcPlaceholderText(),this._setPlaceholderAttr()},remove:function(){return this._options.doNotEmpty||(this.$el.empty(),this.$el.addClass("hide")),this.searchResultsGridView&&(this.searchResultsGridView.remove(),this.searchResultsGridView=null),this._searchSuggest&&this._searchSuggest.remove(),this},preDetailViewCallback:function(e){var t=this._options.preDetailViewCallback(e);return s.isEqual(t.containerDims,this._options.containerDims)?{resized:!1}:(this._options.containerDims=s.assign(this._options.containerDims||{},t.containerDims),t.gridDims&&s.assign(this._gridDims,t.gridDims),{resized:!0,containerDims:this._options.containerDims,gridDims:this._gridDims})},getLocStringForEditor:function(e){return u.getString(e)}})}.apply(s,r))||(e.exports=i)},2504:function(e,s,t){var r=t(3422);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};t(189)(r,i);r.locals&&(e.exports=r.locals)},2505:function(e,s,t){var r,i;r=[t(6),t(2),t(0),t(5),t(15),t(22),t(20),t(8),t(1),t(62),t(76),t(380),t(1752)],void 0===(i=function(e,s,t,r,i,a,l,n,o,h,c,d,u){"use strict";var g,m=o.cpTemplateSearchRemixFeedTag,p=o.cpTemplateSearchRemixPaidTag,f=o.cpTemplateSearchMappedTagRemixPaid,v=f.split("-")[1],w=o.cpTemplateSearchGiphyTag,b=w.split("-")[1],_={thumbClick:"useCaseSearch",seeMore:"useCaseSearch"},x=r.Model.extend({initialize:function(e){g=(e=e||{}).logger||window.marvel.logger,this.setCallbacks(e.callbacks),this._options=e||{},this._initializeLists(),this.dataId=this._options.dataId,window._searchViewTemplateSearchBadAssets||(window._searchViewTemplateSearchBadAssets={count:0,ids:{}}),this._badAssets=window._searchViewTemplateSearchBadAssets,this._boundFunctions||(this._boundFunctions=!0,this.assetLoadFailed=this.assetLoadFailed.bind(this)),this._sparkContentSearchAllFields=!l.hasFeature("npw-vb-search-spark-content-search-tags-only"),this._processOneSparkContentAsset=this._processOneSparkContentAsset.bind(this),this._options.enableSearchHistory&&this._initSearchHistory("template"),this._initSizeFilterMaps(this._options.sizeFilterInfo)},getSearchLocale:function(){return this._options.searchLocale},updateOptions:function(e){},_normalizeAspectRatio:function(e){return Math.floor(1e6*e)},_aspectRatioSearchString:function(e,s){return this._aspectRatioSearchStringMinMax(e,e,s)},_aspectRatioSearchStringMinMax:function(e,s,t){return"rendition.aspectRatio:["+(e-(t=t||0))+" TO "+(s+t)+"]"},_initSizeFilterMaps:function(e){if(e&&!e.unsupported){var t=e.sizeFilterMapsJSON.maps,r={},i=this._normalizeAspectRatio(e.sizeFilterMapsJSON.sizeRangeForEquality),a=i;this._sizeFilterMaps={sizesByLowerCaseId:r},this._sizeFilterMaps.sizes=s.reduce(e.pickerInfo.sizes,function(e,s){var i=t[s.id],l={id:s.id,aspectRatio:this._normalizeAspectRatio(s.aspectRatio),_baseWidth:s.width,_baseHeight:s.height};return r[l.id.toLowerCase()]=l,i&&(l.filters=i.filters,l.str=i.str,l.sizeQueryString=this._aspectRatioSearchString(l.aspectRatio,a)),e[l.id]=l,e}.bind(this),{});var l=[],n=s.reduce(this._sizeFilterMaps.sizes,(function(e,s){var t=s.aspectRatio+"",r=e[t];return r||(r={aspectRatio:s.aspectRatio,sizes:[],sizeQueryString:s.sizeQueryString},e[t]=r,l.push(r)),r.sizes.push(s),s.aspectGroup=r,e}),{});this._sizeFilterMaps.aspectGroups=n,l.sort((function(e,s){return e.aspectRatio-s.aspectRatio})),s.each(l,(function(e,s){e.index=s}));var o=l.length;s.each(l,(function(e,s){var t,r,a=[];if(s)for(r=s-1;r>=0&&(t=l[r],e.aspectRatio-t.aspectRatio<=i);r--)a.push(t);if(s<o-2)for(r=s+1;r<o&&(t=l[r]).aspectRatio-e.aspectRatio<=i;r++)a.push(t);e.related=a})),s.each(l,function(e){if(e.related&&e.related.length){var t={min:e.aspectRatio,max:e.aspectRatio};s.reduce(e.related,(function(e,s){return s.aspectRatio<e.min?e.min=s.aspectRatio:s.aspectRatio>e.max&&(e.max=s.aspectRatio),e}),t),e.relatedSizeQueryString=this._aspectRatioSearchStringMinMax(t.min,t.max,a)}else e.relatedSizeQueryString=e.sizeQueryString}.bind(this))}else this._sizeFilterMaps=null},_initializeLists:function(){this._fieldToTagMapsNoLoc=s.clone(this._fieldToTagMaps),delete this._fieldToTagMapsNoLoc.locales,this._nonLangTagFieldIds=s.keys(this._fieldToTagMapsNoLoc),this._nonLangTagToFieldMap=s.reduce(this._fieldToTagMapsNoLoc,(function(e,s,t){return e[s]=t,e}),{});var e=s.keys(this._fieldToTagMaps);this._allFieldsToSelect=e.concat(this._nonTagFieldsToSelect),this._initCustomFlags()},setCallbacks:function(e){this.callbacks=s.assign(this.callbacks||{},e||{}),s.each(this.requiredCallbackNames,(function(s){e[s]||(e[s]=function(){g.debugger("send "+s+" in in setCallbacks")})}))},assetLoadFailed:function(e){this._badAssets.ids[e.id]||(this._badAssets.count++,this._badAssets.ids[e.id]=!0)},_combineResultAssets:function(e){var t=s.reduce(e,(function(e,s){return e[s.id]=s,s.matched=!1,e}),{}),r=this._assets.assetsArray;return s.each(r,(function(e,s){var i=t[e.id];i&&(i.matched=!0,r[s]=i)})),s.each(e,function(e){e.matched||r.push(e)}.bind(this)),r},_setupOneAssetRenditionFromResult:function(e,s){e.width=e.width||e.w,e.height=e.height||e.h},_assets:{assetsById:{},assetsArray:[]},_allowedTagPrefixes:["explore","spcase","spterm","spstyle","spcolor","spsize","spingred","spinfluencer","spcollect","sploc","spmap","cpat"],_addAllTagsToAsset:function(e){e.allTags||(e.tags?(e.allTags=s.map(e.tags,(function(e){var s=e.split("-"),t=s.slice(1);return{label:t.join(" "),keyword:t.join("-"),prefix:s[0],id:e}})),e.allTags.sort((function(e,s){return e.label>=s.label?1:-1}))):e.allTags=[])},_assignTagsDataToResults:function(e,t,r){var i=e.tagsData,a=t.options.tagFilters;a||(a=[]),(i=this._tagsDataFromSparkContentResults(e,a,t.options)).tagsInOrder=i.tagFilters.concat(i.tagsInOrder);var l=[],n=s.reduce(e.assets,function(t,r){var i=s.isUndefined(r.isPremiumTemplate)?-1!==r.tags.indexOf(f):r.isPremiumTemplate,a=-1!==r.tags.indexOf(w),n=r.animated;if(i){if(!this._options.allowPremiumTemplates)return g.debug("asset in result with premium when not allowed:"+r.id,r),t;r.isPremiumTemplate=!0}if(a){if(!this._options.allowGiphyTemplates)return g.debug("asset in result with giphy when not allowed:"+r.id,r),t;r.isGiphyTemplate=!0}if(r.sploc?-1===r.sploc.indexOf("sploc-")&&(r.sploc="sploc-"+r.sploc):r.sploc="sploc-en",this._setupOneAssetRenditionFromResult(r,e),"post"===r.app&&s.isUndefined(r.remixable)&&(r.remixable=!0),!r.templatedImgHref)return g.debug("asset with no rendition:"+r.id,r),t;if(n&&this._options.animationEnabled){var o=r.templatedImgHref.split("rendition")[0],h=r.templatedImgHref.split("/version/")[1].split("/")[0];r.animationHref=o+"dcx/"+r.id+"/content/videoRendition.mp4/version/"+h}return this._addAllTagsToAsset(r),r.tagsForData=r.tags.join(":"),r._orderedIndex=l.length,l.push(r),t[r.id]=r,t}.bind(this),{});s.assign(e,{tagsData:i,tagFilters:i.tagFilters,assetsById:n,assets:l})},_getTokensArrayFromQueryStr:function(e,t){var r="+";-1!==e.indexOf("%20")?r="%20":-1!==e.indexOf(" ")&&(r=" ");var i=e.split(r);return t&&(i=s.map(i,this._cleanUserStringAllowColon)),i},_getValidPctFilterStringFromValue:function(e,s){var t="";if("string"==typeof e)if(e=e.toLowerCase(),-1!==["hide","only","allow"].indexOf(e))t=e;else if(s){var r=e.split("pct:");if(2===r.length)if(1===(r=r[1].split(":")).length){var i=1*r[0];0===i?t="hide":i>0&&i<=100&&(t="pct:"+i)}else if(2===r.length){var a=1*r[0],l=1*r[1];l>0&&a>0&&l<=10&&a<=10&&(t="pct:"+a+":"+l)}}return t},getTriggeredAutoSearchOptions:function(){return this._triggeredAutoSearchOptions},_getQueryBoolean:function(e,t){return s.isUndefined(e)?t:!0===e||"true"===e},_initCustomFlags:function(){var e;this._options.allowPremiumTemplates&&((e=this._initCustomFlag(v,2,"npw-vb-search-box-cat-all-premium")).assetProps={isPremiumTemplate:!0},e.filterTag.isPremium=!0),this._options.animationEnabled&&((e=this._initCustomFlag("animated",3,"npw-vb-search-box-cat-all-animated")).filterTag.isAnimated=!0)},_initCustomFlag:function(e,s,t){var r=i.getString(t),a=r.toLowerCase(),l={label:r,labelLc:a};this._customFlags[e]=l,this._customLabels[e]=l.label,this._customLabelsLc[e]=a,this._customKeyFromLabelLc[a]=e;var n="spmap-"+e,o={id:a,label:r,key:e,keyword:e,srcKey:e,tag:n,tags:[n],filterStr:e+":true",customFilterType:e,suggestSortPriority:s};return l.filterTag=o,l},_customFlags:{},_customLabels:{},_customLabelsLc:{},_customKeyFromLabelLc:{},_getCustomTag:function(e,t){var r=this._customFlags[e];return r?s.assign({},r.filterTag,t||{}):(g.debug("[SearchRequestsController] bad tagType in _getCustomTag: "+e),{})},getValidatedSizeFilterId:function(e){var s;if(this._sizeFilterMaps){var t=this._sizeFilterMaps.sizesByLowerCaseId[e.toLowerCase()];t&&(s=t.id)}return s},triggerAutoSearch:function(e,r){var i=e.trigger||e.searchQuery&&e.searchQuery.trigger||this._triggeredAutoSearchCallbackOptions&&this._triggeredAutoSearchCallbackOptions.searchQuery.trigger||"autoSearch";if(e.needsToBeTriggered=!1,e.useController)return r&&r(this._triggeredAutoSearchCallbackOptions),e.searchPromise?e.searchPromise.then((function(e){return e})):t.resolve(this._lastProcessedData);var a,l=[],n=[],o=e.searchQuery,h=o.app&&this._options.VisualBrowseAndSearchAppsController.getFormatInfo(o.app),c={assetId:o.assetId};if(this._triggeredAutoSearchOptions=e,o.limit){var d=1*o.limit;isNaN(d)||(d>100&&(d=100),c.limit=d),this._getQueryBoolean(o.forceLowerLimit,!1)&&(c.forceLowerLimit=!0)}if(o.filters&&(n=this._getTokensArrayFromQueryStr(o.filters,!0)),"true"===o.all)c.isFindAll=!0;else{s.isUndefined(o.tag)?s.isUndefined(o.key)?s.isUndefined(o.keys)?s.isUndefined(o.tags)||(n=this._getTokensArrayFromQueryStr(o.tags)):l=this._getTokensArrayFromQueryStr(o.keys):l=s.isArray(o.key)?o.key:[o.key]:s.isArray(o.tag)?o.tag:[o.tag];var u={};l=s.reduce(l,function(e,s){return s=this.cleanUserString(s.split("-").join(" ")),u[s]||(u[s]=!0,e.push(s)),e}.bind(this),[])}if(o.sizeFilter)if(this._sizeFilterMaps){var m=this._sizeFilterMaps.sizesByLowerCaseId[o.sizeFilter.toLowerCase()];if(m){var f=m.str||"";c.sizeFilterMap=m,s.each(m.filters,(function(e){-1===n.indexOf(e)&&n.push(e)})),f&&(l=s.uniq(l.concat(f.split(" "))))}}else g.debug("requesting sizeFilter but unsupported:"+o.sizeFilter,e);var w,b=o[p]||o.premium;if(b){var _=this._getValidPctFilterStringFromValue(b,!0);if(""!==_&&(c.premiumFilter=_,n.length)){var x=n.indexOf(v);-1!==x&&n.splice(x,1)}}(n.length&&l.length&&(l=s.filter(l,(function(e){return-1===n.indexOf(e)}))),l.length?c.keywords=l:c.isFindAll=!0,n.length&&(c.tagFilters=s.map(n,function(e){var s=e.split(":"),t=s[0],r=s.length>1?s[1]:void 0;if(t===v)return this._getCustomTag(v,{value:r});c.verifyTagFilters=!0;var i=t.split("-");if(i.length>1){var a=this._nonLangTagToFieldMap[i[0]];if(a)return{fields:[a],tag:t,tags:[t],id:t,keyword:i.slice(1).join("-"),value:r,needsLabel:!0,label:i.slice(1).join(" ")}}return{keyword:t,id:t,value:r}}.bind(this))),a=c.isFindAll?"":c.keywords.join(" "),c.analyticsData={searchTerm:a,trigger:i},h&&(this._options.searchPageAndVideoAsRelated&&("page"!==h.type&&"video"!==h.type||(c.assetId=null)),c.analyticsData.sparkFormat=h.type),s.isUndefined(o.fallbackThresh))||(w="default"===o.fallbackThresh?this._options.defaultFallbackThresh:1*o.fallbackThresh,!isNaN(w)&&w>=0&&(c.fallbackSearch={minResults:w}));return this._triggeredAutoSearchCallbackOptions={searchOptions:c,fieldSearchStr:a,appInfo:h,searchQuery:o},r&&r(this._triggeredAutoSearchCallbackOptions),this.getTemplateResults(c)},repeatSearch:function(e){var t=s.isUndefined(e.searchStr)?this._currentSearch.searchStr:e.searchStr,r=s.isUndefined(e.userStr)?this._currentSearch.userStr:e.userStr,i=e.forceApp?e.forceApp.app:this._currentSearch.app,a=e.options||this._currentSearch.options;e.deferForRender||this.callbacks.setSearchingForResults(!0,e),this._getSparkContentSearchResults(i,t,r,a,e).then(function(s){e.deferForRender?e.deferForRender.resolve(s):this.callbacks.renderCpSearchResults(s,{repeatOptions:e,hideProgressWhenRendered:!0})}.bind(this),(function(s){g.error("repeat search returned error",s),e.deferForRender&&e.deferForRender.reject(s)}))},getCurrentSearch:function(){return this._currentSearch},getSearchDataForRestore:function(e){return e},getCurrentSearchAnalytics:function(){return this._lastGetTemplateResultsAnalytics||{}},getLastTemplateResultsAnalyticsTriggerCategory:function(){this._lastGetTemplateResultsAnalytics||g.debug("no _lastGetTemplateResultsAnalytics in getLastTemplateResultsAnalyticsTriggerCategory");var e=this._lastGetTemplateResultsAnalytics.trigger;return _[e]||"templateSearch"},getDataForRestoringAfterRedraw:function(){return{_currentSearch:this._currentSearch,_tagsData:this._tagsData,_nextCursorHref:this._nextCursorHref,_remainingIds:this._remainingIds,_assets:this._assets,_lastGetTemplateResultsOptions:this._lastGetTemplateResultsOptions,_lastGetTemplateResultsAnalytics:this._lastGetTemplateResultsAnalytics}},restoreSearchAfterReRender:function(e){return e=e||{},s.assign(this,e.dataToRestore||{}),e.currentSearch||this._currentSearch},getTemplateResultsForOpeningEditor:function(e,t){var r={searchQuery:s.clone(t)};return r.searchQuery.app=e.typeName||e,this.triggerAutoSearch(r)},keysStrFromTagsArray:function(e,t){return s.map(e,(function(e){return e.split("-").slice(1).join(" ")})).join(s.isUndefined(t)?" ":t)},_getSearchTermForAnalytics:function(e,t){return s.isUndefined(e)&&(e=t||""),""===e?"searchTerm:none":e},_trackEvent:function(e,s){a.trackEvent(e,s||{},this._getAnalyticsPage())},_getAnalyticsPage:function(){var e=(this._options.context||"npw")+":search";return this._showingCpResults&&(e+="ResultsGrid"),e},_sendTemplateFeedViewedAnalyticsAndExtend:function(e,t,r){var i="notEntitled";if(this._options.allowPremiumTemplates&&(i=0,e.assets.length)){var a=0;if(s.each(e.assets,(function(e){e.isPremiumTemplate&&a++})),a)i=e.assets.length-a?Math.round(100*a/e.assets.length):100}var l="premiumToTotalTemplatePercent:"+i,n=_[r.trigger]||"templateSearch";this._trackEvent("templateFeedViewed",{contextualData3:"categoryName:"+n,contextualData4:l,isFullHomepage:this._options.inMainSearchHeader}),t.contextualData4=l},_areTagsListsDifferent:function(e,t){if(!e||!e.length)return!(!t||!t.length);if(!t||!t.length||t.length!==e.length)return!0;var r=s.reduce(e,(function(e,s){return e[s.keyword]=!0,e}),{});return!!s.find(t,(function(e){return!r[e.keyword]}))},isSearchDifferent:function(e){var s=!0;return this._lastGetTemplateResultsOptions&&((s=this._lastGetTemplateResultsOptions.searchString!==e.searchString)||(s=e.findAllType!==this._lastGetTemplateResultsOptions.findAllType||this._areTagsListsDifferent(e.tagFilters,this._lastGetTemplateResultsOptions.tagFilters))),s},getTemplateResults:function(e){var r=t.defer();this._lastGetTemplateResultsOptions=s.cloneDeep(e);var i,l,n=e.app,o="",h=!1;this._options.searchPageAndVideoAsRelated?n="post":n&&this._options.searchPageAndVideoAsRelated&&(n=null),e.user?(i=e.searchStr||"",o=e.userStr||i,l=e.user):e.findAllType?(i="",h=this._options.keysForTags):e.tags?(i=e.tags.join(" "),o=this.keysStrFromTagsArray(e.tags)):this._options.keysForTags?(h=!0,i=e.searchString||e.keywords&&e.keywords.join(" ")||""):i=o=e.keywords&&e.keywords.join(" ")||"",this.callbacks.setSearchingForResults(!0,e);var c,d=s.assign({pageName:a.getPageName(),contextualData2:"searchStr:"+i,contextualData3:"isUserSearch:"+!!e.isUserSearch},e.analyticsData);(d.searchTerm=this._getSearchTermForAnalytics(d.searchTerm,i),d.tagId?d.contextualData13="method:tag":d.contextualData13="method:search",e.tagFilters&&e.tagFilters.length)?c="["+s.map(e.tagFilters,(function(e){return e.keyword})).join(",")+"]":c="none";if(d.contextualData14="tagFilters:"+c,this._trackEvent("NPWVisualBrowseTemplateSearchTriggered",d),this._lastGetTemplateResultsAnalytics){var u=this._lastGetTemplateResultsAnalytics.contextualData2;u&&(u=u.split("searchStr:").slice(1).join());var g=s.assign({},d,{numAssets:this._lastGetTemplateResultsAnalytics.numAssets,contextualData15:"prevTerm:"+u});this._showingCpResults&&this.searchResultsGridView&&this.searchResultsGridView.pagination&&(g.numSlides=this.searchResultsGridView.pagination.lastShowing),this._trackEvent("NPWVisualBrowseTemplateAdditionalSearch",g)}var m,p={field:"tags",keysOnly:h,assetId:e.assetId||e.jumpToDetailAssetId,sizeFilterMap:e.sizeFilterMap,user:l,tagFilters:e.tagFilters,contentSearch:!!e.contentSearch,flags:{},strFilters:[],verifyTagFilters:e.verifyTagFilters};if(e.limit&&(p.limit=e.limit,e.forceLowerLimit&&(p.forceLowerLimit=!0)),p.assetId&&e.assetIdApp&&(p.assetIdApp=e.assetIdApp),this._options.allowGiphyTemplates&&(p[w]="allow"),this._options.animationEnabled){var b;if("searchAllAnimated"===e.findAllType)b=!0;else if(i){m=i.toLowerCase().split(" ");var _=this._customLabelsLc.animated;(b=-1!==m.indexOf(_))&&p.strFilters.push(_)}if(b)p.tagFilters&&s.find(p.tagFilters,(function(e){return e.isAnimated}))||("searchAllAnimated"===e.findAllType?(p.tagFilters||(p.tagFilters=[]),p.tagFilters.push(this._getCustomTag("animated"))):p.flags.animated=!0)}if(this._options.allowPremiumTemplates){var x,y,S=e.premiumFilter;if(i)-1!==(m=i.toLowerCase().split(" ")).indexOf(this._customLabelsLc[v])?(x=!0,p.strFilters.push(this._customLabelsLc[v])):x=-1!==m.indexOf(v)||-1!==m.indexOf(f);else if("searchAllPremium"===e.findAllType)y=this._getCustomTag(v),p.tagFilters?s.find(p.tagFilters,(function(e){return e.isPremium}))||p.tagFilters.push(y):p.tagFilters=[y];else if(p.tagFilters){var T=s.find(p.tagFilters,(function(e){return e.isPremium}));T&&(S="false"===T.value||!1===T.value?"hide":"only")}y||(S||(S="searchAllPremium"===e.findAllType?"only":this._options.premiumFilter),x&&"hide"!==S&&"only"!==S&&(S="pct:100",p.flags[v]="true"),p[f]=S)}else p[f]="hide";return this._getSparkContentSearchResults(n,i,o,p).then(function(i){var a,l;if(e.fallbackSearch&&i.total<=e.fallbackSearch.minResults){var o=e.fallbackSearch.fieldSearchStr||"";p.tagFilters=e.fallbackSearch.tagFilters||[],l=!0,e.fallbackSearch.triggered={fieldSearchStr:o,isFindAll:""===o},a=this._getSparkContentSearchResults(n,o,o,p)}else a=t(i);a.then(function(t){var i={numAssets:t.total};this._sendTemplateFeedViewedAnalyticsAndExtend(t,i,d),this._lastGetTemplateResultsAnalytics=s.assign({},d,i),this._trackEvent("NPWVisualBrowseTemplateSearchReturned",this._lastGetTemplateResultsAnalytics),e.addHistory&&!l&&this._addSearchHistoryAfterResults(t,e),t.searchAnalytics={searchStr:this._lastGetTemplateResultsAnalytics.contextualData2,tagFilters:this._lastGetTemplateResultsAnalytics.contextualData14,searchTerm:this._lastGetTemplateResultsAnalytics.searchTerm},r.resolve(t)}.bind(this))}.bind(this),(function(e){r.resolve({err:e||"unknown err"})})).done(),r.promise},_defaultSearchHistory:{searches:{}},_recalcSortedSearchHistory:function(){var e=s.map(this._searchHistory.savedHistory.searches,(function(e){return e}));e.sort((function(e,s){return s.d-e.d})),e.length>20&&e.splice(20),this._searchHistory.searches=e},getMySearchHistory:function(e,s){return this._initSearchHistory(s),this._searchHistory},_searchHistories:{},_initSearchHistory:function(e){var t,r=this._searchHistories[e];if(r)return this._historyEnabled=!0,void(this._searchHistory=r);try{var i=n.getProfile();i&&i.userId&&(t="vb-tmpl-search-history-json_"+(new d).update(i.userId).digest("hex"),"template"!==e&&(t+="_"+e))}catch(o){g.warn("error initting search history",o)}if(t){var a;this._historyEnabled=!0;try{var l=window.localStorage.getItem(t);l&&(a=JSON.parse(l))}catch(o){}a?a.searches=s.reduce(a.searches,(function(e,s,t){return(t=t.toLowerCase())&&(e[t]=s,(s.t||s.k)&&(delete s.t,delete s.k)),e}),{}):a=s.cloneDeep(this._defaultSearchHistory),this._searchHistory={savedHistory:a,searches:[],type:e,storageKey:t},this._searchHistories[e]=this._searchHistory,this._recalcSortedSearchHistory()}},addSearchHistoryForResults:function(e){var s=this._searchHistory&&this._searchHistory.type;s===e.type?this._addSearchHistoryAfterResults({total:e.total||0},e):g.debug("history type mismatch: requested: "+e.type+", current:"+(s||"uninitialized"))},_addSearchHistoryAfterResults:function(e,s){if(this._historyEnabled&&e.total&&s.searchString&&this._searchHistory){var t,r=s.searchString.toLowerCase(),i=this._searchHistory.savedHistory.searches[r],a={d:Date.now(),r:1,s:s.searchString};if(s.app&&(a.app="object"==typeof s.app?s.app.typeName:s.app),i&&(a.r=i.r+1),this._searchHistory.savedHistory.searches[a.s]=a,this._recalcSortedSearchHistory(),this._searchHistory.storageKey){try{t=JSON.stringify(this._searchHistory.savedHistory)}catch(l){g.error("error parsing json in addSearchHistory",{err:l,searchOptions:s})}if(t)try{window.localStorage.setItem(this._searchHistory.storageKey,t)}catch(l){g.warn("error saving to localStorage in addSearchHistory",l)}}}},getHeroTemplateFromResults:function(e,t){if(!e||!e.assets||!e.assets.length)return null;if(this._options.allowPremiumTemplates&&"ifEntitled"===t.premium&&l.hasFeature("is-paid-user")){var r=s.find(e.assets,(function(e){return e.isPremiumTemplate}));return r||e.assets[0]}return s.find(e.assets,(function(e){return!e.isPremiumTemplate}))},_constantSearchType:"application/vnd.adobe.theo.document+dcx",_constantSearchTypeFilterString:'type:"application/vnd.adobe.theo.document+dcx"',_nonTagFieldsToSelect:["created","description","id","urn","premium","remixCount","rendition","_score","animated","title"],_fieldToTagMaps:{categories:"explore",colors:"spcolor",collections:"spcollect",influencers:"spinfluencer",ingredients:"spingred",locales:"sploc",styles:"spstyle",tasks:"spcase",topics:"spterm"},_aggsFieldsToRequest:["categories","colors","collections","influencers","ingredients","styles","tasks","topics"],getFieldToMapKey:function(e){return this._fieldToTagMaps[e]||"unk"},_labelFromTagKey:function(e){return e.split("-").join(" ")},_tagsDataFromSparkContentResults:function(e,t,r){var i,a={},l=0,n=(r=r||{}).verifyTagFilters&&{};t&&(i=s.reduce(t,(function(e,s,t){return s.selected=!0,s.isFilter=!0,s.needsLabel?(a[s.id]={tag:s,index:t},l++):e[s.id]={index:t,tag:s},n&&(n[s.keyword]=s,s.needsValidation=!0),e}),{}));var o,h=[],c={},d=(e.options.keysOnly,s.reduce(this._customFlags,(function(e,s,t){return e[t]={flagData:s,assets:[]},e}),{}));if(e.aggregations){var u={};if(!e.aggregations.processed){var g=e.aggregations;g.length||(g=[g]),s.each(g,function(e){s.each(e,function(e,t){if(e.buckets&&e.buckets.length){var r=this._fieldToTagMapsNoLoc[t];r?s.each(e.buckets,function(e){var s=e.key.split(" ").join("-");if(s){var t=e.label||this._labelFromTagKey(s),o=t.toLowerCase(),h=this._customKeyFromLabelLc[o],c=u[o];if(h)if(c)u[o].numAssets+=e.docCount;else{var d=this._getCustomTag(h,{numAssets:e.docCount,aggregateType:"only"});u[o]=d}else{var g=r+"-"+s;if(c)c.numAssets+=e.docCount,-1===c.fields.indexOf(r)&&c.fields.push(r),-1===c.tags.indexOf(g)&&c.tags.push(g),c.label!==t&&t!==o&&c.label.toLowerCase()===c.label&&(c.label=t);else{var m={numAssets:e.docCount,id:o,label:t,key:s,srcKey:s,keyword:s,fields:[r],tags:[g],tag:g,aggregateType:"only",assets:[]};u[o]=m}if(l&&a[g]){var p=a[g];p.tag.id=t,p.tag.needsLabel=!1,i[p.tag.id]=p,--l&&delete a[g]}}n&&n[s]&&(n[s].tagMatch=u[t])}}.bind(this)):window.marvel.logger.debug("unknown aggId in _tagsDataFromSparkContentResults")}}.bind(this))}.bind(this)),e.aggregations={aggTags:u,processed:!0}}o=s.cloneDeep(e.aggregations.aggTags),c=o}return s.each(e.assets,function(e){e.originalTags=e.tags,e.tags=[],s.each(d,(function(t,r){e[r]&&(t.assets.push(e),t.flagData.assetProps&&s.assign(e,t.flagData.assetProps))})),s.each(this._fieldToTagMaps,function(t,r){s.each(e[r],function(s){if(""!==s){s=s.split(" ").join("-");var i=t+"-"+s;"locales"!==r?e.tags.push(i):e.sploc=i}}.bind(this))}.bind(this))}.bind(this)),s.each(c,function(e,t){h.push(e),e.selected=!1,e.aggregateType?"inResult"===e.aggregateType&&(e.numAssets=Math.max(e.assets.length,e.numAssets)):e.numAssets=e.assets.length,e.fields=s.uniq(e.fields),this._calcTagSuggestPriority(e)}.bind(this)),i&&(h=s.filter(h,(function(e){var s=i[e.id];return s?(t[s.index]=e,e.selected=!0,e.isFilter=!0):e.isFilter=!1,e.isSearchTerm=!1,!e.isFilter})),n&&(t=s.reduce(t,(function(e,s){var t=n[s.keyword];return t&&t.tagMatch&&e.push(t.tagMatch),e}),[]))),h.sort(this.sortTagsInOrder),s.each(d,function(s,r){if(s.assets.length||!(""!==e.searchStr||t&&t.length)){var a=s.flagData.labelLc,l=c[a];if(!l){var n=i[a];n?l=n.tag:(l=this._getCustomTag(r),h.unshift(l)),c[a]=l}l.assets=s.assets,l.numAssets=s.assets.length}}.bind(this)),s.assign(e.tagsData,{tags:c,tagsInOrder:h,tagFilters:t}),e.tagsData},_processQueryPostResults:function(e){var t=0,r=0,i=[];return s.each(e,function(e){var s=e.srcPart;if(e.err)window.marvel.logger.error("Error with split query: "+s.sendOptions.q,e.err),s.data=this._getEmptyResultsObj();else if(s.doingNumFromFirst){s.doingNumFromFirst=!1;var a=s.data._embedded.results;s.data=e.value;var l={};s.data._embedded.results=a.concat(s.data._embedded.results).filter((function(e){if(!l[e.id])return l[e.id]=!0,!0})),s.data._embedded.count=s.data._embedded.results.length}else s.data=e.value,s.data._embedded.aggregations&&i.push(s.data._embedded.aggregations);s.total=s.data._embedded.total,t+=s.total,s.nextIndex=0,s.totalPulled+=s.data._embedded.count,s.numRemaining=s.total-s.totalPulled,s.nextHref=s.data._links&&s.data._links.next&&s.data._links.next.href,s.nextHref&&(s.nextBody=s.data._links.next.body),s.nextHref?s.numRemaining||(s.numRemaining=1):s.numRemaining=0,r+=s.numRemaining}.bind(this)),{total:t,numRemaining:r,aggregations:i.length&&i}},_setupSplitQueries:function(e,t,r,i,a){var l=t&&t[0],n=[],o=function(e,t){var a=t&&i.limit||1,o=s.cloneDeep(i),h={sendOptions:o,totalPulled:0},c={};if(e&&o.filters&&(o.filters=o.filters.replace(l,e)),r){var d=s.cloneDeep(o);o.filters?o.filters+=" AND premium:false":o.filters="premium:false",d.filters?d.filters+=" AND premium:true":d.filters="premium:true",h.interleave=r.free;var u=[h];u.push({sendOptions:d,interleave:r.premium,totalPulled:0}),s.each(u,function(e){n.push({sendOptions:this._getSparkContentQueryTotalSendOptions(e.sendOptions,a),srcPart:e})}.bind(this)),c.parts=u}else c.single=h,n.push({sendOptions:this._getSparkContentQueryTotalSendOptions(h.sendOptions,a),srcPart:h});return c}.bind(this),h=[];t?s.each(t,(function(e,s){h.push(o(e,!s))})):h.push(o(null,!0));var c={queries:h};return c.currentQuery=c.queries[0],a&&n.push({sendOptions:this._getAssetIdQueryData(a),srcPart:{assetId:a}}),this._sendSparkContentQueryPostArray(n).then(function(t){if(a){var r=t.pop(),l=r&&r.value._embedded.results[0];l&&(c.assetIdResult=this._processOneSparkContentAsset(l))}var n=this._processQueryPostResults(t);c.initialTotal=n.total,c.numRemaining=n.numRemaining,c.aggregations=n.aggregations,c.queries=s.filter(c.queries,function(e){return e===c.currentQuery||(e.single?!!e.single.total&&(e.single.numFromFirst=e.single.data._embedded.results.length,e.single.numRemaining+=e.single.numFromFirst,void(c.numRemaining+=e.single.numFromFirst)):(e.parts=s.filter(e.parts,(function(e){return!!e.total&&(e.numFromFirst=e.data._embedded.results.length,e.numRemaining+=e.numFromFirst,c.numRemaining+=e.numFromFirst,!0)})),!!e.parts.length&&(1===e.parts.length&&(e.single=e.parts[0],e.parts=null),!0)))}.bind(this)),e.splitQuery=c,e.targetTotal=i.limit}.bind(this))},_doNextSplitQuery:function(e,r,i){var a=i.splitQuery,l=r.targetTotal-this._assets.assetsArray.length;if(!a.currentQuery)return t.reject({errorMessage:"no more records for split query"});if(!a.currentQuery.single){var n=s.filter(a.currentQuery.parts,(function(e){return e.numRemaining>0&&e.nextHref}));a.currentQuery.parts=n,1===n.length&&(a.currentQuery.single=n[0])}var o=[];return a.currentQuery.single?o.push({sendOptions:this._getSplitCursorQuerySendOptions(a.currentQuery.single,l),srcPart:a.currentQuery.single}):s.each(a.currentQuery.parts,function(e){o.push({sendOptions:this._getSplitCursorQuerySendOptions(e,l),srcPart:e})}.bind(this)),this._sendSparkContentQueryPostArray(o).then(function(s){return this._processQueryPostResults(s),this._processSplitQuery(e,r,i)}.bind(this))},cleanUserString:function(e){return e.replace(/[.,\/#!$%\^&\*;:{}\]\[=\_"`~()\\]/g," ").replace(/ +/g," ").trim()},_cleanUserStringAllowColon:function(e){return e.replace(/[.,\/#!$%\^&\*;{}\]\[=\_"`~()\\]/g," ").replace(/ +/g," ").trim()},_getSingularIfPlural:function(e){if(u.isPlural(e)){var s=u.singular(e);if(s!==e)return s}return""},_requestFieldIdFromFieldId:function(e){return this._nonLangTagToFieldMap[e]||e},_getFiltersFromTagFilters:function(e){var t={customFilters:[]};return t.filters=s.reduce(e,function(e,r){if(r.customFilterType)t.customFilters.push(r);else{var i='"'+r.keyword.split("-").join(" ")+'"';if(r.fields)if(r.fields.length>1){var a=s.map(r.fields,function(e){return this._requestFieldIdFromFieldId(e)+":"+i}.bind(this));i="("+a.join(" OR ")+")"}else i=this._requestFieldIdFromFieldId(r.fields[0])+":"+i;e.push(i)}return e}.bind(this),[]),t},_getSparkContentSearchResults:function(e,t,r,i,a){if((a=a||{isFirstQuery:!0,totalPulled:0}).extraResults)return this._preSparkContentSearchTemplateResults(i,this._currentSearch,a);var n;"string"==typeof e&&(e=h.getAppByType(e)),i.user&&window.marvel.logger.debug("asking for user in _getSparkContentSearchResults:"+i.user),t&&(t=this.cleanUserString(t)),i.limit&&a.isFirstQuery?(n=i.limit)<1?n=1:n>100?n=100:i.forceLowerLimit||(n=Math.max(n,40)):n=a.isFirstQuery?80:a.targetTotal;var o,d,u,g,p={searchStr:t,userStr:r,app:e,options:i,splitQuery:a.splitQuery,totalPulled:a.totalPulled,targetTotal:n};if(this._currentSearch=p,a.splitQuery)return this._doNextSplitQuery(i,p,a);if(a.loadNext){var v=p.targetTotal-this._assets.assetsArray.length;v<40&&(v=40);var _=c.parse(this._nextCursorHref,!0);_.protocol="https",_.host=this._options.searchHost,_.query.limit=v,_.search="",o=c.format(_)}else{var x=!this._sparkContentSearchAllFields,y=i[f],S=[],T=i.strFilters&&i.strFilters.slice()||[],k=!s.isEmpty(i.flags)&&i.flags;if(i.tagFilters&&i.tagFilters.length){var C,R={},F=s.reduce(i.tagFilters,function(e,t){if(t.customFilterType)R[t.customFilterType]=t,t.isPremium&&(C=t),e.push(t.filterStr);else if(t.tags){var r=s.reduce(t.tags,function(e,s){var t=s.split("-"),r=this._nonLangTagToFieldMap[t[0]],i=e[r];return i||(i=[],e[r]=i),i.push(t.slice(1).join("-")),e}.bind(this),{}),a=s.reduce(r,(function(e,s,t){var r=t+":";return 1===s.length?r+='"'+s[0]+'"':r+='("'+s.join('" OR "')+'")',e.push(r),e}),[]);1===a.length?e.push(a[0]):e.push("("+a.join(" OR ")+")")}else{i.verifyTagFilters||window.marvel.logger.debug("no tags for tag filter",t);var l='"'+t.keyword.split("-").join(" ")+'"';if(t.fields)if(t.fields.length>1){var n=s.map(t.fields,(function(e){return e+":"+l}));l="("+n.join(" OR ")+")"}else l=t.fields[0]+":"+l;e.push(l)}return e}.bind(this),[]);k&&s.each(k,function(e,s){R.hasOwnProperty(s)||(S.push(s+":"+e),T.push(this._customLabelsLc[s]))}.bind(this)),F.length&&(S=S.concat(F)),C&&"hide"!==y&&"pct:0"!==y&&(y="only")}else k&&s.each(k,function(e,s){S.push(s+":"+e),T.push(this._customLabelsLc[s])}.bind(this));if(i.sizeFilterMap){var A=i.sizeFilterMap.aspectGroup?i.sizeFilterMap.aspectGroup.sizeQueryString:i.sizeFilterMap.sizeQueryString;A&&S.push(A)}if(T.length&&t.length){T=s.uniq(T);var I=s.filter(t.split(" "),(function(e){return""!==e&&-1===T.indexOf(e.toLowerCase())}));t=I.join(" ")}-1!==(u={q:t||"",limit:p.targetTotal,select:this._allFieldsToSelect.join(",")}).q.indexOf(m)&&(u.q=u.q.split(m).join("")),x&&(u.searchIn=this._nonLangTagFieldIds.join(",")),u.aggs=this._aggsFieldsToRequest.join(","),u.aggsLimit=10;var D,P=""!==t&&["-_score"]||[];if(l.hasFeature("npw-vb-search-scs-sort-score-by-remix-count-over-created")||P.push("-created"),P.push("-remixCount"),y&&"hide"!==y&&"pct:0"!==y){if("pct:100"===y||"only"===y)D="premium:true";else if(0===y.indexOf("pct:"))if(l.hasFeature("npw-vb-search-scs-no-split-query-for-premium-freq"))u.premiumFreq=2;else{var $=1,O=1,L=y.split(":");if(2===L.length){var M=1*L[1];isNaN(M)||M>0&&M<100&&50!==M&&(M<50?$=Math.min(Math.round(100/M)-1,10):O=Math.min(Math.round(100/(100-M))-1,10))}else 3===L.length&&(O=Math.round(1*L[1]),$=Math.round(1*L[2]),isNaN(O)||(O>10?O=10:O<1&&(O=1)),isNaN($)||($>10?$=10:$<1&&($=1)));g={free:$,premium:O}}}else D="premium:false";D&&!i.flags.premium&&S.push(D),"allow"!==i[w]&&S.push("NOT ingredients:"+b);var V=this.getSearchLocale(),E=V.split("-")[0],B=E+"*",z=!1;if(u.qLoc=V,"en"!==E&&!l.hasFeature("npw-vb-search-scs-no-en-fallback")&&((u.premiumFreq||g)&&l.hasFeature("npw-vb-search-scs-split-query-for-premium-locales")&&(z=!0),!z)){B="("+B+" OR en*)";var H="locales";E>"en"&&(H="-"+H),P.unshift(H)}B&&(z&&(d=["locales:"+B,"locales:en*"]),S.push("locales:"+B)),this._constantSearchTypeFilterString&&S.push(this._constantSearchTypeFilterString),S.length&&(u.filters=S.join(" AND ")),u.orderBy=P.join(","),u.q||(u.q="*"),o=c.format({protocol:"https",host:this._options.searchHost,pathname:this._options.searchPathPrefix,query:u})}return d||g?this._setupSplitQueries(a,d,g,u,i.assetId).then(function(){return this._processSplitQuery(i,p,a)}.bind(this)):(i.assetId&&!a.loadNext&&(this._fixSendOptionsJsonForPost(u),o={sendOptions:u,assetId:i.assetId}),this._doSparkContentQuery(o,i,p,a))},_getEmptyResultsObj:function(e){return{_embedded:{count:0,results:[],total:0},_links:{self:{href:e}}}},_setProcessedAssetAsFirstAsset:function(e,t){if(0!==e._orderedIndex){var r=-1;if(s.isUndefined(e._orderedIndex)||t.assetsArray[e._orderedIndex]===e&&(r=e._orderedIndex),-1===r){var i=-1;e._orderedIndex=0,s.each(t.assetsArray,(function(s,t){s!==e?s._orderedIndex=t+1:i=t})),-1!==i&&t.assetsArray.splice(i,1),t.assetsArray.unshift(e)}else t.assetsArray.splice(r,1),t.assetsArray.unshift(e),s.each(t.assetsArray,(function(e,s){e._orderedIndex=s}))}},_addAssetAsFirstAsset:function(e,s){s.assetsById[e.id]=e,this._setProcessedAssetAsFirstAsset(e,s),this._addAllTagsToAsset(e)},_addMappedAssetToAssetsObj:function(e,s){s=s||this._assets;var t=this._options.VisualBrowseUseCasesController.getAssetFromData({asset:{id:e,app:"post"}});return t&&t.app&&this._addAssetAsFirstAsset(t,s),t},_cleanupSplitQueriesAfterProcess:function(e){var t=0;e.queries=s.filter(e.queries,(function(e){if(e.single)e.numRemaining=e.single.numRemaining;else{e.numRemaining=0;var r=s.filter(e.parts,(function(s){return e.numRemaining+=s.numRemaining,s.nextHref}));e.numRemaining&&(1===r.length?e.single=r[0]:e.parts=r)}return t+=e.numRemaining,e.numRemaining})),e.currentQuery=e.queries[0],e.hasMoreQueries=e.queries.length>1,e.numRemaining=t},_processSplitQuery:function(e,s,r){s.splitQuery=r.splitQuery;var i=t.defer();return this._preSparkContentSearchTemplateResults(null,s,r).then(function(t){if(this._assets={assetsArray:t.assets,assetsById:t.assetsById},e.assetId){var a=t.assetsById[e.assetId];if(a)0!==a._orderedIndex&&this._setProcessedAssetAsFirstAsset(a,this._assets);else if(s.splitQuery&&s.splitQuery.assetIdResult)this._addAssetAsFirstAsset(s.splitQuery.assetIdResult,this._assets);else{var l=this._addMappedAssetToAssetsObj(e.assetId,this._assets);l&&(this._assets.assetsById[l.id]=l)}}this._tagsData=t.tagsData,this._cleanupSplitQueriesAfterProcess(s.splitQuery),t.hasMore=!!s.splitQuery.currentQuery,t.total=this._assets.assetsArray.length+s.splitQuery.numRemaining,s.extraResults&&(t.total+=s.extraResults.assets.length),this._assets.assetsArray.length>=s.targetTotal?i.resolve(t):s.splitQuery.numRemaining?this._doNextSplitQuery(e,s,r).then((function(e){i.resolve(e)})):i.resolve(t)}.bind(this)),i.promise},_getAssetIdQueryData:function(e){return{limit:1,filters:'id:"'+e+'"'}},_moveAssetToBeginningOfArray:function(e,t){return s.find(t,(function(s,r){if(s.id===e){var i=t.splice(r,1);return t.unshift(i[0]),!0}}))},_doSparkContentQuery:function(e,s,r,i){var a,l=t.defer();if(e.assetId){var n={main:e.sendOptions,asset:this._getAssetIdQueryData(e.assetId)};a=this._sendSparkContentQueryPost(null,n).then(function(e){var s;try{if(s=e._embedded.asset._embedded.results[0])this._moveAssetToBeginningOfArray(s.id,e._embedded.main._embedded.results)||(e._embedded.main._embedded.results.unshift(s),e._embedded.main._embedded.total++)}catch(t){}return e._embedded.main}.bind(this))}else a=this._sendSparkContentQuery(e);return a.then(function(e){var t=this._nextCursorHref,a=(i.totalPulled||0)+e._embedded.count;this._nextCursorHref=e._links&&e._links.next&&e._links.next.href,e.hasMore=!!this._nextCursorHref,e.totalPulled=a,r.totalPulled=a,e.numRemaining=e._embedded.total-e.totalPulled,this._preSparkContentSearchTemplateResults(e,r,i).then(function(n){if(this._assets={assetsArray:e.assets,assetsById:e.assetsById},s.assetId&&!e.assetsById[s.assetId]&&this._addMappedAssetToAssetsObj(s.assetId,this._assets),this._tagsData=e.tagsData,i&&i.numRepeats&&i.numRepeats>3)t===this._nextCursorHref&&t&&(this._nextCursorHref=null,n.hasMore=!1,window.marvel.logger.error("[SearcRequestController] cursor not updating:"+t)),l.resolve(n);else if(this._assets.assetsArray.length>=r.targetTotal)l.resolve(n);else if(this._nextCursorHref){var o=i&&i.numRepeats||0;this.repeatSearch({loadNext:!0,numRepeats:o+1,deferForRender:l,targetTotal:r.targetTotal,totalPulled:a})}else l.resolve(n)}.bind(this))}.bind(this),function(e){l.reject(e)}.bind(this)).done(),l.promise},_sentUrls:[],_sendSparkContentQuery:function(s){var r=t.defer();return this._sentUrls.push(s),window.marvel.logger.debug("sendSparkContentQuery:"+s),e.ajax({type:"GET",url:s,headers:{"X-Api-Key":o.sparkContentSearchApiKey,Accept:"application/hal+json"},success:function(e,s,t){r.resolve(e)}.bind(this),error:function(e,s,t){window.marvel.logger.error("[SearcRequestController] Errored out while attempting to get query count from content service: ["+e.status+"]",e.responseJSON||e.responseText),r.reject(e)}.bind(this)},null,!0),r.promise},_sendSparkContentQueryPostArray:function(e){var r={},i=0,a=[],l=s.reduce(e,(function(e,s,t){var a=s.sendOptions;return a.fulfilledData?r["r"+t]=a.fulfilledData:(e["r"+t]=a,i++),e}),{});return i?this._sendSparkContentQueryPost(null,l).then(function(t){var i=t._links&&t._links.next&&t._links.next.body;return s.each(e,(function(e,s){var l="r"+s,n=r[l];if(!n){var o=(n=t._embedded[l]).nextBody||i&&i[l];o&&(n._links.next.body=o)}a.push({value:n,srcPart:e.srcPart})})),a}.bind(this),(function(e){return t.reject(e)})):(s.each(e,(function(e,s){a.push({value:r["r"+s],srcPart:e.srcPart})})),t.resolve(a))},_sendSparkContentQueryPostArraySimple:function(e){var r=[];if(!e.length)return t.resolve(r);var i=s.reduce(e,(function(e,s,t){return e["r"+t]=s,e}),{});return this._sendSparkContentQueryPost(null,i).then(function(t){var i=t._links&&t._links.next&&t._links.next.body;return s.each(e,(function(e,s){var a="r"+s,l=t._embedded[a];if(l){var n=l.nextBody||i&&i[a];n&&(l._links.next.body=n)}r.push(l)})),r}.bind(this),(function(e){return t.reject(e)}))},_sendSparkContentQueryPost:function(s,r){s||(s=c.format({protocol:"https",host:this._options.searchHost,pathname:this._options.searchPathPrefix}));var i=t.defer();return e.ajax({method:"POST",data:JSON.stringify(r),url:s,dataType:"json",contentType:"application/json",headers:{"X-Api-Key":o.sparkContentSearchApiKey,Accept:"application/hal+json"},success:function(e,s,t){i.resolve(e)}.bind(this),error:function(e,s,t){window.marvel.logger.error("[SearcRequestController] Errored out querying content service: ["+e.status+"]",{response:e.responseJSON||e.responseText||e.statusText,requestData:r}),i.reject(e)}.bind(this)},null,!0),i.promise},_sendBatchQuery:function(e){return this._sendSparkContentQuery(e,"POST")},doAggregatesFromFragmentsQuery:function(e,t){var r,i=(t=t||{}).locale||this.getSearchLocale(),a=[],l=i,n={qLoc:i,limit:0,aggs:this._aggsFieldsToRequest,aggsLimit:t.aggsLimit||5};t.tagFilters&&(r=this._getFiltersFromTagFilters(t.tagFilters))&&r.filters&&r.filters.length&&(a=a.concat(r.filters)),t.langOnly?l.length>2&&(l=l.substring(0,2)+"*"):l=l.toLowerCase(),t.includeEnglishIfNonEnglish&&"en-us"!==i.toLowerCase()&&(t.langOnly?l+=" OR en*":l+=" OR en-us",l="("+l+")"),a.push("locales:"+l),this._options.allowPremiumTemplates||a.push("premium:false"),this._constantSearchTypeFilterString&&a.push(this._constantSearchTypeFilterString),n.filters=a.join(" AND ");var o=t.calcAggsForAllFragments?e:e.slice(0,1),h=s.map(o,(function(e){return s.assign({q:e||"*"},n)}));return this._sendSparkContentQueryPostArraySimple(h).then(function(r){var i=s.map(o,function(e,s){var i=r[s]._embedded;return{str:e,totalResults:i.total,tagsInOrder:this._tagsInOrderFromOneAggsSet(i.aggregations,!s&&t.prepends)}}.bind(this));return!t.calcAggsForAllFragments&&e.length>1&&(i=this.appendFragStringEmptyAggsToArray(i,e,1)),i}.bind(this))},appendFragStringEmptyAggsToArray:function(e,t,r){var i=e.slice(0);return s.map(t.slice(r),(function(e){i.push({str:e,totalResults:-1})})),0===r&&(i[0].tagsInOrder=[]),i},_calcTagSuggestPriority:function(e){s.isUndefined(e.suggestSortPriority)&&(1===e.fields.length&&"explore"===e.fields[0]?e.suggestSortPriority=-1:e.suggestSortPriority=1)},sortTagsInOrder:function(e,s){return e.suggestSortPriority!==s.suggestSortPriority?e.suggestSortPriority>s.suggestSortPriority?-1:1:s.numAssets-e.numAssets},_tagsInOrderFromOneAggsSet:function(e,t){var r={},i=[],a={};if(s.each(e,function(e,t){if(e.buckets&&e.buckets.length){var l=this._fieldToTagMapsNoLoc[t];l?s.each(e.buckets,function(e){var s=e.key.split(" ").join("-");if(s){var t=e.label||this._labelFromTagKey(s),n=r[t],o=l+"-"+s;if(n)n.numAssets+=e.docCount,-1===n.fields.indexOf(l)&&n.fields.push(l),-1===n.tags.indexOf(o)&&n.tags.push(o);else{var h={numAssets:e.docCount,id:t,label:t,key:s,keyword:s,srcKey:s,fields:[],tag:o,tags:[o]};r[h.id]=h,i.push(h),a[h.id]&&window.marvel.logger.debug("duped aggTag:"+h.id),a[h.id]=h,h.fields.push(l)}}}.bind(this)):window.marvel.logger.debug("unknown aggId in _tagsInOrderFromOneAggsSet")}}.bind(this)),i.forEach(this._calcTagSuggestPriority),i.sort(this.sortTagsInOrder),t&&t.length){var l=s.map(t,function(e){return this._getCustomTag(e)}.bind(this));l.reverse(),i=l.concat(i)}return i},_getSplitCursorQuerySendOptions:function(e,s){if(e.numFromFirst){if(!e.nextBody||e.numFromFirst>=s)return e.numFromFirst=0,{fulfilledData:e.data};s-=e.numFromFirst}return e.forceLowerLimit?s=Math.max(0,s):s<40&&(s=40),e.numFromFirst?(e.numPulled-=e.numFromFirst,e.numFromFirst=0,e.doingNumFromFirst=!0,this._extendSplitCursorQuerySendOptions(e.nextBody,s)):this._extendSplitCursorQuerySendOptions(e.nextBody,s)},_getSparkContentQueryTotal:function(e,t){(e=s.cloneDeep(e)).limit=t||1;var r=c.format({protocol:"https",host:this._options.searchHost,pathname:this._options.searchPathPrefix,query:e});return this._sendSparkContentQuery(r)},_fixSendOptionsJsonForPost:function(e){s.each(["orderBy","aggs","select"],(function(s){e[s]&&(e[s]=e[s].split(","))}))},_getSparkContentQueryTotalSendOptions:function(e,t){return e=s.cloneDeep(e),this._fixSendOptionsJsonForPost(e),e.limit=t||1,e},_extendSplitCursorQuerySendOptions:function(e,t){return(e=s.cloneDeep(e)).limit=t||1,e},_processOneSparkContentAsset:function(e){if(this._badAssets.count&&this._badAssets.ids[e.id])return null;e.tags=[],s.each(this._fieldToTagMaps,(function(t,r){s.each(e[r],(function(s){s&&e.tags.push(t+"-"+s)}))}));var t=this._constantSearchType||"";return e.app=this._options.VisualBrowseAndSearchAppsController.getAppType(e.type||t),e.templatedImgHref=e.rendition.href,e.width=e.rendition.maxWidth,e.height=e.rendition.maxHeight,e},_interleaveParts:function(e){for(var s=[],t=e;t.length>1;){for(var r=[],i=0;i<t.length;i++){var a=t[i];a.nextIndex<a.assets.length&&(1===a.interleave?(s.push(a.assets[a.nextIndex]),a.nextIndex++):(s=s.concat(a.assets.slice(a.nextIndex,a.nextIndex+a.interleave)),a.nextIndex+=a.interleave),a.nextIndex<a.assets.length&&r.push(a))}t=r}if(t.length){var l=t[0];s=s.concat(l.assets.slice(l.nextIndex)),l.nextIndex=l.assets.length}return s},_preSparkContentSearchTemplateResults:function(e,r,i){var a,l=(i=i||{}).extraResults;if(i.isFirstQuery?a=i.splitQuery?i.splitQuery.aggregations:e._embedded&&e._embedded.aggregations:(a=i.aggregations,this._badAssets.count&&(this._assets.assetsArray=s.filter(this._assets.assetsArray,function(e){return!this._badAssets.ids[e.id]&&e}.bind(this)))),l){e=l.resultsData;var n,o=i.targetTotal-this._assets.assetsArray.length;o>l.assets.length?(n=l.assets,i.extraResults=null,r.extraResults=null):(n=l.assets.splice(0,o),0===l.assets.length&&(i.extraResults=null,r.extraResults=null)),this._assets.assetsArray=this._assets.assetsArray.concat(n),e.assets=this._assets.assetsArray}else{if(i.splitQuery&&i.splitQuery.currentQuery?(i.splitQuery.currentQuery.single?(e=i.splitQuery.currentQuery.single.data).assets=s.filter(e._embedded.results,this._processOneSparkContentAsset):(e=i.splitQuery.currentQuery.parts[0].data,s.each(i.splitQuery.currentQuery.parts,function(e){e.assets=s.filter(e.data._embedded.results,this._processOneSparkContentAsset)}.bind(this)),e.assets=this._interleaveParts(i.splitQuery.currentQuery.parts)),e.hasMore=i.splitQuery.numRemaining>0):e.assets=s.filter(e._embedded.results,this._processOneSparkContentAsset),s.extend(e,r),e.tagsData={},i.isFirstQuery)e.tagsData.keysForTags=this._options.keysForTags,e.total=e._embedded.total,i.isFirstQuery=!1;else{var h=e._embedded.total-e._embedded.count;e.assets=this._combineResultAssets(e.assets),e.total=e.assets.length+h,e.tagsData=this._tagsData}e.assets.length>i.targetTotal?r.extraResults={assets:e.assets.splice(i.targetTotal),resultsData:s.clone(e)}:r.extraResults=null}var c=e.assets.length;return i.splitQuery?c+=i.splitQuery.numRemaining:e.numRemaining&&(c+=e.numRemaining),r.extraResults&&(c+=r.extraResults.assets.length),e.total=c,e.aggregations=a,this._assignTagsDataToResults(e,r,i),r.aggregations=e.aggregations,i.aggregations=e.aggregations,this._options.favoritesEnabled?this._options.VisualBrowseUseCasesController.applyFavoritesToSearchResults(e).then((function(e){return e})):t.resolve(e)}});return x.requiredCallbackNames=["setSearchingForResults","renderCpSearchResults"],x}.apply(s,r))||(e.exports=i)},2506:function(e){e.exports=JSON.parse('{"sizeRangeForEquality":0.01,"maps":{"Instagram":{"filters":["instagram"]},"InstagramStory":{"filters":["instagram-story"]},"InstagramPortrait":{"filters":["instagram"]},"InstagramLandscape":{"filters":["instagram"]},"Facebook":{"filters":["facebook"]},"Pinterest":{"filters":["pinterest"]},"YouTubeThumbnail":{"filters":["youtube"],"str":"thumbnail"},"LinkedInBlogPost":{"filters":["linkedin"]},"SnapchatStory":{"filters":[],"str":"snapchat"},"Twitter":{"filters":["twitter"]},"Letter":{"filters":["letter"]},"Poster":{"filters":["poster"]},"Card":{"filters":["card"]},"A5":{},"A4":{},"A3":{},"FacebookProfileCover":{"filters":["facebook"],"str":"profile cover"},"FacebookPageCover":{"filters":["facebook"]},"FacebookEventCover":{"filters":["facebook"],"str":"event cover"},"YouTubeChannelArt":{"filters":["youtube"]},"TwitchBanner":{"filters":["twitch"]},"TwitterHeader":{"filters":["twitter"],"str":"header"},"EtsyCover":{"filters":["etsy"]},"LinkedInProfileCover":{"filters":["linkedin"],"str":"profile"},"EventbriteEventImage":{"filters":["eventbrite"]},"iPhone":{"filters":["iphone"]},"Square":{},"3:2":{},"4:3":{},"16:9":{},"2:3":{},"3:1":{},"2:1":{},"1:2":{},"SparkVideoSlide":{},"SparkVideoSlideSquare":{},"KindleCover":{"filters":["kindle"]},"BlogPost":{"filters":["blog"]}}}')},3420:function(e,s){e.exports='<div class="search-results-ul-scroller" style="{{#scrollInnerHeight}}max-height:{{scrollInnerHeight}};{{/scrollInnerHeight}}">\n<ul class="search-results-ul show-group-lines">\n{{#selectedTags}}\n<div class="search-result-group-line search-result-group-line-tags search-result-group-line-tags-{{id}}" data-id="{{id}}"><div class="tags-label-and-clear">{{npw-vb-search-box-section-filters}}\n    {{#numSelected}}\n    <button class="search-box-filters-clear-all enabled" title="{{npw-vb-search-box-section-filters-clear-title}}">{{npw-vb-search-box-section-filters-clear}}</button>\n    {{/numSelected}}\n    {{^numSelected}}\n    <button class="search-box-filters-clear-all"  title="{{npw-vb-search-box-section-filters-clear-title}}" disabled>{{npw-vb-search-box-section-filters-clear}}</button>\n    {{/numSelected}}\n    </div>\n<div class="search-result-group-line-tags-tags{{#atMaxTags}} at-max-tags{{/atMaxTags}}">\n{{#items}}\n    <button tabindex="-1" class="search-result-group-line-tag search-results-selected-tag search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}}{{#ifShowingAll}} if-showing-all{{/ifShowingAll}} search-result-group-line-tag-tag-{{id}}{{#customFilterType}} ignore-at-max-tags{{/customFilterType}} {{debugCssStr}}" title="{{itemTitle}}" data-id="{{id}}" data-src-key="{{srcKey}}">{{label}}</button>\n{{/items}}\n{{#numMoreItems}}\n    <button tabindex="-1" class="search-result-group-line-tag search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}} search-result-group-line-tag-tag-{{id}} show-more-tags-btn {{debugCssStr}}" data-group-id="{{groupId}}" data-id="{{id}}" >...</button>\n{{/numMoreItems}}\n</div>\n</div>\n<div class="search-result-group-line search-result-group-line-rule"></div>\n{{/selectedTags}}\n{{#numResults}}\n{{#tagLines}}\n    <li class="search-result-result-line search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n{{/tagLines}}\n{{#hasTextOrSuggestionLines}}\n<li class="search-result-group-line-tags-label">{{npw-vb-search-box-section-searching-for}}</li>\n{{#hasTextLines}}\n    {{#textLines}}\n    <li class="search-result-result-line search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n    {{/textLines}}\n{{/hasTextLines}}\n{{#hasSuggestionLines}}\n    {{#suggestionLines}}\n    <li class="search-result-search-suggest-line no-indent search-result-search-suggest-line-user-text search-result-line-can-arrow-nav" data-tags="{{tags}}" data-keywords="{{keywords}}">{{> lineLabels}}</li>\n    {{/suggestionLines}}\n{{/hasSuggestionLines}}\n{{/hasTextOrSuggestionLines}}\n<div class="search-result-group-line search-result-group-line-rule"></div>\n{{#tagLinesGroups}}\n<li class="search-result-group-line-tags-label">{{npw-vb-search-box-section-related}}</li>\n{{#items}}\n    <li class="search-result-group-line-tag {{#isAddText}} search-add-text-tag{{/isAddText}}{{^ifShowingAll}} search-result-line-can-arrow-nav{{/ifShowingAll}}{{#ifShowingAll}} if-showing-all{{/ifShowingAll}} search-results-tag-button search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}}{{#selected}} selected{{/selected}} search-result-group-line-tag-tag-{{id}} {{debugCssStr}}" title="{{itemTitle}}" data-group-id="{{groupId}}" data-text="{{label}}" data-id="{{id}}" data-src-key="{{srcKey}}">&mldr; {{label}}</li>\n{{/items}}\n{{#numMoreItems}}\n    <li class="search-result-group-line-tag search-results-tag-button search-result-line-can-arrow-nav search-result-colored-tag search-result-colored-tag-{{prefix}} search-result-group-line-tag-{{prefix}} search-result-group-line-tag-tag-{{id}} show-more-tags-btn{{#isAddText}} search-add-text-tag{{/isAddText}} {{debugCssStr}}" data-group-id="{{groupId}}" data-id="{{id}}" data-src-key="{{srcKey}}">{{npw-vb-search-results-related-more}}</li>\n{{/numMoreItems}}\n{{/tagLinesGroups}}\n{{/numResults}}\n{{^numResults}}\n{{#fromNoResults}}\n{{^isLearn}}\n{{^selectedTags.numSelected}}\n<div class="search-result-group-line search-result-no-results-line">{{npw-vb-search-box-section-sorry}}</div>\n{{/selectedTags.numSelected}}\n{{#selectedTags.numSelected}}\n<div class="search-result-group-line search-result-no-results-line">{{npw-vb-search-box-section-sorry-filters}}</div>\n{{/selectedTags.numSelected}}\n{{/isLearn}}\n{{/fromNoResults}}\n{{#historySearches}}\n<div class="search-result-group-line">{{historyLabel}}</div>\n{{#historySubLabel}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-history">{{historySubLabel}}</li>\n{{/historySubLabel}}\n{{#searches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-history search-result-line-can-arrow-nav" data-app="{{app}}" data-label="{{label}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{label}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label-{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/searches}}\n{{/historySearches}}\n{{#popularSearches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-use-cases" data-term="{{term}}">{{term}}</li>\n{{/popularSearches}}\n{{/numResults}}\n{{#showPopular}}\n<div class="search-result-group-line">{{npw-vb-search-box-section-popular}}</div>\n{{#searches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-search search-result-line-can-arrow-nav{{#commandType}} is-command{{/commandType}}" data-app="{{app}}" data-command-type="{{commandType}}" data-label="{{label}}" data-src-label="{{srcLabel}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{label}}{{#translation}}<span class="search-result-line-popular-translation">&nbsp;({{.}})</span>{{/translation}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/searches}}\n{{/showPopular}}\n{{#showCategorySearches}}\n<div class="search-result-group-line">{{npw-vb-search-box-section-categories}}</div>\n{{#categorySearches}}\n<li class="search-result-search-suggest-line search-result-search-suggest-line-popular-category search-result-line-can-arrow-nav{{#commandType}} is-command{{/commandType}}" data-app="{{app}}" data-command-type="{{commandType}}" data-label="{{label}}" data-keywords="{{keywords}}" data-tags="{{tags}}">{{labelG11n}}{{#appLabel}}<span class="search-result-line-app-label search-result-line-app-label{{app}}">&nbsp;({{.}})</span>{{/appLabel}}</li>\n{{/categorySearches}}\n{{/showCategorySearches}}\n\n</ul>\n</div>\n'},3421:function(e,s){e.exports='{{#displayArray}}<span class="search-result-line-span-tag search-result-colored-tag-{{prefix}} {{debugCssStr}}" title="{{#debugCssStr}}{{tag}}{{/debugCssStr}}">{{#chunks}}{{#src}}<span class="search-result-result-line-span-src">{{{.}}}</span>{{/src}}{{#hint}}<span class="search-result-result-line-span-hint">{{{.}}}</span>{{/hint}}{{{space}}}{{/chunks}}</span>{{/displayArray}}{{#showAnyCounts}}{{#totalCount}}<span class="search-result-result-line-span-count search-app-color-all"> ({{totalCount}})</span>{{/totalCount}}{{/showAnyCounts}}'},3422:function(e,s,t){(e.exports=t(188)(!1)).push([e.i,'@-webkit-keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes appear{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeTo{0%{opacity:0}to{opacity:.1}}@keyframes fadeTo{0%{opacity:0}to{opacity:.1}}.search-app-color-all{color:#3e3f41}.search-results-grid-item-thumb-premium-icon{display:none;background-image:url(/images/icon-premium-template-badge.svg);width:20px;height:27px;background-repeat:no-repeat;background-size:contain;position:absolute;right:4px;top:-4px}.search-results-grid-item-thumb-premium-icon.show-premium-user-badge-shield-dark{width:24px;height:33px;background-image:url(/images/icon-premium-user-premium-badge-shield-dark.svg)}.search-results-grid-item-thumb-premium-icon.show-premium-user-badge-shield-light{width:24px;height:33px;background-image:url(/images/icon-premium-user-premium-badge-shield-light.svg)}.search-results-grid-view-holder{display:block;left:0;position:relative;width:100%;height:calc(100vh - 112px);padding:0 0 10px;z-index:1;background-color:#fff;opacity:1}.search-results-grid-view-holder.search-view-in-container{height:calc(100% - 72px);top:72px;position:absolute;background-color:inherit}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder{z-index:1}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header{z-index:1;top:-32px;width:100%}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas{display:none}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-create{left:auto;right:0;top:-57px;-webkit-transform:none;transform:none;right:16px}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow{top:-40px;position:relative;height:100%;width:50px;background-color:transparent;background-position:0;background-image:url(/images/spectrum-back-arrow-valley.svg);background-repeat:no-repeat;background-size:18px;margin-left:34px;cursor:pointer}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow:hover{background-image:url(/images/spectrum-back-arrow-midnight.svg)}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow.has-text{padding-left:30px;line-height:66px;text-transform:uppercase;width:auto;font-weight:700;font-size:12px;color:#808990;transition:color .2s ease-in-out}.search-results-grid-view-holder.search-view-in-container .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .npw-visual-browse-header-back-arrow.has-text:hover{color:#3e3f41}.search-results-grid-view-holder .search-results-grid-view{position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);height:100%;width:100%;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center}.search-results-grid-view-holder .search-results-grid-view .search-results-tags{width:100%;text-align:center;padding:12px 24px 24px;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;align-items:flex-start;-webkit-justify-content:center;justify-content:center;-webkit-flex-wrap:wrap;flex-wrap:wrap}.search-results-grid-view-holder .search-results-grid-view .search-results-tags.at-max-tags .search-results-tag:not(.selected):not(.search-results-tag-tag-premium){background-color:#f4f5f5;opacity:.5}.search-results-grid-view-holder .search-results-grid-view .search-results-pagination{color:#3e3f41;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;font-weight:500;text-align:center;-webkit-align-items:center;align-items:center;height:100px;overflow-y:hidden}.search-results-grid-view-holder .search-results-grid-view .search-results-pagination .search-results-pagination-more{margin-top:12px}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item .search-results-grid-item-thumb-icon{display:none}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-page .search-results-grid-item-thumb-icon{width:100%;height:35px;left:0;bottom:0;display:block;background-image:url(/images/npw/visualBrowse/thumb-icon-page-footer35.svg);position:absolute;background-repeat:no-repeat;background-size:contain;background-color:#fff;background-position:50%}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-page .search-results-grid-item-thumb-icon.non-expandable{height:25px;background-size:cover}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-post .search-results-grid-item-thumb-animation-icon{width:20px;height:20px;left:8px;bottom:8px;display:block;background-image:url(/images/thumb-icon-post-animated.svg);position:absolute;background-repeat:no-repeat;background-size:contain;background-position:50%;transition:opacity .2s ease-in-out;opacity:1}.search-results-grid-view-holder .search-results-grid-view .search-results-grid-item.search-results-grid-item-post .search-results-grid-item-thumb-animation-icon.non-expandable{height:25px;width:25px;background-size:cover}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item .search-results-grid-item-thumb-favorite-icon{background-repeat:no-repeat;background-position:0;background-size:contain;background-image:url(/images/npw/visualBrowse/icon-heart-empty.svg);width:24px;height:24px;position:absolute;top:3px;right:3px;opacity:0;display:block;cursor:pointer;transition:opacity .2s ease-in-out;z-index:2}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-favorite-icon:hover,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item .search-results-grid-item-thumb-favorite-icon:hover{background-image:url(/images/npw/visualBrowse/icon-heart-empty-no-background-hover.svg)}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.is-favorite .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.is-favorite .search-results-grid-item-thumb-favorite-icon{background-image:url(/images/npw/visualBrowse/icon-heart-solid-with-border.svg);opacity:1}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.is-favorite .search-results-grid-item-thumb-favorite-icon:hover,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.is-favorite .search-results-grid-item-thumb-favorite-icon:hover{background-image:url(/images/npw/visualBrowse/icon-heart-solid-no-border.svg)}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon{opacity:0}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item:not(.is-favorite):hover .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item:not(.is-favorite):hover .search-results-grid-item-thumb-favorite-icon{opacity:1}.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item-detail-other-results-item.expand:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon,.search-results-grid-view-holder .search-results-grid-view.favorites-enabled .search-results-grid-item.expand:not(.is-favorite) .search-results-grid-item-thumb-favorite-icon{display:block}.search-results-grid-view-holder .search-results-grid-holder{overflow-y:auto;overflow-x:hidden;width:100%;padding:0 12px}.search-results-grid-view-holder .search-results-grid-holder:hover{overflow-y:auto;overflow-x:hidden}.search-results-grid-view-holder .search-results-grid-item-detail-holder{top:60px;height:calc(100vh - 175px);min-height:240px;width:100%;position:absolute;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;transition:opacity .2s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder.revealing{opacity:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .share-results-share-button{cursor:pointer;color:#3e3f41;background-color:#fff;margin-top:12px;border-radius:16px;padding:8px;width:100%;text-align:center;opacity:1;font-weight:700;font-size:14px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .share-results-share-button:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-overlay-bg{z-index:105;position:fixed;left:0;top:-120px;width:101vw;height:110vh;background-color:rgba(0,0,0,.5)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal{display:block;padding:0 10%;overflow:hidden}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg{overflow:hidden;background-color:#fff;border-radius:6px;-webkit-transform:translateY(75%);transform:translateY(75%);padding:16px 5px 0;color:#808990;margin:0 auto;max-width:240px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg.field-view{max-width:300px;padding-bottom:24px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .x-close-btn{position:absolute;right:8px;top:8px;background-image:url(/images/close_active.svg);background-color:transparent;background-repeat:no-repeat;background-size:contain;background-position:50%;width:16px;height:16px;border:none;cursor:pointer;color:transparent}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .x-close-btn:hover{background-image:url(/images/close_hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-header{background-color:#e8ebed;border-top-left-radius:6px;border-top-right-radius:6px;padding:6px 16px 5px;margin:-16px -5px 8px;font-size:15x;font-weight:700;height:30px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-title{color:#3e3f41;margin-bottom:10px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea{width:100%;resize:none;height:38px;border:1px solid #e1e1e1;border-radius:6px;padding:8px;box-sizing:border-box;color:#3e3f41}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea.embed{height:80px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea.textarea-edit-display{text-overflow:clip}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea:active,.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-field-view .social-modal-field-textarea:focus{border:1px solid #1473e6;outline:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu.hide{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line{font-weight:700;padding:11px 16px 12px 46px;background-repeat:no-repeat;background-position:13px;background-size:22px;border-radius:6px;cursor:pointer;opacity:.75;line-height:normal;margin-bottom:8px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line:hover{background-color:#dce0e3;color:#3e3f41;opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.twitter{background-size:24px;background-image:url(/images/icon-social-twitter.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.facebook{background-image:url(/images/icon-social-facebook.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.embed{background-image:url(/images/icon-social-embed-sp.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy{background-image:url(/images/icon-social-copy.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy span{font-size:inherit;font-weight:inherit}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy span.copied-span{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover{background-color:#808990;color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover.copied span.copied-span{display:inline-block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.copy:hover.copied span.copy-span{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.message{background-image:url(/images/icon-social-message.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .social-modal .social-modal-bg .social-modal-menu .social-line.email{background-image:url(/images/icon-social-email.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right{position:relative;width:25%;height:100%;background:#3e3f41;padding:24px 12px;display:none;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:space-between;justify-content:space-between}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-ctas .search-results-grid-item-detail-right-cta{font-size:14px;font-weight:700;color:#fff;border-radius:16px;background-color:#1473e6;padding:8px;text-align:center;width:100%;cursor:pointer;opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-ctas .search-results-grid-item-detail-right-cta:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-tags{display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-right .search-results-grid-item-detail-right-tags .search-results-grid-item-detail-right-tag{padding:4px 8px;font-size:13px;margin:4px 4px 0 0;border-radius:18px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header{position:fixed;width:100vw;height:66px;top:-113px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-create{background-color:#1473e6;color:#fff;font-size:15px;font-weight:700;border-radius:20px;width:auto;padding:0 20px;height:40px;line-height:40px;position:fixed;top:-100px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas{display:-webkit-flex;display:flex;position:absolute;top:20px;right:32px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta{cursor:pointer;color:#3e3f41;font-size:14px;font-weight:700;height:32px;line-height:30px;border:1px solid #fff;border-radius:20px;padding:0 8px 0 26px;background-position:4px;background-repeat:no-repeat;opacity:1;transition:opacity .1s ease-in-out,background-color .1s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta span{font-weight:inherit;font-size:inherit;color:inherit}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-share{background-image:url(/images/spectrum-share-midnight.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite{width:134px;text-align:left;padding-left:30px;background-image:url(/images/npw/visualBrowse/icon-heart-empty-with-background.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite .search-results-grid-item-detail-header-cta-favorite-is-not{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite .search-results-grid-item-detail-header-cta-favorite-is{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite{background-image:url(/images/npw/visualBrowse/icon-heart-solid-no-border.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite .search-results-grid-item-detail-header-cta-favorite-is-not{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta.search-results-grid-item-detail-header-cta-favorite.is-favorite .search-results-grid-item-detail-header-cta-favorite-is{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-header .search-results-grid-item-detail-header-ctas .search-results-grid-item-detail-header-cta:hover{opacity:.8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail{background-color:#fff;width:100%;height:100%;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller-holder{height:25%;background-color:#fff;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller{width:100%;height:100%;overflow-y:hidden;overflow-x:scroll}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section{width:auto;height:100%;display:-webkit-flex;display:flex;-webkit-align-items:flex-start;align-items:flex-start}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item{margin:0 4px;height:100%;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item:first-child{margin-left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item:last-child{margin-right:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-thumb{height:calc(100% - 5px);background-repeat:no-repeat;background-size:contain;background-position:50%;position:relative;opacity:.5;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-thumb .search-results-grid-item-detail-other-results-item-thumb-loader{left:2px;top:2px;width:calc(100% - 4px);height:calc(100% - 4px);position:absolute}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item .search-results-grid-item-detail-other-results-item-selection{position:absolute;bottom:0;background-color:transparent;width:100%;height:3px;margin-top:2px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item.selected .search-results-grid-item-detail-other-results-item-selection{display:block;background-color:#1473e6}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-other-results-section-scroller .search-results-grid-item-detail-other-results-section .search-results-grid-item-detail-other-results-item.selected .search-results-grid-item-detail-other-results-item-thumb{width:calc(100% - 4px);height:calc(100% - 4px);opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section{width:100%;height:75%;min-height:160px;display:-webkit-flex;display:flex;background-color:#f4f5f5}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{position:relative;width:100%;max-width:calc(100% - 100px);height:100%}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{margin:8px 0 0;height:40px;-webkit-justify-content:left;justify-content:left;overflow-x:auto;overflow-y:hidden;position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder{height:100%;width:auto;position:relative}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading{position:absolute;background-repeat:no-repeat;background-size:contain;background-position:50%;width:100%;height:100%}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation.search-results-grid-item-detail-image,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-image,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-image{z-index:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation.search-results-grid-item-detail-animation,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-animation,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-animation{z-index:2}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-nav{width:50px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav{position:relative;top:0;background-repeat:no-repeat;width:75px;height:calc(100% - (3vh + 36px));z-index:1;pointer-events:none;opacity:.5;background-color:transparent}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav .search-results-grid-item-detail-nav-icon{background-size:24px;background-repeat:no-repeat;height:100%;width:32px;position:absolute;pointer-events:auto;top:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left{left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon{right:0;background-position:100%;background-image:url(/images/caret-left.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon:hover{background-image:url(/images/caret-left-hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right{right:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon{left:0;background-position:0;background-image:url(/images/caret-right.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon:hover{background-image:url(/images/caret-right-hover.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail.can-nav .search-results-grid-item-detail-nav{opacity:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail-right{display:-webkit-flex;display:flex}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail{width:75%}.search-results-grid-view-holder .search-results-grid-item-detail-holder.show-right-rail .search-results-grid-item-detail-header{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder{z-index:2;top:-47px;height:calc(100% + 47px)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section{width:100%;height:calc(82vh - 66px);padding-top:5vh}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;margin:3vh 0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags .search-results-tag-button{padding:0 10px;margin:0 3px;border:1px solid #c5ccd0;height:28px;line-height:25px;opacity:1;font-weight:500;transition:opacity .1s ease-in-out,background-color .1s ease-in-out}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags .search-results-tag-button:hover{background-color:#f8f8f8}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-detail-other-results-section-scroller-holder{height:18vh;padding-top:1.75vh}.search-results-grid-view-holder .search-results-grid{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center;padding-bottom:66px;width:100%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);position:relative}.search-results-grid-view-holder .search-results-grid .search-results-grid-row{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:space-between;justify-content:space-between;width:100%;margin-top:20px}.search-results-grid-view-holder .search-results-grid .search-results-grid-row:first-child{margin-top:0}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row{-webkit-justify-content:flex-start;justify-content:flex-start}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow{-webkit-justify-content:space-between;justify-content:space-between}.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow:after,.search-results-grid-view-holder .search-results-grid .search-results-grid-row.partial-row-narrow:before{content:"";display:block}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item{position:relative;text-decoration:none;color:#3e3f41;cursor:default}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:hover{color:#000}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:1}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item:last-child{margin-right:0}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-thumb{background-size:contain;background-repeat:no-repeat;background-position:50%;z-index:1;position:relative;opacity:1;transition:opacity .3s ease-in-out,-webkit-transform .3s ease-in-out;transition:opacity .3s ease-in-out,transform .3s ease-in-out;transition:opacity .3s ease-in-out,transform .3s ease-in-out,-webkit-transform .3s ease-in-out;-webkit-transform:scale(1);transform:scale(1)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label{font-size:15px;font-weight:600;color:inherit;text-decoration:none;margin-top:6px}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label:first-letter{text-transform:uppercase}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-label:not(.debug-tagging){display:none}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item .search-results-grid-item-thumb-bg-load{position:absolute;top:1px;left:1px;z-index:-1;background-color:#f4f5f5;width:calc(100% - 2px);height:calc(100% - 2px)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item.not-loaded .search-results-grid-item-thumb{opacity:0;-webkit-transform:scale(.8);transform:scale(.8)}.search-results-grid-view-holder .search-results-grid .search-results-grid-row .search-results-grid-item.had-load-error{display:none}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang{opacity:0;width:100%;height:100%;position:absolute;top:0;left:0;transition:opacity .3s ease-in-out .1s}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang.is-IE,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang.is-IE,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang.is-edge,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang.is-IE{transition-delay:0s}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background{width:100%;height:100%;background-color:rgba(0,0,0,.7);position:absolute;top:0;left:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-main-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-main-cta,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-main-cta{height:30px;width:auto;color:#fff;border:2px solid #fff;font-size:15px;font-weight:700;line-height:25px;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);border-radius:15px;padding:0 12px;white-space:nowrap;background-color:rgba(0,0,0,.25);transition:color .2s ease-in-out,background-color .2s ease-in-out;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-main-cta:hover{background-color:#fff;color:#3e3f41}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas{z-index:1;width:100%;position:absolute;top:0;left:0;display:-webkit-flex;display:flex;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-flex-wrap:wrap;flex-wrap:wrap;padding:2px 26px 0 4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta{border-radius:16px;font-size:12px;font-weight:500;color:#3e3f41;padding:4px 6px;margin:3px;background-repeat:no-repeat;background-size:contain;width:22px;height:22px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta.search-results-grid-item-hover-cta-detail{background-image:url(/images/spectrum-magnify-white.svg)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-ctas .search-results-grid-item-hover-cta:hover{opacity:.85}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags{z-index:1;width:100%;position:absolute;bottom:0;left:0;height:auto;display:none;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-justify-content:flex-start;justify-content:flex-start;padding-bottom:4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags.debug-tagging{display:-webkit-flex;display:flex;max-height:100%;overflow:hidden auto}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag{font-size:10px;border-radius:16px;padding:4px 6px;margin:3px;height:20px;background-color:hsla(0,0%,100%,.8)}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-score,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-score{background-color:rgba(126,13,13,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-id,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-id{background-color:rgba(13,13,126,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-holder .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-id.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-score.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-size.search-results-grid-item-hover-size,.search-results-grid-view-holder .search-results-grid-item .search-results-grid-item-hover-thang .search-results-grid-item-hover-tags .search-results-grid-item-hover-tag.search-results-grid-item-hover-size{background-color:rgba(13,126,13,.8);color:#fff}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template .search-results-grid-item-thumb-premium-icon{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template.search-results-grid-item-detail-other-results-item .search-results-grid-item-thumb-premium-icon{display:block;z-index:1;top:-1px;width:16px;background-position:top}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.is-premium-template.search-results-grid-item-detail-holder.search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-thumb-premium-icon{display:block}.search-results-grid-view-holder .search-results-grid-item-detail-holder.is-premium-template .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.is-premium-template .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.is-premium-template .search-results-grid-item-hover-thang{height:calc(100% + 4px);top:-4px}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta{outline:3px solid transparent;transition:outline .2s ease-in-out .1s;cursor:pointer}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta.is-IE,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta.is-IE,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta.is-edge,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta.is-IE{transition-delay:0s}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-thumb-premium-icon{z-index:1}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang{border:1px solid #1a1a1a;height:100%;top:0}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta .search-results-grid-item-hover-thang .search-results-grid-item-hover-thang-background{background-color:transparent}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded),.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded){outline:2px solid #1a1a1a}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded):focus,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded):focus{outline:2px solid #1473e6}.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-holder.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item-detail-other-results-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:focus:not(.not-loaded) .search-results-grid-item-hover-thang,.search-results-grid-view-holder .search-results-grid-item.search-results-grid-item.implicit-create-cta:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:1}.search-results-grid-view-holder .search-results-grid-holder .search-results-grid-row.hide-assets .search-results-grid-item:hover:not(.not-loaded) .search-results-grid-item-hover-thang{opacity:0}.search-results-grid-view-holder .search-results-grid-holder .search-results-grid-row.hide-assets .search-results-grid-item .search-results-grid-item-thumb{opacity:0;-webkit-transform:scale(.8);transform:scale(.8)}.search-results-grid-view-holder .search-results-grid-holder .search-results-grid-row .search-results-grid-item-post:hover .search-results-grid-item-thumb-animation-icon{opacity:0}.search-results-tag-button{font-size:15px;padding:8px 12px;margin:9px 6px 0 0;color:#1a1a1a;border:1px solid #c5ccd0;cursor:pointer;background-color:#fff;border-radius:18px;font-weight:500;height:30px;line-height:10px;-webkit-flex-shrink:0;flex-shrink:0;box-sizing:border-box;background-color:transparent}.search-results-tag-button:hover{background-color:#f8f8f8}.search-results-tag-button.selected{border:1px solid transparent;color:#fff;background-color:#1a1a1a}.search-results-tag-button.if-showing-all{display:none}.search-results-tag-button.debug-tagging.search-results-tag-prefix-categories,.search-results-tag-button.debug-tagging.search-results-tag-prefix-explore{color:red}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spcase,.search-results-tag-button.debug-tagging.search-results-tag-prefix-tasks{color:blue}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spterm,.search-results-tag-button.debug-tagging.search-results-tag-prefix-topics{color:orange}.search-results-tag-button.debug-tagging.search-results-tag-prefix-colors,.search-results-tag-button.debug-tagging.search-results-tag-prefix-spcolor{color:#000}.search-results-tag-button.debug-tagging.search-results-tag-prefix-multi{color:green}.search-results-tag-button.debug-tagging.search-results-tag-prefix-spstyle,.search-results-tag-button.debug-tagging.search-results-tag-prefix-styles{color:#fe0}.search-results-tag-button.debug-tagging.selected{background-color:#1a1a1a}.search-view{color:#fff;height:66vh;min-height:400px}.search-view .search-overlay{display:block;position:fixed;left:0;top:0;width:100%;height:100%;opacity:.1;background-color:#000;z-index:1}.search-view .search-input,.search-view .search-input-disabled{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.search-view .search-top-container{position:relative;top:0;width:100%;height:inherit;min-height:400px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center;-ms-grid-column-align:center;justify-items:center;padding-top:120px}.search-view .search-top-container .search-bar{padding-top:46px;font-size:0;z-index:1;position:relative;max-width:90vw}.search-view .search-top-container .search-bar .search-input-holder{position:relative}.search-view .search-top-container .search-bar .search-input,.search-view .search-top-container .search-bar .search-input-disabled{margin:0 auto;height:40px;width:500px;max-width:90vw;border-radius:4px;font-size:15px;line-height:23px;padding:0 30px 1px 40px;text-overflow:ellipsis;color:#3e3f41;caret-color:#1473e6;background-color:#fff;position:relative;font-weight:500;transition:border-color .2s ease-in-out;border-radius:24px}.search-view .search-top-container .search-bar .search-input-disabled:active,.search-view .search-top-container .search-bar .search-input-disabled:focus,.search-view .search-top-container .search-bar .search-input:active,.search-view .search-top-container .search-bar .search-input:focus{outline:none;border:1px solid #1473e6}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::-webkit-input-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::-webkit-input-placeholder{color:#808990}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::-moz-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::-moz-placeholder{color:#808990}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled:-ms-input-placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input:-ms-input-placeholder{color:#808990}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input-disabled::placeholder,.search-view .search-top-container .search-bar .search-input.search-input-disabled,.search-view .search-top-container .search-bar .search-input::placeholder{color:#808990}.search-view .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view .search-top-container .search-bar .search-input.search-input-disabled{line-height:38px;text-align:left;font-style:italic}.search-view .search-top-container .search-bar .search-input-disabled::-ms-clear,.search-view .search-top-container .search-bar .search-input::-ms-clear{display:none;width:0;height:0}.search-view .search-top-container .search-bar .search-button,.search-view .search-top-container .search-bar .search-clear{position:absolute;height:32px;width:30px;top:4px;background-position:50%;background-repeat:no-repeat;background-color:#fff;z-index:2;cursor:pointer;opacity:.7;transition:opacity .02s ease-in-out}.search-view .search-top-container .search-bar .search-button.search-clear,.search-view .search-top-container .search-bar .search-clear.search-clear{background-image:url(/images/search/search-clear-x-midnight.svg);right:4px;border-top-right-radius:24px;border-bottom-right-radius:24px;background-size:14px}.search-view .search-top-container .search-bar .search-button.search-button,.search-view .search-top-container .search-bar .search-clear.search-button{background-image:url(/images/search/search.svg);left:8px;border-top-left-radius:24px;border-bottom-left-radius:24px;background-size:18px;opacity:.7;transition:opacity .2s ease-in-out}.search-view .search-top-container .search-bar .search-button.search-button:not(.searching).active,.search-view .search-top-container .search-bar .search-button:not(.searching):hover,.search-view .search-top-container .search-bar .search-clear.search-button:not(.searching).active,.search-view .search-top-container .search-bar .search-clear:not(.searching):hover{opacity:1}.search-view .search-top-container .search-bar .search-button:not(.searching):hover.active,.search-view .search-top-container .search-bar .search-clear:not(.searching):hover.active{opacity:.7}.search-view .search-top-container .search-bar .search-button.disabled,.search-view .search-top-container .search-bar .search-clear.disabled{cursor:default;opacity:0}.search-view .search-top-container .search-bar .search-button.disabled:hover,.search-view .search-top-container .search-bar .search-clear.disabled:hover{opacity:0}.search-view .search-top-container .search-bar .search-button.disabled.search-clear,.search-view .search-top-container .search-bar .search-clear.disabled.search-clear{display:none}.search-view.search-view-in-container{height:100%;width:100%}.search-view.search-view-in-container .search-top-container{padding:16px;position:absolute;top:0}.search-view.search-view-in-container .search-top-container .search-bg-underlay{display:none;position:absolute;width:100vw;height:100vh;top:0;right:0;z-index:-1;background-color:rgba(0,0,0,.4)}.search-view.search-view-in-container .search-top-container .search-bg-underlay.showing{display:block}.search-view.search-view-in-container .search-top-container .search-bar{padding-top:0;max-width:500px;width:100%}.search-view.search-view-in-container .search-top-container .search-bar .search-results{width:100%;margin-top:0;box-shadow:0 0 20px #00000029}.search-view.search-view-in-container .search-top-container .search-bar .search-results .earch-results-pagination{color:#fff}.search-view.search-view-in-container .search-top-container .search-bar .search-input,.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled{width:100%;box-shadow:none;border:1px solid #dce0e3;transition:border-color .2s ease-in-out}.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled:active,.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled:focus,.search-view.search-view-in-container .search-top-container .search-bar .search-input:active,.search-view.search-view-in-container .search-top-container .search-bar .search-input:focus{outline:none;border:1px solid #1473e6}.search-view.search-view-in-container .search-top-container .search-bar .search-input-disabled.search-input-disabled,.search-view.search-view-in-container .search-top-container .search-bar .search-input.search-input-disabled{text-align:left;line-height:38px}.search-view .search-results{position:absolute;display:block;background-color:#fff;max-height:500px;width:500px;max-width:90vw;margin:0 auto;color:#1a1a1a;font-size:15px;font-weight:400;z-index:1;box-shadow:0 0 20px #00000029;border-radius:10px;top:56px;margin-top:56px;overflow-y:hidden;padding-top:12px;padding-bottom:12px}.search-view .search-results .search-results-ul-scroller{max-height:inherit;overflow-y:auto}.search-view .search-results ul{margin:7px 0}.search-view .search-results ul div.search-result-group-line,.search-view .search-results ul li{display:block;text-align:left;padding:4px 16px 6px;font-weight:400;font-size:14px;line-height:18px;cursor:default}.search-view .search-results ul div.search-result-group-line.if-showing-all:not(.show-more-tags-tags),.search-view .search-results ul div.search-result-group-line.is-more-tags-tag:not(.show-more-tags-tags),.search-view .search-results ul li.if-showing-all:not(.show-more-tags-tags),.search-view .search-results ul li.is-more-tags-tag:not(.show-more-tags-tags){display:none}.search-view .search-results ul div.search-result-group-line.search-result-result-line,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line,.search-view .search-results ul li.search-result-result-line,.search-view .search-results ul li.search-result-search-suggest-line{cursor:pointer;margin-left:21px;margin-right:21px;border-radius:40px}.search-view .search-results ul div.search-result-group-line.search-result-result-line.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line.selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line:hover,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line:hover,.search-view .search-results ul li.search-result-result-line.arrow-selected,.search-view .search-results ul li.search-result-result-line.selected,.search-view .search-results ul li.search-result-result-line:hover,.search-view .search-results ul li.search-result-search-suggest-line.arrow-selected,.search-view .search-results ul li.search-result-search-suggest-line.selected,.search-view .search-results ul li.search-result-search-suggest-line:hover{background-color:#e8ebed}.search-view .search-results ul div.search-result-group-line.search-result-result-line:not(.search-result-line-can-arrow-nav),.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line:not(.search-result-line-can-arrow-nav),.search-view .search-results ul li.search-result-result-line:not(.search-result-line-can-arrow-nav),.search-view .search-results ul li.search-result-search-suggest-line:not(.search-result-line-can-arrow-nav){cursor:default}.search-view .search-results ul div.search-result-group-line.search-result-result-line:not(.search-result-line-can-arrow-nav):hover,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line:not(.search-result-line-can-arrow-nav):hover,.search-view .search-results ul li.search-result-result-line:not(.search-result-line-can-arrow-nav):hover,.search-view .search-results ul li.search-result-search-suggest-line:not(.search-result-line-can-arrow-nav):hover{background-color:inherit}.search-view .search-results ul div.search-result-group-line.search-result-result-line .search-result-line-app-label,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line .search-result-line-app-label,.search-view .search-results ul li.search-result-result-line .search-result-line-app-label,.search-view .search-results ul li.search-result-search-suggest-line .search-result-line-app-label{font-size:13px;text-transform:uppercase;line-height:16px}.search-view .search-results ul div.search-result-group-line.search-result-result-line .search-result-line-popular-translation,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line .search-result-line-popular-translation,.search-view .search-results ul li.search-result-result-line .search-result-line-popular-translation,.search-view .search-results ul li.search-result-search-suggest-line .search-result-line-popular-translation{font-style:italic}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases{color:#1473e6;padding-left:32px}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases:hover,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases:hover{background-color:#f4f5f5;color:#1473e6;cursor:pointer}.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-result-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul li.search-result-result-line.search-result-search-suggest-line-popular-use-cases.selected,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.arrow-selected,.search-view .search-results ul li.search-result-search-suggest-line.search-result-search-suggest-line-popular-use-cases.selected{background-color:#f4f5f5;color:#1473e6}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line,.search-view .search-results ul div.search-result-group-line.search-result-group-line,.search-view .search-results ul li.search-result-create-one-line,.search-view .search-results ul li.search-result-group-line{font-size:14px;font-weight:500;color:#808990;padding-left:24px}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line:not(.search-result-group-line),.search-view .search-results ul div.search-result-group-line.search-result-group-line:not(.search-result-group-line),.search-view .search-results ul li.search-result-create-one-line:not(.search-result-group-line),.search-view .search-results ul li.search-result-group-line:not(.search-result-group-line){display:none}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.search-result-group-line-rule,.search-view .search-results ul div.search-result-group-line.search-result-group-line.search-result-group-line-rule,.search-view .search-results ul li.search-result-create-one-line.search-result-group-line-rule,.search-view .search-results ul li.search-result-group-line.search-result-group-line-rule{padding:0;margin:8px 24px;width:calc(100% - 48px);opacity:.25;border-bottom:1px solid #808990}.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-create-one-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-group-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul div.search-result-group-line.search-result-group-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul li.search-result-create-one-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul li.search-result-create-one-line.show-all .search-results-tag-button.if-showing-all,.search-view .search-results ul li.search-result-group-line.show-all .search-result-group-line-tag.if-showing-all,.search-view .search-results ul li.search-result-group-line.show-all .search-results-tag-button.if-showing-all{display:block}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line,.search-view .search-results ul li.search-result-no-results-line{line-height:25px}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line .search-term-link,.search-view .search-results ul li.search-result-no-results-line .search-term-link{font-weight:500;cursor:pointer;opacity:.85}.search-view .search-results ul div.search-result-group-line.search-result-no-results-line .search-term-link:hover,.search-view .search-results ul li.search-result-no-results-line .search-term-link:hover{opacity:1}.search-view .search-results ul div.search-result-group-line.search-add-text-tag,.search-view .search-results ul li.search-add-text-tag{height:28px;padding:4px 8px 6px;border:none;margin:0 16px}.search-view .search-results ul div.search-result-group-line.search-add-text-tag.arrow-selected,.search-view .search-results ul div.search-result-group-line.search-add-text-tag:hover,.search-view .search-results ul li.search-add-text-tag.arrow-selected,.search-view .search-results ul li.search-add-text-tag:hover{background-color:#e8ebed}.search-view .search-results ul div.search-result-group-line.search-add-text-tag.show-more-tags-btn,.search-view .search-results ul li.search-add-text-tag.show-more-tags-btn{text-align:center;color:#808990}.search-view .search-results ul div.search-result-group-line span,.search-view .search-results ul li span{font-size:inherit;font-weight:inherit}.search-view .search-results ul div.search-result-group-line span:not(.search-result-result-line-span-count),.search-view .search-results ul li span:not(.search-result-result-line-span-count){color:inherit}.search-view .search-results ul div.search-result-group-line span.search-result-result-line-span-hint,.search-view .search-results ul li span.search-result-result-line-span-hint{font-weight:700}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-search-suggest-line:not(.no-indent),.search-view .search-results ul.show-group-lines li.search-result-search-suggest-line:not(.no-indent){padding-left:14px}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line-tags-label,.search-view .search-results ul.show-group-lines li.search-result-group-line-tags-label{color:#808990;font-weight:500;padding-left:22px}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line,.search-view .search-results ul.show-group-lines li.search-result-create-one-line,.search-view .search-results ul.show-group-lines li.search-result-group-line{display:block}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .tags-label-and-clear,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .tags-label-and-clear,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .tags-label-and-clear,.search-view .search-results ul.show-group-lines li.search-result-group-line .tags-label-and-clear{display:-webkit-flex;display:flex;-webkit-justify-content:space-between;justify-content:space-between;font-weight:inherit}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all{right:16px;color:#808990;font-weight:500;font-size:14px;opacity:.5;background-color:transparent}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all.enabled,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all.enabled{cursor:pointer;opacity:1}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-box-filters-clear-all.enabled:hover,.search-view .search-results ul.show-group-lines li.search-result-group-line .search-box-filters-clear-all.enabled:hover{color:#3e3f41}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line:first-letter,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line:first-letter,.search-view .search-results ul.show-group-lines li.search-result-create-one-line:first-letter,.search-view .search-results ul.show-group-lines li.search-result-group-line:first-letter{text-transform:uppercase}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.search-result-group-line-tags .search-result-group-line-tags-tags,.search-view .search-results ul.show-group-lines li.search-result-group-line.search-result-group-line-tags .search-result-group-line-tags-tags{margin-top:5px;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.if-showing-all,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.is-more-tags-tag{display:block}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines li.search-result-create-one-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn,.search-view .search-results ul.show-group-lines li.search-result-group-line.show-more-tags-tags .search-result-group-line-tags-tags .search-result-group-line-tag.show-more-tags-btn{display:none}.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-create-one-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.ignore-at-max-tags):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines div.search-result-group-line.search-result-group-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.ignore-at-max-tags):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines li.search-result-create-one-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.ignore-at-max-tags):not(.show-more-tags-btn),.search-view .search-results ul.show-group-lines li.search-result-group-line .search-result-group-line-tags-tags.at-max-tags .search-result-group-line-tag:not(.selected):not(.ignore-at-max-tags):not(.show-more-tags-btn){background-color:#f4f5f5;opacity:.5}.search-view .search-results ul.show-group-lines div.search-result-group-line .search-result-line-span-tag,.search-view .search-results ul.show-group-lines li .search-result-line-span-tag{display:inline-block}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-explore,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-explore{color:red}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spcase,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spcase{color:blue}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spterm,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spterm{color:orange}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-color,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-color{color:#000}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-multi,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-multi{color:green}.search-view .search-results ul.show-group-lines div.search-result-group-line .debug-tagging.search-result-colored-tag-spstyle,.search-view .search-results ul.show-group-lines li .debug-tagging.search-result-colored-tag-spstyle{color:#fe0}.search-view .search-overlay.overlay-showing{-webkit-animation-name:fadeTo;animation-name:fadeTo;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}.search-view .search-overlay.overlay-opaque{opacity:1;-webkit-animation-name:none;animation-name:none;background-color:#f4f5f5}.search-view.searching .search-results{-webkit-animation-name:appear;animation-name:appear;-webkit-animation-duration:.2s;animation-duration:.2s;-webkit-animation-timing-function:cubic-bezier(.22,.61,.36,1);animation-timing-function:cubic-bezier(.22,.61,.36,1);z-index:1}.search-view .search-bar.show-search-button .search-input,.search-view .search-bar.show-search-button .search-input-disabled{border-radius:4px 0 0 4px}.search-view .search-bar.show-search-button .search-results{-webkit-transform:translateX(-43px);transform:translateX(-43px)}.search-view.search-view-parent-height-control{height:auto;min-height:0}.search-view.search-view-parent-height-control .search-top-container{min-height:0;padding-top:0}.search-view.search-view-bar-only{min-height:66px;height:66px;padding:16px}.search-view.search-view-bar-only .search-top-container{min-height:66px}.search-view.search-view-bar-only .search-bar{width:100%;padding-top:0}.search-view.search-view-bar-only .search-welcome-text{display:none}.search-view.in-main-search-header{position:relative}.search-view.in-vb-search-header{padding-top:0;padding-bottom:120px;width:auto}.search-view.in-vb-search-header .search-top-container{padding-top:0}.search-view.in-vb-search-header.search-view-bar-only{padding-top:56px;padding-bottom:100px}.search-view.in-vb-search-header.search-view-fixed{position:fixed;top:0;left:50vw;max-width:calc(100vw - 466px);-webkit-transform:translateX(-50%);transform:translateX(-50%);padding:13px 0 0;z-index:2;width:500px}@media (max-width:840px){.search-view.in-vb-search-header.search-view-fixed{top:56px;max-width:90vw}}.search-view.in-vb-search-header.search-view-fixed .search-overlay{width:200vw;height:200vh;top:-100px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-overlay{background-color:#0b0f1d}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-overlay.overlay-opaque{background-color:#f4f5f5}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input-disabled{box-shadow:none;border:1px solid #dce0e3}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input-disabled:focus,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header .search-input:focus{background-color:#fff}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-input,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-input-disabled{border:1px solid #dce0e3;background-color:#fff}.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-button,.search-view.in-vb-search-header.search-view-fixed.search-view-in-header:not(.searching) .search-clear{background-color:#fff}body.showing-search-header-results-grid .mrvl-main-page{display:none}body.showing-search-header-results-grid .mrvl-header .mrvl-logo{z-index:105}body.showing-search-header-results-grid .mrvl-header .mrvl-logo-link:focus .mrvl-logo{outline:1px dotted #212121;outline:5px auto -webkit-focus-ring-color}body.showing-search-header-results-grid .mrvl-header .site-nav-upgrade{display:none}.search-in-main-header,.vb-search-header{height:66px}.search-in-main-header.vb-search-header,.vb-search-header.vb-search-header{position:fixed;top:0;left:0;width:100%;z-index:2000}.search-in-main-header .vb-search-header-background,.vb-search-header .vb-search-header-background{position:absolute;height:100%;width:100%;top:0;left:0;background-color:#fff;opacity:1;z-index:-1}.search-in-main-header .search-view .search-top-container,.vb-search-header .search-view .search-top-container{min-height:40px;height:40px}.search-in-main-header .search-view .search-top-container .search-bar .search-results,.vb-search-header .search-view .search-top-container .search-bar .search-results{width:100%;max-height:calc(100vh - 100px);margin-top:0}.search-in-main-header .search-view .search-top-container .search-bar .search-results .search-results-ul-scroller,.vb-search-header .search-view .search-top-container .search-bar .search-results .search-results-ul-scroller{max-height:calc(100vh - 100px - 24px)}.search-in-main-header .search-view .search-top-container .search-bar .search-input,.search-in-main-header .search-view .search-top-container .search-bar .search-input-disabled,.vb-search-header .search-view .search-top-container .search-bar .search-input,.vb-search-header .search-view .search-top-container .search-bar .search-input-disabled{height:40px;width:100%;opacity:1;background-position:left 12px center;background-size:18px;border-radius:20px;transition:border-color .2s ease-in-out}.search-in-main-header .search-view .search-top-container .search-bar .search-input-disabled:active,.search-in-main-header .search-view .search-top-container .search-bar .search-input-disabled:focus,.search-in-main-header .search-view .search-top-container .search-bar .search-input:active,.search-in-main-header .search-view .search-top-container .search-bar .search-input:focus,.vb-search-header .search-view .search-top-container .search-bar .search-input-disabled:active,.vb-search-header .search-view .search-top-container .search-bar .search-input-disabled:focus,.vb-search-header .search-view .search-top-container .search-bar .search-input:active,.vb-search-header .search-view .search-top-container .search-bar .search-input:focus{border:1px solid #1473e6;outline:none}.search-in-main-header .search-view .search-top-container .search-bar .search-button,.search-in-main-header .search-view .search-top-container .search-bar .search-clear,.vb-search-header .search-view .search-top-container .search-bar .search-button,.vb-search-header .search-view .search-top-container .search-bar .search-clear{height:32px}.search-in-main-header .search-header-logo-and-back,.vb-search-header .search-header-logo-and-back{height:66px}.search-in-main-header .search-header-logo-and-back .mrvl-logo-link:focus .mrvl-logo,.vb-search-header .search-header-logo-and-back .mrvl-logo-link:focus .mrvl-logo{outline:1px dotted #212121;outline:5px auto -webkit-focus-ring-color}.search-in-main-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow,.vb-search-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow{display:none}.search-in-main-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow.has-text,.vb-search-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow.has-text{display:block;cursor:pointer;height:100%;background-color:transparent;margin-left:90px;line-height:66px;text-transform:uppercase;width:auto;font-weight:700;font-size:12px;color:#808990;transition:color .2s ease-in-out}.search-in-main-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow.has-text:hover,.vb-search-header .search-header-logo-and-back .npw-visual-browse-header-back-arrow.has-text:hover{color:#3e3f41}.search-in-main-header .npw-visual-browser-header-favorites,.vb-search-header .npw-visual-browser-header-favorites{text-transform:uppercase;cursor:pointer;color:#3e3f41;font-size:14px;font-weight:700;height:32px;line-height:30px;border:1px solid #fff;border-radius:20px;padding:0 8px 0 26px;background-position:4px;background-repeat:no-repeat;background-image:url(/images/npw/visualBrowse/icon-heart-empty-with-background.svg);opacity:1;transition:opacity .1s ease-in-out,background-color .1s ease-in-out;position:absolute;right:280px;top:18px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown,.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer{position:absolute;min-width:160px;height:40px;line-height:23px;top:13px;right:36px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown-v-spacer,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown-v-spacer,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown-v-spacer{height:0;top:55px}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown{opacity:1}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider{background-color:transparent}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Underlay{height:100vh}.search-in-main-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.search-in-main-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.vb-search-header .npw-visual-browse-header-create-new-dropdown-v-spacer.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover,.vb-search-header .npw-visual-browse-header-create-new-dropdown.npw-visual-browse-header-create-new-dropdown .react-spectrum-provider .spectrum-Popover{-webkit-transform:translate(-40px,6px);transform:translate(-40px,6px)}.search-in-main-header.white,.vb-search-header.white{background-color:#fff}.search-in-main-header.short-header .in-vb-search-header,.search-in-main-header.short-header .npw-visual-browse-header-back-arrow,.search-in-main-header.short-header .npw-visual-browse-header-create-new-dropdown,.search-in-main-header.short-header .search-header-logo-and-back,.search-in-main-header.short-header .search-input,.vb-search-header.short-header .in-vb-search-header,.vb-search-header.short-header .npw-visual-browse-header-back-arrow,.vb-search-header.short-header .npw-visual-browse-header-create-new-dropdown,.vb-search-header.short-header .search-header-logo-and-back,.vb-search-header.short-header .search-input{display:none}.search-in-main-header.short-header .grid-detail-header-back-arrow,.vb-search-header.short-header .grid-detail-header-back-arrow{display:block}.search-in-main-header.short-header .vb-search-header-short-v-filler,.vb-search-header.short-header .vb-search-header-short-v-filler{height:66px}.search-in-main-header.search-in-main-header,.vb-search-header.search-in-main-header{position:absolute;height:66px;top:0;z-index:104}.search-in-main-header.search-in-main-header .vb-search-header-background,.vb-search-header.search-in-main-header .vb-search-header-background{background-color:transparent}.search-in-main-header.search-in-main-header:not(.showing-results-grid),.vb-search-header.search-in-main-header:not(.showing-results-grid){width:500px;-webkit-transform:translateX(-50%);transform:translateX(-50%);left:calc(50% + 8px);max-width:calc(100% - 320px);min-width:400px}.search-in-main-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-back-arrow,.search-in-main-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-create-new-dropdown,.search-in-main-header.search-in-main-header:not(.showing-results-grid) .search-header-logo-and-back,.vb-search-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-back-arrow,.vb-search-header.search-in-main-header:not(.showing-results-grid) .npw-visual-browse-header-create-new-dropdown,.vb-search-header.search-in-main-header:not(.showing-results-grid) .search-header-logo-and-back{display:none}.search-in-main-header.search-in-main-header:not(.showing-results-grid) .search-results,.vb-search-header.search-in-main-header:not(.showing-results-grid) .search-results{top:52px;margin-top:52px}.search-in-main-header.search-in-main-header.showing-results-grid,.vb-search-header.search-in-main-header.showing-results-grid{background-color:#fff;width:100vw}.search-in-main-header.search-in-main-header.showing-results-grid .search-view,.vb-search-header.search-in-main-header.showing-results-grid .search-view{top:-66px;width:500px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);max-width:calc(100vw - 466px)}@media (max-width:840px){.search-in-main-header.search-in-main-header.showing-results-grid,.vb-search-header.search-in-main-header.showing-results-grid{height:114px}.search-in-main-header.search-in-main-header.showing-results-grid .npw-visual-browse-header-back-arrow,.vb-search-header.search-in-main-header.showing-results-grid .npw-visual-browse-header-back-arrow{height:66px}.search-in-main-header.search-in-main-header.showing-results-grid .search-view,.vb-search-header.search-in-main-header.showing-results-grid .search-view{top:-16px;max-width:90vw}.search-in-main-header.search-in-main-header.showing-results-grid .search-view .search-overlay,.vb-search-header.search-in-main-header.showing-results-grid .search-view .search-overlay{top:-50px}}.search-in-main-header.search-in-main-header .search-overlay,.vb-search-header.search-in-main-header .search-overlay{width:calc(100vw + 40px);height:100vh;left:50%;position:absolute;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-in-main-header.search-in-main-header .search-results,.vb-search-header.search-in-main-header .search-results{top:56px}.search-in-main-header.search-in-main-header .search-view,.vb-search-header.search-in-main-header .search-view{padding:13px}.search-in-main-header.search-in-main-header .search-view .search-input,.search-in-main-header.search-in-main-header .search-view .search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input,.vb-search-header.search-in-main-header .search-view .search-input-disabled{width:100%;box-shadow:none;border:1px solid #dce0e3;transition:border-color .2s ease-in-out}.search-in-main-header.search-in-main-header .search-view .search-input-disabled:active,.search-in-main-header.search-in-main-header .search-view .search-input-disabled:focus,.search-in-main-header.search-in-main-header .search-view .search-input:active,.search-in-main-header.search-in-main-header .search-view .search-input:focus,.vb-search-header.search-in-main-header .search-view .search-input-disabled:active,.vb-search-header.search-in-main-header .search-view .search-input-disabled:focus,.vb-search-header.search-in-main-header .search-view .search-input:active,.vb-search-header.search-in-main-header .search-view .search-input:focus{outline:none;border:1px solid #1473e6}.search-in-main-header.search-in-main-header .search-view .search-input-disabled.search-input-disabled,.search-in-main-header.search-in-main-header .search-view .search-input.search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input-disabled.search-input-disabled,.vb-search-header.search-in-main-header .search-view .search-input.search-input-disabled{text-align:left;line-height:38px}@media (min-width:768px){.mrvl-header.unentitled .search-in-main-header:not(.showing-results-grid){max-width:calc(100% - 638px)}}.vb-search-header-filters-background{width:100%;background-color:#fff;padding:8px 0 0}.vb-search-header-filters-background,.vb-search-header-filters-background .vb-search-header-formats{position:relative;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center}.vb-search-header-filters-background .vb-search-header-formats{max-width:90vw;-webkit-flex-wrap:wrap;flex-wrap:wrap}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep{font-size:12px;font-weight:700;color:#808990;margin:0;padding:12px;text-transform:uppercase;cursor:pointer;border-bottom:3px solid transparent}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep.selected,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format.selected{color:#1473e6;border-bottom-color:#1473e6}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep:hover,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format:hover{color:#1473e6}.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format-sep:first-child,.vb-search-header-filters-background .vb-search-header-formats .vb-search-header-formats-format:first-child{margin-left:0}@media (max-width:840px){.vb-search-header-filters-background{height:84px}.vb-search-header-filters-background .vb-search-header-formats{top:36px;height:40px}}.vb-search-header-filters-background .vb-search-header-formats{margin-top:0}.vb-search-header-filters-background.hide-formats{height:47px}.vb-search-header-filters-background.hide-formats .vb-search-header-formats{display:none}@-webkit-keyframes auto-load-spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes auto-load-spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.search-view-common .load-more-toggle{display:block;clear:both;padding:0 18px;height:40px;margin:40px auto;cursor:pointer;text-align:center;font-size:1.3em;font-weight:600;text-decoration:none;line-height:36px;color:#3e3f41;background:transparent;border-radius:40px;border:2px solid #3e3f41;opacity:1;transition:opacity .3s ease-out}.search-view-common .load-more-toggle:not(.spinner):hover{background:#3e3f41;color:#fff}.search-view-common .load-more-toggle:not(.spinner).melting{opacity:0;transition:opacity .3s ease-out}.search-view-common .load-more-toggle:not(.spinner).disabled{cursor:default;border:2px solid #dce0e3;color:#dce0e3;background-color:transparent}.search-view-common .load-more-toggle.spinner{color:transparent;border-color:transparent;background-color:transparent;cursor:default;width:40px;height:40px;outline:none}.search-view-common .load-more-toggle.spinner.spinner-loading{background-repeat:no-repeat;background-position:50%;background-size:40px;background-image:url(/marvel-core/images/common/light-spinner.svg);transition:opacity;transition-duration:.75s;-webkit-animation-name:auto-load-spinner-rotate;animation-name:auto-load-spinner-rotate;-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;animation-timing-function:linear}.search-view-common .load-more-toggle.spinner.no-more{cursor:default}.search-results-grid-item-detail-confirm-overlay{width:100vw;height:100vh;position:absolute;top:0;left:0;background-color:rgba(0,0,0,.45);z-index:2002}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-button{cursor:pointer;z-index:2}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs{height:30%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb{display:block;color:#808990;font-size:14px;font-weight:400;height:18px;padding-left:32px;background-position:0;background-repeat:no-repeat;background-size:contain}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-template{height:20px;line-height:20px;padding-left:22px;background-image:url(/images/icon-premium-gold-no-border.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-template.show-premium-user-badge-shield-dark{background-image:url(/images/icon-premium-user-premium-badge-shield-dark.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-template.show-premium-user-badge-shield-light{background-image:url(/images/icon-premium-user-premium-badge-shield-light.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-blurb-fonts{background-image:url(/images/npw/visualBrowse/premium-blurb-fonts.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-premium-blurbs .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-blurb-animation{background-image:url(/images/thumb-icon-post-animated.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right{width:40%;min-width:350px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:340px;-webkit-justify-content:space-around;justify-content:space-around;padding:0 40px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-message-and-ctas{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:330px;-webkit-justify-content:space-around;justify-content:space-around}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-title{font-size:26px;font-weight:900}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-subtitle{font-size:16px;font-weight:400;line-height:23px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;width:100%;max-width:300px;-webkit-justify-content:flex-start;justify-content:flex-start}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta{display:block;cursor:pointer;height:34px;font-weight:700;font-size:16px;z-index:1;padding:16px;line-height:1px;color:#fff;background-color:#1473e6;border-radius:20px;transition:width .3s,background-color .3s,top .2s,opacity .3s ease-in-out .2s;opacity:1}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta:hover{background-color:#1269d0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas .search-results-grid-item-detail-confirm-cta:active{background-color:#1056a7}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail{padding:0;height:60vh;width:75vw;max-width:1024px;max-height:800px;min-height:450px;min-width:800px;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background-color:#fff;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;align-items:center;border-radius:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes{display:-webkit-flex;display:flex;margin-top:26px;background-color:#f4f5f5;padding:0;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:space-between;justify-content:space-between;color:#808990;font-size:15px;min-width:300px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes .search-results-detail-confirm-num-remixes,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes .search-results-grid-item-detail-premium-blurb{font-size:16px;font-weight:400}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes .search-results-detail-confirm-num-remixes.search-results-grid-item-detail-premium-blurb,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-detail-confirm-premium-and-num-remixes .search-results-grid-item-detail-premium-blurb.search-results-grid-item-detail-premium-blurb{margin-top:-2px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .detail-close-button{position:absolute;height:24px;width:24px;top:16px;right:16px;background-color:transparent;background-image:url(/images/search/search-clear-x-midnight.svg);background-size:20px;background-repeat:no-repeat}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.vertical-default) .search-results-detail-confirm-premium-and-num-remixes{display:none}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default{-webkit-flex-direction:column;flex-direction:column;height:calc(100vh - 100px);width:auto}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .detail-close-button{height:28px;width:28px;top:4px;right:4px;background-position:50%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-premium-blurbs{height:30px;width:auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-align-items:center;align-items:center}@media (max-width:800px){.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default{width:calc(100vw - 48px);min-width:200px}}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-image-section{width:100%;height:100%;border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-left-radius:0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right{height:120px;width:100%;padding:20px 40px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-message-and-ctas{height:120px;-webkit-align-items:center;align-items:center}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas{-webkit-justify-content:space-between;justify-content:space-between;max-width:100%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas:after,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.vertical-default .search-results-grid-item-detail-confirm-right .search-results-grid-item-detail-confirm-ctas:before{content:"";display:block}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.has-ingredient-animation) .show-if-premium-ingredient-animation,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.has-premium-ingredient-fonts) .show-if-premium-ingredient-fonts,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.is-premium-template) .hide-if-not-premium{display:none}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section{width:60%;height:100%;min-height:160px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;background-color:#f4f5f5;border-top-left-radius:10px;border-bottom-left-radius:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section.show-preview-nav-side{-webkit-flex-direction:row;flex-direction:row}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-preview-nav{display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;height:32px;margin-top:16px;width:100%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder{position:relative;width:100%;max-width:100%;height:100%;background-color:#f4f5f5;padding:0;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;align-items:center}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-detail-confirm-asset-label{color:#1a1a1a;font-size:16px;width:100%;text-align:center;position:relative;height:56px;padding-bottom:16px;padding-top:16px;font-weight:700}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-tags{margin:8px 0 0;height:40px;-webkit-justify-content:left;justify-content:left;overflow-x:auto;overflow-y:hidden;position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder{height:100%;width:auto;position:relative}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading{position:absolute;background-repeat:no-repeat;background-size:contain;background-position:50%;width:100%;height:100%}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation.search-results-grid-item-detail-image,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-image,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-image{z-index:1}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-animation.search-results-grid-item-detail-animation,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-image.search-results-grid-item-detail-animation,.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-image-and-tags-holder .search-results-grid-item-detail-image-holder .search-results-grid-item-detail-loading.search-results-grid-item-detail-animation{z-index:2}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-image-section .search-results-grid-item-detail-nav{width:32px;-webkit-flex-shrink:0;flex-shrink:0}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail:not(.vertical-default) .search-results-grid-item-detail-image-and-tags-holder{padding-bottom:32px;padding-top:32px;-webkit-justify-content:center;justify-content:center}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav{position:relative;background-repeat:no-repeat;width:32px;height:60px;top:calc(50% - 30px);z-index:1;pointer-events:none;opacity:0;background-color:transparent}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav .search-results-grid-item-detail-nav-icon{background-size:28px;background-repeat:no-repeat;top:0;height:100%;width:32px;position:absolute;pointer-events:auto}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left{margin-right:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left .search-results-grid-item-detail-nav-icon{right:0;background-position:100%;background-image:url(/images/npw/visualBrowse/caret-left-valley.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-left:hover .search-results-grid-item-detail-nav-icon{background-image:url(/images/npw/visualBrowse/caret-left-dark-midnight.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right{margin-left:10px}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right .search-results-grid-item-detail-nav-icon{left:0;background-position:0;background-image:url(/images/npw/visualBrowse/caret-right-valley.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail .search-results-grid-item-detail-nav.search-results-grid-item-detail-nav-right:hover .search-results-grid-item-detail-nav-icon{background-image:url(/images/npw/visualBrowse/caret-right-dark-midnight.svg)}.search-results-grid-item-detail-confirm-overlay .search-results-grid-item-detail.can-nav .search-results-grid-item-detail-nav{opacity:1}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox{display:-webkit-inline-flex;display:inline-flex;-webkit-align-items:center;align-items:center;position:relative;height:32px;max-width:100%;margin-right:16px;vertical-align:top}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox:hover .spectrum-Checkbox-box-border{border-color:#6e6e6e}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox:hover .spectrum-Checkbox-label{color:#2c2c2c}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input{font-family:inherit;font-size:100%;line-height:1.15;margin:0;overflow:visible;box-sizing:border-box;padding:0;position:absolute;top:0;left:-8px;width:calc(100% + 16px);height:100%;opacity:.0001;z-index:1;cursor:pointer}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:disabled{cursor:default}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:checked+.spectrum-Checkbox-box-holder .spectrum-Checkbox-box-check{opacity:1}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-input:checked+.spectrum-Checkbox-box-holder .spectrum-Checkbox-box-border{border-width:7px;border-color:#1473e6}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-border{border:2px solid #8e8e8e;position:absolute;width:14px;height:14px;border-radius:2px;transition:border .13s ease-in-out,box-shadow .13s ease-in-out}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-check{background-image:url(/images/npw/visualBrowse/spectrum-checkbox-check.svg);background-size:28px;width:14px;height:14px;position:absolute;left:1px;top:1px;display:block;opacity:0;transition:opacity .13s ease-in-out}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-label{line-height:32px;margin-left:10px;margin-top:0;font-size:14px;font-weight:400;transition:color .13s ease-in-out;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:#4b4b4b}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-box-holder{position:relative;box-sizing:border-box;width:14px;height:14px;-webkit-flex-grow:0;flex-grow:0;-webkit-flex-shrink:0;flex-shrink:0}.search-results-grid-item-detail-confirm-overlay .spectrum-Checkbox .spectrum-Checkbox-checkmark{position:absolute;top:50%;left:50%;margin-top:-5px;margin-left:-5px;opacity:0;-webkit-transform:scale(0);transform:scale(0);transition:opacity .13s ease-in-out,-webkit-transform .13s ease-in-out;transition:opacity .13s ease-in-out,transform .13s ease-in-out;transition:opacity .13s ease-in-out,transform .13s ease-in-out,-webkit-transform .13s ease-in-out}.main-header-search-results.search-results-grid-view-holder{position:absolute;height:calc(100vh - 66px);width:100vw;left:0;top:66px}@media (max-width:840px){.main-header-search-results.search-results-grid-view-holder{top:114px}}.search-input-tooltip{position:relative;display:inline-block;color:#fff;background:#1473e6 0 0 no-repeat padding-box;border-radius:4px;opacity:1;pointer-events:none;font-size:14px;font-weight:500;padding:10px 20px;text-align:center;top:-1px;transition:top .25s ease-in,opacity .5s ease-in}.search-input-tooltip:after{position:absolute;bottom:100%;left:50%;margin-left:-5px;width:0;border-top:5px solid transparent;border-bottom:5px solid #1473e6;border-right:5px solid transparent;border-left:5px solid transparent;content:" ";font-size:0;line-height:0}.search-input-tooltip-holder{text-align:center;height:auto}.search-input-tooltip-holder.off{opacity:0;height:0}.search-input-tooltip-holder.off .search-input-tooltip{top:10px}',""])},3423:function(e,s,t){var r,i;r=[t(6),t(2),t(5),t(0),t(1430),t(161),t(22),t(123),t(1325),t(15),t(100),t(2304),t(3424),t(3425),t(3426),t(3427),t(3428),t(2504)],void 0===(i=function(e,s,t,r,i,a,l,n,o,h,c,d,u,g,m,p,f,v){"use strict";return t.View.extend({events:{"click .search-results-tag":"handleTagClick","click .search-results-tag-button":"handleTagClick","click .search-results-grid-item-hover-id":"handleDebugIdClick","click .search-results-pagination-more":"handleLoadMoreClick","click .search-results-grid-item":"handleItemClick","keyup .search-results-grid-item":"handleItemKeyUp","mouseover .search-results-grid-item.has-animation":"handleAnimationItemMouseOver","mouseout .search-results-grid-item.has-animation":"handleAnimationItemMouseOut","click .search-results-grid-main-cta":"handleItemMainCtaClick","click .search-results-grid-item-thumb-favorite-icon":"handleFavoriteIconClick","click .search-results-grid-item-hover-cta":"handleItemCtaClick","click .search-results-grid-item-detail-nav":"handleDetailNavClick","click .search-results-grid-item-detail-other-results-item-thumb":"handleDetailResultNavClick","click .search-results-grid-item-detail-cta":"handleDetailCtaClick","click .social-line":"handleShareTemplateCtaClick","click .social-overlay-bg":"handleShareModalCloseClick","click .js-close-modal":"handleShareModalCloseClick","click .grid-detail-header-back-arrow":"handleDetailBackArrowClick"},initialize:function(e){s.bindAll(this,s.functionsIn(this)),this.SearchController=e.SearchController,e.resultsData&&this.setResultsData(e.resultsData),this.parentRerendersOnResize=e.parentRerendersOnResize,this._debouncedBound||(this._debouncedBound=!0,this._debouncedVerticalScroll=s.debounce(this.handleScroll.bind(this),500),this.parentRerendersOnResize||(this._debouncedResize=s.debounce(this.handleResize.bind(this),500)))},applyNewInitOptions:function(t){this.setElement(t.el),t.parentRerendersOnResize!==this.parentRerendersOnResize&&(this.parentRerendersOnResize=t.parentRerendersOnResize,this.parentRerendersOnResize?(this._debouncedResize.cancel(),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize))):this._debouncedResize=s.debounce(this.handleResize.bind(this),500))},_partialRowClass:"partial-row",_getRowWidth:function(e){var t=0;return s.each(e.assets,(function(e){t+=e.widthInGrid})),t+=this.gridDims.borderSpace*(e.assets.length-1)},_reduceHeight:function(e,t){var r=this.gridDims.borderSpace*(e.assets.length-1),i=0;return t=t||1,s.each(e.assets,(function(e){e.heightInGrid-=t,i=Math.max(i,e.heightInGrid),e.widthInGrid=Math.floor(e.width*e.heightInGrid/e.height),r+=e.widthInGrid})),e.heightInGrid=i,r},_rerenderGridAfterResize:function(){this._render({isResize:!0})},_getViewportWidth:function(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width},_getViewportHeight:function(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height},_imagePreloads:{},_setBackgroundUrl:function(e,s){e.css("background-image","url("+s+")")},_couldNotLoadBackgroundFromLoad:function(e){var s=this.resultsGrid$.find("#"+e.thumbId);if(e.hadLoadError=!0,this.gridOptions.assetLoadFailed(e),this.pagination.lastShowing--,this.pagination.total--,this._updatePaginationDisplay(),s.length){var t=s.parents(".search-results-grid-item");t.parent(".search-results-grid-row").addClass(this._partialRowClass),t.addClass("had-load-error"),this.gridOptions.detailViewEnabled&&this.detailView$.find("#"+e.thumbId).parents(".search-results-grid-item-detail-other-results-item").addClass("had-load-error")}},_setBackgroundFromLoad:function(e){var s="url("+e.renditions[this._currentPreload.fieldId]+")",t=this.resultsGrid$.find("#"+e.thumbId);if(t.length){this.gridOptions.detailViewEnabled&&this.detailView$.find("#"+e.thumbId).css("background-image",s);var r=t.parents(".search-results-grid-item");t.css("background-image",s),r.removeClass("not-loaded")}},_preloadNextAsset:function(){if(this._currentPreload&&this._currentPreload.nextIndex<this._currentPreload.assetsToPreload.length){var e=this._currentPreload,t=this._currentPreload.assetsToPreload[this._currentPreload.nextIndex],r=t.renditions[this._currentPreload.fieldId],i=this._currentPreload.nextIndex;this._currentPreload.nextIndex++;var a=this._currentPreload.nextIndex==this._currentPreload.assetsToPreload.length;this._currentPreload.currentAsset=t;var l=new Image;l.onload=function(s){if(e===this._currentPreload&&(t.hideUntilLoaded=!1,this._currentPreload.loadedByIndex[i]=t,this._lastGridData.successfulPreloads[t.id]=!0,i==this._currentPreload.nextLoadedIndex&&(this._currentPreload.nextLoadedIndex++,this._lastGridData.hideAssetsUntilLoaded))){this._setBackgroundFromLoad(t);for(var r=this._currentPreload.nextLoadedIndex;r<this._currentPreload.assetsToPreload.length;r++){var a=this._currentPreload.loadedByIndex[r];if(!a)break;this._currentPreload.nextLoadedIndex=r+1,a.hadLoadError||this._setBackgroundFromLoad(a)}}}.bind(this),l.onerror=function(s){if(e===this._currentPreload&&(window.marvel.logger.warn("error loading image in template search results",l.src),this._currentPreload.loadedByIndex[i]=t,this._couldNotLoadBackgroundFromLoad(t),i==this._currentPreload.nextLoadedIndex&&(this._currentPreload.nextLoadedIndex++,this._lastGridData.hideAssetsUntilLoaded)))for(var r=this._currentPreload.nextLoadedIndex;r<this._currentPreload.assetsToPreload.length;r++){var a=this._currentPreload.loadedByIndex[r];if(!a)break;this._currentPreload.nextLoadedIndex=r+1,this._setBackgroundFromLoad(a)}}.bind(this),l.src=r,a||s.defer(this._preloadNextAsset.bind(this))}},_setupAssetRenditionsLoader:function(e){e.assetsToPreload.length?this._currentPreload={assetsToPreload:e.assetsToPreload,nextIndex:0,nextLoadedIndex:0,fieldId:this.isRetina()?"rendition2x":"rendition",loadedByIndex:[]}:this._currentPreload=null},_generateGrid:function(e){var t=(e=e||{}).containerDims;t||(t={height:this.$el.height(),width:this.$el.width()},this.$el.hasClass("hide")&&(this.$el.removeClass("hide"),t.width=this.$el.width(),t.height=this.$el.height(),this.$el.addClass("hide")),t.height<=0&&(t.height=this._getViewportHeight()-122),t.width<=0&&(t.width=this._getViewportWidth()));var r=t.width-2*this.gridDims.rowHMargin,i=this.gridDims.minHeight,a=this.gridDims.minPerRowForMinHeight||2,l=this.gridDims.maxWidth?Math.min(r,this.gridDims.maxWidth):r,n=Math.floor(this.gridDims.targetNumRows)-1,o=t.height-n*this.gridDims.rowVSpace,h=this.gridDims.targetNumRows?Math.round(o/this.gridDims.targetNumRows):this.gridDims.maxHeight,c=this.gridOptions.hideAssetUntilLoaded;c&&e.preLoadMoreGridData&&e.preLoadMoreGridData.stylesData.length;this._partialRowClass=t.width<=300?"partial-row-narrow":"partial-row",h<this.gridDims.minHeight?h=this.gridDims.minHeight:h>this.gridDims.maxHeight&&(h=this.gridDims.maxHeight);var d=[],u={assets:[],width:0};d.push(u),s.each(this.assets,function(e){var t=e.width,r=e.height;if(e.heightInGrid=h,e.widthInGrid=t*e.heightInGrid/r,e.heightInGrid=parseInt(e.heightInGrid),e.widthInGrid=parseInt(e.widthInGrid),e.originalHeightInGrid=e.heightInGrid,e.originalWidthInGrid=e.widthInGrid,u.assets.push(e),u.width+=e.widthInGrid,u.width>=l){var n=null;if(u.assets.length>a){for(var o=this._getRowWidth(u),c=!1;o>l;)if(o=this._reduceHeight(u),u.heightInGrid<=i){o>l&&(c=!0);break}s.each(u.assets,(function(e){e.widthInGrid=e.originalWidthInGrid,e.heightInGrid=e.originalHeightInGrid})),c&&(n=u.assets.pop())}u={assets:[],width:0},n&&(u.assets.push(n),u.width+=n.widthInGrid),d.push(u)}}.bind(this)),0===d[d.length-1].length&&d.pop();var g=[],m=[],p=[],f=1e6,v=(this.gridDims.detailResultsThumbHeight,this.gridDims.detailResaultsMinThumbHeight||0),w={},b=[];s.each(d,function(t,r){for(var i=this._getRowWidth(t),a={assets:[],index:r};i>l;)i=this._reduceHeight(t);a.partialRow=l-i>this.gridDims.borderSpace&&this._partialRowClass,r||(a.rowVSpace=0);var n=t.assets.length-1;s.each(t.assets,function(t,r){var i=t.usecases&&t.usecases[0]||t.app,l=t.favoriteData&&t.favoriteData.favDate>0,o="thumb_"+t.id,h=c,d=t.templatedImgHref,u={rendition:this._getRenditionUrl(d,t.heightInGrid),rendition2x:this._getRenditionUrl(d,2*t.heightInGrid)},g=t.animationHref&&{href:t.animationHref,width:t.widthInGrid,height:t.heightInGrid};e.preLoadMoreGridData&&e.preLoadMoreGridData.successfulPreloads[t.id]&&(h=!1),f=Math.min(f,t.heightInGrid);var v={id:o,w:t.widthInGrid+"px",h:t.heightInGrid+"px"};h?v.hideAssetUntilLoaded=!0:s.assign(v,u),m.push(v);var _={id:t.id,ctaItemId:t.id,thumbId:o,title:t.title,type:t.app,bgLoadWidth:t.widthInGrid-3+"px",bgLoadHeight:t.heightInGrid-3+"px",assetW:t.width,assetH:t.height,assetAspectRatio:t.width/t.height,label:i,isFavorite:l,tagsForData:t.tagsForData,allTags:t.allTags,score:t._score,hideUntilLoaded:h,isPremiumTemplate:t.isPremiumTemplate,premiumTemplateBadge:t.isPremiumTemplate&&this.gridOptions.premiumTemplateBadge,marginRight:r!==n&&this.gridDims.borderSpace+"px"||0,animation:g,indexInRow:a.assets.length};h&&(_.renditions=u,b.push(_)),w[o]=_,a.assets.push(_),p.push(_)}.bind(this)),g.push(a)}.bind(this));var _=t.height,x=Math.floor(.25*_)-40,y=this.detailResultHSpace*(p.length-2);s.each(p,(function(e){e.detailResultWidth=e.assetW*x/e.assetH,y+=e.detailResultWidth})),s.each(p,(function(e){e.detailResultWidth=100*e.detailResultWidth/y+"%",e.detailResultHeight="100%"})),c&&this._setupAssetRenditionsLoader({assetsToPreload:b});var S=e.preLoadMoreGridData&&e.preLoadMoreGridData.successfulPreloads||{};return{hideAssetsUntilLoaded:c,delayAllAssets:!c,rowsData:g,stylesData:m,successfulPreloads:S,maxRowWidth:l+"px",rowVSpace:this.gridDims.rowVSpace,containerDims:t,detailData:this.gridOptions.detailViewEnabled&&{detailAssetsData:{assets:p,maxH:x+"px",totalWidth:y+"px",thumbHeight:"100%",maxTotalWidth:y+"px",minThumbHeight:v&&v+"px",minTotalWidth:v&&y*v/f+"px"},detailBackArrowText:this.gridOptions.backArrowTextForDetail}}},scrollToPreLoadMoreTop:function(){if(this._preLoadMoreLastElemId){var e=this.verticalScroller$.find("#"+this._preLoadMoreLastElemId);if(e&&e.length)return void e[0].focus()}this.verticalScroller$.scrollTop(this._preLoadMoreScrollTop)},scrollToGridRow:function(s){s>=this.rows$.length&&(s=this.rows$.length-1);var t=e(this.rows$[s]),r=e(this.rows$[0]),i=t.position(),a=r.position(),l=i&&a&&i.top-a.top||0;this._verticalScrollRegistered&&(this._ignoreNextVerticalScroll=!0),this.verticalScroller$.scrollTop(l)},_getRenditionUrl:function(e,s,t){return t=t||"height",e.replace("{format}","jpg").replace("{dimension}",t).replace("{size}",s)},setResultsData:function(e,t){this.assets=e.assets,this.assetsById=e.assetsById,this.tagsData=e.tagsData,this.searchAnalytics=e.searchAnalytics,this.tagsData.tags||(this.tagsData.tags=s.reduce(this.tagsData.tagsInOrder,(function(e,s){return e[s.id]=s,e}),{})),this._setAtMaxSelectedTagsForTagsData(this.tagsData,t),this.pagination={total:e.hasMore&&e.total||this.assets.length,firstShowing:1,lastShowing:this.assets.length,hasMore:e.hasMore}},_addPaginationToTemplateOptions:function(e){return e.paginationTotal=this.pagination.total,e.paginationFirst=this.pagination.firstShowing,e.paginationLast=this.pagination.lastShowing,e},_updatePaginationDisplay:function(){var e=this.$el.find(".search-results-pagination-pages-info"),s=this._addPaginationToTemplateOptions({}),t=this.pagination.total?"npw-vb-search-results-pagination-some":"npw-vb-search-results-pagination-none",r=h.formatMessage(t,s);e.text(r)},renderResults:function(e,s){this.gridOptions=s,this.gridDims=this.gridOptions.gridDims,this.setResultsData(e,s),this.render(s)},_extendDebugSettingsToTemplateSettings:function(e){return this.gridOptions.debugSettings&&(e.debugCssStr=this.gridOptions.debugSettings.debugCssStr),e},_recordExperiment:function(){return this._recordExperimentDefer||(this._recordExperimentDefer=r.defer(),a.run("npwSearchResults*").then(function(e){this._recordExperimentDefer.resolve(e)}.bind(this)).catch(function(e){window.marvel.logger.error("Error loading experiment in npw search results: ",e),this._recordExperimentDefer.resolve(null)}.bind(this)).done()),this._recordExperimentDefer.promise},render:function(e){return e.isReRender?this._render(e):this._recordExperiment().then(function(){this._render(e)}.bind(this)).done(),this},_isEdge:function(){return-1!==window.navigator.userAgent.indexOf("Edge/")},_isIE:function(){var e=window.navigator.userAgent;return-1!==e.indexOf("Trident/")||-1!==e.indexOf("MSIE ")},_setAtMaxSelectedTagsForTagsData:function(e,t){var r=!1;if(t.maxNumSelectedTags&&e.currentSelectedTags&&e.currentSelectedTags.length){var i=0;s.find(e.currentSelectedTags,(function(e){if(!e.selected)return!0;e.customFilterType||i++})),r=i>=this.gridOptions.maxNumSelectedTags}e.atMaxSelectedTags=r},focusFirstAsset:function(){if(this.rows$&&this.rows$.length){var s=e(this.rows$[0]).find(".search-results-grid-item");s.length&&e(s[0]).focus()}},keyEventFunc:function(t){if(this._detailConfirmInfo&&this._detailConfirmInfo.showing)this._detailConfirmInfo.keyEventFunc(t);else if("keydown"===t.type&&-1!==[n.DOM_VK_LEFT,n.DOM_VK_RIGHT,n.DOM_VK_UP,n.DOM_VK_DOWN].indexOf(t.keyCode)){if(t.metaKey||t.altKey)return void(t.keyCode===n.DOM_VK_UP&&this.focusFirstAsset());var r=e(document.activeElement);if(r.hasClass("search-results-grid-item")){var i,a,l=r.parent(".search-results-grid-row"),o=l.find(".search-results-grid-item"),h=l.data("index"),c=r.data("index-in-row"),d=0;if(t.keyCode===n.DOM_VK_LEFT)--c>-1?i=e(o[c]):h?(a=e(this.rows$[h-1]).find(".search-results-grid-item"),i=e(a[a.length-1])):d=-1;else if(t.keyCode===n.DOM_VK_RIGHT)++c<o.length?i=e(o[c]):h===this.rows$.length-1?d=1:(a=e(this.rows$[h+1]).find(".search-results-grid-item"),i=e(a[0]));else{var u;if(t.keyCode===n.DOM_VK_UP?(u=h-1)<0&&(d=-1):(u=h+1)>=this.rows$.length&&(d=1),-1!==d&&t.preventDefault(),!d){a=e(this.rows$[u]).find(".search-results-grid-item");var g=c?a.length-1:0,m=r.offset().left+.5*r.width(),p=0;s.find(a,(function(s,t){var r=e(s),i=r.width(),a=r.offset().left,l=a+i;return m<a?!!p&&(g=m>=.5*(p+a)?t:t-1,!0):m<=l?(g=t,!0):(p=l,!1)})),i=e(a[g])}}i?i.focus():1===d&&this.loadMoreIfNotLoadingAndMore()}else(document.activeElement===document.body||r.hasClass("search-results-tag-button"))&&(this.focusFirstAsset(),t.preventDefault())}},_render:function(t){t=t||{},this.keyFuncRegistered||(this.keyFuncRegistered=!0,this.keyEventElem$=e(document),this.keyEventElem$.on("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this.keyEventFunc)),this._verticalScrollRegistered&&(this.verticalScroller$.off("scroll.searchresultsgridview",this._debouncedVerticalScroll),this._verticalScrollRegistered=!1),this._resizeRegistered||this.parentRerendersOnResize||(this._resizeRegistered=!0,e(window).on("resize.srgv",this._debouncedResize));var r=0;this.gridOptions.repeatOptions&&this.gridOptions.repeatOptions.loadNext&&(r=this.rows$&&this.rows$.length),this.detailResultMaxHeight=this.gridDims.maxHeight,this.detailResultHSpace=8,this._showingDetail=!1;var i={numCtas:0,ctas:[]},a=this._parseTags(this.gridOptions.debugSettings),l=this._generateGrid({preLoadMoreGridData:this._preLoadMoreGridData,containerDims:t.containerDims}),n=this.tagsData.atMaxSelectedTags,o=t.uiStrings||{};o.resultItemCreateFrom||(o.resultItemCreateFrom=h.getString("npw-vb-search-results-item-create-from"));var g={rows:l.rowsData,maxRowWidth:l.maxRowWidth,rowVSpace:l.rowVSpace,hoverCtas:i,detailData:l.detailData,tagsAboveResults:this._tagsAboveResultsEnabled(),tags:a,pagination:this.pagination,favoritesEnabled:this.gridOptions.favoritesEnabled,assetsStyles:c.to_html(d,{assets:l.stylesData}),isEdge:this._isEdge(),isIE:this._isIE(),uiStrings:o,implicitCreateCta:this.gridOptions.implicitCreateCta,delayAllAssets:l.delayAllAssets,atMaxSelectedTags:n,preloadAllResultMp4s:this.gridOptions.preloadAllResultMp4s};this._addPaginationToTemplateOptions(g),this._lastGridData=l,this._preLoadMoreGridData=null,g.detailData&&i.ctas.push({id:"detail"}),i.numCtas=i.ctas.length,this._extendDebugSettingsToTemplateSettings(g);var m,f=h.mustacheRender(p,g,{itemDetail:l.detailData&&u});return this.$el.html(f),this._applySelectedTagsToResultsAfterRender(),l.hideAssetsUntilLoaded&&this._preloadNextAsset(),this.verticalScroller$=this.$el.find(".search-results-grid-holder"),this.resultsGrid$=this.$el.find(".search-results-grid"),this.rows$=this.verticalScroller$.find(".search-results-grid-row"),this.detailView$=this.$el.find(".search-results-grid-item-detail-holder"),this.detailImage$=this.detailView$.find(".search-results-grid-item-detail-image"),this.detailThumbsRowScroller$=this.detailView$.find(".search-results-grid-item-detail-other-results-section-scroller"),this.detailRightSide$=this.detailView$.find(".search-results-grid-item-detail-right"),this.gridOptions.rightRailForDetail?this.detailView$.addClass("show-right-rail"):this.detailView$.removeClass("show-right-rail"),t.jumpToDetailAssetId&&this.jumpToDetailAsset(t.jumpToDetailAssetId),this.$el.removeClass("hide"),this.pagination.div$=this.$el.find(".search-results-pagination").removeClass("loading-more"),this.pagination.moreBtn$=this.pagination.div$.find(".load-more-toggle"),m=this.pagination.hasMore?this.gridOptions.showLoadMoreButton?this.pagination.lastShowing>t.maxResultsBeforeAutoLoadFromScroll?"spinner-loaded":"load-more":"spinner-loaded":"no-more",this._setMoreBtnState(m),"spinner-loaded"===m?(this._verticalScrollRegistered=!0,r&&!t.isReRender&&this.scrollToPreLoadMoreTop(),this.verticalScroller$.on("scroll.searchresultsgridview",this._debouncedVerticalScroll)):"no-more"===m&&r&&this.scrollToPreLoadMoreTop(),l.delayAllAssets&&s.delay(function(){this.rows$.removeClass("hide-assets")}.bind(this),5),this},hide:function(){this.$el.addClass("hide"),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize)),this.keyFuncRegistered&&(this.keyFuncRegistered=!1,this.keyEventElem$.off("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this.keyEventFunc))},getLastAssetElemId:function(){if(this.rows$&&this.rows$.length){var s=e(this.rows$[this.rows$.length-1]),t=s.find(".search-results-grid-item");if(t.length||(t=s.prev().find(".search-results-grid-item")),t.length)return t[t.length-1].id}return""},handleLoadMoreClick:function(e){if(!this.pagination.moreBtn$.hasClass("no-more")){this.pagination.div$.addClass("loading-more"),this._setMoreBtnState("spinner-loading"),this._preLoadMoreScrollTop=this.verticalScroller$.scrollTop(),this._preLoadMoreLastElemId=this.getLastAssetElemId(),this._preLoadMoreGridData=this._lastGridData;var t=s.map(this.tagsData.currentSelectedTags,(function(e){return e.id}));this.gridOptions.loadMoreClickHandler({isClick:!!e,pagination:this.pagination,selectedTags:t})}},handleResize:function(e){this._rerenderGridAfterResize()},loadMoreIfNotLoadingAndMore:function(){this.pagination.moreBtn$.hasClass("spinner")&&!this.pagination.moreBtn$.hasClass("spinner-loading")&&this.pagination.hasMore&&this.handleLoadMoreClick()},handleScroll:function(e){if(this._ignoreNextVerticalScroll)this._ignoreNextVerticalScroll=!1;else{var s=this.verticalScroller$.scrollTop(),t=this.verticalScroller$[0].scrollHeight;s+this.verticalScroller$.height()>=t&&this.loadMoreIfNotLoadingAndMore()}},_setMoreBtnState:function(e){"load-more"===e?(this.pagination.moreBtn$.removeClass("disabled").removeClass("spinner"),s.delay(function(){this.pagination.moreBtn$.removeClass("hide").removeClass("melting")}.bind(this),300)):"spinner-loaded"===e||"no-more"===e?(this.pagination.moreBtn$.removeClass("disabled").addClass("spinner").removeClass("spinner-loading"),"no-more"===e?this.pagination.moreBtn$.addClass("no-more"):this.pagination.moreBtn$.removeClass("no-more")):"spinner-loading"===e&&this.pagination.moreBtn$.removeClass("disabled").addClass("spinner").addClass("spinner-loading").removeClass("no-more")},_currentVideoRollPlayTimer:{},_triggerVideoRollPlayTimer:function(s){var t=e(s.currentTarget),r=t.find(".search-results-grid-item-thumb-animation"),i=this._getAssetFromElement(t);this._currentVideoRollPlayTimer.timer&&clearTimeout(this._currentVideoRollPlayTimer.timer),this._currentVideoRollPlayTimer.timer=setTimeout(function(){var e=r.get(0),s=r.find("source"),t=s.attr("src");e.loop=!0,t||(t=s.data("src"),s.attr("src",t),e.load()),this.SearchController.autoPlayVideo(e,{asset:i,context:this.gridOptions.analytics.context},(function(e){e.err||r.removeClass("hide")}))}.bind(this),500),this._currentVideoRollPlayTimer.video$=r},handleAnimationItemMouseOver:function(e){this._triggerVideoRollPlayTimer(e)},handleAnimationItemMouseOut:function(s){var t=e(s.currentTarget).find(".search-results-grid-item-thumb-animation");this._currentVideoRollPlayTimer.video$&&t[0]===this._currentVideoRollPlayTimer.video$[0]&&this._currentVideoRollPlayTimer.timer&&(clearTimeout(this._currentVideoRollPlayTimer.timer),this._currentVideoRollPlayTimer.timer=null,this._currentVideoRollPlayTimer.video$=null),t.get(0).loop=!1},handleItemKeyUp:function(e){e.keyCode===n.DOM_VK_RETURN&&e.stopPropagation()},handleItemClick:function(s){if(this.gridOptions.implicitCreateCta){var t=e(s.currentTarget),r=(t.data("cta"),t.closest(".search-results-grid-item"));this._handleCreateFromItem(s,r,{uiId:"thumb-hover-create"})}},_handleCreateFromItem:function(e,t,r){var i=this._getAssetFromElement(t);r=s.assign({},{context:"item-grid",alias:i.alias,sparkFormat:i.app},r||{}),this.gridOptions.createFromThumbClickHandler(i,{analytics:r,event:e})},getDataForRedraw:function(){return{showingDetailId:this._showingDetail&&this._detailInfo.asset&&this._detailInfo.asset.id}},handleItemMainCtaClick:function(s){var t=e(s.currentTarget),r=t.data("cta"),i=t.data("analytics-id"),a=t.closest(".search-results-grid-item");"create"===r&&this._handleCreateFromItem(s,a,{uiId:i})},isRetina:function(){return window.devicePixelRatio>1||!(!window.matchMedia||!window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(min--moz-device-pixel-ratio: 1.5),(-o-min-device-pixel-ratio: 3/2),(min-resolution: 1.5dppx)").matches)},_getAssetFromClickTarget:function(e,s){s=s||".search-results-grid-item";var t=e.closest(s);return this._getAssetFromElement(t)},_getAssetFromElement:function(e){var s=e.data("id");return this.assetsById[s]},handleItemCtaClick:function(s){var t=e(s.currentTarget),r=t.data("id"),i=this._getAssetFromClickTarget(t);if(s.preventDefault(),s.stopImmediatePropagation(),"detail"===r){if(this.gridOptions.preDetailViewCallback){var a=this.gridOptions.preDetailViewCallback(i);a.resized&&this.containerResized(a)}this._showDetailViewForAsset(i,this.assets,{context:"from-results-cta"})}},jumpToDetailAsset:function(e){"string"==typeof e&&(e=this.assetsById[e]),e&&this._showDetailViewForAsset(e,this.assets,{context:"from-jump"})},handleFavoriteIconClick:function(s){s.preventDefault(),s.stopImmediatePropagation();var t,r,i,a,l=e(s.currentTarget),n=l.parents(".search-results-grid-item");l.hasClass("search-results-grid-item-detail-cta")?(i=!0,a=this._detailInfo.asset,n=l,r=this.detailView$.find("#other-results-item-"+a.id)):(n.length||(n=l.parents(".search-results-grid-item-detail-other-results-item"),i=!0),a=this._getAssetFromElement(n));var o=n.hasClass("is-favorite");n.hasClass("is-setting-favorite")||(n.addClass("is-setting-favorite"),o=!o,i&&(t=this.resultsGrid$.find("#thumb_"+a.id).parents(".search-results-grid-item")),o?(n.addClass("is-favorite"),t&&t.addClass("is-favorite"),r&&r.addClass("is-favorite")):(n.removeClass("is-favorite"),t&&t.removeClass("is-favorite"),r&&r.removeClass("is-favorite")),this.gridOptions.setFavorite(a,o).then((function(){n.removeClass("is-setting-favorite")})))},remove:function(){return this.$el.empty(),this.$el.addClass("hide"),this._resizeRegistered&&(this._resizeRegistered=!1,e(window).off("resize.srgv",this._debouncedResize)),e(document.body).find(".vb-search-header").removeClass("short-header"),this},searchViewShown:function(e){var t=!1;if(e.gridDims||e.containerDims){this.gridDims&&this._lastGridData||window.marvel.logger.debug("null gridDims or lastGridData in searchViewShown",{gridDims:this.gridDims,lastGridData:this._lastGridData}),t=!0;var r=s.find(e.gridDims,function(e,s){return this.gridDims[s]!==e}.bind(this));if(s.isUndefined(r)){var i=s.find(e.containerDims,function(e,s){return this._lastGridData.containerDims[s]!==e}.bind(this));t=!s.isUndefined(i)}}t&&this.containerResized(e)},containerResized:function(e){e.gridDims&&s.assign(this.gridDims,e.gridDims),this._render({isResize:!0,containerDims:e.containerDims}),this._detailConfirmInfo&&this._detailConfirmInfo.showing&&this._redrawCurrentConfirm()},_parseTags:function(e){var t=[],r=this.tagsData.tagsInOrder;return this.gridOptions.maxNumTagsInResults&&r.length>this.gridOptions.maxNumTagsInResults&&(r=r.slice(0,this.gridOptions.maxNumTagsInResults)),s.each(r,(function(r,i){var a={label:r.keyword.replace(/\-/g," "),index:i},l=r.prefix;if(!l&&r.fields&&(l=r.fields.length>1?"multi":r.fields[0]),l&&(a.prefix=l),e){var n=[];r.tags&&(n=r.tags),n.length&&(a.title=n.join(","))}t.push(s.assign(a,r))})),t},_applySelectedTagsToResultsAfterRender:function(){s.each(this.tagsData.currentSelectedTags,function(e){this._setTagDivsSelected(e.id,!0)}.bind(this))},_tagsAboveResultsEnabled:function(){return!this.gridDims.hideTagsAboveResults},_setTagDivsSelected:function(e,s){var t=this.$el.find(".search-results-tag-tag-"+e+'[data-id="'+e+'"]');s?t.addClass("selected"):t.removeClass("selected")},_isTagSelectedInDetail:function(e){return this.$el.find(".search-results-detail-tag-tag-"+e).hasClass("selected")},handleDebugIdClick:function(s){if(this.gridOptions.debugSettings.cpAssetPathTemplate){s.stopImmediatePropagation();var t=e(s.currentTarget),r=t.data("id"),i=this._getAssetFromElement(t),a=o.getFormatInfo(i.app).app.getCPCommunity(),l=this.gridOptions.debugSettings.cpAssetPathTemplate.replace("{assetId}",r).replace("{community}",a);window.open(l,"_blank")}},handleTagClick:function(t){var r,i=e(t.currentTarget),a=i.data("id"),l=a;if(t.preventDefault(),t.stopImmediatePropagation(),this.tagsData.keysForTags){if(!(r=this.tagsData.tags[l])){var n=a.split("-");l=2===n.length?n[1]:n.slice(1).join("-"),r=this.tagsData.tags[l]}}else r=this.tagsData.tags[l];if(!this.tagsData.atMaxSelectedTags||!r||r.selected||r.customFilterType){var o=[],h={selectedTags:s.map(this.tagsData.currentSelectedTags,(function(e){return o.push(e.srcKey||e.id),e.id})),selectedTagKeys:o};if(r)if(i.hasClass("search-results-grid-item-detail-tag")){var c=this._isTagSelectedInDetail(a);this._setTagDivsSelected(a,!c),//!tagData.selected would be if we show selected when displaying detail
h.changeSelectionValue=!c,this.gridOptions.tagClickHandler(r,h)}else this._setTagDivsSelected(a,!r.selected),this.gridOptions.tagClickHandler(r,h);else window.marvel.logger.debug("tagData not found for tag click:"+a)}},searchTriggered:function(){this._showingDetail&&this.closeDetail()},_setDetailRightSide:function(e){if(this.gridOptions.rightRailForDetail){var t=[],r=o.getFormatInfo(e.app);s.each(e.allTags,function(e){var r=!!s.find(this.tagsData.currentSelectedTags,(function(s){return s.id===e.id}));t.push(s.assign({},e,{selected:r}))}.bind(this));var i=s.assign({},e,{allTags:t,appLabel:r.formatLabel});this._extendDebugSettingsToTemplateSettings(i);var a=c.to_html(m,i);this.detailRightSide$.html(a)}else{var l=this.detailView$.find(".search-results-grid-item-detail-tags"),n=this.detailView$.find(".search-results-grid-item-detail-header-cta-favorite");e.favoriteData&&e.favoriteData.favDate>0?n.addClass("is-favorite"):n.removeClass("is-favorite"),l.html(c.to_html('{{#allTags}}{{^hideTag}}<div class="search-results-grid-item-detail-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-detail-tag-tag-{{id}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>{{/hideTag}}{{/allTags}}',this._extendDebugSettingsToTemplateSettings({allTags:e.allTags})))}},_hiRezDetailRequests:{hrefs:{},forceNext:!1,delay:1e3},_cancelDetailImageBackgroundNextLoad:function(){this._hiRezDetailRequests.timeout&&(clearTimeout(this._hiRezDetailRequests.timeout),this._hiRezDetailRequests.timeout=null)},_resetHiRezDetailRequests:function(e){this._cancelDetailImageBackgroundNextLoad(),s.isUndefined(e)||(this._hiRezDetailRequests.forceNext=e)},_requestDetailImageBackground:function(e,s){this._cancelDetailImageBackgroundNextLoad(),!this._hiRezDetailRequests.delay||this._hiRezDetailRequests.forceNext||this._hiRezDetailRequests.hrefs[s]?(this._hiRezDetailRequests.forceNext=!1,this._hiRezDetailRequests.hrefs[s]=!0,e.css("background-image","url("+s+")")):(e.css("background-image","none"),this._hiRezDetailRequests.timeout=setTimeout(function(){this._hiRezDetailRequests.hrefs[s]=!0,e.css("background-image","url("+s+")")}.bind(this),this._hiRezDetailRequests.delay))},_setDetailImage:function(e,s,t,r){var i,a,l=e.height,n=e.width,o=t,h=s,c=this.isRetina();l>o?n>s?h/n>=o/l?(i="height",a=o):(i="width",a=h):(i="height",a=o):n>h?(i="width",a=s):(i="width",a=n);var d,u,g,m=a*(c?2:1),p=this._getRenditionUrl(e.templatedImgHref,m,i),f=r&&r.detailImage$||this.detailImage$,v=r&&r.loader$||this.$el.find(".search-results-grid-item-detail-image-holder").find(".search-results-grid-item-detail-loading");r&&(r.renditionInfo={href:p,dim:m,isRetina:c,dimType:i},r.resizer$&&("width"===i?(u=a,g=Math.round(e.height*u/e.width)):(g=a,u=Math.round(e.width*g/e.height)),g=Math.min(g,t),u=Math.min(u,s),r.resizer$.css("width",u+"px"),r.resizer$.css("height",g+"px"),r.matchImageHolderWitdh$.css("width",u+"px"),e.animationHref&&(d={href:e.animationHref,width:u,height:g})));if(e.preloadedRendition)v.css("background-image",'url("'+e.preloadedRendition.url+'")');else{var w=this.$el.find("#thumb_"+e.id);this._copyCss(w,v,["background-image"])}if(this.gridOptions.animationEnabled){var b=r.detailView$.find(".search-results-grid-item-detail-animation");d?(r.animation=d,b.attr("width",d.width),b.attr("height",d.height),b.find("source").attr("src",d.href),b[0].load(),this.gridOptions.autoPlayDetailAnimation&&this.SearchController.autoPlayVideo(b),b.removeClass("hide"),f.addClass("hide"),r.detailView$.addClass("has-ingredient-animation")):(r.animation=null,b.addClass("hide"),b.find("source").attr("src",""),f.removeClass("hide"),this._requestDetailImageBackground(f,p),r.detailView$.removeClass("has-ingredient-animation"))}else f.removeClass("hide"),this._requestDetailImageBackground(f,p)},_copyCss:function(e,t,r){s.each(r,(function(s){t.css(s,e.css(s))}))},_setAssetDetailTagsForTagFilters:function(e){s.each(e.allTags,function(e){var s=this.tagsData.tags[e.keyword];s?(e.isFilter=s.isFilter,e.isSearchTerm=s.isSearchTerm,e.isFilter?(e.selected=!0,e.hideTag=!1):(e.hideTag=s.isSearchTerm,e.selected=!1)):window.marvel.logger.debug("no srcTag match in _setAssetDetailTagsForTagFilters")}.bind(this))},_detailAssetSet:function(e){if(e.itemsViewed.byId[e.asset.id]||(e.itemsViewed.byId[e.asset.id]=e.asset,e.itemsViewed.total++),e.ctasForPremium){var t=e.asset.premium||e.asset.isPremiumTemplate;s.each(e.ctasForPremium,(function(e){var s=t&&e.settings.textIfAssetRequiresUpgrade||e.settings.text;e.elem$.text(s)}))}},_setDetailAsset:function(e,s){s=s||{},this._setAssetDetailTagsForTagFilters(e),s.analytics&&this.gridOptions.assetDetailShownCallback&&this.gridOptions.assetDetailShownCallback({asset:e,analytics:s.analytics}),this._detailInfo.selectedThumbItem$&&this._detailInfo.selectedThumbItem$.removeClass("selected"),this._detailInfo.selectedThumbItem$=this.detailView$.find("#other-results-item-"+e.id).addClass("selected"),this._detailInfo.asset=e,this._detailInfo.index=e._orderedIndex,this.gridOptions.allowPremiumTemplates&&(e.isPremiumTemplate?this.detailView$.addClass("is-premium-template"):this.detailView$.removeClass("is-premium-template")),this._setDetailImage(e,this._detailInfo.maxW,this._detailInfo.maxH),this._setDetailRightSide(e),this._setShareTemplateHtml(e),this._detailAssetSet(this._detailInfo),s.noScroll||this._scrollDetailAssetIntoView()},_redrawCurrentConfirm:function(){if(this._detailConfirmInfo&&this._detailConfirmInfo.showing){var e=s.assign({},this._detailConfirmInfo.currentOptions,{isRedraw:!0});this._setDetailConfirmAsset(this._detailConfirmInfo.asset,e)}},_getAssetLabel:function(e){return""},_setDetailConfirmAsset:function(e,s){s=s||this._detailConfirmInfo.currentOptions||{},this._detailConfirmInfo.currentOptions=s,this._detailConfirmInfo.asset=e,this._detailConfirmInfo.index=e._orderedIndex,this._detailConfirmInfo.resizer$.css("width","100%"),this._detailConfirmInfo.resizer$.css("height","100%");var t=this._detailConfirmInfo.resizer$.width(),r=t,i=this._detailConfirmInfo.resizer$.height();this._detailConfirmInfo.detailImageContainer$.width(t),this.gridOptions.allowPremiumTemplates&&(e.isPremiumTemplate?this._detailConfirmInfo.detailView$.addClass("is-premium-template has-premium-ingredient-fonts"):this._detailConfirmInfo.detailView$.removeClass("is-premium-template has-premium-ingredient-fonts")),this._detailConfirmInfo.remixCount$.text(h.formatMessage("search-results-confirm-num-remixes",{remixCount:e.remixCount}));var a=this._getAssetLabel(e);this._detailConfirmInfo.assetLabel$.html(a),this._setDetailImage(e,r,i,this._detailConfirmInfo),this._detailAssetSet(this._detailConfirmInfo)},closeDetailConfirm:function(e){this._resetHiRezDetailRequests(),this._detailConfirmInfo&&(this._detailConfirmInfo.buttons$.off("click",this._detailConfirmInfo.buttonClickFunc),this._detailConfirmInfo.showing=!1,this._detailConfirmInfo.overlay$.addClass("hide"),e&&(this._detailConfirmInfo.overlay$.empty(),this._detailConfirmInfo.emptied=!0),this._detailConfirmInfo.keyEventElem$&&(this._detailConfirmInfo.keyEventElem$.off("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this._detailConfirmInfo.keyEventFunc),this._detailConfirmInfo.keyEventElem$=null))},_previewLocationToSparkFormat:function(e){return"editorPost"===e?"post":null},_trackConfirmEvent:function(e,t){var r="templateType:"+(this._detailConfirmInfo.asset.premium?"premium":"free"),i=this.gridOptions.animationEnabled&&"hasAnimation:"+(this._detailConfirmInfo.asset.animated?"true":"false"),a=this._detailConfirmInfo.previewLocation,n=this._detailConfirmInfo.analytics.context;"header"===n&&(n="search");var o={},h="previewLocation:"+a,c="tagNames:"+this.gridOptions.getTagNamesAnalyticValForAsset(this._detailConfirmInfo.asset),d=this._previewLocationToSparkFormat(a);if(d&&(o.sparkFormat=d),"templatePreviewClosed"===e){var u=this._detailConfirmInfo.asset.locales;s.assign(o,{contextualData2:h,contextualData3:"isNav:"+(this._detailConfirmInfo.asset!==t.originalAsset),templateId:this._detailConfirmInfo.asset.id,contextualData1:"numPreviewed:"+this._detailConfirmInfo.itemsViewed.total,contextualData4:r,contextualData6:c,contextualData7:"templateLocale:"+u}),i&&(o.contextualData10=i)}else"templatePreviewed"===e&&(s.assign(o,{templateId:this._detailConfirmInfo.asset.id,contextualData2:h,contextualData4:r,contextualData6:c}),i&&(o.contextualData7=i));this.searchAnalytics&&(o.contextualData8=this.searchAnalytics.searchStr,o.contextualData9=this.searchAnalytics.tagFilters);var g=this._detailConfirmInfo.analytics[e];g&&(g.data&&s.assign(o,g.data),g.callback&&g.callback(o,t)),l.trackEvent(e,o,n)},showDetailConfirmForCurrentClickedThumb:function(t){var i,a,l=e(document.body).find(".search-results-grid-item-detail-confirm-overlay");l.length||(l=e('<div class="search-results-grid-item-detail-confirm-overlay search-results-grid-item-detail-confirm-button hide"></div>'),e(document.body).append(l)),t.gridlessOptions&&(i=this.assets,this.assets=t.gridlessOptions.assets,a=this.searchAnalytics,this.searchAnalytics=t.gridlessOptions.searchAnalytics,t.gridlessOptions.gridOptions&&(this.gridOptions=t.gridlessOptions.gridOptions)),t.analytics&&t.analytics.templatePreviewedClosed&&(t.analytics.templatePreviewClosed=t.analytics.templatePreviewedClosed),this._detailConfirmInfo={totalAssets:this.assets.length,canNav:t.showPreviewNav&&this.assets.length>1,assets:this.assets,maxW:600,maxH:600,closeDefer:r.defer(),overlay$:l,showing:!0,analytics:t.analytics,previewLocation:t.previewLocation,itemsViewed:{byId:{},total:0},premiumRequiresUpgrade:t.premiumRequiresUpgrade,ctasForPremium:t.ctasForPremium};var o=function(l,o){var h,d,u,g;if(l){var m=e(l.currentTarget),p=e(l.target).hasClass("search-results-grid-item-detail-confirm-overlay");if(m.hasClass("detail-close-button")||p)h="close";else if(m.hasClass("search-results-grid-item-detail-nav"))h="nav";else{if(!m.hasClass("search-results-grid-item-detail-confirm-cta"))return;h="cta";var f=m.data("id");d=s.find(t.ctas,(function(e){return e.id===f}))}l.preventDefault(),l.stopPropagation()}else if(o===n.DOM_VK_ESCAPE)h="close";else{if(o!==n.DOM_VK_RETURN)return;if(1!==t.ctas.length)return;h="cta",d=t.ctas[0]}if("close"===h)g={cancelled:!0,closeDefer:u=r.defer(),originalAsset:t.asset},this._trackConfirmEvent("templatePreviewClosed",g),this._detailConfirmInfo.closeDefer.resolve(g);else if("cta"===h){if(g={closeDefer:u=r.defer(),cta:d,asset:this._detailConfirmInfo.asset,originalAsset:t.asset,detailRenditionInfo:this._detailConfirmInfo.renditionInfo,showUpgradeForPremium:this.gridOptions.showUpgradeForPremium},c.numCheckboxes){var v=s.reduce(this._detailConfirmInfo.detailView$.find(":checkbox"),(function(e,s){return e[s.id]=s.checked,e}),{});g.checkboxValues=v}this._trackConfirmEvent("templatePreviewClosed",g),this._detailConfirmInfo.closeDefer.resolve(g)}else{if("nav"!==h)return;this.handleDetailNavClick(l,{isConfirm:!0})}u&&u.promise.then(function(){t.gridlessOptions&&(this.assets=i,this.searchAnalytics=a),this.closeDetailConfirm(!0)}.bind(this))}.bind(this);this._detailConfirmInfo.buttonClickFunc=o;var c=s.assign({},t);c.checkboxes&&c.checkboxes.length&&(c.numCheckboxes=c.checkboxes.length),t.stringsAreIds&&(c.title=h.getString(c.title),c.subtitle=h.getString(c.subtitle),s.each(c.ctas,(function(e){e.text=h.getString(e.text),e.textIfAssetRequiresUpgrade&&(e.textIfAssetRequiresUpgrade=h.getString(e.textIfAssetRequiresUpgrade))})),c.checkboxes&&s.each(c.checkboxes,(function(e){e.text=h.getString(e.text)}))),c.canNav=c.previewNavType&&this.assets.length>1,"side"===c.previewNavType?c.showPreviewNavSide=!0:"bottom"===c.previewNavType&&(c.showPreviewNavBototm=!0),this.gridOptions.animationEnabled&&(c.animationEnabled=!0,c.autoPlayDetailAnimation=this.gridOptions.autoPlayDetailAnimation);var d=h.mustacheRender(g,c);this._detailConfirmInfo.detailView$=e(d),this._detailConfirmInfo.remixCount$=this._detailConfirmInfo.detailView$.find(".search-results-detail-confirm-num-remixes"),this._detailConfirmInfo.assetLabel$=this._detailConfirmInfo.detailView$.find(".search-results-detail-confirm-asset-label"),t.premiumRequiresUpgrade&&t.ctasForPremium&&(this._detailConfirmInfo.ctasForPremium=s.reduce(t.ctasForPremium,function(e,s){var t=this._detailConfirmInfo.detailView$.find("[data-id="+s.id+"]");return t&&e.push({elem$:t,settings:s}),e}.bind(this),[])),this._detailConfirmInfo.detailImageContainer$=this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-image-and-tags-holder");var u=this._detailConfirmInfo.detailImageContainer$.find(".search-results-grid-item-detail-image-holder");this._detailConfirmInfo.resizer$=u,this._detailConfirmInfo.matchImageHolderWitdh$=this._detailConfirmInfo.detailView$.find(".match-image-holder-width"),this._detailConfirmInfo.detailImage$=u.find(".search-results-grid-item-detail-image"),this._detailConfirmInfo.loader$=this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-loading"),l.append(this._detailConfirmInfo.detailView$),l.removeClass("hide"),this._resetHiRezDetailRequests(!0),this._setDetailConfirmAsset(t.asset,t);var m=".search-results-grid-item-detail-confirm-button";this._detailConfirmInfo.buttons$=l.find(m).addBack(m),this._detailConfirmInfo.buttons$.on("click",o);var p=-1,f=[this._detailConfirmInfo.detailView$.find(".primary-cta"),this._detailConfirmInfo.detailView$.find(".detail-close-button"),this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-nav-left"),this._detailConfirmInfo.detailView$.find(".search-results-grid-item-detail-nav-right")];return this._detailConfirmInfo.keyEventFunc=function(e){if(-1!==[n.DOM_VK_LEFT,n.DOM_VK_RIGHT,n.DOM_VK_ESCAPE,n.DOM_VK_RETURN,n.DOM_VK_TAB].indexOf(e.keyCode)){var s=!0;"keyup"===e.type?e.keyCode===n.DOM_VK_LEFT||e.keyCode===n.DOM_VK_RIGHT?this.handleDetailNavClick(null,{isConfirm:!0,domKey:e.keyCode}):e.keyCode===n.DOM_VK_ESCAPE?o(null,e.keyCode):e.keyCode===n.DOM_VK_RETURN?p||o(null,e.keyCode):e.keyCode===n.DOM_VK_TAB&&(e.shiftKey?--p<0&&(p=f.length-1):++p>f.length-1&&(p=0),f[p].focus()):"keydown"===e.type&&p&&e.keyCode===n.DOM_VK_RETURN&&(s=!1),s&&e.preventDefault()}}.bind(this),t.gridlessOptions&&(this._detailConfirmInfo.keyEventElem$=e(document),this._detailConfirmInfo.keyEventElem$.on("keydown.searchDetailConfirm, keyup.searchDetailConfirm",this._detailConfirmInfo.keyEventFunc)),this._trackConfirmEvent("templatePreviewed",{}),this._detailConfirmInfo.closeDefer.promise},_showDetailViewForAsset:function(t,r,i){this._detailInfo={totalAssets:r.length,canNav:r.length>1,assets:r,maxW:1e3,maxH:1e3,itemsViewed:{byId:{},total:0}},this._showingDetail||(this.detailView$.addClass("revealing"),this.detailView$.removeClass("hide"),s.delay(function(){this.detailView$.removeClass("revealing")}.bind(this),0)),this._resetHiRezDetailRequests(!0),this._setDetailAsset(t,{noScroll:!0,analytics:i}),this._detailInfo.canNav?(this.detailView$.addClass("can-nav"),this._setupDetailResultsScroll({current:!0})):(this.detailView$.removeClass("can-nav"),this._setupDetailResultsScroll({reset:!0})),this._showingDetail=!0,this.tagClickedSinceChangingToGridDetail=!1,e(document.body).find(".vb-search-header").addClass("short-header")},closeDetail:function(){this._showingDetail=!1,this.detailView$.addClass("hide"),this._resetHiRezDetailRequests(),e(document.body).find(".vb-search-header").removeClass("short-header")},handleDetailNavClick:function(s,t){var r=(t=t||{}).isConfirm&&this._detailConfirmInfo||this._detailInfo,i=0,a=r.index;s?i="right"===e(s.currentTarget).data("id")?1:-1:t.domKey===n.DOM_VK_LEFT?i=-1:t.domKey===n.DOM_VK_RIGHT&&(i=1);if(i){(a=r.index+i)<0?a=r.totalAssets-1:a>=r.totalAssets&&(a=0);var l=r.assets[a];t.isConfirm?this._setDetailConfirmAsset(l):this._setDetailAsset(l,{analytics:{context:"from-results-detail-nav"}})}},handleDetailBackArrowClick:function(e){this.closeDetail()},handleDetailCtaClick:function(s){var t=e(s.currentTarget).data("cta-type");if("create"===t){var r={context:"item-detail-create",alias:this._detailInfo.asset.alias||this._detailInfo.asset.id};this.gridOptions.createFromThumbClickHandler(this._detailInfo.asset,{analytics:r,event:s,detailRenditionInfo:this._detailInfo.renditionInfo})}else"share"===t?this.handleShareTemplateButton(s):"favorite"===t&&this.handleFavoriteIconClick(s)},handleDetailResultNavClick:function(s){var t=e(s.currentTarget),r=this._getAssetFromClickTarget(t,".search-results-grid-item-detail-other-results-item");this._setDetailAsset(r,{analytics:{context:"from-results-detail-thumb"}})},_scrollDetailAssetIntoView:function(e){e=e||{};this._detailResultsScroll.resultsSection$[0].scrollWidth;var s,t,r=this._detailResultsScroll.scroller$.innerWidth(),i=(s=e.asset?this.detailView$.find("#other-results-item-"+e.asset.id):this._detailInfo.selectedThumbItem$).offset().left,a=this._detailResultsScroll.scroller$.scrollLeft();if(i<0)t=i;else{var l=i+s.outerWidth();l>r&&(t=l-r)}t&&this._detailResultsScroll.scroller$.scrollLeft(a+t)},_setupDetailResultsScroll:function(e){e=e||{};var s=this.$el.find(".search-results-grid-item-detail-other-results-section-scroller-holder"),t=s.find(".search-results-grid-item-detail-other-results-section-scroller"),r=t.find(".search-results-grid-item-detail-other-results-section");this._detailResultsScroll={scrollerHolder$:s,scroller$:t,resultsSection$:r},e.current?this._scrollDetailAssetIntoView():e.reset?this._detailResultsScroll.scroller$.scrollLeft(0):e.asset&&this._scrollDetailAssetIntoView(e)},handleShareTemplateButton:function(e){this._shareModal$.removeClass("hide"),this._shareModalMenu$.removeClass("hide")},handleShareTemplateCtaClick:function(s){s.preventDefault(),s.stopImmediatePropagation();var t=e(s.currentTarget).data("share-type");"twitter"===t?this.onTwitterShare():"facebook"===t?this.onFacebookShare():"email"===t?this.onEmailShare():"copy"===t&&this.onCopyShare()},handleShareModalCloseClick:function(e){e.preventDefault(),this.closeModal()},onCopyShare:function(){if(this._supportsClipboard){var e=this._shareModal$.find(".js-copy-link"),s=e.data("copy-url");try{i.copyStringToClipboard(s),e.addClass("copied"),e.one("mouseleave",function(s){s.target===s.currentTarget&&e.removeClass("copied"),this.closeModal()}.bind(this))}catch(t){}}},popup:function(e,s,t,r){var i=screen.width/2-t/2,a=screen.height/2-r/2;window.open(e,s,"width="+t+",height="+r+",left="+i+",top="+a+",scrollbars=no,status=0")},closeModal:function(e){this._shareModal$.addClass("hide")},onEmailShare:function(){window.location.href=this._shareModal$.find(".js-email").attr("href"),this.closeModal()},onTwitterShare:function(){var e=this._shareModal$.find(".js-twitter-share").attr("href");this.popup(e,h.getString("npw-vb-search-results-detail-share-modal-title-twitter"),680,500),this.closeModal()},onFacebookShare:function(){var e=this._shareModal$.find(".js-facebook-share").attr("href");this.popup(e,h.getString("npw-vb-search-results-detail-share-modal-title-fb"),680,500),this.closeModal()},_setShareTemplateHtml:function(e){var s="https://spark.adobe.com/"+e.app+"/"+(e.alias||e.id);this._supportsClipboard=i.isClipboardSupported();var t={twitterShareUrl:"https://twitter.com/intent/tweet?url="+encodeURIComponent(s)+"&via=AdobeSpark&hashtags=adobespark",facebookShareUrl:"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(s),mailtoString:this.getMailtoString(s,e),copyUrl:this._supportsClipboard&&s};this._extendDebugSettingsToTemplateSettings(t);var r=h.mustacheRender(f,t);this.share$=this.$el.find(".search-results-grid-item-detail-share"),this.share$.html(r),this._shareModal$=this.share$.find(".social-modal"),this._shareModalMenu$=this._shareModal$.find(".social-modal-menu")},getMailtoString:function(e,s){encodeURIComponent("\r\n\r\n");var t={format:o.getFormatInfo(s.app).type,url:e};return"mailto:"+h.formatMessage("npw-vb-search-results-detail-share-modal-mailto",t)}})}.apply(s,r))||(e.exports=i)},3424:function(e,s){e.exports='{{#detailData}}\n<div class="search-results-grid-item-detail-header">\n    <button class="npw-visual-browse-header-back-arrow grid-detail-header-back-arrow{{#detailBackArrowText}} has-text{{/detailBackArrowText}}" title="{{detailBackArrowText}}">{{detailBackArrowText}}</button>\n    <button class="search-results-grid-item-detail-header-create search-results-grid-item-detail-cta" data-cta-type="create">{{npw-vb-search-results-detail-create-btn}}</button>\n    <div class="search-results-grid-item-detail-header-ctas">\n        <div class="search-results-grid-item-detail-header-cta search-results-grid-item-detail-header-cta-share search-results-grid-item-detail-cta" data-cta-type="share">{{npw-vb-search-results-detail-share}}</div>\n        <div class="search-results-grid-item-detail-header-cta search-results-grid-item-detail-header-cta-favorite search-results-grid-item-detail-cta" data-cta-type="favorite"><span class="search-results-grid-item-detail-header-cta-favorite-is-not">{{npw-vb-search-results-detail-add-to-favorites}}</span><span class="search-results-grid-item-detail-header-cta-favorite-is">npw-vb-search-results-detail-favorited</span></div>\n    </div>\n</div>\n<div class="search-results-grid-item-detail-share"></div>\n<div class="search-results-grid-item-detail">\n    <div class="search-results-grid-item-detail-image-section">\n        <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left" data-id="left">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </div>\n        <div class="search-results-grid-item-detail-image-and-tags-holder">\n            <div class="search-results-grid-item-detail-image-holder">\n                <div class="search-results-grid-item-thumb-premium-icon"></div>\n                <div class="search-results-grid-item-detail-loading"></div>\n                <div class="search-results-grid-item-detail-image"></div>\n            </div>\n            {{^detailsOnRight}}\n            <div class="search-results-grid-item-detail-tags">\n                {{#allTags}}\n                    {{^hideTag}}\n                    <div class="search-results-grid-item-detail-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-detail-tag-tag-{{id}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>\n                    {{/hideTag}}\n                {{/allTags}}\n            </div>\n            {{/detailsOnRight}}\n        </div>\n        <div class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right" data-id="right">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </div>\n    </div>\n    <div class="search-results-grid-item-detail-other-results-section-scroller-holder">\n        <div class="search-results-grid-item-detail-other-results-section-scroller">\n            <div class="search-results-grid-item-detail-other-results-section" style="width:{{detailAssetsData.totalWidth}};max-width:{{detailAssetsData.maxTotalWidth}};{{#detailAssetsData.minTotalWidth}}min-width:{{.}};{{/detailAssetsData.minTotalWidth}}">\n            {{#detailAssetsData}}\n            {{#assets}}\n                <div class="search-results-grid-item-detail-other-results-item{{#selected}} selected{{/selected}}{{#isFavorite}} is-favorite{{/isFavorite}}{{#isPremiumTemplate}} is-premium-template{{/isPremiumTemplate}}" data-premium="{{isPremiumTemplate}}" style="width:{{detailResultWidth}};" id="other-results-item-{{id}}" data-id="{{id}}">\n                    {{#favoritesEnabled}}\n                    <div class="search-results-grid-item-thumb-favorite-icon"></div>\n                    {{/favoritesEnabled}}\n                    {{#isPremiumTemplate}}\n                    <div class="search-results-grid-item-thumb-premium-icon"></div>\n                    {{/isPremiumTemplate}}\n                    <div class="search-results-grid-item-detail-other-results-item-thumb" style="width:100%;height:{{detailAssetsData.thumbHeight}};{{#detailAssetsData.minThumbHeight}}min-height:{{.}}{{/detailAssetsData.minThumbHeight}}" id="{{thumbId}}">\n                    <div class="search-results-grid-item-detail-other-results-item-thumb-loader">\n                    </div>\n                    </div>\n                    <div class="search-results-grid-item-detail-other-results-item-selection"></div>\n                    {{! not setting for now}}{{#showDetailThumbLabels}}{{#label}}<div class="search-results-grid-item-detail-other-results-item-label">{{.}}</div>{{/label}}{{/showDetailThumbLabels}}\n                </div>\n            {{/assets}}\n            {{/detailAssetsData}}\n            </div>\n        </div>\n    </div>\n</div>\n<div class="search-results-grid-item-detail-right">\n</div>\n{{/detailData}}\n'},3425:function(e,s){e.exports='<div class="search-results-grid-item-detail{{#canNav}} can-nav{{/canNav}}{{#cssClass}} {{.}}{{/cssClass}}" data-auto="search-results-detail-confirm">\n    <button class="detail-close-button search-results-grid-item-detail-confirm-button" data-auto="search-results-detail-confirm-close-btn"></button>\n    <div class="search-results-grid-item-detail-image-section{{#previewNavType}} show-preview-nav show-preview-nav-{{previewNavType}}{{/previewNavType}}">\n        {{#showPreviewNavSide}}\n        <button class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left search-results-grid-item-detail-confirm-button" data-id="left">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </button>\n        {{/showPreviewNavSide}}\n        <div class="search-results-grid-item-detail-image-and-tags-holder">\n            {{#isVertical}}\n            <div class="search-results-detail-confirm-asset-label"></div>\n            {{/isVertical}}\n            <div class="search-results-grid-item-detail-image-holder">\n                <div class="search-results-grid-item-thumb-premium-icon hide-if-not-premium{{#premiumTemplateBadge}} {{.}}{{/premiumTemplateBadge}}"></div>\n                <div class="search-results-grid-item-detail-loading"></div>\n                <div class="search-results-grid-item-detail-image"></div>\n                {{#animationEnabled}}\n                    {{#autoPlayDetailAnimation}}\n                        <video class="search-results-grid-item-detail-animation hide" autoplay loop>\n                            <source src="" type="video/mp4">\n                        </video>\n                    {{/autoPlayDetailAnimation}}\n                    {{^autoPlayDetailAnimation}}\n                        <video class="search-results-grid-item-detail-animation hide" controls>\n                            <source src="" type="video/mp4">\n                        </video>\n                    {{/autoPlayDetailAnimation}}\n                {{/animationEnabled}}\n            </div>\n            {{#isVertical}}\n            <div class="search-results-detail-confirm-premium-and-num-remixes match-image-holder-width">\n                <div class="search-results-grid-item-detail-premium-blurbs">\n                    <div class="search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-template hide-if-not-premium{{#premiumTemplateBadge}} {{.}}{{/premiumTemplateBadge}}">{{search-results-confirm-premium-template}}</div>\n                    <div class="hide search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-blurb-fonts show-if-premium-ingredient-fonts">{{search-results-confirm-made-width-adobe-fonts}}</div>\n                </div>\n                <div class="search-results-detail-confirm-num-remixes"></div>\n            </div>\n            {{/isVertical}}\n        </div>\n        {{#showPreviewNavSide}}\n        <button class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right search-results-grid-item-detail-confirm-button" data-id="right">\n            <div class="search-results-grid-item-detail-nav-icon"></div>\n        </button>\n        {{/showPreviewNavSide}}\n        {{#showPreviewNavBottom}}\n        <div class="search-results-grid-item-detail-preview-nav">\n            <button class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-left  search-results-grid-item-detail-confirm-button" data-id="left">\n                <div class="search-results-grid-item-detail-nav-icon"></div>\n            </button>\n            <button class="search-results-grid-item-detail-nav search-results-grid-item-detail-nav-right  search-results-grid-item-detail-confirm-button" data-id="right">\n                <div class="search-results-grid-item-detail-nav-icon"></div>\n            </button>\n        </div>\n        {{/showPreviewNavBottom}}\n    </div>\n    <div class="search-results-grid-item-detail-confirm-right">\n        {{^isVertical}}\n        <div class="search-results-grid-item-detail-premium-blurbs">\n            <div class="search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-template hide-if-not-premium{{#premiumTemplateBadge}} {{.}}{{/premiumTemplateBadge}}">{{search-results-confirm-premium-template}}</div>\n            <div class="hide search-results-grid-item-detail-premium-blurb search-results-grid-item-detail-premium-blurb-fonts show-if-premium-ingredient-fonts">{{search-results-confirm-made-width-adobe-fonts}}</div>\n        </div>\n        {{/isVertical}}\n        <div class="search-results-grid-item-detail-message-and-ctas">\n            {{#title}}\n            <h2 class="search-results-grid-item-detail-confirm-title">{{title}}</h2>\n            {{/title}}\n            {{#subtitle}}\n            <h3 class="search-results-grid-item-detail-confirm-subtitle">{{{subtitle}}}</h3>\n            {{/subtitle}}\n            {{#numCheckboxes}}\n            {{#checkboxes}}\n            <label class="spectrum-Checkbox">\n                {{#checked}}\n                <input type="checkbox" class="spectrum-Checkbox-input" name="{{id}}" id="{{id}}" data-auto="search-results-detail-confirm-checkbox-{{id}}" checked>\n                {{/checked}}\n                {{^checked}}\n                <input type="checkbox" class="spectrum-Checkbox-input" name="{{id}}" id="{{id}}" data-auto="search-results-detail-confirm-checkbox-{{id}}">\n                {{/checked}}\n                <span class="spectrum-Checkbox-box-holder">\n                <span class="spectrum-Checkbox-box-border"></span>\n                <span class="spectrum-Checkbox-box-check"></span>\n                </span>\n                <span class="spectrum-Checkbox-label">{{text}}</span>\n            </label>\n            {{/checkboxes}}\n            {{/numCheckboxes}}\n            <div class="search-results-grid-item-detail-confirm-ctas">\n            {{#ctas}}\n                <button class="search-results-grid-item-detail-confirm-cta {{#primary}} primary-cta{{/primary}} search-results-grid-item-detail-confirm-button" data-id="{{id}}" data-auto="search-results-detail-confirm-cta-{{id}}">{{text}}</button>\n            {{/ctas}}\n            </div>\n        </div>\n    </div>\n</div>\n'},3426:function(e,s){e.exports='<div class="search-results-grid-item-detail-right-ctas">\n    <div class="search-results-grid-item-detail-right-cta search-results-grid-item-detail-cta" data-cta-type="create">Create a {{appLabel}} like this</div>\n\n    <div class="search-results-grid-item-detail-share">\n    </div>\n</div>\n<div class="search-results-grid-item-detail-right-tags">\n    {{#allTags}}\n        <div class="search-results-grid-item-detail-right-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}} {{debugCssStr}}" data-id="{{id}}">{{label}}</div>\n    {{/allTags}}\n</div>'},3427:function(e,s){e.exports='<div class="search-results-grid-view{{#favoritesEnabled}} favorites-enabled{{/favoritesEnabled}}" data-auto="search-reults-grid-view">\n{{#tagsAboveResults}}\n<div class="search-results-tags{{#atMaxSelectedTags}} at-max-tags{{/atMaxSelectedTags}}" data-auto="search-results-grid-view-tags">\n    {{#tags}}\n    <button class="search-results-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}}{{#customFilterType}} ignore-at-max-tags{{/customFilterType}} {{debugCssStr}}" title="{{title}}" data-id="{{id}}" data-src-key="{{srcKey}}" data-index="{{index}}">{{label}}</button>\n    {{/tags}}\n</div>\n{{/tagsAboveResults}}\n<div class="search-results-grid-item-detail-holder hide">\n    {{ > itemDetail}}\n</div>\n<div class="search-results-grid-holder">\n    <div class="search-results-grid{{#favoritesEnabled}} favorites-enabled{{/favoritesEnabled}}" style="max-width:{{maxRowWidth}}">\n    {{{assetsStyles}}}\n    {{#rows}}\n    <div class="search-results-grid-row{{#partialRow}} {{partialRow}}{{/partialRow}}{{#delayAllAssets}} hide-assets{{/delayAllAssets}}" style="{{#rowVSpace}}margin-top:{{rowVSpace}}px;{{/rowVSpace}}" data-auto="search-results-grid-view-row" data-index="{{index}}">\n        {{#assets}}\n            <button class="search-results-grid-item search-results-grid-item-{{type}}{{#isPremiumTemplate}} is-premium-template{{/isPremiumTemplate}}{{#isFavorite}} is-favorite{{/isFavorite}}{{#animation}} has-animation{{/animation}}{{#hideUntilLoaded}} not-loaded{{/hideUntilLoaded}}{{#hadLoadError}} had-load-error{{/hadLoadError}}{{#implicitCreateCta}} implicit-create-cta{{/implicitCreateCta}}{{#isEdge}} is-edge{{/isEdge}}{{#isIE}} is-IE{{/isIE}}" style="{{#marginRight}}margin-right:{{marginRight}};{{/marginRight}}" id="{{id}}" data-tags="{{tagsForData}}" data-id="{{id}}" data-cta="{{#implicitCreateCta}}create{{/implicitCreateCta}}"  data-cta-item-id="{{#implicitCreateCta}}{{ctaItemId}}{{/implicitCreateCta}}" data-premium="{{isPremiumTemplate}}" data-auto="search-results-grid-item" data-index-in-row="{{indexInRow}}">\n                <div class="search-results-grid-item-thumb-bg-load" style="width:{{bgLoadWidth}};height:{{bgLoadHeight}}"></div>\n                <div class="search-results-grid-item-thumb" id="{{thumbId}}">\n                    {{#favoritesEnabled}}\n                    <div class="search-results-grid-item-thumb-favorite-icon"></div>\n                    {{/favoritesEnabled}}\n                    {{#isPremiumTemplate}}\n                    <div class="search-results-grid-item-thumb-premium-icon{{#premiumTemplateBadge}} {{.}}{{/premiumTemplateBadge}}"></div>\n                    {{/isPremiumTemplate}}\n                    {{#animation}}\n                    <div class="search-results-grid-item-thumb-animation-icon"></div>\n                    <video class="search-results-grid-item-thumb-animation hide" height="{{height}}" width="{{width}}" loop>\n                    {{#preloadAllResultMp4s}}\n                    <source src="{{{href}}}" type="video/mp4">\n                    {{/preloadAllResultMp4s}}\n                    {{^preloadAllResultMp4s}}\n                    <source src="" data-src="{{{href}}}" type="video/mp4">\n                    {{/preloadAllResultMp4s}}\n                    </video>\n                    {{/animation}}\n                    <div class="search-results-grid-item-thumb-icon"></div>\n                    <div class="search-results-grid-item-hover-thang{{#isEdge}} is-edge{{/isEdge}}{{#isIE}} is-IE{{/isIE}}">\n                        <div class="search-results-grid-item-hover-thang-background"></div>\n                        {{#hoverCtas.numCtas}}\n                        <div class="search-results-grid-item-hover-ctas">\n                            {{#hoverCtas.ctas}}\n                            <div class="search-results-grid-item-hover-cta search-results-grid-item-hover-cta-{{id}}" data-id="{{id}}"></div>\n                            {{/hoverCtas.ctas}}\n                        </div>\n                        {{/hoverCtas.numCtas}}\n                        {{^implicitCreateCta}}\n                        <div class="search-results-grid-main-cta search-results-grid-main-cta-create" data-analytics-id="thumb-hover-create" data-auto="search-result-item-cta-create" data-cta="create" data-cta-item-id="{{ctaItemId}}">{{uiStrings.resultItemCreateFrom}}</div>\n                        {{/implicitCreateCta}}\n                        <div class="search-results-grid-item-hover-tags {{debugCssStr}}">\n                        {{#debugCssStr}}\n                        <div class="search-results-grid-item-hover-id {{debugCssStr}}" data-id="{{id}}">{{id}}</div>\n                        <div class="search-results-grid-item-hover-size {{debugCssStr}}">{{assetW}}x{{assetH}}({{assetAspectRatio}})</div>\n                        {{#score}}\n                        <div class="search-results-grid-item-hover-score {{debugCssStr}}">{{score}}</div>\n                        {{/score}}\n                        {{/debugCssStr}}\n                        {{#allTags}}\n                        <div class="search-results-grid-item-hover-tag search-results-tag-button search-results-tag-prefix-{{prefix}}{{#selected}} selected{{/selected}} search-results-tag-tag-{{id}} {{debugCssStr}}" title="{{#debugCssStr}}{{prefix}}{{/debugCssStr}}" data-id="{{id}}">{{label}}</div>\n                        {{/allTags}}\n                        </div>\n                    </div>\n                </div>\n                {{#label}}\n                <div class="search-results-grid-item-label {{debugCssStr}}">{{.}}</div>\n                {{/label}}\n            </button>\n        {{/assets}}\n    </div>\n    {{/rows}}\n    </div>\n    {{#pagination}}\n    <div class="search-results-pagination{{#hasMore}} has-more{{/hasMore}}">\n        <div class="search-results-pagination-pages-info">{{^total}}{{#fm}}npw-vb-search-results-pagination-none{{/fm}}{{/total}}{{#total}}{{#fm}}npw-vb-search-results-pagination-some{{/fm}}{{/total}}</div>\n\n        <button class="search-results-pagination-more load-more-toggle">{{npw-vb-search-results-see-more}}</button>\n\n    </div>\n    {{/pagination}}\n</div>\n</div>\n'},3428:function(e,s){e.exports='<div class="social-modal js-share-modal social-overlay-bg hide">\n            <div class="social-modal-bg">\n                <button class="x-close-btn js-close-modal">X</button>\n                <div class="social-modal-header">{{npw-vb-search-results-detail-share-modal-title}}</div>\n                <div class="social-modal-menu hide js-social-modal-menu">\n                    <div href="{{{ twitterShareUrl }}}" target="_blank" data-share-type="twitter" class="social-line twitter js-twitter-share">{{npw-vb-search-results-detail-share-modal-btn-tweet}}</div>\n                    <div href="{{{ facebookShareUrl }}}" target="_blank" data-share-type="facebook" class="social-line facebook js-facebook-share">{{npw-vb-search-results-detail-share-modal-btn-fb}}</div>\n\n                    <div href="{{ mailtoString }}" target="_blank" data-share-type="email" class="social-line email js-email">{{npw-vb-search-results-detail-share-modal-btn-email}}</div>\n                    {{#copyUrl}}\n                    <div class="social-line copy js-copy-link" data-copy-url="{{.}}"" data-share-type="copy"><span class="copy-span">{{npw-vb-search-results-detail-share-modal-btn-copy-link}}</span><span class="copied-span">{{npw-vb-search-results-detail-share-modal-link-copied}}</span></div>\n                    {{/copyUrl}}\n                </div>\n            </div>\n        </div>\n'},3429:function(e,s,t){var r,i;r=[t(6),t(2),t(0),t(5),t(76),t(15)],void 0===(i=function(e,s,t,r,i,a){"use strict";var l={};return r.Model.extend({initialize:function(e){e=e||{},l={},this.MAX_TEMPLATE_SEARCH_STRING_LENGTH=e.MAX_TEMPLATE_SEARCH_STRING_LENGTH,this.MAX_TEMPLATE_SEARCH_TERMS=e.MAX_TEMPLATE_SEARCH_TERMS,this.MAX_SUGGEST_IF_FILTERS=3,this.MAX_RESULTS_CACHE_TIME=e.MAX_RESULTS_CACHE_TIME||72e5,this.FALLBACK_NUM_TEMPLATES_IF_INIT_ERROR=25e3,l[e.REMIX_PAID_MAP_TAG]={tag:e.REMIX_PAID_MAP_TAG,dflt:"hide"},l[e.GIPHY_TAG]={tag:e.GIPHY_TAG,dflt:"hide"},this._cachedResults=window._cachedSearchSuggestControllerResults||{},window._cachedSearchSuggestControllerResults||(window._cachedSearchSuggestControllerResults=this._cachedResults),this._setupFilters(),this.searchServiceSuggestOptions=s.assign({},e.searchServiceSuggestOptions),this.SearchRequestsController=e.SearchRequestsController,this._initMostCommonAggs(this.searchServiceSuggestOptions.optionsForAllQuery).done()},suggestAggsOnSpace:function(){return this.searchServiceSuggestOptions.suggestAggsOnSpace},_setupFilters:function(e){this._specialTagFilters=e&&e.specialTagFilters||l,s.each(this._specialTagFilters,(function(e){e.key=e.tag.split("-")[1]}))},_suggestedTagPrefixOrder:["spterm","spstyle","spcolor","spsize","spcase","explore","spingred","spinfluencer","spcollect","spmap"],_tagPrefixLabels:{explore:{singular:"category",plural:"categories"},spcase:{singluar:"use case",plural:"use cases"},spterm:{singular:"term",plural:"terms"},spstyle:{singular:"style",plural:"styles"},spcolor:{singular:"color",plural:"colors"},spsize:{singular:"size",plural:"sizes"},spmap:{singlar:"map",plural:"maps"},spingred:{singular:"ingredient",plural:"ingredients"},spinfluencer:{singular:"influencer",plural:"influencers"},spcollect:{singular:"collection",plural:"collections"},sploc:{singluar:"locale",plural:"locales"},all:{singular:"tag",plural:"tags"}},_getGroupedTagLinesForService:function(e){var t=e.prefix,r=e.aggs,i=r&&r.length&&r[0],a=i&&i.tagsInOrder,l=" "+t.toLowerCase()+" ";if(!a)return[];var n={},o=[];return s.each(a,function(s){var t,r;if(e.useKeys)s.label||window.marvel.logger.debug("[SearchSuggestController]no tabel for tag",s),t=s.label||s.keyword,r="all";else{var i=s.split("-");r=i[0],t=i[1]}var a=n[r];a||(a={prefix:r,groupId:r,id:r,keywordsById:{},items:[],label:this._tagPrefixLabels[r],isAddText:!0,numMoreItems:0},n[r]=a,o.push(a));var h=a.keywordsById[t];h||-1===l.indexOf(" "+t.toLowerCase()+" ")&&(h={id:t,label:t,count:s.numAssets},e.useKeys?(e.debug&&(h.itemTitle=s.tags.slice(0).sort().join(",")),h.key=t):h.tag=s,h.srcKey=s.srcKey||s.key,a.keywordsById[t]=h,a.items.push(h))}.bind(this)),o.sort(function(e,s){return this._suggestedTagPrefixOrder.indexOf(e.prefix)-this._suggestedTagPrefixOrder.indexOf(s.prefix)}.bind(this)),s.each(o,function(t){t.items.sort((function(e,s){return s.count-e.count})),e.maxItemsToDisplayInGroup&&t.items.length>e.maxItemsToDisplayInGroup&&(t.numMoreItems=t.items.length-e.maxItemsToDisplayInGroup,s.each(t.items.slice(e.maxItemsToDisplayInGroup),(function(e){e.ifShowingAll=!0})))}.bind(this)),o},_getNewTagGroup:function(e,s){return s=s||{},{prefix:e,groupId:e,id:e,items:[],label:this._tagPrefixLabels[e],numMoreItems:0,maxNumSelectedTags:s.maxNumSelectedTags||0,maxKeywordFiltersToDisplay:s.maxKeywordFiltersToDisplay||0,atMaxTags:!1,numMaxTagsSelected:0}},_applyMaxKewywordFiltersToDisplayForGroup:function(e,t){e.maxKeywordFiltersToDisplay&&(e.numMoreItems=0,s.each(e.items,(function(s,r){t&&(s.selected=!1),r<e.maxKeywordFiltersToDisplay?s.ifShowingAll=!1:(s.ifShowingAll=!0,e.numMoreItems++)})))},getSelectedTagsForNoResults:function(e,t){if(t){var r=!1;if(e&&e.length){var i=[],a=[],l={},n=0;s.each(e,(function(e){l[e.label]=!0})),s.each(t.items,(function(e){e.selected=!!l[e.label],e.selected?(a.push(e),e.customFilterType||n++):i.push(e)})),t.items=a.concat(i),t.numSelected=a.length,t.maxNumSelectedTags&&(t.numMaxTagsSelected=n)}else r=!0,t.numSelected=0,t.numMaxTagsSelected=0,t.atMaxTags=!1;return this._applyMaxKewywordFiltersToDisplayForGroup(t,r),t}return this._getTagLinesForSelectedTags({tagFilters:e})},_getTagLinesForSelectedTags:function(e,t){var r,i=t&&t.tagsInOrder&&t.tagsInOrder.length&&t.tagsInOrder,a=e.tagFilters&&e.tagFilters.length&&e.tagFilters;if(i&&!e.showOnlySelectedKeywordFilters||a){r=this._getNewTagGroup("all",e);var l={};if(a){var n=0;s.each(a,(function(t){var i=t.label||t.keyword,a={aggTag:t,label:i,id:i,srcKey:t.srcKey,count:t.numAssets,selected:!0,tags:t.tags&&s.clone(t.tags).sort().join(",")||"",customFilterType:t.customFilterType};e.debug&&(a.itemTitle=a.tags),t.customFilterType||n++,r.items.push(a),l[a.label]=a})),r.numSelected=r.items.length,r.atMaxTags=r.maxNumSelectedTags>0&&n>=r.maxNumSelectedTags,r.numMaxTagsSelected=n}i&&!e.showOnlySelectedKeywordFilters&&(!e.maxKeywordFilters||r.items.length<e.maxKeywordFilters)&&s.find(i,(function(t){var i=t.label;if(!l[i]){l[i]=t;var a={label:i,id:i,count:t.numAssets,aggTag:t,tags:t.tags&&s.clone(t.tags).sort().join(",")||"",srcKey:t.srcKey||i,customFilterType:t.customFilterType};if(e.debug&&(a.itemTitle=a.tags),e.maxKeywordFiltersToDisplay&&r.items.length>=e.maxKeywordFiltersToDisplay&&(a.ifShowingAll=!0,r.numMoreItems++),r.items.push(a),e.maxKeywordFilters&&r.items.length>=e.maxKeywordFilters)return!0}}))}return r},_textLinesFromData:function(e,t){if(!t)return[];var r=[],i=t.toLowerCase();return s.each(e,(function(e,s){var a,l=t,n=e.str,o=n.toLowerCase(),h={chunks:[],key:n};if(o!==i&&(o.startsWith(i)?a=n.substring(t.length):(l="",a=n)),l){var c=t;t.split(" ");h.chunks.push({src:c})}a&&h.chunks.push({hint:a});var d={keysArray:[n.split(" | ").join(" ")],displayArray:[h],totalCount:e.numAssets,srcObj:e};r.push(d)})),r},_recalcNumberOfSplitLines:function(e,s,t){if(e.textLines.length+e.suggestionLines.length>s)if(e.suggestionLines.length<t){var r=s-e.suggestionLines.length;r<e.textLines.length&&(e.textLines=e.textLines.slice(0,r))}else if(s-e.textLines.length>t){var i=s-e.textLines.length;e.suggestionLines=e.suggestionLines.slice(0,i)}else{var a=Math.min(s-t);e.suggestionLines=e.suggestionLines.slice(0,t),e.textLines=e.textLines.slice(0,a)}},_cachedResults:{},_getCachedInfoForOptions:function(e,t){var r=t.cacheId,i=t.tagFilters&&t.tagFilters.length&&t.tagFilters;if(r||(e?r=e:i||(r="_all")),r){var a={cacheId:r},l=this._cachedResults[r];return l&&Date.now()-l.timeStamp<this.MAX_RESULTS_CACHE_TIME&&(a.result=s.cloneDeep(l.result)),a}return{ignore:!0}},_cacheAResult:function(e,t){e.cacheId&&(this._cachedResults[e.cacheId]={result:s.cloneDeep(t),timeStamp:Date.now()})},_getAggsFromResultsTags:function(e,s){var t=this.SearchRequestsController.appendFragStringEmptyAggsToArray([],e,0);return t[0].tagsInOrder=s,t},_getMostCommonAggs:function(e,s){var r=this._getCachedInfoForOptions("",{cacheId:"_allCommonAggs"});if(r.result)return r.result[0].str=e[0],r.result=this.SearchRequestsController.appendFragStringEmptyAggsToArray(r.result,e,1),t(r.result);var i=[];this.searchServiceSuggestOptions.allowPremiumTemplates&&i.push("premium"),this.searchServiceSuggestOptions.animationEnabled&&i.push("animated");var a={tagFilters:null,calcAggsForAllFragments:!0,prepends:i,includeEnglishIfNonEnglish:!0};return this.SearchRequestsController.doAggregatesFromFragmentsQuery([""],a).then(function(s){return this._cacheAResult(r,s),s[0].str=e[0],s=this.SearchRequestsController.appendFragStringEmptyAggsToArray(s,e,1)}.bind(this))},getTotalTemplatesCount:function(){return this._initMostCommonAggsDefer.promise.then(function(e){var s=e&&e[0];return s&&s.totalResults||this.FALLBACK_NUM_TEMPLATES_IF_INIT_ERROR}.bind(this),function(){return this.FALLBACK_NUM_TEMPLATES_IF_INIT_ERROR}.bind(this))},_initMostCommonAggs:function(e){return this._initMostCommonAggsDefer||(this._initMostCommonAggsDefer=t.defer(),this._getMostCommonAggs([""],e).then(function(e){this._initMostCommonAggsDefer.resolve(e)}.bind(this),function(e){window.marvel.logger.warn("[SearchSuggestController] Error getting common aggs in _initMostCommonAggs",e&&e.responseJSON||e),this._initMostCommonAggsDefer.reject(e)}.bind(this))),this._initMostCommonAggsDefer.promise},_getCpPrefixDataFromService:function(e,r){var i=e.prefix,a=1*e.preferredNumSuggestedResults||5,l=1*e.maxTotalResultLinesToDisplay||8,n=e.lastSearchResults&&e.lastSearchResults.tagsData;l<a&&(a=l),i&&(i=this.SearchRequestsController.cleanUserString(i.replace(/  +/g," ").trim())).length>this.MAX_TEMPLATE_SEARCH_STRING_LENGTH&&(i=i.substring(0,this.MAX_TEMPLATE_SEARCH_STRING_LENGTH));var o=this._getCachedInfoForOptions(i,e),h=t.defer(),c=t.defer(),d=this.searchServiceSuggestOptions.numFragmentsToRequest,u=this.searchServiceSuggestOptions.calcAggsForAllFragments;if(o.result)c.resolve(o.result);else if(i){var g,m,p=i,f=i.split(" ");f.length>1&&(this.searchServiceSuggestOptions.multiWordBabel?g=!0:(p=f.pop(),m=f.join(" ")+" "));var v={prefix:p,numFragmentsToRequest:d};this._getSingleFragmentResults(v).then(function(e){if(e.length>0||!g)if(m){var t=s.map(e,(function(e){return m+e}));c.resolve(t)}else c.resolve(e);else v.prefix=f.pop(),this._getSingleFragmentResults(v).then((function(e){if(e.length){m=f.join(" ")+" ";var t=s.map(e,(function(e){return m+e}));c.resolve(t)}else c.resolve(e)})).catch((function(e){c.resolve({err:e})}))}.bind(this)).catch((function(e){c.resolve({err:e})}))}else c.resolve([]);return c.promise.then(function(r){r.err?r=[i]:o.result||this._cacheAResult(o,r);var c,d={},g=e.tagFilters,m=n&&n.tagsInOrder.length&&n.tagsInOrder;r.length||(r=[i]),(this.searchServiceSuggestOptions.updateKeysForUserStringUpdate||e.spaceAggsRecalc)&&(c=!0);var p,f={tagFilters:g,calcAggsForAllFragments:u,includeEnglishIfNonEnglish:!0};if(c){var v=t.defer();p=v.promise,this.SearchRequestsController.doAggregatesFromFragmentsQuery(r,f).then((function(e){v.resolve(e)}),function(s){m?v.resolve(this._getAggsFromResultsTags(r,m)):this._getMostCommonAggs(r,e,f).then((function(e){v.resolve(e)}),(function(){v.reject(s)}))}.bind(this))}else p=m?t(this._getAggsFromResultsTags(r,m)):this._getMostCommonAggs(r,e,f);p.then(function(t){if(e.spaceAggsRecalc&&m){var n=this._getAggsFromResultsTags(r,m);d.selectedTags=this._getTagLinesForSelectedTags(e,n[0])}else d.selectedTags=this._getTagLinesForSelectedTags(e,t[0]);var o=[],c=[];s.each(t,(function(e){var s={str:e.str,numAssets:e.totalResults};s.numAssets&&o.push(s)})),c.sort((function(e,s){return s.numAssets-e.numAssets})),d.splitLinesData={textLines:this._textLinesFromData(o,i),suggestionLines:this._textLinesFromData(c,i)},d.tagLinesGroups=this._getGroupedTagLinesForService({prefix:i,aggs:t,useKeys:!0,maxItemsToDisplayInGroup:e.maxItemsToDisplayInGroup,debug:e.debug}),e.tagFilters&&(d.srcTagFilters=s.cloneDeep(e.tagFilters)),this._recalcNumberOfSplitLines(d.splitLinesData,l,a),h.resolve(d)}.bind(this),(function(e){h.reject(e)}))}.bind(this)).done(),h.promise},_allowedFilterSettings:["hide","only","allow","ignore"],_specialTagFilters:l,remove:function(){},_getSingleFragmentResults:function(r){var a=t.defer(),l={locale:this.searchServiceSuggestOptions.locale,prefix:r.prefix,limit:r.numFragmentsToRequest},n=i.format({protocol:"https",host:this.searchServiceSuggestOptions.host,pathname:this.searchServiceSuggestOptions.pathPrefix,query:l});return e.ajax({type:"GET",url:n,headers:{"X-Api-Key":this.searchServiceSuggestOptions.apiKey,Accept:"application/hal+json"},success:function(e,t,r){e.length&&(e=s.uniqBy(e,(function(e){return e.toLowerCase()}))),a.resolve(e)}.bind(this),error:function(e,s,t){window.marvel.logger.error("[SearchSuggestController] Errored out while attempting to get suggestion: ["+e.status+"]",e.responseJSON||e.responseText||t),a.reject(e)}.bind(this)}),a.promise},getCpPrefixData:function(e,s){return this._getCpPrefixDataFromService(e,s)}})}.apply(s,r))||(e.exports=i)},687:function(e,s,t){var r,i;r=[t(6),t(2),t(0),t(5),t(15),t(22),t(8),t(20),t(283),t(11),t(1),t(62),t(34),t(59),t(76),t(621),t(1752)],void 0===(i=function(e,s,r,i,a,l,n,o,h,c,d,u,g,m,p,f,v){"use strict";var w=g.default,b=new c.default({color:"green",name:"SearchController"}),_=["visualBrowse","projects","home","branding"],x=d.cpTemplateSearchRemixFeedTag,y=d.cpTemplateSearchRemixPaidTag,S=d.cpTemplateSearchMappedTagRemixPaid,T={default:a.getString("npw-vb-back-to-default"),projects:a.getString("npw-vb-back-to-organizer"),branding:a.getString("npw-vb-back-to-branding"),visualBrowse:a.getString("npw-vb-back-to-visual-browse"),searchResults:a.getString("npw-vb-back-to-results"),home:a.getString("npw-vb-back-to-home"),learn:a.getString("npw-vb-back-to-learn")},k={projects:"projects",branding:"branding",learn:"learn",home:""},C={"cy-GB":"en-US"};return new(i.Model.extend({initialize:function(){s.defer(function(){n.isValid().then(this._initSearchRequires.bind(this),(function(){})).done()}.bind(this)),s.bindAll(this,["handleCreateFromHomeTemplateThumb","handleHomeCreateFromScratch"])},_searchViews:{},_searchViewsPreviousInstancesData:{},_findTagsWithPrefix:function(e,t,r){return s.reduce(e,(function(e,s){var i=s.split(t+"-");return""===i[0]&&(r?e.push(i.slice(1)).join("-"):e.push(s)),e}),[])},_seoPageToSearch:{"photo-collage-maker":{keys:"collage"}},setupUrlSearchFromRemixMetadataAndOrSeoPageOrQuery:function(e){if((e=e||{}).query)return this.setupUrlSearchFromArgs(e.query);var t,r,i,a=e.seoPage,l=e.searchRemixMetadata;if(a){if("templates"===a.type||"make"===a.type){var n=a.id.split(":").join("_");i=a.id.split(":"),"templates"===a.type?(i=a.id.split(":"),v.isPlural(i[0])&&(i[0]=v.singular(i[0]))):i=s.map(i,(function(e){var s=e.split("-"),t=s[s.length-1];return"builder"!==t&&"maker"!==t||(e=s.slice(0,s.length-1).join("-")),e})),r="seo:"+a.type+":"+n+":"+(l?"remix":"new")}}else r="remix";var o={trigger:r},h=a.customSearch;if(h)s.assign(o,h);else{var c=[],d=a.id&&this._seoPageToSearch[a.id];if(d)s.assign(o,d);else if(l&&"[]"!=l.tagNames){try{var u=l.tagNames.substring(1,l.tagNames.length-1);t=u.length?s.reduce(u.split(","),(function(e,s){return(s=s.trim())!==x&&e.push(s.trim()),e}),[]):[]}catch(p){t=[]}var g=[];if(t.length){var m=this._findTagsWithPrefix(t,"spcase",!1);m.length?g.push(m[0]):(m=this._findTagsWithPrefix(t,"explore",!1)).length&&g.push(m[0])}g.length||a.id||g.push("spcase-social"),c=s.map(g,(function(e){return e.split("-").splice(1).join("-")}))}i&&i.length&&!d&&(c=c.concat(i)),(c=s.uniq(c)).length?o.keys=c.join("+"):o.all=!0}return l&&!o.assetId&&(o.assetId=l.templateId),this.setupUrlSearchFromArgs(o)},vbTriggeringRemixFromSearchThumb:function(e,s,t){var r;t||(r=s&&s.getDataForReopenRedraw()),this._triggeredRemixData={useCase:e,from:"vb",searchQueryForReopen:t,reopenRedrawData:r}},editorTriggeringRemixFromSearchThumb:function(e,s){this.saveSessionForNewDocRequest(s,null,e,"createFromSearchThumb"),this._triggeredRemixData={useCase:e,from:s.editorApp,reopenRedrawData:s&&s.getDataForReopenRedraw()}},getInitialHomeModuleResults:function(e){return this._initialHomeModuleResultsDefer||(this._initialHomeModuleResultsDefer=r.defer(),this.getASearchRequestsController({addDefaultCallbacks:!0}).then(function(t){var r,i=e.limit;e.eduType?r="spterm-k12":"en"===a.getLocale().split("-")[0]&&(r="explore-feed");e.randomizeOrder&&e.randomSampleSize&&e.randomSampleSize>i&&(i=e.randomSampleSize);var l={limit:i,forceLowerLimit:!0,filters:r};e.allPremium&&(l.filters="premium"),e.forceAnimations&&(l.filters="animated"),t.getTemplateResultsForOpeningEditor("post",l).then(function(t){if(e.randomizeOrder){if(t.nonRamdomAssets=s.clone(t.assets),e.randomSampleSize&&e.randomSampleSize!==e.limit)if(e.randomSampleSize>e.limit)t.assets=s.shuffle(t.assets).slice(0,e.limit);else{var r=t.assets.splice(0,e.randomizeOrder);r=s.shuffle(r),t.assets=r.concat(t.assets)}else t.assets=s.shuffle(t.assets);s.each(t.assets,(function(e,s){e._orderedIndex=s}))}this._initialHomeModuleResults=t,this._initialHomeModuleOriginalQuery=l,this._initialHomeModuleResultsDefer.resolve(t)}.bind(this)).done()}.bind(this)).done()),this._initialHomeModuleResultsDefer.promise},renderingHome:function(){this._headerSearchView&&this._headerSearchView._showingCpResults&&this._headerSearchView.hideResultsForHomeRender()},getHeaderBackInfo:function(){var e,s,t;if(marvel._isInApp){s=(t=p.parse(i.history.fragment,!0).pathname||"").split("/"),t="/"+t}else{var r=a.localePathPrefix,l=window.location.pathname||"";if(s=window.location.pathname.split("/"),r){var n=s.indexOf(r);-1!==n&&(s=s.slice(n))}else"/"===l[0]&&(s=s.slice(1))}if("search"!==(e=s[0])&&"npw"!==e){var o;o=e?"folders"===e?"projects":marvel._isInApp?k[e]||"home":"landing:"+e:"home";return marvel._isInApp?window.marvel.navigate("/search",{trigger:!1,replace:!1}):window.location.href=a.getLocalizedSparkPath("/sp/search"),{backPath:t,backType:o}}return null},_getValidBackInfoQuery:function(e){var t;if(e.backType){var r=e.backType.split("/"),i=r[0].toLowerCase();"organizer"===i&&(i="projects"),s.find(_,(function(e){return e.toLowerCase()===i}))&&(t={backType:i},r.length>1&&(t.backPath=r.join("/")))}return t},setupUrlSearchFromArgs:function(e){if("string"==typeof e)if(-1!==e.indexOf("="))try{e=p.parse("?"+e,!0).query}catch(i){return null}else e={keys:e};s.isUndefined(e.fallbackThresh)&&(e.fallbackThresh=10);var t={searchQuery:e,trigger:e.trigger||"urlSearch",needsToBeTriggered:!0},r=this._getValidBackInfoQuery(e);return r&&(t.backInfo=r),t},triggerSearchForView:function(e,s){},defaultHandleCreateFromSearchResultsThumbClick:function(e,s){w.trigger("create-from-search-results",{asset:e,analytics:s})},_getAppFromAppOrAppProperty:function(e){return e&&(this._searchRequires?e=this._searchRequires.VisualBrowseAndSearchAppsController.getApp(e):("string"==typeof e&&(e=u.getAppByType(e)||u.getAppByName(e)||u.getAppByDocType(e)),!e||e.isaProjectFormat&&e.isaProjectFormat()||(e=null))),e},appSupportsEditorSearch:function(e){return(e=this._getAppFromAppOrAppProperty(e))&&e.appSupportsEditorSearch&&e.appSupportsEditorSearch()?"post"===e.typeName?o.hasFeature("post-templates-search-enabled")&&e:e:null},getBackArrowText:function(e){if(e&&s.startsWith("landing:"))return a.formatMessage("npw-vb-back-to-landing",{landing:e.split(":")[1]});var t=T[e];return t||""===t?t:T.default},getBackInfoFromNPWCurrentPath:function(e,s){var t,r,a=p.parse(e||i.history.fragment,!0);s?t=a.query&&a.query.backType?a.query.backType:"visualBrowse":a.query&&a.query.homeBackType?(t=a.query.homeBackType,r=a.query.backAppPath):t="home";return{text:this.getBackArrowText(t),backId:t,backPath:r}},_getUserFlagTemplatesData:function(){if(!this._userFlagTemplatesData){var e,s,t=!1;this._isLoggedOut?(e=o.hasUnauthenticatedFeature("npw-vb-search-enable-premium-templates-pre-susi"))&&(s=d.cpTemplateSearchRemixPaidDefaultFilter):(e=o.hasFeature("enable-premium-templates"),t=o.hasFeature("enable-giphy-templates-web")&&o.hasFeature("user-flag-image-source-giphy"),e&&o.hasFeature("is-paid-user")&&!o.hasFeature("has-premium-typekit")&&(e=!1),e&&(s=o.hasFeature("is-paid-user")?d.cpTemplateSearchRemixPaidDefaultFilterPremiumUser:d.cpTemplateSearchRemixPaidDefaultFilter));var r=f.getBadgeForPremiumContent("template");this._userFlagTemplatesData={premiumFilter:s,allowPremiumTemplates:e,allowGiphyTemplates:t,showUpgradeForPremium:e&&!o.hasFeature("is-paid-user"),animationEnabled:this.animationEnabled(),autoPlayDetailAnimation:!o.hasFeature("search-animation-detail-no-auto-play"),preloadAllResultMp4s:o.hasFeature("search-animation-preload-for-all-results"),premiumTemplateBadge:r}}return this._userFlagTemplatesData},animationEnabled:function(){return!0},_getCommonOptions:function(){var e,t=this._getUserFlagTemplatesData(),r=o.hasFeature("npw-visual-browse-search-debug-tagging"),i=o.hasFeature("npw-visual-browse-search-page-and-video-as-related"),a=d.sparkContentSearchHostProd,l=!1,n={apiKey:d.sparkContentSearchApiKey,calcAggsForAllFragments:o.hasFeature("search-suggest-aggs-on-all-fragments"),updateKeysForUserStringUpdate:o.hasFeature("search-suggest-update-keys-for-string-update"),multiWordBabel:o.hasFeature("search-suggest-multi-word-babel"),suggestAggsOnSpace:!0,numFragmentsToRequest:8,animationEnabled:this._userFlagTemplatesData.animationEnabled,allowPremiumTemplates:this._userFlagTemplatesData.allowPremiumTemplates,locale:this._searchLocale};o.hasFeature("remix-and-search-use-stage-cp")?(a=d.sparkContentSearchHostStage,n.host=d.sparkContentSuggestHostStage,l=!0):n.host=d.sparkContentSuggestHostProd,r&&(e=a===d.sparkContentSearchHostStage?d.cpCuratorAssetPathStage:d.cpCuratorAssetPathProd),n.pathPrefix="/suggestions";var h={debugTagging:r,debugTaggingAssetPathTemplate:e,showNumbersInLines:r||o.hasFeature("npw-visual-browse-search-numbers-per-line"),keysForTags:!o.hasFeature("npw-visual-browse-search-cp-separate-prefixes"),detailViewEnabled:o.hasFeature("npw-visual-browse-search-cp-enable-detail"),hideAssetUntilLoaded:o.hasFeature("search-results-hide-asset-until-loaded"),allowFieldDefault:o.hasFeature("npw-visual-browse-search-allow-field-default"),showLoadMoreButton:o.hasFeature("npw-visual-browse-show-load-more-button"),searchPageAndVideoAsRelated:i,enableSearchHistory:!0,defaultFallbackThresh:10,usingStageContent:l,searchHost:a,searchPathPrefix:"/v2/content",searchServiceSuggestOptions:n,SearchController:this,isLoggedOut:this._isLoggedOut,searchLocale:this._searchLocale};return s.assign(h,t),h},_moveAssetToHeadOfAssetsArray:function(e,t){var r=-1;s.find(t,(function(s,t){if(s.id===e.id)return r=t,!0})),r>0?(t.splice(r,1),t.unshift(e)):-1===r&&t.unshift(e)},_getAppliedDefaultOptions:function(e,t,r,i){var a=this._getCommonOptions(),l=this._triggeredRemixData;this._triggeredRemixData=null,a.popularSearchStrings=t,r&&!r.unsupported&&(a.sizeFilterInfo=r);var n=e.editorApp&&this._getAppFromAppOrAppProperty(e.editorApp);(e=s.assign({},a,e)).handleCreateFromSearchResultsThumbClick||(e.handleCreateFromSearchResultsThumbClick=this.defaultHandleCreateFromSearchResultsThumbClick.bind(this));var h="";if(this._isEDUAccount&&(h="edu"),e.userProps={eduType:h,isPremiumUser:o.hasFeature("entitle-brand-kit"),refAppEnabled:o.hasFeature("enable-reference-app"),createMenuIconOnlyTrigger:!0,allowPremiumTemplates:e.allowPremiumTemplates},i&&(e.searchReact=i),e.SearchRequestsController&&(e.searchPromise||e.SearchRequestsController._assets))e.autoSearch={useController:!0,needsToBeTriggered:!0,searchPromise:e.searchPromise};else if(e.searchQuery&&!e.autoSearch)e.autoSearch=this.setupUrlSearchFromArgs(e.searchQuery);else if(l&&l.searchQueryForReopen)e.autoSearch=this.setupUrlSearchFromArgs(l.searchQueryForReopen);else if(l&&l.reopenRedrawData){if(l.useCase){var c=l.reopenRedrawData.lastRenderedResults.results,d=c.assetsById[l.useCase.id];d&&(this._moveAssetToHeadOfAssetsArray(d,c.assets),this._moveAssetToHeadOfAssetsArray(d,l.reopenRedrawData.dataToRestore._assets.assetsArray),s.each(c.assets,(function(e,s){e._orderedIndex=s})))}e.searchData=l.reopenRedrawData}else e.searchIfNotVB?e.autoSearch=this.setupUrlSearchFromArgs(e.searchIfNotVB):e.autoSearch||(e.seoPage||e.searchRemixMetadata)&&(e.autoSearch=this.setupUrlSearchFromRemixMetadataAndOrSeoPageOrQuery(e));if(e.editorApp=n,n&&!e.context&&(e.context="editor:"+n.typeName),e.searchViewId=e.searchViewId||e.context,!e.searchData&&!e.autoSearch){var u=this.getCachedView(e.searchViewId),g=u&&u.SearchRequestsController,m=this._searchViewsPreviousInstancesData[e.searchViewId];m?e.searchData=g?g.getSearchDataForRestore(m):m:g&&(e.searchData=g.getSearchDataForRestore(null))}return e.resultsOptions&&!s.isUndefined(e.resultsOptions.implicitCreateCta)||(e.resultsOptions=s.assign({},e.resultsOptions||{},{implicitCreateCta:!0}),e.defaultCreateAction||(e.defaultCreateAction="confirm")),e.allowPremiumTemplates&&e.experimentPremiumFilter&&(e.premiumFilter=e.experimentPremiumFilter),e.SearchController=this,e},_getNonEditorSearchReactRequires:function(){return this._getHomeSearchReactRequiresDefer||(this._getHomeSearchReactRequiresDefer=r.defer(),Promise.all([t.e("m-react-spectrum"),t.e(0),t.e(1),t.e("vendors~brand-kit-context-views~brand-kit-editor~brandswitcher~logged-in-app~non-editor-search-react~37af230b"),t.e("non-editor-search-react")]).then(function(e){var s=t(693).default,r=t(1316).default;this._getHomeSearchReactRequiresDefer.resolve({reactWrapper:s,CreateProjectMenu:r})}.bind(this).bind(null,t)).catch(t.oe)),this._getHomeSearchReactRequiresDefer.promise},_initSearchRequires:function(){return this._initSearchRequiresDefer||(this._initSearchRequiresDefer=r.defer(),this._searchLocale=a.getLocale(),C[this._searchLocale]&&(this._searchLocale=C[this._searchLocale],this._disablePopularSearchStrings=!0),n.isValid().then(function(){return this._isLoggedOut=!1,o.featuresLoaded()}.bind(this),function(e){this._isLoggedOut=!0}.bind(this)).finally(function(){(this._isLoggedOut?r(!1):h.getIsEDUAccount()).then(function(e){Promise.all([t.e("npw-visual-browse-view~search-controller~share-view"),t.e("search-controller")]).then(function(s){var r=t(1774),i=t(2503),a=t(1772),l=t(1325),n=t(2505),o=t(2506);this._isEDUAccount=e,this._searchRequires={SearchView:i,SearchViewTemplate:r,VisualBrowseUseCasesController:a,VisualBrowseAndSearchAppsController:l,SearchRequestsController:n,SearchControllerSizeFilterMapsJSON:o},this._initSearchRequiresDefer.resolve(this._searchRequires)}.bind(this).bind(null,t)).catch(t.oe)}.bind(this)).done()}.bind(this)).done()),this._initSearchRequiresDefer.promise},getCachedView:function(e){return this._searchViews[e]},_editorSizeInfoDefers:{},_getEditorSizeFilterInfoAfterRequires:function(e){var s={unsupported:!0};if(e=this._getAppFromAppOrAppProperty(e)){var t=this._editorSizeInfoDefers[e.typeName];if(!t)if(t=r.defer(),this._editorSizeInfoDefers[e.typeName]=t,e.getSizePickerInfo){var i={sizeFilterMapsJSON:this._searchRequires.SearchControllerSizeFilterMapsJSON};e.getSizePickerInfo().then((function(e){i.pickerInfo=e,t.resolve(i)})).catch((function(e){b.error("error getting size picker info",e),t.resolve(s)}))}else t.resolve(s);return t.promise}return r.resolve(s)},_getDataIdFromViewOptions:function(e){return e.editorApp?"editor:"+e.editorApp.getAppTypeID():e.searchViewId},_requestControllers:{},_getASearchRequestsControllerAfterRequires:function(e){if((e=e||{}).editorApp){var t=this.getCachedView("editor:"+e.editorApp.getAppTypeID());if(t&&t.SearchRequestsController)return t.SearchRequestsController}var r=this._getDataIdFromViewOptions(e),i=s.assign(this._getCommonOptions(),{logger:b,callbacks:{},dataId:r},e,{VisualBrowseUseCasesController:this._searchRequires.VisualBrowseUseCasesController,VisualBrowseAndSearchAppsController:this._searchRequires.VisualBrowseAndSearchAppsController});e.addDefaultCallbacks&&s.each(this._searchRequires.SearchRequestsController.requiredCallbackNames,(function(e){i.callbacks[e]||(i.callbacks[e]=function(){})}));var a=this._requestControllers[r];return a?a.updateOptions(i):(a=new this._searchRequires.SearchRequestsController(i),this._requestControllers[a.dataId]=a),a},getASearchRequestsController:function(e){return this._initSearchRequires().then(function(){return this._getEditorSizeFilterInfoAfterRequires(e.editorApp).then(function(s){return e.sizeFilterInfo=s,this._getASearchRequestsControllerAfterRequires(e)}.bind(this))}.bind(this))},getEditorSizeFilterInfo:function(e){return this._initSearchRequires().then(function(){return this._getEditorSizeFilterInfoAfterRequires(e)}.bind(this))},reopeningEditorWithSearchView:function(e){return this.getASearchView(e)},getASearchView:function(e){return this._initSearchRequires().then(function(){var t,i=[];return e.template=e.template||this._searchRequires.SearchViewTemplate,this._getPopularSearchStringsPromise||(this._getPopularSearchStringsPromise=this._searchRequires.VisualBrowseUseCasesController.getPopularSearchStrings({disablePopularSearchStrings:this._disablePopularSearchStrings})),i.push(this._getPopularSearchStringsPromise),i.push(this._getEditorSizeFilterInfoAfterRequires(e.editorApp||"post")),e.editorApp||(i.push(this._getNonEditorSearchReactRequires()),t=!0),r.allSettled(i).then(function(r){var i,a=r[0].value,l=r[1].value;t&&(i=r[r.length-1].value),"header"!==e.context||this._headerOptions||(this._headerOptions=s.clone(e)),e=this._getAppliedDefaultOptions(e,a,l,i);var n=this.getCachedView(e.searchViewId);return n?("header"===e.searchViewId&&e.context!==n._options.context&&(e.reset=!0,e.SearchRequestsController||(e.SearchRequestsController=n.SearchRequestsController)),n.updateOptions(e)):(e.SearchRequestsController||(e.SearchRequestsController=this._getASearchRequestsControllerAfterRequires(e)),n=new this._searchRequires.SearchView(e),this._searchViews[e.searchViewId]=n),n}.bind(this))}.bind(this))},searchViewShown:function(e,s){e.searchViewShown(s)},removeSearchView:function(e){var t=e._options.searchViewId;if("header"!==t){var r=t&&this._searchViews[t];r&&(r!==e&&b.debug("mismatched views in removeSearchView",{cachedView:r,view:e}),this._searchViewsPreviousInstancesData[t]=r.getDataForReopenRedraw(),delete this._searchViews[t]),e.remove()}else{var i=s.clone(this._headerOptions);this.getASearchView(i).then((function(e){e.setElement(i.el),e.render()}))}},_maxTotalStringLengthForTranslate:512,_cachedTranslationsByTransGroup:{},_cacheTranslationTypeIdFromSendData:function(e){var s=[e.to[0]];return e.preferredSrcLang?s.push(e.preferredSrcLang):e.from&&s.push("f."+e.from),s.join(".")},_getTranslationFromCache:function(e){var s=this._cacheTranslationTypeIdFromSendData(e),t=this._cachedTranslationsByTransGroup[s];return t&&t[e.str[0]]},_addTranslationToCache:function(e,t){var r=this._cacheTranslationTypeIdFromSendData(e),i=this._cachedTranslationsByTransGroup[r],a=e.str[0];i||(i={},this._cachedTranslationsByTransGroup[r]=i),i[a]=s.clone(t)},_getTranslateSettingsFromOptions:function(e){var s,t=e.fromLang,r=e.toLang,i=a.getLocale().split("-").join("_"),l=e.translationType,n=!!l;if(l)if(n=!0,"guessToUs"===l){var o=t||i;s=o,r="en_US",e.guessIfUs||"en_US"===o&&(t=r)}else"currentToUs"===l?(t=i,r="en_US"):"usToCurrent"===l?(t="en_US",r=i):n=!1;n||(t=t&&t.split("-").join("_")||i,r=r&&r.split("-").join("_")||"en_US");var h={contentType:"UGC",domain:"GENERIC",to:[r]};return t&&(h.from=t),s&&(h.preferredSrcLang=s),h.from===h.to[0]&&(h.noTranslationNeeded=!0),h},_getNoTranslateResults:function(e,t){var r=s.map(e.str,(function(s){return{translatedText:s,originalText:s,success:!0,from:e.to,to:e.to[0]}}));return t?r:r[0]},getTranslatedSearchString:function(t){var i;if("string"==typeof t?(i=t,t={}):i=t.textToTranslate,i.length>this._maxTotalStringLengthForTranslate)return r.reject("string longer than "+this._maxTotalStringLengthForTranslate+":"+i.length);var a=this._getTranslateSettingsFromOptions(t),l=i;if(a.str=[l],a.noTranslationNeeded)return r.resolve(this._getNoTranslateResults(a));var n=this._getTranslationFromCache(a);if(n)return r(n);var o={},h=r.defer();return e.ajax({type:"POST",url:d.mtTranslationServicePath,headers:{"X-Api-Key":d.key,"Content-Type":"application/json"},data:JSON.stringify(a),dataType:"json",traditional:!0,success:function(e,t,r){if(e.code)-9!==e.code&&b.error("[Search:MachineTranslation] unexpected translation error:"+e.msg,e),o=this._getNoTranslateResults(a);else{var i=e.Bing;i||(i=s.find(e,(function(e){return e})));var n=i[0],c=n.translations[0];""===(o=s.assign({from:n.from,originalText:n.originalText},c)).translatedText&&(o.translatedText=l)}this._addTranslationToCache(a,o),h.resolve(o)}.bind(this),error:function(e,s,t){b.error("mt translation failure:"+s,e),h.reject(t||"translation service error")}.bind(this)}),h.promise},_navigateRequiringLogin:function(e,t){if(this._isLoggedOut)"/"!==e[0]&&(e="/"+e),window.location.href="/sp"+e;else{var r=s.assign({trigger:!0},t||{});window.marvel.navigate(e,r)}},_visualBrowseLoggedOutCreateNav:function(e,s,t){s&&"new"!==s||(s="newlo");var r="/npw/"+e+"/"+s;t&&("?"!==t.charAt(0)&&(r+="?"),r+=t),this._navigateRequiringLogin(r)},_getRemixUrlFromSearchResultAsset:function(e,s){return e.remixable||e.remixfeed?"design-remix/"+s.type+"/"+(e.alias||e.id):e.remixUrl?e.remixUrl:""},remixFromSearchThumb:function(e,s,t){var r,i=e;switch(t.analytics.context){case"item-detail-create":r="createFromSearchDetail";break;case"item-grid":r="createFromSearchThumb";break;case"home":r="createFromHomeThumb"}this.vbTriggeringRemixFromSearchThumb(e,s,t.searchQueryForReopen),this._handleSearchThumbCreateAnalytics(e,t),this._handleNewDocRequest(s,i.app,i,r)},_handleNewDocRequest:function(e,s,t,r,i){var a=this._searchRequires.VisualBrowseAndSearchAppsController.getFormatInfo(s),l="home:"+i;if(b.debug("need to pass in page info for _handleNewDocRequest"),this.saveSessionForNewDocRequest(e,s,t,r,i),t){var n=this._getRemixUrlFromSearchResultAsset(t,a);if(n)return void this._navigateRequiringLogin(n)}this._isLoggedOut?this._visualBrowseLoggedOutCreateNav(s):a.app.requestAppCreateNew({},l)},_handleSearchThumbCreateAnalytics:function(e,s){var t=s&&s.analytics||{},r=s&&s.eventName||"NPWVisualBrowseCreateFromTemplateResult";this._handleProjectCreateClickedAnalyticsData({eventName:r,extraData:t})},_addCurrentSearchToContextData:function(e,t,r,i,a){var l=e.SearchRequestsController.getCurrentSearch();if(l){var n={str:l.searchStr};l.options.tagFilters&&(n.tagFilters=s.map(l.options.tagFilters,(function(e){return e.tag}))),t.search=n}},saveSessionForNewDocRequest:function(e,s,t,r,i){var a="npw"===(i=i||e&&e._options.context).split(":")[0]?"visual-browse":i,l={},n=e&&"createFromHomeThumb"!==r;t&&("useCaseClicked"===r?(l.useCaseId=t.id.split("_")[0],n=!1):"createFromSearchThumb"===r&&(a+=":search")),l.npwMethod=a,n&&this._addCurrentSearchToContextData(e,l,s,t,r),this._saveProjectContextData(l)},_saveProjectContextData:function(e){if(window.sessionStorage)try{sessionStorage.setItem("project_ctx",JSON.stringify(e))}catch(s){}},_headerSearchInittedDefer:r.defer(),headerSearchInitted:function(){return this._headerSearchInittedDefer.promise},_backArrowClickHandlerForHeader:function(s,t){var i=e(s.target).data("back-id"),a=e(s.target).data("back-path")||"/"+i;return a?("/home"===a&&(a="/"),marvel._isInApp&&window.marvel.navigate(a,{trigger:!0})):history.back(),r()},_formatFilters:{format:{id:"all",app:""}},initHeaderSearch:function(t){if(!this._initHeaderSearchPromise){t=t||{};var r={asHeader:!0,doNotRenderOnInit:!0,templateOptions:{searchViewBarOnly:!0,searchParentHeightControl:!0,searchViewNoBackground:!0,searchViewInHeader:!1,inVbSearchHeader:!0,inMainSearchHeader:!0},el:e(".search-in-main-header"),resultsHolder$:e(".main-header-search-results"),context:"header",sendDeferWithCreateEvent:!1,defaultCreateAction:"confirm",dropdownSelectorStr:".npw-visual-browse-header-create-new-dropdown",createFormats:!0,showFormatFilters:!1,showPlaceholderIfNotShowingResultsGrid:!0,navBackClickHandler:this._backArrowClickHandlerForHeader.bind(this),inMainSearchHeader:!0};s.assign(r,t),this._initHeaderSearchPromise=this.getASearchView(r).then(function(e){return e.render(),this._headerSearchInittedDefer.resolve(e),this._headerSearchView=e,window.marvel.events.on("design-view-unloading",this._handleDesignViewUnloading.bind(this)),window.marvel.events.on("designview-rendersubview-doc-loaded",this._handleDesignViewLoaded.bind(this)),e}.bind(this))}return this._initHeaderSearchPromise},_handleDesignViewUnloading:function(e){this._headerSearchView&&this._headerSearchView._cachedParent$&&(this._headerSearchView.$el.appendTo(this._headerSearchView._cachedParent$),this._headerSearchView._cachedParent$=null)},_handleDesignViewLoaded:function(e){if(this._headerSearchView){var s=this._headerSearchView.$el.parent();s.length&&(this._headerSearchView.$el.detach(),this._headerSearchView._cachedParent$=s)}},getTagNamesAnalyticValForAsset:function(e){var t=s.clone(e.tags||[]);if(t.push(x),e.nsTags&&(t=t.concat(e.nsTags)),e.isPremiumTemplate){t.push(y);var r=t.indexOf(S);-1!==r&&t.splice(r,1)}return t.push(e.sploc),"["+(t=s.uniq(t)).join(",")+"]"},showPremiumUpgradeModalForPremiumTemplate:function(e,s,t){var r=(s=s||{}).analyticsPage||"home",i=s.analyticsFullTagNames||this.getTagNamesAnalyticValForAsset(e);f.showMerchMessagingModal({workflow:"premiumTemplate",destinationUrl:"design-remix/post/"+(e.alias||e.id),asset:e,analyticsPage:r,analyticsFullTagNames:i,detailRenditionInfo:s.detailRenditionInfo,totalAssets:t})},_addFormatToAnalyticsData:function(e,s){var t="unknown";return"page"!==s&&"post"!==s&&"video"!==s||(t=s),e.sparkFormat=t,e},_trackEvent:function(e,t){var r,i;i=r=(t=t||{}).context||"header";var a=s.assign(t,{context:r});l.trackEvent(e,a,i)},_handleProjectCreateClickedAnalyticsData:function(e){e=s.cloneDeep(e),this._trackEvent("project:"+e.eventName,e.extraData)},_handleProjectCreateClickedAnalytics:function(e,s){s=s||{},this._addFormatToAnalyticsData(s,e),this._handleProjectCreateClickedAnalyticsData({eventName:"createClicked",extraData:s})},handleFormatCreateFromScratch:function(e){this._handleProjectCreateClickedAnalytics(e),this._isLoggedOut,this._handleNewDocRequest(this._headerSearchView,e,null,"createClicked")},_sendHomeTemplatePressedAnalytics:function(e){this._sendTemplatePressedAnalyticsForAsset({asset:e.asset||{},categoryName:"homeTemplates",extendedData:e.eventData,templateLocation:"home"})},sendTemplatePressedAnalyticsFromNPW:function(e){this._sendTemplatePressedAnalyticsForAsset({asset:e.useCase,categoryName:"visualBrowse",extendedData:e.extendedData,templateLocation:"npw"})},sendTemplatePressedAnalyticsFromSearchResult:function(e,s){var t=s.asset||s.detailOptions&&s.detailOptions.asset;if(t&&"post"===t.app){var r,i=e._options;r="editor:post"===i.context?"editorPost":"npw"===i.context||"header"===i.context?"search":"unknown";var a="none";s.detailOptions?a=s.detailOptions.analytics.context:s.createOptions&&(a=s.createOptions.analytics.context);var l={categoryName:e.SearchRequestsController.getLastTemplateResultsAnalyticsTriggerCategory(),templateLocation:r,eventAction:a,asset:t,extendTemplatePressed:i.extendTemplatePressed};this._sendTemplatePressedAnalyticsForAsset(l)}},_sendTemplatePressedAnalyticsForAsset:function(e){var s=e.asset,t=e.templateLocation,r=e.eventAction,i=e.categoryName,a={contextualData5:"tagNames:"+this.getTagNamesAnalyticValForAsset(s),contextualData6:"templateType:"+(s.isPremiumTemplate||s.premium?"premium":"free"),contextualData3:"categoryName:"+i,contextualData4:"templateLocation:"+t,templateId:s.id||"none"};r&&(a.eventAction=r),this._userFlagTemplatesData.animationEnabled&&"post"===s.app&&(a.contextualData7="hasAnimation:"+(s.animated?"true":"false")),e.extendTemplatePressed&&e.extendTemplatePressed(a),this._trackEvent("templatePressed",a)},handleCreateFromHomeTemplateThumb:function(e){var t=s.cloneDeep(this._initialHomeModuleOriginalQuery);delete t.limit,delete t.forceLowerLimit,t.trigger="homeTemplates",e.searchInfoForReopen={results:this._initialHomeModuleResults,query:t},e.previewLocation="home",e.searchAnalytics=this._initialHomeModuleResults.searchAnalytics,this._headerSearchView.showCreateConfirmWithoutGrid(e);var r=e.asset,i=e.analytics;this._sendHomeTemplatePressedAnalytics({asset:r,eventData:i})},handleHomeCreateFromScratchInSearch:function(e,s,t){this._handleHomeCreateFromScratch(s,t,e)},handleHomeCreateFromScratch:function(e,s){this._handleHomeCreateFromScratch(e,s,null)},_handleHomeCreateFromScratch:function(e,s,t){"video"===e.app?this.doNewNonPost(e,"video"):"page"===e.app?this.doNewNonPost(e,"page"):"refapp"===e.app?this.doNewNonPost(e,"refapp"):"brandedTemplatePicker"===e.id?this.doPostBrandedTemplate(s,t):this.doPostBlank(e,s)},queryStringFromObject:function(e,t){var r=new URLSearchParams;return s.each(e,(function(e,s){r.set(s,e)})),(t?"?":"")+r},doPostBrandedTemplate:function(e,s){var t,r=e.templateData.asset,i=e.templateData.kit,a=e.templateData.fromScratch,l=e.templateData.app,n=i.getId(),h={workflow:"blank",fallbackThresh:"default",trigger:"CreateProjectMenu"};a?(t="design/"+l+"/new",h.branded=!0,h.sizeCategory="popular"):t=r.remixUrl,t+=this.queryStringFromObject(h,!0),o.hasFeature("entitle-brand-kit")?this._navigateRequiringLogin(t,{trigger:!0,replace:!1}):s?this.navigateToBrandingFromCreateProjectMenu(s,n):this._navigateRequiringLogin("branding/"+(n||""),{trigger:!0})},doPostBlank:function(e,t){var r={"instagram-story":{aspectId:"InstagramStory"},"instagram-post":{aspectId:"Instagram"},"facebook-post":{aspectId:"Facebook"},"facebook-cover":{aspectId:"Facebook"},collage:{sizeCategory:"popular",pickImage:"beforeSize",search:"keys=collage"},flyer:{aspectId:"Poster",search:"flyer"},"custom-size-graphic":{sizeCategory:"custom"},custom:{sizeCategory:"custom"},sizePicker:{}}[e.id]||{};s.assign(r,s.pick(e,["aspectId","search","sizeCategory","pickImage"]));var i={workflow:"blank",fallbackThresh:"default",trigger:"CreateProjectMenu"};s.assign(i,r);var a="/design/post/new"+this.queryStringFromObject(i,!0);this._navigateRequiringLogin(a,{trigger:!0,replace:!1})},doNewNonPost:function(e,s){var t="/design/";s||("refapp"===e.id?s="refapp":(b.warn("unknown action in doNewNonPost",{action:e}),s="page")),t+=s+"/new",this._navigateRequiringLogin(t,{trigger:!0,replace:!1})},navigateToBrandingFromCreateProjectMenu:function(e,s){this._navigateRequiringLogin("branding/"+(s||""),{trigger:!0}),e.returningToHome()},sendAutoPlayAnalytics:function(e,s){var t=e.asset,r=e.context;"editor:post"===r?r="editorPost":"header"===r&&(r="search");var i={contextualData1:"templateLocation:"+r,contextualData2:"templateType:"+(t.isPremiumTemplate?"premium":"free"),templateId:t.id||"none"};this._trackEvent("template:animationHover",i)},autoPlayVideo:function(e,s,t){var r;e.play?r=e:e.length&&e[0].play&&(r=e[0]),r.muted=!0,s&&this.sendAutoPlayAnalytics(s);try{var i=r.play();i&&i.then((function(){t&&t({})}),(function(e){b.info("muted video failed to play",e),t&&t({err:e})}))}catch(a){b.info("muted video failed to play",a),t&&t({err:a})}}}))}.apply(s,r))||(e.exports=i)}}]);
//# sourceMappingURL=search-controller-d5cd91f9.js.map