(window.webpackJsonptheoWebApp=window.webpackJsonptheoWebApp||[]).push([[97,76,87],{"+VG/":function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("KFmL")],void 0===(r=function(e,t,n){return function(e){(e=e||{}).tag=e.tag||"DIV",e.width=e.width||57,e.height=e.height||40,e.label=e.label,e.iconTemplate=e.iconTemplate||"<i></i>",e.template=e.iconTemplate+(e.label?"<label>"+e.label+"</label>":"");var t=new n(e),o=t.update;return t.update=function(t){void 0!==t.label&&(t.template=e.iconTemplate+(t.label?"<label>"+t.label+"</label>":"")),o(t)},t.el.className+=" post-icon-button",t.el.style.width=e.width+"px",t.el.style.height=e.height+"px",t}}.apply(t,o))||(e.exports=r)},"/nf9":function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("2Fsf")],void 0===(r=function(e,t,n){return function(e){var o=(e=e||{}).arrowDirection?"tooltip-arrow-"+e.arrowDirection:"tooltip-arrow-down";e.message||0===e.message?e.template="<p>"+e.message+'</p><p class="'+o+'"></p>':e.template='<p></p><p class="'+o+'"></p>';var r=new n(e),s=r.show,i=r.hide;return r.show=function(e=!0){e?(r.$el.addClass("fade"),t.delay((function(){r.$el.removeClass("fade")}),200),s()):r.hide()},r.hide=function(){r.$el.addClass("fade"),t.delay((function(){i(),r.$el.removeClass("fade")}),200)},r.el.className+=" post-tooltip",r}}.apply(t,o))||(e.exports=r)},"7N+y":function(e,t,n){var o,r;o=[n("8/rx"),n("279a"),n("2Fsf"),n("YLtl")],void 0===(r=function(e,t,n,o){return function(r){r.tag=e.TheoAssetRailNav.elementName;const s=new n(r),i=s.update,a=t.ASSET_RAIL_LIST,l=r.list,c=r.clickCb;let d=!1;const u=function({hide:e=!1,selectedId:t}={}){s.el.hide=e,s.el.setAttribute("list",JSON.stringify(l)),s.el.list=l,void 0!==t&&(s.el.setAttribute("selectedId",t),s.el.selectedId=t)},h=function(e){const t=a[e.originalEvent.detail.id];c(t)},p=function(){d=!1,s.$el.off("ASSET_RAIL_NAV_SELECTION",h)},m=function(){d||(d=!0,s.$el.on("ASSET_RAIL_NAV_SELECTION",h))};s.bind=m,s.show=function(){u({hide:!1})},s.hide=function(){u({hide:!0})},s.update=function({eleProps:e,attributes:t}){o.isEmpty(e)||(e.left=s.parent.getWidth()+20,i(e)),t&&u(t)};return u(),s.events.subscribe("shown",m),s.events.subscribe("hidden",p),s}}.apply(t,o))||(e.exports=r)},Avqh:function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("rCSV"),n("3xm6")],void 0===(r=function(e,t,n,o){const r=n.default;e(document.body);var s=0,i={},a={};function l(t){return{el:t,$el:e(t),events:new r,isHidden:function(){return!1}}}return function(t){var n,c,d={},u=(t=t||{}).template||"",h=!!t.hidden,p="none";function m(){n=d.parent.events.subscribe("change:size",f),c=d.parent.events.subscribe("change:hidden",g),h||(d.localize("initial-render"),d.parent.el.appendChild(d.el))}function f(e){d.handleParentResize(e)}function g(e){!1===h&&(d.events.publish("change:hidden",e),!1===e.hidden?d.events.publish("shown"):d.events.publish("hidden"))}return d.data=t.data,d.context=t.context,d.events=new r,d.id=t.id||"component-"+s++,d.parent=function(e){return"string"==typeof e.parent?i[e.parent]:"object"==typeof e.parent?e.parent:l(e.parentDomElement||document.body)}(t),d.el=t.el||document.createElement(t.tag||"DIV"),d.$el=e(d.el),d.update=function(e){const t=d.el.tagName.includes("THEO-");void 0!==(e=e||{}).hidden&&d.show(!e.hidden),void 0!==e.parentDomElement&&e.parentDomElement!=d.parent.el&&(e.parent=l(e.parentDomElement)),void 0!==e.parent&&(n&&n.remove(),c&&c.remove(),d.$el.remove(),d.parent=e.parent,m());var o=void 0!==e.template;o&&(d.el.innerHTML=e.template),void 0!==e.data&&(d.data=e.data);var r,s=void 0!==e.context;s&&(d.context=e.context),r=o?"content-updated":s?"context-updated":"salient-update",t||d.localize(r)},d.insert=function(){e.contains(d.parent.$el,d.$el)||(d.localize("initial-render"),d.parent.el.appendChild(d.el))},d.show=function(e){!1!==e?h&&(d.insert(),h=!1,d.isHidden()||(d.events.publish("change:hidden",{hidden:h}),d.events.publish("shown")),"none"!=p&&a[p].forEach((function(e){e.id!==d.id&&e.hide()}))):d.hide()},d.remove=function(){h||d.parent.el.removeChild(d.el)},d.hide=function(){if(!h){d.remove();var e=d.isHidden();h=!0,e||(d.events.publish("change:hidden",{hidden:h}),d.events.publish("hidden"))}},d.localize=function(e){if(d.$el&&d.$el.localize){var t=o.localizeContext(d.context);o.transformNodeForLocalization(d.$el,e,t),d.$el.localize(t)}},d.isHidden=function(){return!0===h||!0===d.parent.isHidden()},d.handleParentResize=function(e){},d.getComponentById=function(e){return i[e]},d.republish=function(e,t,n){return e.subscribe(t,(function(){var e=[n||t].concat([].slice.apply(arguments));d.events.publish.apply(d.events,e)}))},d.bindToEventsWithHandlers=function(e){const t=[];for(const n in e)t.hasOwnProperty(n)||t.push(d.events.subscribe(n,e[n]));return t},d.unbindEvents=function(e){e.forEach(e=>{e&&"function"==typeof e.remove&&e.remove()})},function(){if(d.el.id=d.id,d.el.className+=" post-component",t.class&&(d.el.className+=" "+t.class),t.attributes){if(!(t.attributes instanceof Object))throw new Error("config.attributes is not an Object");for(var e in t.attributes)d.el.setAttribute(e,t.attributes[e])}u&&(d.el.innerHTML=u),t.visibilityGroup&&(p=t.visibilityGroup,a[p]?a[p].push(d):a[p]=[d]),m(),i[d.id]=d,o.events.subscribe("change:language",(function(){d.localize("language-changed")}))}(),d}}.apply(t,o))||(e.exports=r)},KFmL:function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("Avqh"),n("Lo4C")],void 0===(r=function(e,t,n,o){return function(t){if((t=t||{}).tag=t.tag||"BUTTON",!t.template){var r=t.label||"i18n.common.kOK";t.hoverLabel?t.template="<span>"+r+"</span>":"icon"===t.closeButtonType?t.template="<i></i>":t.template=r}var s=!0;"boolean"==typeof t.enabled&&(s=t.enabled);var i=new n(t),a=i.update,l=null;function c(){i.$el.off("click",u)}function d(){i.$el.on("click",u)}function u(e){s&&("function"==typeof t.onClick&&t.onClick(e),i.handleClick(e))}return i.handleClick=function(){},i.isEnabled=function(){return s},i.enable=function(){s=!0,i.$el.removeClass("post-button-disabled")},i.disable=function(){s=!1,i.$el.addClass("post-button-disabled")},i.hideHoverLabel=function(){l&&l.hide()},i.updateLabel=function(t){if(l){var n=i.$el.find("span");e(n[0]).text(t)}else i.$el.text(t);i.localize("content-updated")},i.update=function(e){void 0!==(e=e||{}).hoverLabel&&l&&l.update({message:e.hoverLabel,context:e.context}),a(e)},i.el.className+=" post-button",s||(i.el.className+=" post-button-disabled"),t.hoverLabel&&(l=new o({parent:i,hoverLabelPosition:t.hoverLabelPosition,class:t.hoverClass,message:t.hoverLabel}),i.events.subscribe("hidden",l.hide)),i.events.subscribe("shown",d),i.events.subscribe("hidden",c),i.isHidden()||d(),i}}.apply(t,o))||(e.exports=r)},Lo4C:function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("2Fsf")],void 0===(r=function(e,t,n){return function(e){var t=(e=e||{}).hoverEl||e.parent.$el,o=e.hoverLabelPosition?e.hoverLabelPosition:"above",r="below"===o?"pointer-up":"pointer-down";e.message||0===e.message?e.template="<p>"+e.message+'</p><p class="pointer '+r+'"></p>':e.template='<p></p><p class="'+r+'"></p>';var s=new n(e),i=s.update;var a=null;return s.show=function(){null!=a&&(clearTimeout(a),a=null),a=setTimeout((function(){s.$el.addClass("visible")}),750)},s.hide=function(){null!=a&&(clearTimeout(a),a=null),s.$el.removeClass("visible")},s.update=function(t){(e.message||0===e.message)&&(t.template="<p>"+t.message+'</p><p class="pointer '+r+'"></p>'),i(t)},s.el.className+=" post-hover-label post-hover-label-"+o,t.hover(s.show,s.hide),s}}.apply(t,o))||(e.exports=r)},WPh2:function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("KFmL"),n("+Ltv")],void 0===(r=function(e,t,n,o){var r={};return function(e){(e=e||{}).height=e.height||48,e.label=e.label||"",e.template=e.template||"<div class='tab-button-icon'></div><div class='tab-button-inner'>"+e.label+"</div>";var t,s=new n(e),i=e.group||"default",a=e.defaultSelected||!1,l=!1,c=e.isPremium,d=e.isEntitled,u=s.show;return s.handleClick=function(){l?"function"==typeof e.handleClickOnSelected&&e.handleClickOnSelected():s.select({userActivated:!0})},s.show=function(n){if(!0,u(n=n||{}),"function"!=typeof e.onShown||n.silent||e.onShown(),t=o[e.group],n.rememberLastSelectedTab&&t){for(var i=r[groupId],a=0;a<r[groupId].length;a++)if(i[a].id===t&&!i[a].isSelected()){i[a].select();break}}else n.preventSelection||s.select()},s.getSelectedTab=function(){for(var t=r[e.group],n=t.length-1;n>=0;n--)if(t[n].isSelected())return t[n]},s.isSelected=function(){return l},s.deselect=function(){l&&(s.$el.removeClass("post-tab-selected"),l=!1,s.events.publish("deselect"))},s.select=function(t){(t=t||{},"function"!=typeof e.onTrySelect||e.onTrySelect())&&("function"!=typeof e.onSelect||t.silent||e.onSelect(t.userActivated),s.$el.addClass("post-tab-selected"),l=!0,o[e.group]=s.id,r[e.group].forEach((function(e){e.id!==s.id&&e.deselect()})),t.silent||s.events.publish("select"))},s.$el.addClass("post-tab-button"),c&&s.$el.addClass("premium"),d&&s.$el.addClass("entitled"),r[i]?r[i].push(s):r[i]=[s],a&&s.select(),s}}.apply(t,o))||(e.exports=r)},"WPm+":function(e,t,n){"use strict";var o=n("ApVh"),r=n.n(o),s=n("MGCh"),i=n.n(s),a=n("tpS0"),l=n.n(a);t.a=function(e,t,n,o){const s=t.cid,a=e.currentDoc,c=n,d=t.PGMRenderServiceEndpoint,u="png"===c&&o,h=i.a.channel("component:downloadList:renderImage"),p=a.getProjectName(),m=new l.a({headerText:"i18n.dialogs.imageRenderSpinner.kHeaderText",contentText:'<div class="postspinner postspinner-large"></div>',dismissable:!1});function f(e){return e.returnValue="","Your download is not ready. If you close this window, you’ll have to download your file again."}function g(){window.removeEventListener("beforeunload",f)}function b(){m.show();const e=a.id,t=`${d}/render/${e}/format/${u?"png-transparent":c}`;return r.a.getAccessToken().then(e=>function(e,t){const n={headers:{Authorization:"Bearer "+t,"X-Api-Key":s}};return function(){window.addEventListener("beforeunload",f)}(),fetch(e,n).then(v).then(I).catch(w)}(t,e))}function v(e){const t=e.headers.get("content-type"),n=e.headers.get("X-Request-Id"),o="image/png"===t||"image/jpeg"===t,r=t.startsWith("application/json");if(e.ok&&o)return e.blob();if(!e.ok&&r){const t=new Error(e.statusText);throw t.response=e,t.requestId=n,t}}function I(e){const t=new Blob([e],{type:"image/"+c}),n=`${p}.${c}`;if(window.navigator&&window.navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(t,n),m.hide(),void g();const o=document.createElement("a");o.href=window.URL.createObjectURL(t),o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),m.hide(),g()}function w(e){if(m.hide(),g(),e.response&&e.requestId){const t=t=>{const n=t.message,o=t.error_code;T(n+"&#013;&#010;code: "+o+"&#013;&#010;requestId: "+e.requestId,e.response),h.error(n,"code:"+o,"requestId:"+e.requestId)};e.response.json().then(t)}else T(e.message),h.error(e.message)}function T(e,t){const n=t&&t.status>=500?S():"",o=new l.a({headerText:'<span class="image-render-error-modal-header">\n                    <span>\n                        i18n.dialogs.imageRenderError.kHeaderText\n                    </span>\n                    <i class="image-render-error-modal-header__icon"></i>\n                </span>',contentText:y(e,n),dismissable:!0,buttons:[{class:"pill pill-primary-on-light",label:"i18n.common.kDone",onClick:()=>{o.hide()}}]}),r=e=>{const t=e.target;if(t.hasAttribute("js-retry-button"))return o.hide(),void b();if(t.hasAttribute("js-copy-to-clipboard")){const e=t.parentElement;e.previousElementSibling.firstElementChild.select(),document.execCommand("copy"),e.classList.add("is-copied-text"),setTimeout((function(){e.classList.remove("is-copied-text")}),5e3)}};document.addEventListener("click",r),o.show();window.marvel.events.on("spark-dialog-closed",()=>{document.removeEventListener("click",r)})}function y(e,t){return`<div class="image-render-error-modal-content">\n                    ${t?S():""}\n                    <p>\n                        <span>i18n.dialogs.imageRenderError.kPleaseText</span>\n                        <a class="image-render-error-modal-content__link" href="https://adobespark.zendesk.com/hc/en-us/requests/new">\n                            i18n.dialogs.imageRenderError.kContactSupportText\n                        </a>\n                        <span>i18n.dialogs.imageRenderError.kWithFollowingErrorText</span>\n                    </p>\n                    <div class="image-render-error-modal-content__erro-block">\n                        <textarea class="image-render-error-modal-content__erro-block__textarea">\n                            ${e}\n                        </textarea>\n                    </div>\n                    <div class="image-render-error-modal-content__clipboard">\n                        <span js-copy-to-clipboard>\n                            i18n.dialogs.imageRenderError.kClickToCopyText\n                        </span>\n                        <span>\n                            i18n.dialogs.imageRenderError.kErrorCodeCopiedText\n                        </span>\n                    </div>\n                </div>`}function S(){return'<p class="image-render-error-modal-content__retry">\n                    <span>\n                        i18n.dialogs.imageRenderError.kPleaseTryText\n                    </span>\n                    <a href="#" role="button" class="image-render-error-modal-content__link" js-retry-button>\n                        i18n.dialogs.imageRenderError.kDownloadingAgainText\n                    </a>\n                </p>'}return b()}},Y7qu:function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("2Fsf")],void 0===(r=function(e,t,n){return function(e){var o=(e=e||{}).arrowDirection?"tooltip-arrow-"+e.arrowDirection:"tooltip-arrow-down";e.message||0===e.message?e.template="<p>"+e.message+'</p><p class="'+o+'"></p>':e.template='<p></p><p class="'+o+'"></p>';var r=new n(e),s=r.show,i=r.hide,a=r.update;return r.show=function(){r.$el.addClass("fade"),t.delay((function(){r.$el.removeClass("fade")}),200),s()},r.hide=function(){r.$el.addClass("fade"),t.delay((function(){i(),r.$el.removeClass("fade")}),200)},r.update=function(t){(e.message||0===e.message)&&(t.template="<p>"+t.message+'</p><p class="'+o+'"></p>'),a(t)},r.el.className+=" post-slider-tooltip",r}}.apply(t,o))||(e.exports=r)},aOoP:function(e,t,n){"use strict";var o=n("ApVh"),r=n.n(o),s=n("MGCh"),i=n.n(s),a=n("tpS0"),l=n.n(a);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class d extends Error{constructor(...e){super(...e),c(this,"response",void 0),c(this,"requestId",void 0)}}let u,h,p,m,f;const g=i.a.channel("component:downloadList:pdfDownload"),b=e=>(e.returnValue="","Your download is not ready. If you close this window, you’ll have to download your file again."),v=()=>{window.removeEventListener("beforeunload",b)},I=(e,t)=>{const n=t&&t.status>=500?'<p class="pdf-download-error-modal-content__retry"><span>i18n.dialogs.pdfDownloadError.kPleaseTryText</span> <a href="#" role="button" class="pdf-download-error-modal-content__link" js-retry-button>i18n.dialogs.pdfDownloadError.kDownloadingAgainText</a></p>':"",o=new l.a({headerText:'<span class="pdf-download-error-modal-header"><span>i18n.dialogs.pdfDownloadError.kHeaderText</span> <i class="pdf-download-error-modal-header__icon"></i></span>',contentText:`<div class="pdf-download-error-modal-content">${n}<p><span>i18n.dialogs.pdfDownloadError.kPleaseText</span> <a class="pdf-download-error-modal-content__link" href="https://adobespark.zendesk.com/hc/en-us/requests/new">i18n.dialogs.pdfDownloadError.kContactSupportText</a> <span>i18n.dialogs.pdfDownloadError.kWithFollowingErrorText</span></p><div class="pdf-download-error-modal-content__erro-block"><textarea class="pdf-download-error-modal-content__erro-block__textarea">${e}</textarea></div><div class="pdf-download-error-modal-content__clipboard"><span js-copy-to-clipboard>i18n.dialogs.pdfDownloadError.kClickToCopyText</span><span>i18n.dialogs.pdfDownloadError.kErrorCodeCopiedText</span></div></div>`,dismissable:!0,buttons:[{class:"pill pill-primary-on-light",label:"i18n.common.kDone",onClick(){o.hide()}}]})},w=e=>{const t=e.headers.get("content-type"),n=e.headers.get("X-Request-Id"),o="application/pdf"===t,r=t.startsWith("application/json");if(e.ok&&o)return e.blob();if(!e.ok&&r){const t=new d(e.statusText);throw t.response=e,t.requestId=n,t}return Promise.reject("Unable to validate response. Unrecognized response type.")},T=e=>{const t=new Blob([e],{type:"application/pdf"}),n=h+".pdf";if(window.navigator&&window.navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(t,n),p.hide(),void v();const o=document.createElement("a");o.href=window.URL.createObjectURL(t),o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),p.hide(),v()},y=e=>{if(p.hide(),v(),e.response&&e.requestId){const t=t=>{const n=t.message,o=t.error_code,r=`${n}&#013;&#010;code: ${o}&#013;&#010;requestId: ${e.requestId}`;I(r,e.response),g.error(n,"code:"+o,"requestId:"+e.requestId)};e.response.json().then(t)}else I(e.message),g.error(e.message)};function S(){p.show(),h=m.getProjectName();const e=m.id,t=`${f}/pdfs/${e}`;r.a.getAccessToken().then(e=>{const n={headers:{Authorization:"Bearer "+e,"X-Api-Key":u}};window.addEventListener("beforeunload",b),fetch(t,n).then(w).then(T).catch(y)})}t.a=function(e,t){m=e.currentDoc,f=t.PDFExportServiceEndpoint,u=t.cid,p=new l.a({headerText:"i18n.dialogs.pdfDownloadSpinner.kHeaderText",contentText:'<div class="postspinner postspinner-large"></div>',dismissable:!1}),S()}},"d/MO":function(e,t,n){var o,r;o=[n("ym4+"),n("Avqh")],void 0===(r=function(e,t){return function(n){(n=n||{}).tag=n.tag||e.TheoDownloadOptions.elementName,n.label=n.label||"",n.submitButtonLabel=n.submitButtonLabel||"",n.optionsList=n.optionsList||[];const o=new t(n),r=o.update;let s=!0;"boolean"==typeof n.enabled&&(s=n.enabled);const i=e=>s&&"function"==typeof e,a=e=>void 0!==e,l=({name:e,label:t,submitButtonLabel:n,selectedOption:r,optionsList:s})=>{a(e)&&(o.el.name=e),a(t)&&(o.el.buttonLabel=t),a(n)&&(o.el.submitLabel=n),a(r)&&(o.el.selectedOption=r),a(s)&&s.length&&(o.el.optionsList=s)},c=function(e){i(n.onPDFDownload)&&n.onPDFDownload(e)},d=function(e){i(n.onIMGDownload)&&n.onIMGDownload(e)},u=function(e){i(n.onMP4Download720p)&&n.onMP4Download720p(e)},h=function(e){i(n.onIMGDownloadV2)&&n.onIMGDownloadV2(e)};o.update=function(e){l(e),r(e)};const p=function(){if(i(n.onOptionsShown)){o.el.isDownloadListVisible()&&n.onOptionsShown()}},m=function(){o.$el.off("DOWNLOAD_FILE_IMG_PNG",d),o.$el.off("DOWNLOAD_FILE_IMG_JPG",d),o.$el.off("DOWNLOAD_FILE_IMG_PNG_V2",h),o.$el.off("DOWNLOAD_FILE_IMG_JPEG_V2",h),o.$el.off("DOWNLOAD_FILE_PDF",c),o.$el.off("DOWNLOAD_FILE_MP4_SEVEN_TWENTY_P",u),o.$el.off("OPTIONS_RENDERED",p)},f=function(){o.$el.on("DOWNLOAD_FILE_IMG_PNG",d),o.$el.on("DOWNLOAD_FILE_IMG_JPG",d),o.$el.on("DOWNLOAD_FILE_IMG_PNG_V2",h),o.$el.on("DOWNLOAD_FILE_IMG_JPEG_V2",h),o.$el.on("DOWNLOAD_FILE_PDF",c),o.$el.on("DOWNLOAD_FILE_MP4_SEVEN_TWENTY_P",u),o.$el.on("OPTIONS_RENDERED",p)};return l(n),o.events.subscribe("shown",f),o.events.subscribe("hidden",m),o.isHidden()||f(),o}}.apply(t,o))||(e.exports=r)},mpVL:function(e,t,n){"use strict";var o=n("ApVh"),r=n.n(o),s=n("Uwho"),i=n.n(s);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class l{static async convertUrlToBlob(e,t){let n,o="";t&&(o=await r.a.getAccessToken()),n=o?{"x-api-key":l.key,Authorization:"Bearer "+o}:{"x-api-key":l.key};const s={originalUrl:e};return window.fetch(e,{method:"GET",headers:new window.Headers(n)}).then(e=>e.blob()).then(e=>{const t=URL.createObjectURL(e);return s.blobUrl=t,s}).catch(e=>(s.error=e,s))}static async convertUrlToBlobWithHeaders(e,t){let n=l.cachedImageUrls[e];return n||(n=await l.convertUrlToBlob(e,t),l.cachedImageUrls[e]=n),Promise.resolve(n)}static getMatrixHref(e,t,n){const o=e.split("{;");let[r]=o;return r=`${r};size=${t}`,r}static async getRenditionFromInfo(e,t,n,o){const r=e.templated?l.getMatrixHref(e.href,t,n):e.href;return l.convertUrlToBlobWithHeaders(r,o)}static getRenditionLinkFromInfo(e,t,n){return`${e.templated?l.getMatrixHref(e.href,t,n):e.href}?api_key=${l.key}`}}a(l,"cachedImageUrls",{}),a(l,"key",i.a.sparkContentSearchApiKey);var c=n("3xm6"),d=n.n(c),u=n("MGCh");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f=n.n(u).a.channel("design-assets-data-controller");var g,b,v;!function(e){e.asset="asset",e.group="group"}(g||(g={})),function(e){e.none="none",e.stickers="stickers",e.designAssets="designAssets",e.backgrounds="backgrounds",e.rootAssets="rootAssets"}(b||(b={})),function(e){e.Folder="folder",e.Collection="collection",e.File="file"}(v||(v={}));const I={[v.Folder]:"vnd.adobecloud.directory+json",[v.File]:"image*",[v.Collection]:"vnd.adobe.light.collection+json"},w="http://ns.adobe.com/adobecloud/rel/rendition",T=!0,y={Stickers:{key:"stickers",value:"Stickers",dal1:b.stickers,maxSearchGroupingLevel:1,path:"/Stickers"},DesignAssets:{key:"designAssets",value:"Design Assets",dal1:b.designAssets,maxSearchGroupingLevel:2,path:"/Design Assets"},RootAssets:{key:"rootAssets",value:"Root Assets",dal1:b.rootAssets,maxSearchGroupingLevel:2,path:""},Backgrounds:{key:"backgrounds",value:"Backgrounds",dal1:b.backgrounds,maxSearchGroupingLevel:1,path:"/Backgrounds"}};class S{constructor(e,t,n,o,r,s){m(this,"dataInitted",!1),m(this,"topItem",void 0),m(this,"id",void 0),m(this,"daL1",void 0),m(this,"currentTop",void 0),m(this,"currentTopFolder",void 0),m(this,"currentPathItems",[]),m(this,"mainDataReadyPromise",void 0),m(this,"defaultLocale","en-US"),m(this,"locale","en-US"),m(this,"searchHost",""),m(this,"userIsPremium",!1),m(this,"premiumBadgeVariant","crown"),m(this,"dragAndDropEnabled",!1),m(this,"defaultNumSearchResults",100),m(this,"defaultNumFolderEnumerationResults",100),m(this,"cachedFolderAggs",{}),m(this,"use2XThumbs",!1),m(this,"mainItems",{files:[],folders:[],collections:[]}),m(this,"rootFolder",{type:g.group,title:"Root"}),m(this,"RENDER_LINK_PRIMARY","http://ns.adobe.com/adobecloud/rel/primary"),m(this,"currentRenderDetails",{collectionItems:[],photoGridItems:[],showFlatThumbnailView:!1,flatIs2:!1,title:"",breadcrumbItems:[],searchSuggestedTopics:[],searchInputText:"",searchPlaceholder:"",photoGridResultsLabel:"",totalPhotoGridItemsCount:0}),this.id=e,this.searchHost=t,this.topItem=S.itemFromSelectKey(e),this.currentRenderDetails.title=this.topItem.value,this.mainDataReadyPromise=this.initMainBrowseData(this.topItem,s),this.userIsPremium=n,this.premiumBadgeVariant=o,this.dragAndDropEnabled=r,this.use2XThumbs=window.devicePixelRatio>=2}async navToFolder(e,t){if(this.currentTop){if(e===this.rootFolder)this.currentPathItems.splice(1),this.setCurrentSearch();else{const{contentItem:t}=e;if(!t)return;const n="/content/assets/publish"+this.topItem.path,o=(t.path.split(n+"/")[1]||"").split("/");if(o.pop(),this.currentPathItems.splice(1),o.length){let e=n;o.forEach(t=>{e=`${e}/${t}`;const n={loadPath:e,type:g.group,title:t};this.currentPathItems.push(n)})}this.currentPathItems.push(e)}return this.pathItemsUpdated(),this.currentTop.bottomItem=e,t.q||t.filters.length?await this.executePanelSearch(t):(await this.loadFolderTags(e),this.setCurrentSearch(),this.currentTop.searchInfo.q=""),this.currentTop.bottomItem}}pathItemsUpdated(){1===this.currentPathItems.length?this.currentRenderDetails.breadcrumbItems=[]:this.currentRenderDetails.breadcrumbItems=this.currentPathItems.map(e=>({id:e.id||"",label:e.title}))}async resetToTop(){await this.navToFolder(this.rootFolder,{q:"",filters:[]})}async showingFromSearchProps(e){var t,n,o,r;let s;await this.mainDataReadyPromise;const i="/content/assets/publish"+e.path,a=e.folderId||e.collId,l={filters:[],q:e.text||""};if(e.filters){const t=e.filters.split(",");l.filters=t.map(e=>({id:e,label:e,count:0,selected:!0}))}var c;if(e.folderId===this.rootFolder.id||(null===(t=this.rootFolder.contentItem)||void 0===t?void 0:t.path)===i)s=null===(c=this.currentTop)||void 0===c?void 0:c.rootItem;else if(!(null===(n=this.currentTop)||void 0===n?void 0:n.bottomItem)||a!==this.currentTop.bottomItem.id&&i!==(null===(o=this.currentTop.bottomItem.contentItem)||void 0===o?void 0:o.path)){const t=e.folderId?this.mainItems.folders:this.mainItems.collections,n=e.folderId||e.collId;s=t.find(e=>{var t;return e.id===n||i===(null===(t=e.contentItem)||void 0===t?void 0:t.path)})}else{var d;s=null===(d=this.currentTop)||void 0===d?void 0:d.bottomItem}if(s)await this.navToFolder(s,l);else{if(e.folderId||e.collId){const t=e.folderId?"folders":"collections",n=await this.fetchezLaVache(`/${t}/${a}`),{_links:o}=n;if(o){const e=n,t={contentItem:e,type:g.group,title:this.titleFromContentItem(e),id:e.id};return t.contentsLoader=this.loadFolderContents(t),await t.contentsLoader,void await this.navToFolder(t,l)}}if(e.path){var u;const t=(null===(u=this.rootFolder.contentItem)||void 0===u?void 0:u.name)||"",n=e.path.split("/");""===n[0]&&n.shift(),n[0]!==t&&n.unshift(t),""===n[n.length-1]&&n.pop();const o="/content/assets/publish".split("/").concat(n).join("%2F"),r=await this.fetchezLaVache("/resolve?path="+o),{_links:s}=r;if(s){const e=r,t={contentItem:e,type:g.group,title:this.titleFromContentItem(e),id:e.id};return t.contentsLoader=this.loadFolderContents(t),await t.contentsLoader,void await this.navToFolder(t,l)}}var h;if(null===(r=this.currentTop)||void 0===r?void 0:r.bottomItem)await this.navToFolder(null===(h=this.currentTop)||void 0===h?void 0:h.bottomItem,l)}}static itemFromSelectKey(e){switch(e){case y.Stickers.key:return y.Stickers;case y.DesignAssets.key:return y.DesignAssets;case y.RootAssets.key:return y.RootAssets;case y.Backgrounds.key:return y.Backgrounds}return y.RootAssets}static getEnumerationMatrixHref(e,t,n=100,o){let r=`${e.split("{?")[0]}?limit=${n}`;if(t){const e=[];t.forEach(t=>{const n=I[t];n&&e.push(n)}),e.length&&(r=`${r}&contentType=${e.join(",")}`)}return o&&(r=`${r}&orderBy=${o.join(",")}`),r}async fetchFolderContents(e,t,n){let o="";if(e.contentItem){const{_links:r}=e.contentItem,s=r["http://ns.adobe.com/light/rel/folder-enumeration"]||r["http://ns.adobe.com/light/rel/collection-enumeration"];o=s.templated?S.getEnumerationMatrixHref(s.href,t,n||this.defaultNumFolderEnumerationResults,["priority","-createDate"]):s.href}return this.fetchezLaVache(o).then(t=>{const{_embedded:n}=t;if(n){const o=n,{children:r,results:s,total:i}=o,a=this.folderContentsFromContentItems(r||s||[],e);return a.totalFiles=i,a.nextFilesHref=this.getNextHrefFromResults(t),a}return S.getFolderContentsForErrorReturn("404","no contents fetching folder contents")})}titleFromContentItem(e,t){let n;const o=null==e?void 0:e.title;return o&&(n=o[this.locale]||o[this.defaultLocale]),n||(n=e.name||"",t&&-1!==n.indexOf(".collection")&&(n=n.substring(0,n.indexOf(".collection")))),n}folderContentsFromContentItems(e,t,n){const o=[],r=n,s=e.reduce((e,t)=>{if(r&&t.directory!==r)return e;const{contentType:n}=t;if(0===n.indexOf("image")){const{_links:n}=t;n&&n[w]?e.files.push({contentItem:t,type:g.asset,title:this.titleFromContentItem(t),id:t.id}):f.info("image contentItem had no rendition",t)}else"application/vnd.adobecloud.directory+json"===n?e.folders.push({contentItem:t,type:g.group,title:this.titleFromContentItem(t),id:t.id,subs:[],items:[]}):"application/vnd.adobe.light.collection+json"===n?e.collections.push({contentItem:t,type:g.group,title:this.titleFromContentItem(t,!0),id:t.id,subs:[],items:[]}):o.push(t);return e},{files:[],folders:[],collections:[]});if(o.length&&(s.misteryoso=o),(s.folders.length||s.collections.length)&&s.files.length&&t&&t.contentItem){const e={title:d.a.translate("app.designAssets.miscFolderName",{folderName:this.titleFromContentItem(t.contentItem)}),isDanglingSubFolder:!0,folderContents:{files:s.files,folders:[],collections:[]},contentItem:t.contentItem,type:g.group,id:t.id,subs:[],items:s.files};s.files=[],s.folders.push(e)}return s}static getFolderContentsForErrorReturn(e,t){return{error:{error:e,errorText:t},files:[],totalFiles:0,folders:[],collections:[]}}static tagsFromAggregates(e){let t;const n={},{topics:o}=e,r=[];return o&&o.buckets.forEach(e=>{if(e.key){let{label:o}=e;o||(o=e.key[0].toUpperCase()+e.key.substring(1)),t={label:o,id:e.key,count:e.docCount},n[t.id]=t,r.push(t)}}),r.sort((e,t)=>e.count-t.count),{ordered:r,byId:n}}async loadFolderTags(e){const t=e.id||"";let n=this.cachedFolderAggs[t];if(!n){var o;const r={q:"*",limit:"1",qLoc:"en-US",aggs:"topics",orderBy:"-createDate",aggsLimit:"20",schema:"ASSET",filters:`directory:("${null===(o=e.contentItem)||void 0===o?void 0:o.path}/") AND NOT contentType:vnd.adobecloud.directory+json`},s=await this.fetchezLaVache("",r),{_embedded:i}=s,a=i;n={daTags:S.tagsFromAggregates(a.aggregations),totalAssets:a.total},this.cachedFolderAggs[t]=n}return e.daTags=n.daTags,e.totalAssets=n.totalAssets,e.daTags}async fetchezLaVache(e,t){let n=e;if(-1===e.indexOf("https:")&&(n=`https://${this.searchHost}/v2/content${e}`),t){n=`${n}?${new URLSearchParams(t)}`}const o={"x-api-key":i.a.sparkContentSearchApiKey};return window.fetch(n,{method:"GET",headers:new window.Headers(o)}).then(e=>e.status<300?200===e.status?e.json().then(e=>e):{status:e.status}:(e.status,{error:e.status,errorText:e.statusText})).catch(e=>({error:e,errorText:"fetch-error"}))}static doesAssetHaveFilters(e,t,n){return!!e.tags&&(1===t.length?e.tags[t[0].id]:n?!t.find(t=>!e.tags||!e.tags[t.id]):!!t.find(t=>!e.tags||e.tags[t.id]))}getItemUpgradePreviewLink(e){const{contentItem:t}=e;return t?l.getRenditionLinkFromInfo(t._links[w],160):""}getHigherResRenditionLink(e,t){let n="";const{contentItem:o}=e;if(o){"premium"===o.licensingCategory||(n=l.getRenditionLinkFromInfo(o._links[w],t))}return n}async fetchHigherResRendition(e,t){const{contentItem:n}=e;if(n){const e="premium"===n.licensingCategory;return l.getRenditionFromInfo(n._links["http://ns.adobe.com/adobecloud/rel/rendition"],t,void 0,this.userIsPremium&&e).then(e=>e.blobUrl?e.blobUrl:l.getRenditionLinkFromInfo(n._links[w],160))}return""}assetSelectDataFromThumbId(e){var t,n;const o=null===(t=this.currentTop)||void 0===t?void 0:t.bottomItem;let r;if(o)return(null===(n=this.currentTop)||void 0===n?void 0:n.searchInfo.currentSearch)&&this.currentTop.searchInfo.currentSearch.assets&&(r=this.currentTop.searchInfo.currentSearch.assets.find(t=>t.id===e),!r&&this.currentTop.searchInfo.currentSearch.searchSubs&&this.currentTop.searchInfo.currentSearch.searchSubs.find(t=>{var n;return!!(null===(n=t.searchInfo.assets)||void 0===n?void 0:n.length)&&(r=t.searchInfo.assets.find(t=>t.id===e),!!r)})),r||(o.subs&&o.subs.length?o.subs.find(t=>(r=t.heroes&&t.heroes.find(t=>t.id===e),r)):o.items&&(r=o.items.find(t=>t.id===e))),r&&this.extendAssetDataForSelectEvent(r)}extendAssetDataForSelectEvent(e){if(!this.currentTop||!this.currentTopFolder)return{item:e};let t=this.currentTopFolder;1!==this.currentTop.pathItems.length&&(t=this.currentTop.bottomItem);const n=t.contentItem;if(!n)return{item:e};const o=n.path.split("/content/assets/publish")[1];let r="";if(this.currentTop.searchInfo.currentSearch){const{filters:e}=this.currentTop.searchInfo.currentSearch;e&&e.length&&(r=e.map(e=>e.id).join(","))}const s={text:this.currentTop.searchInfo.q,path:o,filters:r};"application/vnd.adobe.light.collection+json"===n.contentType?s.collId=n.id:s.folderId=n.id;return{item:e,searchProps:s,searchText:this.currentTop.searchInfo.q,searchFiltersStr:r}}async updateFolderItemLoadByPath(e){const t=(e.loadPath||"").split("/").join("%2F");return this.fetchezLaVache("/resolve?path="+t).then(t=>{const n=p({},t),{_links:o}=n;if(o){const t=n;return e.loadPath=void 0,e.title=this.titleFromContentItem(t),e.id=t.id,e.contentItem=t,e.contentsLoader=this.loadFolderContents(e),e.contentsLoader}})}async handleNavBack(e){var t;if(!this.currentTop)return;if(e){let t=-1;this.currentPathItems.find((n,o)=>n.id===e&&(t=o,!0)),-1!==t&&this.currentPathItems.splice(t+1)}else this.currentPathItems.length>1&&this.currentPathItems.pop();this.pathItemsUpdated();const n=this.currentPathItems[this.currentPathItems.length-1];this.currentTop.searchInfo.currentSearch&&(this.currentTop.searchInfo.currentSub=this.currentPathItems.length>1?n:void 0),this.currentTop.bottomItem=n,n.loadPath&&await this.updateFolderItemLoadByPath(n),(null===(t=this.currentTop.searchInfo.currentSearch)||void 0===t?void 0:t.searchOptions)?await this.executePanelSearch(this.currentTop.searchInfo.currentSearch.searchOptions):this.recalculateCurrentSearchTopics()}async handleMoreClick(e){var t,n;if(this.currentTop){if(this.currentTop.searchInfo.currentSearch){var o;if(this.currentTop.searchInfo.currentSearch.subs){const t=this.currentTop.searchInfo.currentSearch.subs[e];this.currentTop.searchInfo.currentSub=t,this.currentTop.bottomItem=t}else{if(!(null===(o=this.currentTop.bottomItem)||void 0===o?void 0:o.subs))return;{const t=this.currentTop.bottomItem.subs[e];this.currentTop.searchInfo.currentSub=t,this.currentTop.bottomItem=t}}}else{const t=this.currentTop.bottomItem.subs||this.currentTop.bottomItem.items;if(!t)return;{const n=t[e];if(!n)return;n.contentsLoader||(n.contentsLoader=this.loadFolderContents(n)),await n.contentsLoader,await this.loadFolderTags(n),this.currentTop.bottomItem=n}}var r;return this.currentPathItems.push(this.currentTop.bottomItem),this.pathItemsUpdated(),(null===(t=this.currentTop.searchInfo.currentSearch)||void 0===t?void 0:t.searchOptions)?(await this.executePanelSearch(this.currentTop.searchInfo.currentSearch.searchOptions),{assetPath:null===(r=this.currentTop.bottomItem.contentItem)||void 0===r?void 0:r.path,assetId:this.currentTop.bottomItem.id,searchInput:this.currentTop.searchInfo.currentSearch.searchOptions.q,filters:this.currentTop.searchInfo.currentSearch.searchOptions.filters}):(this.recalculateCurrentSearchTopics(),{assetPath:null===(n=this.currentTop.bottomItem.contentItem)||void 0===n?void 0:n.path,assetId:this.currentTop.bottomItem.id})}}async searchCleared(){if(this.currentTop&&this.currentTop.bottomItem!==this.rootFolder){const{bottomItem:e}=this.currentTop;e.contentsLoader||(e.contentsLoader=this.loadFolderContents(e)),await e.contentsLoader,await this.loadFolderTags(e)}this.setCurrentSearch()}static getCollectionsFromSubs(e){return e.filter(e=>{var t;return"application/vnd.adobe.light.collection+json"===(null===(t=e.contentItem)||void 0===t?void 0:t.contentType)})}async searchTopicDeselected(e,t){if(!this.currentTop)return;const{searchInfo:n}=this.currentTop;let o=n.currentSearch&&n.currentSearch.filters&&n.currentSearch.filters.length&&n.currentSearch.filters||[];return o=o.filter(t=>t.id!==e.id),this.executePanelSearch({q:t,filters:o})}async searchTopicClick(e,t){var n;if(!this.currentTop)return;const{searchInfo:o}=this.currentTop,r=o.currentTags.ordered.find(t=>t.id===e.id);if(!r)return;r.selected=!e.isSelected;let s=[];o.currentSearch&&o.currentSearch.filters&&o.currentSearch.filters.length&&(s=[...o.currentSearch.filters]);let i=-1;const a=s.find((t,n)=>t.id===e.id&&(i=n,!0));return e.isSelected?a&&s.splice(i,1):a||s.push(r),t&&t.hideSearch(),this.executePanelSearch({q:(null===(n=o.currentSearch)||void 0===n?void 0:n.q)||"",filters:s})}recalculateCurrentSearchTopics(){if(!this.currentTop)return;const{searchInfo:e,bottomItem:t}=this.currentTop,n=e.currentSearch&&e.currentSearch.daTags||t&&t.daTags||e.daTags,o=e.currentSearch&&e.currentSearch.filters&&e.currentSearch.filters.length&&e.currentSearch.filters,r=[],s=[];n.ordered.forEach(e=>{const t={label:e.label,id:e.id,isSelected:!(!o||!o.find(t=>e.id===t.id))};t.isSelected?r.push(t):s.push(t)}),e.currentTags=n,this.currentRenderDetails.searchSuggestedTopics=r.concat(s)}async loadMoreForCurrentBottom(){if(!this.currentTop)return 0;const{bottomItem:e}=this.currentTop,{folderContents:t}=e;if(!t)return 0;const{nextFilesHref:n}=t;return n?this.fetchezLaVache(n).then(n=>{const{_embedded:o,error:r}=n;if(r)return 0;const s=o;t.totalFiles=s.total,t.nextFilesHref=this.getNextHrefFromResults(n);const i=this.folderContentsFromContentItems(s.children||s.results||[]);return t.files=t.files.concat(i.files),e.items=t.files,t.files.length}):0}async handleLoadMore(){if(!this.currentTop)return 0;const{currentSearch:e}=this.currentTop.searchInfo;if(!e)return this.loadMoreForCurrentBottom();const{nextHref:t}=e;return t?this.fetchezLaVache(t).then(t=>{var n;const{_embedded:o,error:r}=t;if(r)return 0;e.nextHref=this.getNextHrefFromResults(t);const s=o,i=this.folderContentsFromContentItems(s.results);if(e.total=s.total,e.assets=null===(n=e.assets)||void 0===n?void 0:n.concat(i.files),this.currentTop){const t=this.currentTop.searchInfo.cachedResults[e.cacheId||""];t&&(t.total=e.total,t.assets=e.assets,t.nextHref=e.nextHref)}return i.files.length}):0}cleanUserString(e){return e.replace(/[.,\/#!$%\^&\*;:{}\]\[=\_"`~()\\]/g," ").replace(/ +/g," ").trim()}async executePanelSearch(e){var t;if(!this.currentTop)return;let n=this.currentTopFolder,o=(null===(t=this.currentTop.rootItem.subs)||void 0===t?void 0:t.length)&&this.currentTop.pathItems.length<this.currentTop.searchInfo.maxSearchGroupingLevel&&this.currentTop.rootItem.subs;if(1!==this.currentTop.pathItems.length&&(n=this.currentTop.bottomItem),!n)return;let{filters:r,q:s=""}=e;if(s=this.cleanUserString(s),!r){const{searchInfo:e}=this.currentTop;r=e.currentSearch&&e.currentSearch.filters&&e.currentSearch.filters.length&&e.currentSearch.filters||[]}if(!s&&!r.length)return void this.navToFolder(this.currentTop.bottomItem,{q:s,filters:r});const i=s.toLowerCase();let a=`${n.id||""}:${i}`;r&&r.length&&(a+="_::"+r.map(e=>e.id).join(":")),this.currentTop.searchInfo.q=s;let l=this.currentTop.searchInfo.cachedResults[a],c=this.currentTop.searchInfo.currentSearch&&this.currentTop.searchInfo.currentSearch.daTags;if(!l){const t=p(p({},e),{},{q:s,filters:r});l=await this.executeRealSearch(n,t);const i=o&&S.getCollectionsFromSubs(o)||[];if(o&&!l.error&&l.assets&&(l.total>l.assets.length||i.length)){const e=[];l.searchSubs=e,l.assets=[],l.total||(o=i),l.total=0;const n=o.map((n,o)=>this.executeRealSearch(n,p(p({},t),{},{limit:3,assetTypes:[v.File],orderBy:["-_score","-createDate"],customAndFiltersStr:"(hero:(true^2) OR hero:(NOT exists))"})).then(t=>{l.total+=t.total,t.assets&&(l.assets=(l.assets||[]).concat(t.assets)),e[o]={group:n,searchInfo:t}}));await Promise.all(n)}l.pathItems=this.currentTop.pathItems,l.daTags=l.aggregations&&S.tagsFromAggregates(l.aggregations),l.cacheId=a,this.currentTop.searchInfo.cachedResults[a]=l}return l.daTags&&l.daTags.ordered.length?c=l.daTags:c&&!c.ordered.length&&(c=void 0),this.setCurrentSearch(p(p({},l),{},{daTags:c})),this.currentTop.searchInfo.currentSearch&&(this.currentTop.searchInfo.currentSearch.searchOptions=e),this.currentPathItems=l.pathItems,this.pathItemsUpdated(),l.pathItems.length>1?this.currentTop.searchInfo.currentSub=l.pathItems[l.pathItems.length-1]:this.currentTop.searchInfo.currentSub=void 0,l}getNextHrefFromResults(e){const{_links:t}=e;let n=t&&t.next&&t.next.href;return n&&n.startsWith("/v2/content")&&(n=n.split("/v2/content")[1]),n||""}async executeRealSearch(e,t){var n;const o=t.orderBy?[...t.orderBy]:["-createDate"];let r;var s;t.rootOnly&&(o.unshift("directory"),r=null===(s=e.contentItem)||void 0===s?void 0:s.path);let i;var a;"application/vnd.adobe.light.collection+json"===(null===(n=e.contentItem)||void 0===n?void 0:n.contentType)?i=`collections:("${e.id}")`:i=`directory:("${null===(a=e.contentItem)||void 0===a?void 0:a.path}/")`;const{filters:l=[],multiFiltersIsAnd:c=T,q:d}=t;if(l&&l.length){i=`${i} AND (topics:${l.map(e=>e.id).join(c?" AND ":" OR ")})`}if(t.assetTypes){i=`${i} AND (contentType:${t.assetTypes.map(e=>I[e]).join(" OR ")})`}else i+=" AND NOT contentType:vnd.adobecloud.directory+json";t.customAndFiltersStr&&(i=`${i} AND (${t.customAndFiltersStr})`);const u={q:d||"*",limit:""+(t.limit||this.defaultNumSearchResults),qLoc:"en-US",orderBy:o.join(","),schema:"ASSET",filters:i};let h={};return h=t.noAggs?u:p(p({},u),{},{aggs:"topics",aggsLimit:20}),this.fetchezLaVache("",h).then(e=>{const{_embedded:t,error:n}=e;if(n){return{q:d,filters:l,depth:1,total:0,assets:[],subs:[],pathItems:[]}}const o=t,s=this.folderContentsFromContentItems(o.results,void 0,r);return{folderContents:s,nextHref:this.getNextHrefFromResults(e),q:d,filters:l,count:o.count,total:o.total,depth:1,assets:s.files,aggregations:o.aggregations,pathItems:[]}})}async loadFolderContents(e){return e.contentItem?e.isDanglingSubFolder?(e.folderContents||(e.folderContents=S.getFolderContentsForErrorReturn("null folderContents","loadFolderContents danglingSubFolder had no contents")),e.folderContents):this.fetchFolderContents(e).then(t=>(e.folderContents=t,e.subs=t.collections.concat(t.folders),e.items=t.files,t.folders.length||t.collections.length?this.initFolderSubs(e).then(()=>t):t)):S.getFolderContentsForErrorReturn("fakery","loadFolderContents fakery")}async heroesFromFolder(e){return this.executeRealSearch(e,{q:"",limit:10,assetTypes:[v.File],rootOnly:e.isDanglingSubFolder,orderBy:["-_score","priority","-createDate"],customAndFiltersStr:"(hero:(true^2) OR hero:(NOT exists))",noAggs:!0}).then(t=>(e.heroes=t.assets||[],e.heroes))}async initFolderSubs(e){const{folderContents:t}=e;if(!t||!e.contentItem)return[];const n=[];return t.collections.forEach(e=>{e.heroesPromise=this.heroesFromFolder(e),n.push(e.heroesPromise)}),t.folders.forEach(e=>{e.heroesPromise=this.heroesFromFolder(e),n.push(e.heroesPromise)}),Promise.all(n).then(()=>t.collections.concat(t.folders))}getTotalAssets(){return this.currentTopFolder&&this.currentTopFolder.totalAssets||0}async getInitialDaDataPrivate(){const{dal1:e=b.none,maxSearchGroupingLevel:t=0}=this.topItem;let n=this.currentTop;if(n)return n;const o=this.rootFolder;this.currentTopFolder=o,o.subs=await this.initFolderSubs(o),o.items=[];const r=await this.loadFolderTags(o);return n={dal1:e,rootItem:o,pathItems:[o],bottomItem:o,searchInfo:{daTags:r,maxSearchGroupingLevel:t,q:"",cachedResults:{},currentTags:r}},this.currentTop=n,this.currentTop.bottomItem=n.bottomItem,this.recalculateCurrentSearchTopics(),this.currentTop.searchInfo.currentSearch?this.currentPathItems=this.currentTop.searchInfo.currentSearch.pathItems:this.currentPathItems=this.currentTop.pathItems,this.pathItemsUpdated(),n}async initMainBrowseData(e,t){this.topItem=e,this.daL1=e.dal1;const n=("/content/assets/publish"+e.path).split("/").join("%2F");return this.fetchezLaVache("/resolve?path="+n).then(e=>{const n=p({},e),{_links:o}=n;if(o){const e=n;return this.rootFolder={contentItem:e,type:g.group,title:this.titleFromContentItem(e),id:e.id},this.fetchFolderContents(this.rootFolder,[v.Folder,v.Collection]).then(async e=>(this.mainItems=e,this.rootFolder.folderContents=e,this.getInitialDaDataPrivate().then(e=>(this.currentTop=e,this.dataInitted=!0,t(this),e))))}})}setCurrentSearch(e){this.currentTop&&(this.currentTop.searchInfo.currentSearch=e,this.recalculateCurrentSearchTopics())}getFlatItemsFromSubs(e,t){let n=t;return e.forEach(e=>{e.items&&e.items.length&&(n=n.concat(e.items)),e.subs&&e.subs.length&&(n=this.getFlatItemsFromSubs(e.subs,n))}),n}getAllItemsFromItem(e){let t=[];return e.items&&(t=t.concat(e.items)),e.subs&&e.subs.length&&(t=this.getFlatItemsFromSubs(e.subs,t)),t}getGroupForItems(e,t="",n,o,r=!1,s){return{isFromSearchResult:r,title:t,collectionId:""+n,totalCollectionCount:""+(void 0!==s?s:""),items:e.map(e=>this.getAssetForRender(e,3,o))}}renderFlatItems(e,t){let n=3;e.length<=t.flat2ColThreshold&&(n=2);return{itemsForRender:e.map(e=>this.getAssetForRender(e,n,t)),flatIs2:2===n}}getPremiumBadgeType(e){var t;const n="premium"===(null===(t=e.contentItem)||void 0===t?void 0:t.licensingCategory);if("text"===this.premiumBadgeVariant)return this.userIsPremium?n?"premium-text-premium-user":"":n?"":"free-text-non-premium-user";if(!n)return"";const o=this.userIsPremium?"premium-user":"non-premium-user";return`${this.premiumBadgeVariant}-${o}`}getAssetForRender(e,t,n){let o="",r="";const{contentItem:s}=e;let i=!0;if(s){o=s.id,i="premium"===s.licensingCategory;let e=n.colSizes[""+t]||160;this.use2XThumbs&&(e*=2),e>160&&i&&(e=160),r=l.getRenditionLinkFromInfo(s._links[w],e)}return{id:o,url:r,isPremium:i,premiumType:this.getPremiumBadgeType(e),isDraggable:this.dragAndDropEnabled}}renderGroup(e,t,n,o,r,s){if(s&&!s.length)return;const i=e.heroes,a=s||i||e.items||[],l=!!s,c=r||a.length;if(!c)return;let d;d=1===n?3:3*n;const u=Math.min(d,c),h=a.slice(0,u);return this.getGroupForItems(h,e.title,t,o,l,r)}getCurrentSearchResultsForRender(e,t){var n;const{currentSearch:o,maxSearchGroupingLevel:r}=e;if(!o)return{};const{searchSubs:s,assets:i=[]}=o;let a;const l=[],c={},d=this.currentPathItems.length;if(a=null===(n=this.currentTop)||void 0===n?void 0:n.bottomItem,!s&&i.length&&d<r&&a&&a.subs&&a.subs.length>1){var u;const e=(null===(u=a.subs[0].contentItem)||void 0===u?void 0:u.directory)+"/";a.subs.forEach(t=>{var n;const o=(null===(n=t.contentItem)||void 0===n?void 0:n.path.split(e)[1])||"",r={group:t,assets:[]};c[o]=r,l.push(r)}),i.forEach(t=>{var n;const o=((null===(n=t.contentItem)||void 0===n?void 0:n.directory.split(e)[1])||"").split("/")[0],r=c[o];r&&r.assets.push(t)})}if(!i.length||!s&&!l.length)return{totalPhotoGridItemsCount:o.total,flatItems:this.renderFlatItems(i,t)};const h=[];return s?s.forEach((e,n)=>{const o=this.renderGroup(e.group,n,1,t,e.searchInfo.total,e.searchInfo.assets);o&&h.push(o)}):l.length?l.forEach((e,n)=>{const o=this.renderGroup(e.group,n,1,t,e.assets.length,e.assets);o&&h.push(o)}):o&&o.subs&&o.subs.forEach((e,n)=>{const o=this.renderGroup(e,n,1,t);o&&h.push(o)}),{collectionItems:h}}getRenderDetails(e){var t;const{currentTop:n}=this;let o=[],r=[],s=!1,i=!0,a="",l="",c=0;if(n){if(this.currentRenderDetails.title=n.bottomItem.title,n.searchInfo.currentSearch){const t=this.getCurrentSearchResultsForRender(n.searchInfo,e);t.flatItems?(r=t.flatItems.itemsForRender,s=!0,i=t.flatItems.flatIs2,c=t.totalPhotoGridItemsCount):t.collectionItems&&(o=t.collectionItems)}else if(n.bottomItem.subs&&n.bottomItem.subs.length){const t=n.pathItems.length>1?2:1;n.bottomItem.subs.forEach((n,r)=>{const s=this.renderGroup(n,r,t,e);s&&o.push(s)})}else{var u;const t=n.bottomItem,o=t.heroes,a=t.items&&t.items.length&&t.items||o||[],l=this.renderFlatItems(a,e),d=(null===(u=t.folderContents)||void 0===u?void 0:u.totalFiles)||a.length;r=l.itemsForRender,c=d,s=!0,i=l.flatIs2}a=d.a.translate("app.designAssets.searchPlaceholder",{folderName:this.currentRenderDetails.title}),s&&(l=d.a.translate("app.designAssets.gridResultsLabel",{count:r.length,total:c}))}return this.currentRenderDetails.photoGridItems=r,this.currentRenderDetails.showFlatThumbnailView=s,this.currentRenderDetails.flatIs2=i,this.currentRenderDetails.collectionItems=o,this.currentRenderDetails.searchInputText=(null===(t=this.currentTop)||void 0===t?void 0:t.searchInfo.q)||"",this.currentRenderDetails.searchPlaceholder=a,this.currentRenderDetails.totalPhotoGridItemsCount=c,this.currentRenderDetails.photoGridResultsLabel=l,this.currentRenderDetails}}t.a=S},nhA5:function(e,t,n){var o,r;function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}o=[n("Na8G"),n("xFnQ"),n("2Fsf"),n("+Ltv"),n("PsNr"),n("MGCh"),n("bBG2"),n("YLtl")],void 0===(r=function(e,t,n,o,r,a,l,c){return function(d){d.tag=t.TheoDesignAssetsPanel.elementName;const u=new n(d),h=u.update,p=d.onClose,m=d.dataController,f=d.panelId,g=d.premiumBadgeVariant,b=d.userIsPremium,v=a.channel("DesignAssetsPanel"),I=l.default;let w=!1;const T=function(){const e=m.getRenderDetails({colSizes:{2:126,3:80},flat2ColThreshold:20});u.el.title=e.title,u.el.searchSuggestedTopics=e.searchSuggestedTopics,u.el.collectionItems=e.collectionItems,u.el.photoGridItems=e.photoGridItems,u.el.showFlatThumbnailView=e.showFlatThumbnailView,e.flatIs2?u.el.setAttribute("flat-thumb-col-gap-2","true"):u.el.removeAttribute("flat-thumb-col-gap-2"),u.el.breadcrumbItems=e.breadcrumbItems,u.el.searchInputText=e.searchInputText,u.el.searchPlaceholder=e.searchPlaceholder,u.el.totalPhotoGridItemsCount=e.totalPhotoGridItemsCount,u.el.photoGridResultsLabel=e.photoGridResultsLabel},y=function({hide:e=!1}={}){u.el.hide=e,u.el.panelId=f,u.el.premiumBadgeVariant=g,e||T()};function S(e){return"image/png"===e.contentType||(!!function(e){return"image/svg+xml"===e.contentType}(e)||function(e){if(0===e.contentType.indexOf("image/")){const t=e.contentType.split("image/")[1];if("jpg"===t||"jpeg"===t||"png"===t)return!1}return!0}(e))}function E(e){return S(e)?"image/png":e.contentType}function C(e){const{item:t,originalEvent:n}=e.originalEvent.detail,o=m.assetSelectDataFromThumbId(t.id),r=JSON.stringify(o);n.dataTransfer.setData("text",r)}async function F(t){if(this.clickBlocked)return;this.clickBlocked=!0,setTimeout(()=>{this.clickBlocked=!1},1e3);const n=m.assetSelectDataFromThumbId(t.originalEvent.detail.item.id),{item:a,searchProps:l,searchFiltersStr:c}=n,d=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},a.contentItem),h=d._links,p=h[m.RENDER_LINK_PRIMARY];if(!b&&"premium"===d.licensingCategory)return void function(t){const{contentItem:n}=t;e.showMerchMessagingModal({workflow:"addPremiumAssetFromEditor",asset:{id:n.id,urn:n.urn,alias:n.alias,tags:n.tags,animated:n.animated,isPremiumTemplate:!0,remixable:!0,remixpaid:!0,app:this._connectedApp,type:"designAsset_"+f,width:n.width,height:n.height,preloadedRenditionUrl:m.getItemUpgradePreviewLink(t)},totalAssets:m.getTotalAssets(),pickerId:f,editor:"post",assetType:"designAsset",analyticsPage:"editor:post"})}(a);d.schema=d.schema||"ASSET",d.source={name:"CC Light Design Assets"},d.license={short_name:d.licensingCategory},d.owner={name:"Adobe"},d.searchProps=JSON.stringify(l),d.title=d.name,d.design_intent=d.path,d.created_date=Date.parse(d.createDate),d.modified_date=Date.parse(d.modifyDate),d.tags=d.topics,d.context=p,d.searchText=l.text,d.searchFiltersStr=c;const g={link:p.href,width:d.width,height:d.height},v=m.getHigherResRenditionLink(a,512);let I;v||(I=m.fetchHigherResRendition(a,512));let w=512,T=512;if(g.width!==g.height&&(g.width>g.height?T/=g.width/g.height:w/=g.height/g.width),S(d)&&"image/png"!==d.contentType){const e=h["http://ns.adobe.com/adobecloud/rel/rendition"],t=o.maxImageSizeFromStorage;g.link=function(e,t){const n=e.split("{;");let[o]=n;return o=`${o};size=${t}`,o}(e.href,t),g.width===g.height?(g.width=t,g.height=t):g.width>g.height?(g.width=t,g.height=t*(g.height/g.width)):(g.height=t,g.width=t*(g.width/g.height))}let y=[{original:g,source:"CC Light Design Assets",mimeType:E(d),small:{blobPromise:I,link:v,width:w,height:T}}];y=r.cleanUpFiles(y),u.events.publish("item-selected",{files:y,info:d,designAssetsPanelId:f})}async function _(){await m.searchCleared(),T()}function L(e){return e?e.map(e=>e.id||e).join(","):""}function x(e){e&&I.publish("search:keywordEntered",{contextualData1:"keyword:"+e.q,contextualData2:"filters:"+L(e.filters),contextualData3:"type:"+f,contextualData4:"location:editor",contextualData5:"resultsCount:"+e.total})}async function k(e){const{options:t}=e.originalEvent.detail;x(await m.executePanelSearch(t)),T()}async function D(e){if(this.awaitingHandleMoreClick)return;this.awaitingHandleMoreClick=!0;const{collectionId:t}=e.originalEvent.detail,n=await m.handleMoreClick(+t);this.awaitingHandleMoreClick=!1;let o=L(n.filters),r=n.searchInput;r||o||(r="null",o="null"),n&&I.publish("editor:morePressed",{contextualData1:"assetPath:"+n.assetPath,contextualData4:"assetID:"+n.assetId,contextualData2:"filters:"+o,contextualData3:"keyword:"+r}),T()}async function P(){await m.handleNavBack(),T()}async function A(e){const{id:t}=e.originalEvent.detail.item;await m.handleNavBack(t),T()}async function R(){await m.handleLoadMore(),T()}async function O(e){const{inputText:t}=e.originalEvent.detail;x(await m.executePanelSearch({q:t.trim()})),T()}async function $(e){const{item:t}=e.originalEvent.detail;let n;e.currentTarget.shadowRoot&&e.currentTarget.shadowRoot.activeElement&&e.currentTarget.shadowRoot.activeElement.shadowRoot&&(n=e.currentTarget.shadowRoot.querySelector("theo-search"));x(await m.searchTopicClick(t,n)),T()}async function N(e){const{topic:t,searchInputText:n}=e.originalEvent.detail;x(await m.searchTopicDeselected(t,n)),T()}const H=function(){w&&(w=!1,u.$el.off("DESIGN_ASSETS_PANEL_CLOSE",p),u.$el.off("THUMBNAIL_CLICK_EVENT",F),u.$el.off("DESIGN_ASSETS_PANEL_BACK",P),u.$el.off("THEO_DESIGN_ASSETS_PANEL_SEARCH",k),u.$el.off("COLLECTION_SHOW_MORE_ITEMS",D),u.$el.off("BREADCRUMB_LABEL_CLICK",A),u.$el.off("SEARCH_INPUT_CHANGE",O),u.$el.off("SEARCH_CLEAR_ALL",_),u.$el.off("SEARCH_TOPIC_CLICK",$),u.$el.off("TOPIC_DESELECTED",N),u.$el.off("THUMBNAIL_DRAGSTART_EVENT",C),u.$el.off("INFINITE_SCROLL_SHOW_MORE_ITEMS",R))},j=function(){w||(w=!0,u.$el.on("DESIGN_ASSETS_PANEL_CLOSE",p),u.$el.on("THUMBNAIL_CLICK_EVENT",F),u.$el.on("DESIGN_ASSETS_PANEL_BACK",P),u.$el.on("THEO_DESIGN_ASSETS_PANEL_SEARCH",k),u.$el.on("COLLECTION_SHOW_MORE_ITEMS",D),u.$el.on("BREADCRUMB_LABEL_CLICK",A),u.$el.on("SEARCH_INPUT_CHANGE",O),u.$el.on("SEARCH_CLEAR_ALL",_),u.$el.on("SEARCH_TOPIC_CLICK",$),u.$el.on("TOPIC_DESELECTED",N),u.$el.on("THUMBNAIL_DRAGSTART_EVENT",C),u.$el.on("INFINITE_SCROLL_SHOW_MORE_ITEMS",R))};u.controllerLoaded=function(){T()},u.show=function(e){let t=e&&e.context&&e.context.search_props;if(t&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){v.warn("show error parsing searchProps",{error:e,searchProps:t})}else if(e.routeQuery){const{routeQuery:n}=e;t={},n.assetSearchFilters&&(t.filters=n.assetSearchFilters),n.assetFolderId&&(t.folderId=n.assetFolderId),n.assetSearchQ&&(t.text=n.assetSearchQ),n.assetSearchPath&&(t.path=n.assetSearchPath),c.isEmpty(t)&&(t=null)}t?m.showingFromSearchProps(t).then(()=>{y({hide:!1}),u.$el.appendTo(u.parent.$el),j(),T()}):e&&e.keepPreviousState?(y({hide:!1}),u.$el.appendTo(u.parent.$el),j()):m.resetToTop().then(()=>{y({hide:!1}),u.$el.appendTo(u.parent.$el),j(),T()})},u.hide=function(){y({hide:!0}),u.$el.detach(),H()},u.update=function({eleProps:e,attributes:t,state:n}){c.isEmpty(e)||(e.left=u.parent.getWidth()+20,h(e)),n&&(u.el.listOfLoadingAssets=n.listOfLoadingAssets),t&&y(t)};return u.el.className+=" design-assets-panel",y(),u.events.subscribe("shown",j),u.events.subscribe("hidden",H),u}}.apply(t,o))||(e.exports=r)},pEL3:function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("2Fsf"),n("KFmL"),n("8DU0")],void 0===(r=function(e,t,n,o,r){const s=r.default;var i={},a=0;return function(r){(r=r||{}).height=r.height||"auto",r.width=r.width||280,r.top=r.top||"auto",r.left=r.left||"auto",r.right=r.right||"auto",r.bottom=r.bottom||"auto",r.offsetX=r.offsetX||0,r.offsetY=r.offsetY||0,r.variant=r.variant||"default",r.standardPadding=r.standardPadding||!1,r.learnMore=r.learnMore||null,r.dismissable="boolean"!=typeof r.dismissable||r.dismissable,r.showCloseButton="boolean"!=typeof r.showCloseButton||r.showCloseButton,r.removeOnHidden="boolean"!=typeof r.removeOnHidden||r.removeOnHidden,r.closeButtonType=r.closeButtonType||"text";var l=r.userSettingFlag,c=r.arrowDirection?"coachmark-arrow-"+r.arrowDirection:"coachmark-arrow-right",d="center"===r.textAlign?"center-align":"",u="post-coachmark-"+r.variant;r.template="",r.hasHeroImage&&(r.template+='<div class="hero-bg"><p class="hero"></p></div>'),"none"!==r.arrowDirection&&(r.template+='<p class="'+c+'"></p>');var h=new n(r),p=h.show,m=h.hide,f="";"default"===r.variant&&r.title&&(f+='<p class=title "'+d+'">'+(r.title||"")+"</p>"),f+='<p class=body "'+d+'">'+(r.message||"")+" "+(r.learnMore||"")+"</p>";var g=new n({parent:h,class:"message",template:f});h.anchorElement=r.anchorElement;var b=r.onHide||function(){},v=r.onCloseClick||function(){};if(r.showCloseButton)new o({class:"coachmark-close",label:"i18n.components.coachmarks.common.kOK",closeButtonType:r.closeButtonType,parent:g,onClick:function(){w(),I(),v()}});else r.standardPadding?h.$el.addClass("no-close-with-padding"):h.$el.addClass("no-close");function I(){return h.hide(),l&&s.setSetting(l,!0),b(),r.removeOnHidden&&w(),T(100).then(()=>{!function(){for(var e=0;e<=a;e++){var t=i[e];if(t&&!t.anchorElement.isHidden()&&t.id!==h.id){t.show();break}}}()})}function w(){delete i[h.priority]}function T(e){return new Promise(n=>{t.delay(n,e)})}function y(t){e(t.target).is(".post-coachmark")||e(t.target).parents(".post-coachmark").length||e.contains(h.$el,t.target)||I()}function S(){var e=h.anchorElement.$el[0].getBoundingClientRect();"down"===r.arrowDirection?h.update({left:e.left-(r.width-e.width)/2+r.offsetX,top:e.top+r.offsetY}):"left"===r.arrowDirection?h.update({left:e.right+7+r.offsetX,top:e.top+r.offsetY}):"up"===r.arrowDirection?h.update({left:e.left-(r.width-e.width)/2+r.offsetX,top:e.bottom+7+r.offsetY}):"top-right"===r.arrowDirection?h.update({left:e.right-r.width+r.offsetX,top:e.bottom+7+r.offsetY}):h.update({left:e.left-r.width+7+r.offsetX,top:e.top+r.offsetY})}return h.priority=r.priority,h.show=function(){return T(200).then(()=>{if(h.isHidden()&&!h.anchorElement.isHidden()){var t=!0,n=null;if("number"==typeof h.priority)for(var o=0;o<h.priority;o++){if((l=i[o])&&!l.anchorElement.isHidden()){n=l;break}}if(!n){for(var s=0;s<=a;s++){var l;if((l=i[s])&&!l.isHidden()){t=!1;break}}return t?(S(),h.$el.addClass("fade"),p(),e(window).on("resize",S),T(0).then(()=>(r.dismissable&&e("#PostEditorContent").on("click touchend pointerup MSPointerUp","#PostApp",{isCoachmark:!0},y),T(200))).then(()=>{h.$el.removeClass("fade")})):void 0}n.show()}})},h.hide=function(){return e("#PostEditorContent").off("click touchend pointerup MSPointerUp",y),e(window).off("resize",S),h.$el.addClass("fade"),T(200).then(()=>{m(),h.$el.removeClass("fade")})},"number"==typeof h.priority&&(i[h.priority]=h,a=Math.max(a,h.priority)),h.reposition=function(){S()},h.el.className+=" post-coachmark "+u,h}}.apply(t,o))||(e.exports=r)},sggK:function(e,t,n){var o,r;o=[n("xeH2"),n("YLtl"),n("Avqh")],void 0===(r=function(e,t,n){var o={};return function(e){(e=e||{}).hidden="boolean"!=typeof e.defaultActive||!e.defaultActive;var r,s=new n(e),i=e.tabGroup||"default",a=!1,l=s.show,c=s.hide,d="boolean"==typeof e.rememberLastTab&&e.rememberLastTab;return s.registerTab=function(e){o[i].push(e),e.events.subscribe("select",(function(){!function(e){r=e.id,s.isHidden()&&s.show()}(e)}))},s.isActive=function(){return a},s.deselectSelected=function(){var e=o[i];for(var t in e)e[t].deselect()},s.hide=function(n){a=!1,s.$el.addClass("slide-right-fade-out"),t.delay((function(){s.$el.removeClass("slide-right-fade-out")}),200),c(n),"function"==typeof e.onHidden&&e.onHidden()},s.show=function(n){if(n=n||{},a=!0,s.$el.addClass("slide-left-fade-in"),n.noSelect||t.delay((function(){s.$el.removeClass("slide-left-fade-in")}),200),l(n),"function"!=typeof e.onShown||n.silent||e.onShown(),!n.noSelect&&d&&r)for(var c=o[i],u=0;u<o[i].length;u++)if(c[u].id===r&&!c[u].isSelected()){c[u].select();break}},s.$el.addClass("post-tab-set"),o[i]=[],s}}.apply(t,o))||(e.exports=r)},xX9p:function(e,t,n){"use strict";var o=n("ApVh"),r=n.n(o),s=n("bBG2"),i=n("MGCh"),a=n.n(i),l=n("1geK"),c=n("tpS0"),d=n.n(c);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let h,p,m,f,g;const b=a.a.channel("component:downloadList:mp4Download"),v=/[\/\?<>\\:\*\|"]/g,I=/[\x00-\x1f\x80-\x9f]/g,w=/^\.+$/,T=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,y=/[\. ]+$/;var S;!function(e){e[e.SEVEN_TWENTY_P=1280]="SEVEN_TWENTY_P",e[e.TEN_EIGHTY_P=1920]="TEN_EIGHTY_P"}(S||(S={}));class E extends Error{constructor(...e){super(...e),u(this,"response",void 0),u(this,"requestId",void 0)}}const C=e=>(e.returnValue="","Your download is not ready. If you close this window, you’ll have to download your file again."),F=()=>{window.removeEventListener("beforeunload",C)},_=e=>{const t=e.headers.get("X-Request-Id");if(e.ok)return e.blob();const n=new E(e.statusText);throw n.response=e,n.requestId=t,n};const L=(e,t,n,o)=>{const r=new Blob([e],{type:"application/mp4"}),i=function(e,t){if("string"!=typeof e)throw new Error("Input must be string");return e.replace(v,t).replace(I,t).replace(w,t).replace(T,t).replace(y,t)}(p+".mp4","");if(window.navigator&&window.navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(r,i),m.hide(),void F();const a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.download=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),m.hide(),F();const l=new Date;s.default.publish("download:mp4:succeeded",{projectId:t,xRequestId:o,timeSpent:Number(l)-Number(n)+"ms"})},x=(e,t,n)=>{m.hide(),F();const o=(e,t,o)=>{((e,t)=>{const n=t&&t.status>=500?'<p class="mp4-download-error-modal-content__retry"><span>i18n.dialogs.mp4DownloadError.kPleaseTryText</span> <a href="#" role="button" class="mp4-download-error-modal-content__link" js-retry-button>i18n.dialogs.mp4DownloadError.kDownloadingAgainText</a></p>':"",o=new d.a({headerText:'<span class="mp4-download-error-modal-header">\n            <span>i18n.dialogs.mp4DownloadError.kHeaderText</span>\n            <i class="mp4-download-error-modal-header__icon"></i>\n        </span>',contentText:`<div class="mp4-download-error-modal-content">${n}\n            <p>\n                <span>i18n.dialogs.mp4DownloadError.kPleaseText</span>\n                <a class="mp4-download-error-modal-content__link" href="https://adobespark.zendesk.com/hc/en-us/requests/new">\n                    i18n.dialogs.mp4DownloadError.kContactSupportText\n                </a>\n                <span>i18n.dialogs.mp4DownloadError.kWithFollowingErrorText</span>\n            </p>\n            <div class="mp4-download-error-modal-content__erro-block">\n                <textarea class="mp4-download-error-modal-content__erro-block__textarea">${e}</textarea>\n            </div>\n            <div class="mp4-download-error-modal-content__clipboard">\n                <span js-copy-to-clipboard>i18n.dialogs.mp4DownloadError.kClickToCopyText</span>\n                <span>i18n.dialogs.mp4DownloadError.kErrorCodeCopiedText</span>\n            </div>\n        </div>`,dismissable:!0,buttons:[{class:"pill pill-primary-on-light",label:"i18n.common.kDone",onClick(){o.hide()}}]}),r=e=>{const t=e.target;if(t.hasAttribute("js-retry-button"))return o.hide(),void k();if(t.hasAttribute("js-copy-to-clipboard")){const e=t&&t.parentElement;if(e&&e.previousElementSibling){const t=e.previousElementSibling.firstElementChild;t&&(t.select(),document.execCommand("copy"),e.classList.add("is-copied-text"),setTimeout(()=>{e.classList.remove("is-copied-text")},5e3))}}};document.addEventListener("click",r),o.show();window.marvel.events.on("spark-dialog-closed",()=>{document.removeEventListener("click",r)})})(t,o);const r=new Date;b.error(`[mp4 download] failed, projectId: ${e}, time spent: ${Number(r)-Number(n)}ms, error: ${t}`);let i="",a="";o&&(i=o.status,a=o.url),s.default.publish("download:mp4:failed",{projectId:e,timeSpent:Number(r)-Number(n)+"ms",error:t,status:i,url:a})};if(e.response)e.response.json().then(n=>{const r=`${n.message}&#013;&#010;code: ${n.error_code||e.response.status}&#013;&#010;requestId: ${e.requestId}`;o(t,r,e.response)});else{let n="unknown error";if(e.message)n=e.message;else if("object"==typeof e&&null!==e)try{n=JSON.stringify(e,null,2)}catch(e){n="unknown error - JSON.stringify: "+e}else"string"==typeof e&&(n=e);o(t,n)}},k=(e=S.SEVEN_TWENTY_P)=>{m.show(),p=f.getProjectName();const t=f.id,n=new Date;s.default.publish("download:mp4:started",{projectId:t});const o=l.default.getPgmGraphForPublish(h);if(!o)return m.hide(),b.error(`[mp4 download] failed, projectId: ${t}, PGM graph is null`),void s.default.publish("download:mp4:failed",{projectId:t,error:"PGM graph is null"});window.addEventListener("beforeunload",C);const i=l.default.getPublishRequestBody({publishTitle:"",authorFull:"",isPublic:!0,removeBranding:!1});i.pgmGraph=o.encode();const a=e,c=o.bounds.aspectRatio,d=c<1?a:Math.round(a/c),u=c<1?Math.round(a*c):a;i.renderOptions={videoHeight:d,videoWidth:u,scaleType:0},s.default.publish("download:mp4:send-pgm-request",{projectId:t});l.default.sendPgmPublishRequestForDownload(t,i,(e,t,n)=>{if("progress"===e){const e=m.$el.find("progress");e&&e.prop("value",t)}}).then(e=>{const o=e.downloadUrl,i=e.xRequestId;s.default.publish("download:mp4:received-download-url",{projectId:t,downloadUrl:o}),r.a.getAccessToken().then(e=>{fetch(o,{headers:{Authorization:"Bearer "+e,"X-Api-Key":g}}).then(_).then(e=>L(e,t,n,i)).catch(e=>{x(e,t,n)})})}).catch(e=>{m.hide(),x(e,t,n)})};t.a=function(e,t,n,o){f=e.currentDoc,h=n,g=t.cid,m=new d.a({id:"PostMP4DownloadModaloverlay",headerText:"i18n.dialogs.mp4DownloadModal.kHeaderText",contentText:'\n        <div class="mp4-download-modal-content">\n          <p>i18n.dialogs.mp4DownloadModal.kBodyText</p>\n          <progress id="render_progress" max="100" value="0" style="width:100%;"></progress>\n        </div>\n        ',dismissable:!0}),k(o)}}}]);
//# sourceMappingURL=theo-web-view_94b7f9b1-fad3af41.js.map